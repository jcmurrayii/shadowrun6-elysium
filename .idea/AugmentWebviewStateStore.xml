<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="AugmentWebviewStateStore">
    <option name="stateMap">
      <map>
        <entry key="CHAT_STATE" value="eyJjdXJyZW50Q29udmVyc2F0aW9uSWQiOiIxNTlhMjE1MS05NjYyLTQzYmYtYjlhNS0xMDcxYWE0ZTA1MDMiLCJjb252ZXJzYXRpb25zIjp7IjE1OWEyMTUxLTk2NjItNDNiZi1iOWE1LTEwNzFhYTRlMDUwMyI6eyJpZCI6IjE1OWEyMTUxLTk2NjItNDNiZi1iOWE1LTEwNzFhYTRlMDUwMyIsImNyZWF0ZWRBdElzbyI6IjIwMjUtMDUtMjdUMTU6NDM6NTMuNDExWiIsImxhc3RJbnRlcmFjdGVkQXRJc28iOiIyMDI1LTA2LTAyVDIyOjA3OjM5LjI3OVoiLCJjaGF0SGlzdG9yeSI6W3sicmVxdWVzdF9pZCI6Ijc2MjQzZjA5LWZmMDQtNDIyNi1iOTc1LTk5NjJiZDZjYTM2MSIsInV1aWQiOiI5ODAyZGMyOC01Y2EzLTQ0YWYtYTk2YS1mMWQzYjhhNDU5MjIiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjAsInRvVGltZXN0YW1wIjoxNzQ4MzYwNjMzNDE0LCJzZWVuX3N0YXRlIjoic2VlbiJ9LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI2MGE0MGM2OS1lOTY1LTQyYzYtODg1MC1mOWI5ZGE2NWMyMGMiLCJyZXF1ZXN0X21lc3NhZ2UiOiJmb3VuZHJ5IGNvbnRpbnVlcyB0byB0aHJvdyBlcnJvcnMgYWJvdXQgYWN0b3JzIG5vdCBleGlzdGluZyB3aGVuIHdlIGxvYWQgdGhlIGdhbWUuICBJIGJlbGlldmUgdGhpcyBtYXkgYmUgY2F1c2VkIGJ5IHRoZSBjb2RlIHRoYXQgaXMgc2VhcmNoaW5nIGZvciBhY3RvcnMgdG8gYWRkIG1hdHJpeCBhY3Rpb25zIGZvciwgYW5kIGlzIGFjY2Vzc2luZyB0b2tlbnMgd2l0aG91dCBhIGxpbmtlZCBhY3Rvcj8iLCJyaWNoX3RleHRfanNvbl9yZXByIjp7InR5cGUiOiJkb2MiLCJjb250ZW50IjpbeyJ0eXBlIjoicGFyYWdyYXBoIiwiY29udGVudCI6W3sidHlwZSI6InRleHQiLCJ0ZXh0IjoiZm91bmRyeSBjb250aW51ZXMgdG8gdGhyb3cgZXJyb3JzIGFib3V0IGFjdG9ycyBub3QgZXhpc3Rpbmcgd2hlbiB3ZSBsb2FkIHRoZSBnYW1lLiAgSSBiZWxpZXZlIHRoaXMgbWF5IGJlIGNhdXNlZCBieSB0aGUgY29kZSB0aGF0IGlzIHNlYXJjaGluZyBmb3IgYWN0b3JzIHRvIGFkZCBtYXRyaXggYWN0aW9ucyBmb3IsIGFuZCBpcyBhY2Nlc3NpbmcgdG9rZW5zIHdpdGhvdXQgYSBsaW5rZWQgYWN0b3I/In1dfV19LCJtZW50aW9uZWRfaXRlbXMiOltdLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFUc0xLU0ZlWTNmbTdyWWJwUnoxNkxEIiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJDb2RlIHRoYXQgc2VhcmNoZXMgZm9yIGFjdG9ycyB0byBhZGQgbWF0cml4IGFjdGlvbnMsIHBhcnRpY3VsYXJseSBhbnkgY29kZSB0aGF0IGFjY2Vzc2VzIHRva2VucyBhbmQgdGhlaXIgbGlua2VkIGFjdG9ycy4gTG9vayBmb3IgbWF0cml4IGFjdGlvbiBpbml0aWFsaXphdGlvbiwgdG9rZW4gcHJvY2Vzc2luZywgYW5kIGFjdG9yIGxvb2t1cCBmdW5jdGlvbmFsaXR5LlwifSIsIm1jcF9zZXJ2ZXJfbmFtZSI6IiIsIm1jcF90b29sX25hbWUiOiIifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkknbGwgaGVscCB5b3UgaW52ZXN0aWdhdGUgdGhlIGlzc3VlIHdpdGggYWN0b3JzIG5vdCBleGlzdGluZyB3aGVuIGxvYWRpbmcgdGhlIGdhbWUsIHBhcnRpY3VsYXJseSByZWxhdGVkIHRvIG1hdHJpeCBhY3Rpb25zIGFuZCB0b2tlbnMgd2l0aG91dCBsaW5rZWQgYWN0b3JzLiBMZXQgbWUgc3RhcnQgYnkgZ2F0aGVyaW5nIGluZm9ybWF0aW9uIGFib3V0IHRoZSBjdXJyZW50IGNvZGViYXNlIGFuZCB0aGUgc3BlY2lmaWMgZXJyb3IgcGF0dGVybnMuXG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjowLCJ0ZXh0X25vZGUiOnsiY29udGVudCI6ImZvdW5kcnkgY29udGludWVzIHRvIHRocm93IGVycm9ycyBhYm91dCBhY3RvcnMgbm90IGV4aXN0aW5nIHdoZW4gd2UgbG9hZCB0aGUgZ2FtZS4gIEkgYmVsaWV2ZSB0aGlzIG1heSBiZSBjYXVzZWQgYnkgdGhlIGNvZGUgdGhhdCBpcyBzZWFyY2hpbmcgZm9yIGFjdG9ycyB0byBhZGQgbWF0cml4IGFjdGlvbnMgZm9yLCBhbmQgaXMgYWNjZXNzaW5nIHRva2VucyB3aXRob3V0IGEgbGlua2VkIGFjdG9yPyJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSIsImZvbGRlclJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MTIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn19fV0sInRpbWVzdGFtcCI6IjIwMjUtMDUtMjlUMjM6MzE6NTkuMTQxWiIsInJlc3BvbnNlX3RleHQiOiJJJ2xsIGhlbHAgeW91IGludmVzdGlnYXRlIHRoZSBpc3N1ZSB3aXRoIGFjdG9ycyBub3QgZXhpc3Rpbmcgd2hlbiBsb2FkaW5nIHRoZSBnYW1lLCBwYXJ0aWN1bGFybHkgcmVsYXRlZCB0byBtYXRyaXggYWN0aW9ucyBhbmQgdG9rZW5zIHdpdGhvdXQgbGlua2VkIGFjdG9ycy4gTGV0IG1lIHN0YXJ0IGJ5IGdhdGhlcmluZyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgY3VycmVudCBjb2RlYmFzZSBhbmQgdGhlIHNwZWNpZmljIGVycm9yIHBhdHRlcm5zLlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6ImQ3N2RjZTdhLWQyYWUtNGM1NC1iNzJjLTdjZDk1MGJjNDA4ZSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMURNRnJSeTJSb1hBWVNCUDJ5M2JGZDMiLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIkNvZGUgdGhhdCBydW5zIGR1cmluZyBnYW1lIGluaXRpYWxpemF0aW9uIG9yIHdvcmxkIGxvYWRpbmcgdGhhdCBwcm9jZXNzZXMgdG9rZW5zIGFuZCBhY3RvcnMsIHBhcnRpY3VsYXJseSBhbnkgaG9va3Mgb3IgaW5pdGlhbGl6YXRpb24gY29kZSB0aGF0IG1pZ2h0IGJlIGFjY2Vzc2luZyB0b2tlbnMgd2l0aG91dCBjaGVja2luZyBpZiB0aGV5IGhhdmUgbGlua2VkIGFjdG9ycy4gTG9vayBmb3IgcmVhZHkgaG9va3MsIGluaXQgaG9va3MsIGFuZCBhbnkgY29kZSB0aGF0IGl0ZXJhdGVzIHRocm91Z2ggdG9rZW5zIG9yIHNjZW5lcy5cIn0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJOb3cgbGV0IG1lIGxvb2sgZm9yIG1vcmUgc3BlY2lmaWMgY29kZSByZWxhdGVkIHRvIHRva2VuIHByb2Nlc3NpbmcgYW5kIGFjdG9yIGxvb2t1cCBkdXJpbmcgZ2FtZSBpbml0aWFsaXphdGlvbjpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IHNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHNcbi4uLlxuICAgMzE3XHRcbiAgIDMxOFx0ICAgICAgICAvLyBFbnN1cmUgbWF0cml4IGFjdGlvbnMgYXJlIGF2YWlsYWJsZSBmb3IgYWxsIGFjdG9ycyB0aGF0IGNhbiB1c2UgdGhlIE1hdHJpeFxuICAgMzE5XHQgICAgICAgIGlmIChnYW1lLnVzZXI/LmlzR00gJiYgdGhpcy5pc093bmVyICYmICh0aGlzLmlzQ2hhcmFjdGVyKCkgfHwgdGhpcy5pc1Nwcml0ZSgpIHx8IHRoaXMuaXNJQygpKSkge1xuICAgMzIwXHQgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGFkZGVkIG1hdHJpeCBhY3Rpb25zIHRvIHRoaXMgYWN0b3JcbiAgIDMyMVx0ICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XG4gICAzMjJcdCAgICAgICAgICAgIGlmICghaGFzTWF0cml4QWN0aW9ucykge1xuICAgMzIzXHQgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byB1c2UgYSBzZXRUaW1lb3V0IHRvIGF2b2lkIGlzc3VlcyB3aXRoIHRoZSBhY3RvciBiZWluZyBsb2NrZWQgZHVyaW5nIGRhdGEgcHJlcGFyYXRpb25cbiAgIDMyNFx0ICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCksIDUwMCk7XG4gICAzMjVcdCAgICAgICAgICAgIH1cbiAgIDMyNlx0ICAgICAgICB9XG4gICAzMjdcdCAgICB9XG4gICAzMjhcdFxuICAgMzI5XHQgICAgLyoqXG4gICAzMzBcdCAgICAgKiBOT1RFOiBUaGlzIG1ldGhvZCBpcyB1bnVzZWQgYXQgdGhlIG1vbWVudCwga2VlcCBpdCBmb3IgZnV0dXJlIGluc3BpcmF0aW9uLlxuICAgMzMxXHQgICAgICovXG4gICAzMzJcdCAgICBhcHBseU92ZXJyaWRlQWN0aXZlRWZmZWN0cygpIHtcbiAgIDMzM1x0ICAgICAgICBjb25zdCBjaGFuZ2VzID0gdGhpcy5lZmZlY3RzLnJlZHVjZSgoY2hhbmdlczogRWZmZWN0Q2hhbmdlRGF0YVtdLCBlZmZlY3QpID0+IHtcbiAgIDMzNFx0ICAgICAgICAgICAgaWYgKGVmZmVjdC5kYXRhLmRpc2FibGVkKSByZXR1cm4gY2hhbmdlcztcbi4uLlxuICAxNDUwXHRcbiAgMTQ1MVx0ICAgIC8qKiBSZXR1cm4gZWl0aGVyIHRoZSBsaW5rZWQgdG9rZW4gb3IgdGhlIHRva2VuIG9mIHRoZSBzeW50aGV0aWMgYWN0b3IuXG4gIDE0NTJcdCAgICAgKlxuICAxNDUzXHQgICAgICogQHJldHVybiBXaWxsIHJldHVybiBudWxsIHNob3VsZCBubyB0b2tlbiBoYXZlIGJlZW4gcGxhY2VkIG9uIHNjZW5lLlxuICAxNDU0XHQgICAgICovXG4gIDE0NTVcdCAgICBnZXRUb2tlbigpOiBUb2tlbkRvY3VtZW50IHwgbnVsbCB7XG4gIDE0NTZcdCAgICAgICAgLy8gTGlua2VkIGFjdG9ycyBjYW4gb25seSBoYXZlIG9uZSB0b2tlbiwgd2hpY2ggaXNuJ3Qgc3RvcmVkIHdpdGhpbiBhY3RvciBkYXRhLi4uXG4gIDE0NTdcdCAgICAgICAgaWYgKHRoaXMuX2lzTGlua2VkVG9Ub2tlbigpICYmIHRoaXMuaGFzVG9rZW4oKSkge1xuICAxNDU4XHQgICAgICAgICAgICBjb25zdCBsaW5rZWQgPSB0cnVlO1xuICAxNDU5XHQgICAgICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmdldEFjdGl2ZVRva2VucyhsaW5rZWQpIGFzIHVua25vd24gYXMgVG9rZW5bXTtcbiAgMTQ2MFx0ICAgICAgICAgICAgLy8gVGhpcyBhc3N1bWVzIGZvciBhIHRva2VuIHRvIGV4aXN0IGFuZCBzaG91bGQgZmFpbCBpZiBub3QuXG4gIDE0NjFcdCAgICAgICAgICAgIHJldHVybiB0b2tlbnNbMF0uZG9jdW1lbnQ7XG4gIDE0NjJcdCAgICAgICAgfVxuICAxNDYzXHRcbiAgMTQ2NFx0ICAgICAgICAvLyBVbmxpbmtlZCBhY3RvcnMgY2FuIGhhdmUgbXVsdGlwbGUgYWN0aXZlIHRva2VuIGJ1dCBlYWNoIGhhdmUgdGhlaXJzIGRpcmVjdGx5IGF0dGFjaGVkLi4uXG4gIDE0NjVcdCAgICAgICAgcmV0dXJuIHRoaXMudG9rZW47XG4gIDE0NjZcdCAgICB9XG4gIDE0NjdcdFxuICAxNDY4XHQgICAgLyoqXG4gIDE0NjlcdCAgICAgKiBUaGVyZSBpcyBubyBuZWVkIGZvciBhIHRva2VuIHRvIHBsYWNlZC4gVGhlIHByb3RvdHlwZSB0b2tlbiBpcyBlbm91Z2guXG4gIDE0NzBcdCAgICAgKi9cbiAgMTQ3MVx0ICAgIF9pc0xpbmtlZFRvVG9rZW4oKTogYm9vbGVhbiB7XG4gIDE0NzJcdCAgICAgICAgLy9AdHMtZXhwZWN0LWVycm9yIC8vIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAxNDczXHQgICAgICAgIC8vIElmIGFuIGFjdG9yIGlzIGxpbmtlZCwgYWxsIGl0J3MgY29waWVzIGFsc28gY29udGFpbiB0aGlzIGxpbmtlZCBzdGF0dXMsIGV2ZW4gaWYgdGhleSdyZSBub3QuXG4gIDE0NzRcdCAgICAgICAgcmV0dXJuIHRoaXMucHJvdG90eXBlVG9rZW4uYWN0b3JMaW5rICYmICF0aGlzLnRva2VuO1xuICAxNDc1XHQgICAgfVxuICAxNDc2XHRcbiAgMTQ3N1x0ICAgIGhhc1Rva2VuKCk6IGJvb2xlYW4ge1xuICAxNDc4XHQgICAgICAgIHJldHVybiB0aGlzLmdldEFjdGl2ZVRva2VucygpLmxlbmd0aCA+IDA7XG4gIDE0NzlcdCAgICB9XG4gIDE0ODBcdFxuICAxNDgxXHQgICAgaGFzQWN0aXZlUGxheWVyT3duZXIoKTogYm9vbGVhbiB7XG4gIDE0ODJcdCAgICAgICAgY29uc3QgcGxheWVycyA9IHRoaXMuZ2V0QWN0aXZlUGxheWVyT3duZXJzKCk7XG4gIDE0ODNcdCAgICAgICAgcmV0dXJuIHBsYXllcnMubGVuZ3RoID4gMDtcbiAgMTQ4NFx0ICAgIH1cbiAgMTQ4NVx0XG4gIDE0ODZcdCAgICBnZXRBY3RpdmVQbGF5ZXIoKTogVXNlciB8IG51bGwge1xuICAxNDg3XHQgICAgICAgIGlmICghZ2FtZS51c2VycykgcmV0dXJuIG51bGw7XG4gIDE0ODhcdCAgICAgICAgaWYgKCF0aGlzLmhhc1BsYXllck93bmVyKSByZXR1cm4gbnVsbDtcbiAgMTQ4OVx0XG4gIDE0OTBcdCAgICAgICAgZm9yIChjb25zdCB1c2VyIG9mIGdhbWUudXNlcnMuY29udGVudHMpIHtcbiAgMTQ5MVx0ICAgICAgICAgICAgaWYgKCF1c2VyLmFjdGl2ZSB8fCB1c2VyLmlzR00pIHtcbiAgMTQ5Mlx0ICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAxNDkzXHQgICAgICAgICAgICB9XG4gIDE0OTRcdCAgICAgICAgICAgIGlmICh0aGlzLmlkID09PSB1c2VyLmNoYXJhY3Rlcj8uaWQpIHtcbiAgMTQ5NVx0ICAgICAgICAgICAgICAgIHJldHVybiB1c2VyO1xuICAxNDk2XHQgICAgICAgICAgICB9XG4gIDE0OTdcdCAgICAgICAgfVxuICAxNDk4XHRcbiAgMTQ5OVx0ICAgICAgICByZXR1cm4gbnVsbDtcbiAgMTUwMFx0ICAgIH1cbi4uLlxuICAxNzk3XHRcbiAgMTc5OFx0ICAgIC8qKlxuICAxNzk5XHQgICAgICogVGhlIG1hdHJpeCBkZXBlbmRzIG9uIGFjdG9yIHR5cGUgYW5kIHBvc3NpYmx5IGVxdWlwcGVkIG1hdHJpeCBkZXZpY2UuXG4gIDE4MDBcdCAgICAgKlxuICAxODAxXHQgICAgICogVXNlIHRoaXMgbWV0aG9kIGZvciB3aGVuZXZlciB5b3UgbmVlZCB0byBhY2Nlc3MgdGhpcyBhY3RvcnMgbWF0cml4IGRhbWFnZSB0cmFjayBhcyBpdCdzIHNvdXJjZSBtaWdodCBkaWZmZXIuXG4gIDE4MDJcdCAgICAgKi9cbiAgMTgwM1x0ICAgIGdldE1hdHJpeFRyYWNrKCk6IFNoYWRvd3J1bi5Db25kaXRpb25EYXRhIHwgdW5kZWZpbmVkIHtcbiAgMTgwNFx0ICAgICAgICAvLyBTb21lIGFjdG9ycyB3aWxsIGhhdmUgYSBkaXJlY3QgbWF0cml4IHRyYWNrLlxuICAxODA1XHQgICAgICAgIGlmIChcInRyYWNrXCIgaW4gdGhpcy5zeXN0ZW0gJiYgXCJtYXRyaXhcIiBpbiB0aGlzLnN5c3RlbS50cmFjaykge1xuICAxODA2XHQgICAgICAgICAgICByZXR1cm4gdGhpcy5zeXN0ZW0udHJhY2subWF0cml4O1xuICAxODA3XHQgICAgICAgIH1cbiAgMTgwOFx0XG4gIDE4MDlcdCAgICAgICAgLy8gU29tZSBhY3RvcnMgd2lsbCBoYXZlIGEgcGVyc29uYWwgbWF0cml4IGNvbmRpdGlvbiBtb25pdG9yLCBsaWtlIGEgZGV2aWNlIGNvbmRpdGlvbiBtb25pdG9yLlxuICAxODEwXHQgICAgICAgIGlmICh0aGlzLmlzTWF0cml4QWN0b3IpIHtcbiAgMTgxMVx0ICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBpc01hdHJpeEFjdG9yIGNoZWNrcyBmb3IgdGhlIG1hdHJpeCBhdHRyaWJ1dGVcbiAgMTgxMlx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3lzdGVtLm1hdHJpeC5jb25kaXRpb25fbW9uaXRvcjtcbiAgMTgxM1x0ICAgICAgICB9XG4uLi5cbiAgMjI4OVx0ICAgICAgICBpZiAoIXRhcmdldC5hY3RvciB8fCAhdGFyZ2V0LmFjdG9yLmlzTWF0cml4QWN0b3IpIHJldHVybiAwO1xuICAyMjkwXHRcbiAgMjI5MVx0XG4gIDIyOTJcdCAgICAgICAgY29uc3Qgc2NlbmUgPSBvcHRpb25zPy5zY2VuZSB8fCBjYW52YXMuc2NlbmUgYXMgU2NlbmU7XG4gIDIyOTNcdCAgICAgICAgLy8gSWYgYW4gYWN0b3IgaGFzIGJlZW4gdGFyZ2V0ZWQsIHRoZXkgbWlnaHQgaGF2ZSBhIGRldmljZS4gSWYgYW4gaXRlbSAvIGhvc3QgaGFzIGJlZW4gdGFyZ2V0ZWQgdGhleSBkb24ndC5cbiAgMjI5NFx0ICAgICAgICBpdGVtID0gaXRlbSB8fCB0YXJnZXQgaW5zdGFuY2VvZiBTUjZBY3RvciA/IHRhcmdldC5hY3Rvci5nZXRNYXRyaXhEZXZpY2UoKSA6IHVuZGVmaW5lZDtcbiAgMjI5NVx0XG4gIDIyOTZcdCAgICAgICAgY29uc3QgbWFya0lkID0gSGVscGVycy5idWlsZE1hcmtJZChzY2VuZS5pZCBhcyBzdHJpbmcsIHRhcmdldC5pZCwgaXRlbT8uaWQgYXMgc3RyaW5nKTtcbiAgMjI5N1x0ICAgICAgICByZXR1cm4gdGhpcy5nZXRNYXJrc0J5SWQobWFya0lkKTtcbiAgMjI5OFx0ICAgIH1cbiAgMjI5OVx0XG4gIDIzMDBcdCAgICBnZXRNYXJrc0J5SWQobWFya0lkOiBzdHJpbmcpOiBudW1iZXIge1xuICAyMzAxXHQgICAgICAgIHJldHVybiB0aGlzLm1hdHJpeERhdGE/Lm1hcmtzW21hcmtJZF0gfHwgMDtcbiAgMjMwMlx0ICAgIH1cbi4uLlxuICAyNzM3XHRcbiAgMjczOFx0ICAgIC8qKlxuICAyNzM5XHQgICAgICogRW5zdXJlcyB0aGF0IHRoZSBhY3RvciBoYXMgYWNjZXNzIHRvIGFsbCBtYXRyaXggYWN0aW9ucyBmcm9tIHRoZSBtYXRyaXgtYWN0aW9ucyBjb21wZW5kaXVtLlxuICAyNzQwXHQgICAgICogVGhpcyBtZXRob2Qgd2lsbCBhZGQgYW55IG1pc3NpbmcgbWF0cml4IGFjdGlvbnMgdG8gdGhlIGFjdG9yLlxuICAyNzQxXHQgICAgICpcbiAgMjc0Mlx0ICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAyNzQzXHQgICAgICovXG4gIDI3NDRcdCAgICBhc3luYyBlbnN1cmVNYXRyaXhBY3Rpb25zKCkge1xuICAyNzQ1XHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBFbnN1cmluZyBtYXRyaXggYWN0aW9ucyBmb3IgYWN0b3IgJHt0aGlzLm5hbWV9ICgke3RoaXMuaWR9KWApO1xuICAyNzQ2XHRcbiAgMjc0N1x0ICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGFkZGVkIG1hdHJpeCBhY3Rpb25zIHRvIHRoaXMgYWN0b3JcbiAgMjc0OFx0ICAgICAgICBjb25zdCBoYXNNYXRyaXhBY3Rpb25zID0gdGhpcy5nZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnKTtcbiAgMjc0OVx0ICAgICAgICBpZiAoaGFzTWF0cml4QWN0aW9ucykge1xuICAyNzUwXHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIG1hdHJpeCBhY3Rpb25zIGZsYWcgc2V0YCk7XG4gIDI3NTFcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjc1Mlx0ICAgICAgICB9XG4gIDI3NTNcdFxuICAyNzU0XHQgICAgICAgIC8vIEdldCB0aGUgbWF0cml4IGFjdGlvbnMgY29tcGVuZGl1bVxuICAyNzU1XHQgICAgICAgIGNvbnN0IG1hdHJpeFBhY2sgPSBnYW1lLnBhY2tzLmdldChcInNyNmVseXNpdW0ubWF0cml4LWFjdGlvbnNcIik7XG4gIDI3NTZcdCAgICAgICAgaWYgKCFtYXRyaXhQYWNrKSB7XG4gIDI3NTdcdCAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTaGFkb3dydW4gNmUgfCBNYXRyaXggQWN0aW9ucyBjb21wZW5kaXVtIG5vdCBmb3VuZFwiKTtcbiAgMjc1OFx0ICAgICAgICAgICAgcmV0dXJuO1xuICAyNzU5XHQgICAgICAgIH1cbiAgMjc2MFx0XG4gIDI3NjFcdCAgICAgICAgLy8gR2V0IGFsbCBtYXRyaXggYWN0aW9uc1xuICAyNzYyXHQgICAgICAgIGF3YWl0IG1hdHJpeFBhY2suZ2V0SW5kZXgoKTtcbiAgMjc2M1x0ICAgICAgICBjb25zdCBtYXRyaXhBY3Rpb25zID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gIDI3NjRcdCAgICAgICAgICAgIEFycmF5LmZyb20obWF0cml4UGFjay5pbmRleCkubWFwKGkgPT4gbWF0cml4UGFjay5nZXREb2N1bWVudChpLl9pZCkpXG4gIDI3NjVcdCAgICAgICAgKTtcbiAgMjc2Nlx0XG4gIDI3NjdcdCAgICAgICAgLy8gR2V0IGV4aXN0aW5nIGFjdGlvbiBuYW1lcyB0byBhdm9pZCBkdXBsaWNhdGVzXG4gIDI3NjhcdCAgICAgICAgY29uc3QgZXhpc3RpbmdOYW1lcyA9IHRoaXMuaXRlbXNcbiAgMjc2OVx0ICAgICAgICAgICAgLmZpbHRlcihpID0+IGkudHlwZSA9PT0gXCJhY3Rpb25cIilcbiAgMjc3MFx0ICAgICAgICAgICAgLm1hcChpID0+IGkubmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgMjc3MVx0XG4gIDI3NzJcdCAgICAgICAgLy8gRmlsdGVyIG91dCBhY3Rpb25zIHRoZSBhY3RvciBhbHJlYWR5IGhhc1xuICAyNzczXHQgICAgICAgIGNvbnN0IGFjdGlvbnNUb0FkZCA9IG1hdHJpeEFjdGlvbnMuZmlsdGVyKFxuICAyNzc0XHQgICAgICAgICAgICBhID0+ICFleGlzdGluZ05hbWVzLmluY2x1ZGVzKGEubmFtZS50b0xvd2VyQ2FzZSgpKVxuICAyNzc1XHQgICAgICAgICk7XG4gIDI3NzZcdFxuICAyNzc3XHQgICAgICAgIGlmIChhY3Rpb25zVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gIDI3NzhcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCAke3RoaXMubmFtZX0gYWxyZWFkeSBoYXMgYWxsIG1hdHJpeCBhY3Rpb25zYCk7XG4gIDI3NzlcdCAgICAgICAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IHdlJ3ZlIGNoZWNrZWQgZm9yIG1hdHJpeCBhY3Rpb25zXG4gIDI3ODBcdCAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI3ODFcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjc4Mlx0ICAgICAgICB9XG4gIDI3ODNcdFxuICAyNzg0XHQgICAgICAgIC8vIEFkZCB0aGUgYWN0aW9uc1xuICAyNzg1XHQgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRW1iZWRkZWREb2N1bWVudHMoXG4gIDI3ODZcdCAgICAgICAgICAgIFwiSXRlbVwiLFxuICAyNzg3XHQgICAgICAgICAgICBhY3Rpb25zVG9BZGQubWFwKGEgPT4gYS50b09iamVjdCgpKVxuICAyNzg4XHQgICAgICAgICk7XG4gIDI3ODlcdFxuICAyNzkwXHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBBZGRlZCAke2FjdGlvbnNUb0FkZC5sZW5ndGh9IG1hdHJpeCBhY3Rpb25zIHRvICR7dGhpcy5uYW1lfWApO1xuICAyNzkxXHRcbiAgMjc5Mlx0ICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBhZGRlZCBtYXRyaXggYWN0aW9uc1xuICAyNzkzXHQgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI3OTRcdCAgICB9XG4gIDI3OTVcdFxuICAyNzk2XHQgICAgYXN5bmMgbmV3U2NlbmVTZXR1cCgpIHtcbiAgMjc5N1x0ICAgICAgICBjb25zdCB1cGRhdGVEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gIDI3OThcdFxuICAyNzk5XHQgICAgICAgIHVwZGF0ZURhdGFbJ3N5c3RlbS5hdHRyaWJ1dGVzLmVkZ2UudXNlcyddID0gdGhpcy5nZXRFZGdlKCkudmFsdWU7XG4gIDI4MDBcdFxuICAyODAxXHQgICAgICAgIGlmKHVwZGF0ZURhdGEpIGF3YWl0IHRoaXMudXBkYXRlKHVwZGF0ZURhdGEpO1xuICAyODAyXHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL2FjdG9yL3ByZXAvZnVuY3Rpb25zL0luaXRpYXRpdmVQcmVwLnRzXG4uLi5cbiAgICA5NFx0XG4gICAgOTVcdCAgICBzdGF0aWMgcHJlcGFyZU1hdHJpeEluaXQoc3lzdGVtOiBBY3RvclR5cGVzRGF0YSAmIE1hdHJpeEFjdG9yRGF0YSkge1xuICAgIDk2XHQgICAgICAgIGNvbnN0IHsgaW5pdGlhdGl2ZSwgYXR0cmlidXRlcywgbW9kaWZpZXJzLCBtYXRyaXggfSA9IHN5c3RlbTtcbiAgICA5N1x0ICAgICAgICBpZiAobWF0cml4KSB7XG4gICAgOThcdFxuICAgIDk5XHQgICAgICAgICAgICBpbml0aWF0aXZlLm1hdHJpeC5iYXNlLmJhc2UgPSBhdHRyaWJ1dGVzLmludHVpdGlvbi52YWx1ZSArIHN5c3RlbS5tYXRyaXguZGF0YV9wcm9jZXNzaW5nLnZhbHVlO1xuICAgMTAwXHQgICAgICAgICAgICBpbml0aWF0aXZlLm1hdHJpeC5iYXNlLm1vZCA9IFBhcnRzTGlzdC5BZGRVbmlxdWVQYXJ0KGluaXRpYXRpdmUubWF0cml4LmJhc2UubW9kLCBcIlNSNi5Cb251c1wiLCBOdW1iZXIobW9kaWZpZXJzWydtYXRyaXhfaW5pdGlhdGl2ZSddKSk7XG4gICAxMDFcdCAgICAgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmJhc2UudmFsdWUgPSBIZWxwZXJzLmNhbGNUb3RhbChpbml0aWF0aXZlLm1hdHJpeC5iYXNlKTtcbiAgIDEwMlx0XG4gICAxMDNcdCAgICAgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmRpY2UuYmFzZSA9IChtYXRyaXguaG90X3NpbSA/IDQgOiAzKTtcbiAgIDEwNFx0ICAgICAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguZGljZS5tb2QgPSBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydChpbml0aWF0aXZlLm1hdHJpeC5kaWNlLm1vZCwgXCJTUjYuQm9udXNcIiwgTnVtYmVyKG1vZGlmaWVyc1snbWF0cml4X2luaXRpYXRpdmVfZGljZSddKSk7XG4gICAxMDVcdCAgICAgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmRpY2UudmFsdWUgPSBIZWxwZXJzLmNhbGNUb3RhbChpbml0aWF0aXZlLm1hdHJpeC5kaWNlLCB7bWluOiAwLCBtYXg6IDV9KTtcbiAgIDEwNlx0ICAgICAgICB9XG4gICAxMDdcdCAgICB9XG4gICAxMDhcdH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9wcmVwL2Z1bmN0aW9ucy9NYXRyaXhQcmVwLnRzXG4uLi5cbiAgICAgOVx0XG4gICAgMTBcdGV4cG9ydCBjbGFzcyBNYXRyaXhQcmVwIHtcbiAgICAxMVx0ICAgIC8qKlxuICAgIDEyXHQgICAgICogUHJlcGFyZSBNYXRyaXggZGF0YSBvbiB0aGUgYWN0b3JcbiAgICAxM1x0ICAgICAqIC0gaWYgYW4gaXRlbSBpcyBlcXVpcHBlZCwgaXQgd2lsbCB1c2UgdGhhdCBkYXRhXG4gICAgMTRcdCAgICAgKiAtIGlmIGl0IGlzbid0IGFuZCBwbGF5ZXIgaXMgdGVjaG5vbWFuY2VyLCBpdCB3aWxsIHVzZSB0aGF0IGRhdGFcbiAgICAxNVx0ICAgICAqL1xuICAgIDE2XHQgICAgc3RhdGljIHByZXBhcmVNYXRyaXgoc3lzdGVtOiBBY3RvclR5cGVzRGF0YSAmIE1hdHJpeEFjdG9yRGF0YSwgaXRlbXM6IFNSNkl0ZW1EYXRhV3JhcHBlcltdKSB7XG4gICAgMTdcdCAgICAgICAgY29uc3QgeyBtYXRyaXgsIGF0dHJpYnV0ZXMsIG1vZGlmaWVycyB9ID0gc3lzdGVtO1xuICAgIDE4XHRcbiAgICAxOVx0ICAgICAgICBjb25zdCBNYXRyaXhMaXN0ID0gWydmaXJld2FsbCcsICdzbGVhemUnLCAnZGF0YV9wcm9jZXNzaW5nJywgJ2F0dGFjayddO1xuICAgIDIwXHRcbiAgICAyMVx0ICAgICAgICAvLyBjbGVhciBtYXRyaXggZGF0YSB0byBkZWZhdWx0c1xuICAgIDIyXHQgICAgICAgIE1hdHJpeExpc3QuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgMjNcdCAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gbmV3IFBhcnRzTGlzdChtYXRyaXhba2V5XS5tb2QpO1xuICAgIDI0XHQgICAgICAgICAgICBpZiAobWF0cml4W2tleV0udGVtcCkgcGFydHMuYWRkVW5pcXVlUGFydCgnU1I2LlRlbXBvcmFyeScsIG1hdHJpeFtrZXldLnRlbXApO1xuICAgIDI1XHQgICAgICAgICAgICAvLyBMRUdBQ1kgZnJvbSB3aGVuIHRoZSBzaGVldCB1c2VkICdtb2QuVGVtcG9yYXJ5J1xuICAgIDI2XHQgICAgICAgICAgICBwYXJ0cy5yZW1vdmVQYXJ0KCdUZW1wb3JhcnknKTtcbiAgICAyN1x0ICAgICAgICAgICAgbWF0cml4W2tleV0ubW9kID0gcGFydHMubGlzdDtcbiAgICAyOFx0ICAgICAgICAgICAgbWF0cml4W2tleV0udmFsdWUgPSBwYXJ0cy50b3RhbDtcbiAgICAyOVx0ICAgICAgICB9KTtcbi4uLlxuICAgIDM4XHRcbiAgICAzOVx0ICAgICAgICBpZiAoZGV2aWNlKSB7XG4gICAgNDBcdCAgICAgICAgICAgIG1hdHJpeC5kZXZpY2UgPSBkZXZpY2UuZ2V0SWQoKTtcbiAgICA0MVx0XG4gICAgNDJcdCAgICAgICAgICAgIGNvbnN0IGNvbmRpdGlvbk1vbml0b3IgPSBkZXZpY2UuZ2V0Q29uZGl0aW9uTW9uaXRvcigpO1xuICAgIDQzXHRcbiAgICA0NFx0ICAgICAgICAgICAgbWF0cml4LmNvbmRpdGlvbl9tb25pdG9yLm1heCA9IGNvbmRpdGlvbk1vbml0b3IubWF4ICsgTnVtYmVyKG1vZGlmaWVycy5tYXRyaXhfdHJhY2spO1xuICAgIDQ1XHQgICAgICAgICAgICBtYXRyaXguY29uZGl0aW9uX21vbml0b3IudmFsdWUgPSBjb25kaXRpb25Nb25pdG9yLnZhbHVlO1xuICAgIDQ2XHQgICAgICAgICAgICBtYXRyaXgucmF0aW5nID0gZGV2aWNlLmdldFJhdGluZygpO1xuICAgIDQ3XHQgICAgICAgICAgICBtYXRyaXguaXNfY3liZXJkZWNrID0gZGV2aWNlLmlzQ3liZXJkZWNrKCk7XG4gICAgNDhcdCAgICAgICAgICAgIG1hdHJpeC5uYW1lID0gZGV2aWNlLmdldE5hbWUoKTtcbiAgICA0OVx0ICAgICAgICAgICAgbWF0cml4Lml0ZW0gPSBkZXZpY2UuZ2V0RGF0YSgpO1xuICAgIDUwXHQgICAgICAgICAgICBjb25zdCBkZXZpY2VBdHRzID0gZGV2aWNlLmdldEFTREYoKTtcbiAgICA1MVx0ICAgICAgICAgICAgaWYgKGRldmljZUF0dHMpIHtcbiAgICA1Mlx0ICAgICAgICAgICAgICAgIC8vIHNldHVwIHRoZSBhY3R1YWwgbWF0cml4IGF0dHJpYnV0ZXMgZm9yIHRoZSBhY3RvclxuICAgIDUzXHQgICAgICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGV2aWNlQXR0cykpIHtcbiAgICA1NFx0ICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgJiYgbWF0cml4W2tleV0pIHtcbiAgICA1NVx0ICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4W2tleV0uYmFzZSA9IHZhbHVlLnZhbHVlO1xuICAgIDU2XHQgICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXhba2V5XS5kZXZpY2VfYXR0ID0gdmFsdWUuZGV2aWNlX2F0dDtcbiAgICA1N1x0ICAgICAgICAgICAgICAgICAgICB9XG4gICAgNThcdCAgICAgICAgICAgICAgICB9XG4gICAgNTlcdCAgICAgICAgICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9wcmVwL0lDUHJlcC50c1xuLi4uXG4gICAgNDNcdFxuICAgIDQ0XHQgICAgLyoqXG4gICAgNDVcdCAgICAgKiBPbiBpbml0aWFsIGFjdG9yIGNyZWF0aW9uIHRoZSBtYXRyaXggdHJhY2sgd2lsbCBiZSBtaXNzaW5nLlxuICAgIDQ2XHQgICAgICpcbiAgICA0N1x0ICAgICAqIFRoaXMgaXMgaW50ZW50aW9uYWwgYXMgbm90IHRvIHBvbGx1dGUgdGVtcGxhdGUuanNvbiB3aXRoIGFjdG9yIHR5cGUgc3BlY2lmaWMgZGF0YS5cbiAgICA0OFx0ICAgICAqXG4gICAgNDlcdCAgICAgKi9cbiAgICA1MFx0ICAgIHN0YXRpYyBhZGRNaXNzaW5nVHJhY2tzKHN5c3RlbTogSUNEYXRhKSB7XG4gICAgNTFcdCAgICAgICAgLy8gTmV3bHkgY3JlYXRlZCBhY3RvcnMgU0hPVUxEIGhhdmUgdGhpcyBieSB0ZW1wbGF0ZS5cbiAgICA1Mlx0ICAgICAgICAvLyBMZWdhY3kgYWN0b3JzIE1JR0hUIG5vdCBoYXZlIGl0LCB0aGVyZWZvcmUgbWFrZSBzdXJlIGl0J3MgdGhlcmUuXG4gICAgNTNcdCAgICAgICAgY29uc3QgdHJhY2sgPSBzeXN0ZW0udHJhY2sgfHwge307XG4gICAgNTRcdCAgICAgICAgaWYgKCF0cmFjay5tYXRyaXgpIHRyYWNrLm1hdHJpeCA9IERhdGFEZWZhdWx0cy50cmFja0RhdGEoKTtcbiAgICA1NVx0ICAgICAgICBzeXN0ZW0udHJhY2sgPSB0cmFjaztcbiAgICA1Nlx0ICAgIH1cbiAgICA1N1x0XG4gICAgNThcdCAgICAvKipcbiAgICA1OVx0ICAgICAqIEFkZCBJQyBtb2RpZmllcnMgb25seSB0byB0aGUgbWlzYyB0YWIuXG4gICAgNjBcdCAgICAgKiBAcGFyYW0gc3lzdGVtXG4gICAgNjFcdCAgICAgKi9cbiAgICA2Mlx0ICAgIHN0YXRpYyBwcmVwYXJlTW9kaWZpZXJzKHN5c3RlbTogSUNEYXRhKSB7XG4gICAgNjNcdCAgICAgICAgbGV0IG1vZGlmaWVycyA9IE1vZGlmaWVyc1ByZXAuY29tbW9uTW9kaWZpZXJzIGFzIHN0cmluZ1tdO1xuICAgIDY0XHQgICAgICAgIG1vZGlmaWVycyA9IG1vZGlmaWVycy5jb25jYXQoTW9kaWZpZXJzUHJlcC5tYXRyaXhNb2RpZmllcnMgYXMgc3RyaW5nW10pO1xuICAgIDY1XHQgICAgICAgIE1vZGlmaWVyc1ByZXAuc2V0dXBNb2RpZmllcnMoc3lzdGVtLCBtb2RpZmllcnMpO1xuICAgIDY2XHQgICAgfVxuLi4uXG4gICAgODVcdFxuICAgIDg2XHQgICAgc3RhdGljIHByZXBhcmVNYXRyaXhJbml0KHN5c3RlbTogSUNEYXRhKSB7XG4gICAgODdcdCAgICAgICAgY29uc3QgeyBpbml0aWF0aXZlLCBtb2RpZmllcnMsIGhvc3QgfSA9IHN5c3RlbTtcbiAgICA4OFx0XG4gICAgODlcdFxuICAgIDkwXHQgICAgICAgIC8vIFNldCBjdXJyZW50IGluaXRpYXRpdmUgdG8gbWF0cml4XG4gICAgOTFcdCAgICAgICAgaW5pdGlhdGl2ZS5wZXJjZXB0aW9uID0gJ21hdHJpeCc7XG4gICAgOTJcdFxuICAgIDkzXHQgICAgICAgIC8vIFByZXBhcmUgdXNlZCBpbml0aWF0aXZlIHBhcnRzXG4gICAgOTRcdCAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguYmFzZS5iYXNlID0gTWF0cml4UnVsZXMuZ2V0SUNJbml0aWF0aXZlQmFzZShob3N0LnJhdGluZyk7XG4gICAgOTVcdCAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguYmFzZS5tb2QgPSBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydChpbml0aWF0aXZlLm1hdHJpeC5iYXNlLm1vZCwgXCJTUjYuQm9udXNcIiwgTnVtYmVyKG1vZGlmaWVyc1snbWF0cml4X2luaXRpYXRpdmUnXSkpO1xuICAgIDk2XHRcbiAgICA5N1x0ICAgICAgICBpbml0aWF0aXZlLm1hdHJpeC5kaWNlLmJhc2UgPSBNYXRyaXhSdWxlcy5nZXRJQ0luaXRpYXRpdmVEaWNlKCk7XG4gICAgOThcdCAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguZGljZS5tb2QgPSBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydChpbml0aWF0aXZlLm1hdHJpeC5kaWNlLm1vZCwgXCJTUjYuQm9udXNcIiwgTnVtYmVyKG1vZGlmaWVyc1snbWF0cml4X2luaXRpYXRpdmVfZGljZSddKSk7XG4gICAgOTlcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvaGVscGVycy50c1xuLi4uXG4gICAzMDdcdFxuICAgMzA4XHQgICAgLy8gVE9ETzogRm91bmRyeSAwLjkgU2hvdWxkIFRva2VuRG9jdW1lbnQgYmUgdXNlZCBpbnN0ZWFkIG9mIFRva2VuP1xuICAgMzA5XHQgICAgLy8gVE9ETzogQ2hlY2sgY2FudmFzLnNjZW5lLnRva2Vuc1xuICAgMzEwXHQgICAgc3RhdGljIGdldFRva2VuKGlkPzogc3RyaW5nKTogVG9rZW4gfCB1bmRlZmluZWQge1xuICAgMzExXHQgICAgICAgIGlmICghY2FudmFzIHx8ICFjYW52YXMucmVhZHkgfHwgIWNhbnZhcy50b2tlbnMpIHJldHVybjtcbiAgIDMxMlx0XG4gICAzMTNcdCAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiBjYW52YXMudG9rZW5zLnBsYWNlYWJsZXMpIHtcbiAgIDMxNFx0ICAgICAgICAgICAgaWYgKHRva2VuLmlkID09PSBpZCkge1xuICAgMzE1XHQgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgMzE2XHQgICAgICAgICAgICB9XG4gICAzMTdcdCAgICAgICAgfVxuICAgMzE4XHQgICAgfVxuICAgMzE5XHRcbiAgIDMyMFx0ICAgIC8qKlxuICAgMzIxXHQgICAgICogVXNlIHRoaXMgaGVscGVyIHRvIGdldCBhIHRva2VucyBhY3RvciBmcm9tIGFueSBnaXZlbiBzY2VuZSBpZC5cbiAgIDMyMlx0ICAgICAqIEBwYXJhbSBzY2VuZVRva2VuSWQgQSBtaXhlZCBpZCB3aXRoIHRoZSBmb3JtYXQgJzxzY2VuZUlkPi48dG9rZW5pZD5cbiAgIDMyM1x0ICAgICAqL1xuICAgMzI0XHQgICAgc3RhdGljIGdldFNjZW5lVG9rZW5BY3RvcihzY2VuZVRva2VuSWQ6IHN0cmluZyk6IFNSNkFjdG9yIHwgbnVsbCB7XG4gICAzMjVcdCAgICAgICAgY29uc3QgW3NjZW5lSWQsIHRva2VuSWRdID0gSGVscGVycy5kZWNvbnN0cnVjdFNjZW5lVG9rZW5JZChzY2VuZVRva2VuSWQpO1xuICAgMzI2XHQgICAgICAgIGNvbnN0IHRva2VuID0gSGVscGVycy5nZXRTY2VuZVRva2VuRG9jdW1lbnQoc2NlbmVJZCwgdG9rZW5JZCk7XG4gICAzMjdcdCAgICAgICAgaWYgKCF0b2tlbikgcmV0dXJuIG51bGw7XG4gICAzMjhcdCAgICAgICAgcmV0dXJuIHRva2VuLmdldEFjdG9yKCk7XG4gICAzMjlcdCAgICB9XG4uLi5cblBhdGg6IHBhY2tzL19zb3VyY2Uvc3lzdGVtLW1hY3Jvcy9hZGRfbWF0cml4X2FjdGlvbnMuanNvblxuICAgICAxXHR7XG4gICAgIDJcdCAgXCJfaWRcIjogXCJhZGRNYXRyaXhBY3Rpb25zXCIsXG4gICAgIDNcdCAgXCJuYW1lXCI6IFwiQWRkIE1hdHJpeCBBY3Rpb25zIHRvIFNlbGVjdGVkIEFjdG9yc1wiLFxuICAgICA0XHQgIFwidHlwZVwiOiBcInNjcmlwdFwiLFxuICAgICA1XHQgIFwiaW1nXCI6IFwiaWNvbnMvc3ZnL2RpY2UtdGFyZ2V0LnN2Z1wiLFxuICAgICA2XHQgIFwic2NvcGVcIjogXCJnbG9iYWxcIixcbi4uLlxuICAgICA4XHQgIFwiZm9sZGVyXCI6IG51bGwsXG4gICAgIDlcdCAgXCJzb3J0XCI6IDAsXG4gICAgMTBcdCAgXCJvd25lcnNoaXBcIjoge1xuICAgIDExXHQgICAgXCJkZWZhdWx0XCI6IDBcbiAgICAxMlx0ICB9LFxuICAgIDEzXHQgIFwiZmxhZ3NcIjoge30sXG4gICAgMTRcdCAgXCJfc3RhdHNcIjoge1xuICAgIDE1XHQgICAgXCJzeXN0ZW1JZFwiOiBcInNyNmVseXNpdW1cIixcbiAgICAxNlx0ICAgIFwic3lzdGVtVmVyc2lvblwiOiBcIjAuMjQuMFwiLFxuICAgIDE3XHQgICAgXCJjb3JlVmVyc2lvblwiOiBcIjExXCIsXG4gICAgMThcdCAgICBcImNyZWF0ZWRUaW1lXCI6IDE3MTg1NjAwMDAwMDAsXG4gICAgMTlcdCAgICBcIm1vZGlmaWVkVGltZVwiOiAxNzE4NTYwMDAwMDAwLFxuICAgIDIwXHQgICAgXCJsYXN0TW9kaWZpZWRCeVwiOiBcImRldmVsb3BlclwiXG4gICAgMjFcdCAgfSxcbiAgICAyMlx0ICBcIl9rZXlcIjogXCIhbWFjcm9zIWFkZE1hdHJpeEFjdGlvbnNcIlxuICAgIDIzXHR9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvaXRlbS9mbG93cy9BY3Rpb25GbG93LnRzXG4gICAgIDFcdC8qKlxuICAgICAyXHQgKiBIYW5kbGUgYWxsIHRoaW5ncyByZWxhdGVkIHRvIHRoZSBhY3Rpb24gdGVtcGxhdGUgKHRlbXBsYXRlLmpzb24pXG4gICAgIDNcdCAqL1xuICAgICA0XHRpbXBvcnQgeyBTUjZBY3RvciB9IGZyb20gXCIuLi8uLi9hY3Rvci9TUjZBY3RvclwiO1xuICAgICA1XHRpbXBvcnQgeyBIZWxwZXJzIH0gZnJvbSBcIi4uLy4uL2hlbHBlcnNcIjtcbiAgICAgNlx0aW1wb3J0IHsgU1I2SXRlbSB9IGZyb20gXCIuLi9TUjZJdGVtXCI7XG4gICAgIDdcdGltcG9ydCB7IFBhcnRzTGlzdCB9IGZyb20gXCIuLi8uLi9wYXJ0cy9QYXJ0c0xpc3RcIjtcbiAgICAgOFx0aW1wb3J0IHsgU1I2IH0gZnJvbSBcIi4uLy4uL2NvbmZpZ1wiO1xuICAgICA5XHRpbXBvcnQgeyBEYXRhRGVmYXVsdHMgfSBmcm9tIFwiLi4vLi4vZGF0YS9EYXRhRGVmYXVsdHNcIjtcbiAgICAxMFx0aW1wb3J0IHsgVHJhbnNsYXRpb24gfSBmcm9tIFwiLi4vLi4vdXRpbHMvc3RyaW5nc1wiO1xuICAgIDExXHRcbiAgICAxMlx0ZXhwb3J0IGNsYXNzIEFjdGlvbkZsb3cge1xuICAgIDEzXHQgICAgLyoqXG4gICAgMTRcdCAgICAgKiBDYWxjdWxhdGUgYWN0aW9uIGRhbWFnZSBjb25maWd1cmF0aW9uIGJhc2VkIG9uIGZsYXQgZGFtYWdlIGZpZWxkIGFuZCBwb3NzaWJsZSBkeW5hbWljIGF0dHJpYnV0ZSBtb2RpZmljYXRpb24uXG4gICAgMTVcdCAgICAgKlxuICAgIDE2XHQgICAgICogQHBhcmFtIGRhbWFnZSBUaGUgZGFtYWdlIGZpZWxkIGFzIGRlZmluZWQgd2l0aGluIHRoZSBBY3Rpb25EYXRhXG4gICAgMTdcdCAgICAgKiBAcGFyYW0gYWN0b3IgVGhlIGFjdG9yIHRvIHVzZSBzaG91bGQgYSBkeW5hbWljIGNhbGN1bGF0aW9uIGJlIG5lZWRlZC5cbiAgICAxOFx0ICAgICAqIEBwYXJhbSBpdGVtXG4gICAgMTlcdCAgICAgKi9cbiAgICAyMFx0ICAgIHN0YXRpYyBjYWxjRGFtYWdlRGF0YShkYW1hZ2U6IFNoYWRvd3J1bi5EYW1hZ2VEYXRhLCBhY3Rvcj86IFNSNkFjdG9yLCBpdGVtPzogU1I2SXRlbSk6IFNoYWRvd3J1bi5EYW1hZ2VEYXRhIHtcbiAgICAyMVx0ICAgICAgICAvLyBBdm9pZCBtYW5pcHVsYXRpb24gb24gb3JpZ2luYWwgZGF0YSwgd2hpY2ggbWlnaHQgY29tZSBmcm9tIGRhdGFiYXNlIHZhbHVlcy5cbiAgICAyMlx0ICAgICAgICBkYW1hZ2UgPSBmb3VuZHJ5LnV0aWxzLmR1cGxpY2F0ZShkYW1hZ2UpO1xuICAgIDIzXHRcbiAgICAyNFx0ICAgICAgICBpZiAoIWFjdG9yKSByZXR1cm4gZGFtYWdlO1xuICAgIDI1XHRcbiAgICAyNlx0ICAgICAgICBpZiAoaXRlbSkge1xuICAgIDI3XHQgICAgICAgICAgICBkYW1hZ2Uuc291cmNlID0gQWN0aW9uRmxvdy5fZGFtYWdlU291cmNlKGFjdG9yLCBpdGVtKTtcbiAgICAyOFx0ICAgICAgICB9XG4gICAgMjlcdFxuICAgIDMwXHQgICAgICAgIHRoaXMuX2FwcGx5TW9kaWZpYWJsZVZhbHVlKGRhbWFnZSwgYWN0b3IpO1xuICAgIDMxXHQgICAgICAgIGRhbWFnZS52YWx1ZSA9IEhlbHBlcnMuY2FsY1RvdGFsKGRhbWFnZSwgeyBtaW46IDAgfSk7XG4gICAgMzJcdFxuICAgIDMzXHQgICAgICAgIHRoaXMuX2FwcGx5TW9kaWZpYWJsZVZhbHVlKGRhbWFnZS5hcCwgYWN0b3IpO1xuICAgIDM0XHQgICAgICAgIGRhbWFnZS5hcC52YWx1ZSA9IEhlbHBlcnMuY2FsY1RvdGFsKGRhbWFnZS5hcCwgeyBtaW46IDAgfSk7XG4gICAgMzVcdFxuICAgIDM2XHQgICAgICAgIHJldHVybiBkYW1hZ2U7XG4gICAgMzdcdCAgICB9XG4gICAgMzhcdFxuICAgIDM5XHQgICAgc3RhdGljIF9hcHBseU1vZGlmaWFibGVWYWx1ZSh2YWx1ZTogU2hhZG93cnVuLk1vZGlmaWFibGVWYWx1ZUxpbmtlZCwgYWN0b3I6IFNSNkFjdG9yKSB7XG4gICAgNDBcdCAgICAgICAgY29uc3QgYXR0cmlidXRlID0gYWN0b3IuZmluZEF0dHJpYnV0ZSh2YWx1ZS5hdHRyaWJ1dGUpO1xuICAgIDQxXHQgICAgICAgIGlmICghYXR0cmlidXRlKSByZXR1cm47XG4gICAgNDJcdFxuICAgIDQzXHQgICAgICAgIGlmICghdmFsdWUuYmFzZV9mb3JtdWxhX29wZXJhdG9yKSB7XG4gICAgNDRcdCAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFVuc3VwcG9ydGVkIGZvcm11bGEgb3BlcmF0b3I6ICcke3ZhbHVlLmJhc2VfZm9ybXVsYV9vcGVyYXRvcn0nIHVzZWQuIEZhbGxpbmcgYmFjayB0byAnYWRkJy5gKTtcbiAgICA0NVx0ICAgICAgICAgICAgdmFsdWUuYmFzZV9mb3JtdWxhX29wZXJhdG9yID0gJ2FkZCc7XG4gICAgNDZcdCAgICAgICAgfVxuICAgIDQ3XHRcbiAgICA0OFx0ICAgICAgICAvLyBBdm9pZCBhbHRlcmluZyBiYXNlIE9SIHZhbHVlIGZpZWxkcyBhbmQgcmFpc2luZyB0aGUgcmVzdWx0aW5nIGRhbWFnZSBvbiBtdWx0aXBsZSBmdW5jdGlvbiBjYWxscy5cbiAgICA0OVx0ICAgICAgICBzd2l0Y2ggKHZhbHVlLmJhc2VfZm9ybXVsYV9vcGVyYXRvcikge1xuICAgIDUwXHQgICAgICAgICAgICBjYXNlIFwiYWRkXCI6XG4gICAgNTFcdCAgICAgICAgICAgICAgICBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydCh2YWx1ZS5tb2QsIGF0dHJpYnV0ZS5sYWJlbCwgYXR0cmlidXRlLnZhbHVlKTtcbiAgICA1Mlx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgIDUzXHQgICAgICAgICAgICBjYXNlIFwic3VidHJhY3RcIjpcbiAgICA1NFx0ICAgICAgICAgICAgICAgIFBhcnRzTGlzdC5BZGRVbmlxdWVQYXJ0KHZhbHVlLm1vZCwgYXR0cmlidXRlLmxhYmVsLCAtYXR0cmlidXRlLnZhbHVlKTtcbiAgICA1NVx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgIDU2XHQgICAgICAgICAgICBjYXNlIFwibXVsdGlwbHlcIjpcbiAgICA1N1x0ICAgICAgICAgICAgICAgIFBhcnRzTGlzdC5BZGRVbmlxdWVQYXJ0KHZhbHVlLm1vZCwgJ1NSNi5WYWx1ZScsICh2YWx1ZS5iYXNlICogYXR0cmlidXRlLnZhbHVlKSAtIHZhbHVlLmJhc2UpO1xuICAgIDU4XHQgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgNTlcdCAgICAgICAgICAgIGNhc2UgXCJkaXZpZGVcIjpcbiAgICA2MFx0ICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBiYXNlIGZyb20gdmFsdWUgYnkgbW9kaWZ5aW5nLlxuICAgIDYxXHQgICAgICAgICAgICAgICAgUGFydHNMaXN0LkFkZFVuaXF1ZVBhcnQodmFsdWUubW9kLCAnU1I2LkJhc2VWYWx1ZScsIHZhbHVlLmJhc2UgKiAtMSk7XG4gICAgNjJcdCAgICAgICAgICAgICAgICAvLyBBZGQgZGl2aXNpb24gcmVzdWx0IGFzIG1vZGlmaWVyIG9uIHplcm8uXG4gICAgNjNcdCAgICAgICAgICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IGF0dHJpYnV0ZS52YWx1ZSA9PT0gMCA/IDEgOiBhdHRyaWJ1dGUudmFsdWU7XG4gICAgNjRcdCAgICAgICAgICAgICAgICBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydCh2YWx1ZS5tb2QsICdTUjYuVmFsdWUnLCBNYXRoLmZsb29yKHZhbHVlLmJhc2UgLyBkZW5vbWluYXRvcikpO1xuICAgIDY1XHQgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgNjZcdCAgICAgICAgfVxuICAgIDY3XHQgICAgfVxuICAgIDY4XHRcbiAgICA2OVx0ICAgIC8qKlxuICAgIDcwXHQgICAgICogRGFtYWdlIHRoYXQncyBjYXVzZWQgYnkgYW4gaXRlbSBjYW4gbGF0ZXIgYmUgdXNlZCB0byBkZXRlcm1pbmUgaG93IHRoYXQgZGFtYWdlIHNob3VsZCBiZSBhcHBsaWVkXG4gICAgNzFcdCAgICAgKlxuICAgIDcyXHQgICAgICogQHBhcmFtIGFjdG9yIFRoZSBhY3RvciB1c2VkIHRvIGRldGVybWluZSBkYW1hZ2VcbiAgICA3M1x0ICAgICAqIEBwYXJhbSBpdGVtIFRoZSBpdGVtIGZyb20gd2hpY2ggZGFtYWdlJ3MgYmVlbiBkZXRlcm1pbmVkIGZyb20uXG4gICAgNzRcdCAgICAgKi9cbiAgICA3NVx0ICAgIHN0YXRpYyBfZGFtYWdlU291cmNlKGFjdG9yOiBTUjZBY3RvciwgaXRlbTogU1I2SXRlbSk6IFNoYWRvd3J1bi5EYW1hZ2VTb3VyY2Uge1xuICAgIDc2XHQgICAgICAgIHJldHVybiB7XG4gICAgNzdcdCAgICAgICAgICAgIGFjdG9ySWQ6IGFjdG9yLmlkIHx8ICcnLFxuICAgIDc4XHQgICAgICAgICAgICBpdGVtSWQ6IGl0ZW0uaWQgfHwgJycsXG4gICAgNzlcdCAgICAgICAgICAgIGl0ZW1OYW1lOiBpdGVtLm5hbWUgfHwgJycsXG4gICAgODBcdCAgICAgICAgICAgIGl0ZW1UeXBlOiBpdGVtLnR5cGVcbiAgICA4MVx0ICAgICAgICB9XG4gICAgODJcdCAgICB9XG4uLi5cbiAgIDExM1x0ICAgICAgICAvLyAgICAgICAgVGhlIG1ham9yIHVzZSBjYXNlIGlzIHRoZSBzaWRlYmFyIGl0ZW0gY3JlYXRpb24sIHdoZXJlIG5vIGFjdG9yIGlzIGF2YWlsYWJsZS5cbiAgIDExNFx0ICAgICAgICBpZiAoIWFjdG9yIHx8IGFjdG9yLmlzSUMoKSkge1xuICAgMTE1XHQgICAgICAgICAgICAvLyBJbmplY3QgdGhpcyBpdGVtcyBjdXN0b20gc2tpbGwgaW50byB0aGUgZ2xvYmFsIHNraWxsIGxpc3QuXG4gICAxMTZcdCAgICAgICAgICAgIGNvbnN0IGdsb2JhbFNraWxscyA9IGZvdW5kcnkudXRpbHMuZGVlcENsb25lKFNSNi5hY3RpdmVTa2lsbHMpO1xuICAgMTE3XHQgICAgICAgICAgICBBY3Rpb25GbG93Ll9pbmplY3RNaXNzaW5nQ3VzdG9tU2tpbGwoZ2xvYmFsU2tpbGxzLCBza2lsbE5hbWUpO1xuICAgMTE4XHQgICAgICAgICAgICByZXR1cm4gSGVscGVycy5zb3J0Q29uZmlnVmFsdWVzQnlUcmFuc2xhdGlvbihnbG9iYWxTa2lsbHMpO1xuICAgMTE5XHQgICAgICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9pdGVtL2Zsb3dzL0FjdGlvblJlc3VsdEZsb3cudHNcbi4uLlxuICAgIDQzXHQgICAgLyoqXG4gICAgNDRcdCAgICAgKiBNYXRyaXggTWFya3MgYXJlIHBsYWNlZCBvbiBlaXRoZXIgYWN0b3JzIChwZXJzb25hLCBpYykgb3IgaXRlbXMgKGRldmljZSwgaG9zdCwgdGVjaG5vbG9neSkuXG4gICAgNDVcdCAgICAgKi9cbiAgICA0Nlx0ICAgIHN0YXRpYyBhc3luYyBwbGFjZU1hdHJpeE1hcmtzKGFjdGl2ZTogU1I2QWN0b3IsIHRhcmdldHM6IFRva2VuW10sIG1hcmtzOiBudW1iZXIpIHtcbiAgICA0N1x0ICAgICAgICBpZiAoIU1hdHJpeFJ1bGVzLmlzVmFsaWRNYXJrc0NvdW50KG1hcmtzKSkge1xuICAgIDQ4XHQgICAgICAgICAgICByZXR1cm4gdWkubm90aWZpY2F0aW9ucz8ud2FybihnYW1lLmkxOG4ubG9jYWxpemUoXCJTUjYuV2FybmluZ3MuSW52YWxpZE1hcmtzQ291bnRcIikpO1xuICAgIDQ5XHQgICAgICAgIH1cbiAgICA1MFx0XG4gICAgNTFcdCAgICAgICAgZm9yIChjb25zdCB0YXJnZXQgb2YgdGFyZ2V0cykge1xuICAgIDUyXHQgICAgICAgICAgICBhd2FpdCBhY3RpdmUuc2V0TWFya3ModGFyZ2V0LCBtYXJrcyk7XG4gICAgNTNcdCAgICAgICAgfVxuICAgIDU0XHQgICAgfVxuICAgIDU1XHRcbiAgICA1Nlx0ICAgIC8qKlxuICAgIDU3XHQgICAgICogTW9kaWZ5IHRoZSBhY3RvcnMgY29tYmF0YW50IGFjY29yZGluZyB0aGUgdGVzdCBkZWZpbmVkIGluaXRpYXRpdmUgbW9kaWZpZXIuXG4gICAgNThcdCAgICAgKlxuICAgIDU5XHQgICAgICogQHBhcmFtIHRlc3QgVGhlIHRlc3QgaW5zdGFuY2UgY2F1c2luZyB0aGUgaW5pdGlhdGl2ZSBtb2RpZmljYXRpb25cbiAgICA2MFx0ICAgICAqL1xuICAgIDYxXHQgICAgc3RhdGljIGFzeW5jIF9jYXN0SW5pdE1vZGlmaWVyQWN0aW9uKHRlc3Q6IFBoeXNpY2FsRGVmZW5zZVRlc3QpIHtcbiAgICA2Mlx0ICAgICAgICBpZiAoISh0ZXN0IGluc3RhbmNlb2YgUGh5c2ljYWxEZWZlbnNlVGVzdCkpIHJldHVybjtcbiAgICA2M1x0XG4gICAgNjRcdCAgICAgICAgaWYgKCF0ZXN0LmRhdGEuaW5pTW9kKSByZXR1cm47XG4gICAgNjVcdCAgICAgICAgYXdhaXQgdGVzdC5hY3Rvcj8uY2hhbmdlQ29tYmF0SW5pdGlhdGl2ZSh0ZXN0LmRhdGEuaW5pTW9kKTtcbiAgICA2Nlx0ICAgIH1cbiAgICA2N1x0fVxuLi4uXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFUc0xLU0ZlWTNmbTdyWWJwUnoxNkxEIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozMjoxMS4wNDNaIiwicmVzcG9uc2VfdGV4dCI6Ik5vdyBsZXQgbWUgbG9vayBmb3IgbW9yZSBzcGVjaWZpYyBjb2RlIHJlbGF0ZWQgdG8gdG9rZW4gcHJvY2Vzc2luZyBhbmQgYWN0b3IgbG9va3VwIGR1cmluZyBnYW1lIGluaXRpYWxpemF0aW9uOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjkzMzk2NGVmLTI3ZjYtNDdhYi1hNTMxLTQ3M2MxN2I4ODM3YyIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVFvWk1OTWZxbThQS2k1dVJCdHlndjIiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInZpZXdcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50c1wiLCBcInZpZXdfcmFuZ2VcIjogWzMxNSwgMzMwXX0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJOb3cgbGV0IG1lIGxvb2sgYXQgdGhlIHNwZWNpZmljIGVycm9yIHBhdHRlcm5zIGFuZCB0aGUgbWF0cml4IGFjdGlvbiBpbml0aWFsaXphdGlvbiBjb2RlIG1vcmUgY2xvc2VseTpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IHNyYy9tb2R1bGUvaG9va3MudHNcbi4uLlxuICAgIDcwXHRpbXBvcnQgeyBTdWNjZXNzVGVzdEVmZmVjdHNGbG93IH0gZnJvbSAnLi9lZmZlY3QvZmxvd3MvU3VjY2Vzc1Rlc3RFZmZlY3RzRmxvdyc7XG4gICAgNzFcdGltcG9ydCB7IEpvdXJuYWxFbnJpY2hlcnMgfSBmcm9tICcuL2pvdXJuYWwvZW5yaWNoZXInO1xuICAgIDcyXHRpbXBvcnQgeyBEYXRhU3RvcmFnZSB9IGZyb20gJy4vZGF0YS9EYXRhU3RvcmFnZSc7XG4gICAgNzNcdFxuICAgIDc0XHRcbiAgICA3NVx0XG4gICAgNzZcdC8vIFJlZGVjbGFyZSBTUjVjb25maWcgYXMgYSBnbG9iYWwgYXMgZm91bmRyeS12dHQtdHlwZXMgQ09ORklHIHdpdGggU1I1IHByb3BlcnR5IGNhdXNlcyBpc3N1ZXMuXG4gICAgNzdcdGV4cG9ydCBjb25zdCBTUjZDT05GSUcgPSBTUjY7XG4gICAgNzhcdFxuICAgIDc5XHRleHBvcnQgY2xhc3MgSG9va3NNYW5hZ2VyIHtcbiAgICA4MFx0ICAgIHN0YXRpYyByZWdpc3Rlckhvb2tzKCkge1xuICAgIDgxXHQgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBSZWdpc3RlcmluZyBzeXN0ZW0gaG9va3MnKTtcbiAgICA4Mlx0ICAgICAgICAvLyBSZWdpc3RlciB5b3VyIGhpZ2hlc3QgbGV2ZWwgaG9vayBjYWxsYmFja3MgaGVyZSBmb3IgYSBxdWljayBvdmVydmlldyBvZiB3aGF0J3MgaG9va2VkIGludG8uXG4gICAgODNcdFxuICAgIDg0XHQgICAgICAgIEhvb2tzLm9uY2UoJ2luaXQnLCBIb29rc01hbmFnZXIuaW5pdCk7XG4gICAgODVcdCAgICAgICAgSG9va3Mub25jZSgnc2V0dXAnLCBBdXRvY29tcGxldGVJbmxpbmVIb29rc0Zsb3cuc2V0dXBIb29rKTtcbiAgICA4Nlx0XG4gICAgODdcdCAgICAgICAgSG9va3Mub24oJ2NhbnZhc0luaXQnLCBjYW52YXNJbml0KTtcbiAgICA4OFx0ICAgICAgICBIb29rcy5vbigncmVhZHknLCBIb29rc01hbmFnZXIucmVhZHkpO1xuICAgIDg5XHQgICAgICAgIEhvb2tzLm9uKCdob3RiYXJEcm9wJywgSG9va3NNYW5hZ2VyLmhvdGJhckRyb3ApO1xuICAgIDkwXHQgICAgICAgIEhvb2tzLm9uKCdyZW5kZXJTY2VuZUNvbnRyb2xzJywgSG9va3NNYW5hZ2VyLnJlbmRlclNjZW5lQ29udHJvbHMpO1xuICAgIDkxXHQgICAgICAgIEhvb2tzLm9uKCdnZXRTY2VuZUNvbnRyb2xCdXR0b25zJywgSG9va3NNYW5hZ2VyLmdldFNjZW5lQ29udHJvbEJ1dHRvbnMpO1xuICAgIDkyXHQgICAgICAgIEhvb2tzLm9uKCdnZXRDb21iYXRUcmFja2VyRW50cnlDb250ZXh0JywgU1I2Q29tYmF0LmFkZENvbWJhdFRyYWNrZXJDb250ZXh0T3B0aW9ucyk7XG4gICAgOTNcdCAgICAgICAgSG9va3Mub24oJ3JlbmRlckl0ZW1EaXJlY3RvcnknLCBIb29rc01hbmFnZXIucmVuZGVySXRlbURpcmVjdG9yeSk7XG4gICAgOTRcdCAgICAgICAgLy8gSG9va3Mub24oJ3JlbmRlclRva2VuSFVEJywgRW52TW9kaWZpZXJzQXBwbGljYXRpb24uYWRkVG9rZW5IVURGaWVsZHMpO1xuICAgIDk1XHQgICAgICAgIEhvb2tzLm9uKCdyZW5kZXJUb2tlbkhVRCcsIFNpdHVhdGlvbk1vZGlmaWVyc0FwcGxpY2F0aW9uLm9uUmVuZGVyVG9rZW5IVUQpO1xuICAgIDk2XHQgICAgICAgIEhvb2tzLm9uKCd1cGRhdGVJdGVtJywgSG9va3NNYW5hZ2VyLnVwZGF0ZUljQ29ubmVjdGVkVG9Ib3N0SXRlbSk7XG4gICAgOTdcdCAgICAgICAgSG9va3Mub24oJ2RlbGV0ZUl0ZW0nLCBIb29rc01hbmFnZXIucmVtb3ZlRGVsZXRlZEl0ZW1zRnJvbU5ldHdvcmtzKTtcbi4uLlxuICAgMTA3XHRcbiAgIDEwOFx0ICAgIHN0YXRpYyBpbml0KCkge1xuICAgMTA5XHQgICAgICAgIGNvbnNvbGUubG9nKGBMb2FkaW5nIFNoYWRvd3J1biA1ZSBTeXN0ZW1cbiAgIDExMFx0X19fX19fX19fX19fX19fX19fX1xuICAgMTExXHQgX19fX19fX19fX18gX19fX18gXG4gICAxMTJcdC8gIF9fX3wgX19fIFxcXFwgIF9fX3xcbiAgIDExM1x0XFxcXCBcXGAtLS58IHxfLyAvX19fIFxcXFwgXG4gICAxMTRcdCBcXGAtLS4gXFxcXCAgICAvICAgIFxcXFwgXFxcXFxuICAgMTE1XHQvXFxcXF9fLyAvIHxcXFxcIFxcXFwvXFxcXF9fLyAvXG4gICAxMTZcdFxcXFxfX19fL1xcXFxffCBcXFxcX1xcXFxfX19fLyBcbiAgIDExN1x0PT09PT09PT09PT09PT09PT09PVxuICAgMTE4XHRgKTtcbiAgIDExOVx0ICAgICAgICAvLyBDcmVhdGUgYSBzcjZlbHlzaXVtIG5hbWVzcGFjZSB3aXRoaW4gdGhlIGdhbWUgZ2xvYmFsXG4gICAxMjBcdCAgICAgICAgZ2FtZVsnc3I2ZWx5c2l1bSddID0ge1xuICAgMTIxXHQgICAgICAgICAgICAvKipcbiAgIDEyMlx0ICAgICAgICAgICAgICogU3lzdGVtIGxldmVsIERvY3VtZW50IGltcGxlbWVudGF0aW9ucy5cbiAgIDEyM1x0ICAgICAgICAgICAgICovXG4gICAxMjRcdCAgICAgICAgICAgIFNSNkFjdG9yOiBTUjZBY3RvcixcbiAgIDEyNVx0ICAgICAgICAgICAgU1I2SXRlbTogU1I2SXRlbSxcbiAgIDEyNlx0ICAgICAgICAgICAgU1I2QWN0aXZlRWZmZWN0OiBTUjZBY3RpdmVFZmZlY3QsXG4gICAxMjdcdCAgICAgICAgICAgIC8qKlxuICAgMTI4XHQgICAgICAgICAgICAgKiBNYWNybyBob29rcyB1c2VkIHdoZW4gc29tZXRoaW5nJ3MgZHJvcHBlZCBvbnRvIHRoZSBob3RiYXIuXG4gICAxMjlcdCAgICAgICAgICAgICAqL1xuICAgMTMwXHQgICAgICAgICAgICByb2xsSXRlbU1hY3JvLFxuICAgMTMxXHQgICAgICAgICAgICByb2xsU2tpbGxNYWNybyxcbiAgIDEzMlx0ICAgICAgICAgICAgLyoqXG4gICAxMzNcdCAgICAgICAgICAgICAqIFNob3VsZCB5b3Ugb25seSByZWFsbHkgbmVlZCBkaWNlIGhhbmRsaW5nLCB1c2UgdGhpcy4gSWYgeW91IG5lZWQgbW9yZSBjb21wbGV4IHRlc3RpbmcgYmVoYXZpb3VyLFxuICAgMTM0XHQgICAgICAgICAgICAgKiBjaGVjayB0aGUgVGVzdCBpbXBsZW1lbnRhdGlvbnMuXG4gICAxMzVcdCAgICAgICAgICAgICAqL1xuICAgMTM2XHQgICAgICAgICAgICBTUjZSb2xsOiBTUjZSb2xsLFxuLi4uXG4gICAzMzBcdFxuICAgMzMxXHQgICAgICAgIEhvb2tzTWFuYWdlci5jb25maWd1cmVWaXNpb24oKVxuICAgMzMyXHRcbiAgIDMzM1x0ICAgICAgICBIb29rc01hbmFnZXIuY29uZmlndXJlVGV4dEVucmljaGVycygpO1xuICAgMzM0XHRcbiAgIDMzNVx0ICAgICAgICAvLyBQcmVsb2FkIG1pZ2h0IHJlZHVjZSBsb2FkaW5nIHRpbWUgZHVyaW5nIHBsYXkuXG4gICAzMzZcdCAgICAgICAgSGFuZGxlYmFyTWFuYWdlci5sb2FkVGVtcGxhdGVzKCk7XG4gICAzMzdcdFxuICAgMzM4XHQgICAgICAgIC8vIFJlZ2lzdGVyIFRvdXJzXG4gICAzMzlcdCAgICAgICAgcmVnaXN0ZXJTUjZUb3VycygpO1xuICAgMzQwXHRcbiAgIDM0MVx0ICAgICAgICBEYXRhU3RvcmFnZS52YWxpZGF0ZSgpO1xuICAgMzQyXHQgICAgfVxuICAgMzQzXHRcbiAgIDM0NFx0ICAgIHN0YXRpYyBhc3luYyByZWFkeSgpIHtcbiAgIDM0NVx0ICAgICAgICBpZiAoZ2FtZS51c2VyPy5pc0dNKSB7XG4gICAzNDZcdCAgICAgICAgICAgIC8vIFByb2hpYml0IG1pZ3JhdGlvbiBvbiBlbXB0eSB3b3JsZHMuLi5cbiAgIDM0N1x0ICAgICAgICAgICAgaWYgKE1pZ3JhdG9yLmlzRW1wdHlXb3JsZCkge1xuICAgMzQ4XHQgICAgICAgICAgICAgICAgYXdhaXQgTWlncmF0b3IuSW5pdFdvcmxkRm9yTWlncmF0aW9uKCk7XG4gICAzNDlcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gICAzNTBcdCAgICAgICAgICAgIH1cbiAgIDM1MVx0XG4gICAzNTJcdCAgICAgICAgICAgIC8vIE9uIHBvcHVsYXRlZCB3b3JsZHMsIHRyeSBtaWdyYXRpbmdcbiAgIDM1M1x0ICAgICAgICAgICAgYXdhaXQgTWlncmF0b3IuQmVnaW5NaWdyYXRpb24oKTtcbiAgIDM1NFx0XG4gICAzNTVcdCAgICAgICAgICAgIGlmIChDaGFuZ2Vsb2dBcHBsaWNhdGlvbi5zaG93QXBwbGljYXRpb24pIHtcbiAgIDM1Nlx0ICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBDaGFuZ2Vsb2dBcHBsaWNhdGlvbigpLnJlbmRlcih0cnVlKTtcbiAgIDM1N1x0ICAgICAgICAgICAgfVxuICAgMzU4XHQgICAgICAgIH1cbi4uLlxuICAgNDQ2XHRcbiAgIDQ0N1x0ICAgICAgICBpZiAoaXRlbS5pc0hvc3QpIHtcbiAgIDQ0OFx0ICAgICAgICAgICAgLy8gQ29sbGVjdCBhY3RvcnMgZnJvbSBzaWRlYmFyIGFuZCBhY3RpdmUgc2NlbmUgdG8gdXBkYXRlIC8gcmVyZW5kZXJcbiAgIDQ0OVx0ICAgICAgICAgICAgbGV0IGNvbm5lY3RlZElDID0gW1xuICAgNDUwXHQgICAgICAgICAgICAgICAgLy8gQWxsIHNpZGViYXIgYWN0b3JzIHNob3VsZCBhbHNvIGluY2x1ZGUgdG9rZW5zIHdpdGggbGlua2VkIGFjdG9ycy5cbiAgIDQ1MVx0ICAgICAgICAgICAgICAgIC4uLmdhbWUuYWN0b3JzLmZpbHRlcigoYWN0b3I6IFNSNkFjdG9yKSA9PiBhY3Rvci5pc0lDKCkgJiYgYWN0b3IuaGFzSG9zdCgpKSBhcyBTUjZBY3RvcltdLFxuICAgNDUyXHQgICAgICAgICAgICAgICAgLy8gQWxsIHRva2VuIGFjdG9ycyB0aGF0IGFyZW4ndCBsaW5rZWQuXG4gICA0NTNcdCAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC8vIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAgNDU0XHQgICAgICAgICAgICAgICAgLi4uY2FudmFzLnNjZW5lLnRva2Vucy5maWx0ZXIodG9rZW4gPT4gIXRva2VuLmFjdG9yTGluayAmJiB0b2tlbi5hY3Rvcj8uaXNJQygpICYmIHRva2VuLmFjdG9yPy5oYXNIb3N0KCkpLm1hcCh0ID0+IHQuYWN0b3IpXG4gICA0NTVcdCAgICAgICAgICAgIF07XG4gICA0NTZcdFxuICAgNDU3XHQgICAgICAgICAgICAvLyBVcGRhdGUgaG9zdCBkYXRhIG9uIHRoZSBpYyBhY3Rvci5cbiAgIDQ1OFx0ICAgICAgICAgICAgY29uc3QgaG9zdCA9IGl0ZW0uYXNIb3N0O1xuICAgNDU5XHQgICAgICAgICAgICBpZiAoIWhvc3QpIHJldHVybjtcbiAgIDQ2MFx0ICAgICAgICAgICAgZm9yIChjb25zdCBpYyBvZiBjb25uZWN0ZWRJQykge1xuICAgNDYxXHQgICAgICAgICAgICAgICAgaWYgKCFpYykgY29udGludWU7XG4gICA0NjJcdCAgICAgICAgICAgICAgICBhd2FpdCBpYy5fdXBkYXRlSUNIb3N0RGF0YShob3N0KTtcbiAgIDQ2M1x0ICAgICAgICAgICAgfVxuICAgNDY0XHQgICAgICAgIH1cbiAgIDQ2NVx0ICAgIH1cbi4uLlxuICAgNDcwXHRcbiAgIDQ3MVx0ICAgIC8qKlxuICAgNDcyXHQgICAgICogVGhpcyBtZXRob2QgaXMgdXNlZCBhcyBhIHNpbXBsZSBwbGFjZSB0byByZWdpc3RlciBzb2NrZXQgaG9vayBoYW5kbGVycyBmb3IgdGhlIHN5c3RlbS5cbiAgIDQ3M1x0ICAgICAqXG4gICA0NzRcdCAgICAgKiBZb3UgY2FuIHVzZSB0aGUgU29ja2V0TWVzc2FnZSBmb3Igc2VuZGluZyBtZXNzYWdlcyB1c2luZyBhIHNvY2tldCBldmVudCBtZXNzYWdlIGlkIGFuZCBnZW5lcmljIGRhdGEgb2JqZWN0LlxuICAgNDc1XHQgICAgICovXG4gICA0NzZcdCAgICBzdGF0aWMgcmVnaXN0ZXJTb2NrZXRMaXN0ZW5lcnMoKSB7XG4gICA0NzdcdCAgICAgICAgaWYgKCFnYW1lLnNvY2tldCB8fCAhZ2FtZS51c2VyKSByZXR1cm47XG4gICA0NzhcdCAgICAgICAgY29uc29sZS5sb2coJ1JlZ2lzdGVyaW5nIHNyNmVseXNpdW0gc3lzdGVtIHNvY2tldCBtZXNzYWdlcy4uLicpO1xuICAgNDc5XHQgICAgICAgIGNvbnN0IGhvb2tzOiBTaGFkb3dydW4uU29ja2V0TWVzc2FnZUhvb2tzID0ge1xuICAgNDgwXHQgICAgICAgICAgICBbRkxBR1MuYWRkTmV0d29ya0NvbnRyb2xsZXJdOiBbTmV0d29ya0RldmljZUZsb3cuX2hhbmRsZUFkZE5ldHdvcmtDb250cm9sbGVyU29ja2V0TWVzc2FnZV0sXG4gICA0ODFcdCAgICAgICAgICAgIFtGTEFHUy5Eb05leHRSb3VuZF06IFtTUjZDb21iYXQuX2hhbmRsZURvTmV4dFJvdW5kU29ja2V0TWVzc2FnZV0sXG4gICA0ODJcdCAgICAgICAgICAgIFtGTEFHUy5Eb0luaXRQYXNzXTogW1NSNkNvbWJhdC5faGFuZGxlRG9Jbml0UGFzc1NvY2tldE1lc3NhZ2VdLFxuICAgNDgzXHQgICAgICAgICAgICBbRkxBR1MuRG9OZXdBY3Rpb25QaGFzZV06IFtTUjZDb21iYXQuX2hhbmRsZURvTmV3QWN0aW9uUGhhc2VTb2NrZXRNZXNzYWdlXSxcbi4uLlxuICAgNDg4XHRcbiAgIDQ4OVx0ICAgICAgICBnYW1lLnNvY2tldC5vbihTWVNURU1fU09DS0VULCBhc3luYyAobWVzc2FnZTogU2hhZG93cnVuLlNvY2tldE1lc3NhZ2VEYXRhKSA9PiB7XG4gICA0OTBcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBSZWNlaXZlZCBzeXN0ZW0gc29ja2V0IG1lc3NhZ2UuJywgbWVzc2FnZSk7XG4gICA0OTFcdFxuICAgNDkyXHQgICAgICAgICAgICBjb25zdCBoYW5kbGVycyA9IGhvb2tzW21lc3NhZ2UudHlwZV07XG4gICA0OTNcdCAgICAgICAgICAgIGlmICghaGFuZGxlcnMgfHwgaGFuZGxlcnMubGVuZ3RoID09PSAwKSByZXR1cm4gY29uc29sZS53YXJuKCdTaGFkb3dydW4gNmUgfCBTeXN0ZW0gc29ja2V0IG1lc3NhZ2UgaGFzIG5vIHJlZ2lzdGVyZWQgaGFuZGxlciEnLCBtZXNzYWdlKTtcbiAgIDQ5NFx0ICAgICAgICAgICAgLy8gSW4gY2FzZSBvZiB0YXJnZXRlZCBzb2NrZXQgbWVzc2FnZSBvbmx5IGV4ZWN1dGUgd2l0aCB0YXJnZXQgdXNlciAoaW50ZW5kZWQgZm9yIEdNIHVzYWdlKVxuICAgNDk1XHQgICAgICAgICAgICBpZiAobWVzc2FnZS51c2VySWQgJiYgZ2FtZS51c2VyPy5pZCAhPT0gbWVzc2FnZS51c2VySWQpIHJldHVybjtcbiAgIDQ5Nlx0ICAgICAgICAgICAgaWYgKG1lc3NhZ2UudXNlcklkICYmIGdhbWUudXNlcj8uaWQpIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBHTSBpcyBoYW5kbGluZyBzeXN0ZW0gc29ja2V0IG1lc3NhZ2UnKTtcbiAgIDQ5N1x0XG4gICA0OThcdCAgICAgICAgICAgIGZvciAoY29uc3QgaGFuZGxlciBvZiBoYW5kbGVycykge1xuICAgNDk5XHQgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhgU2hhZG93cnVuIDZlIHwgSGFuZG92ZXIgc3lzdGVtIHNvY2tldCBtZXNzYWdlIHRvIGhhbmRsZXI6ICR7aGFuZGxlci5uYW1lfWApO1xuICAgNTAwXHQgICAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlcihtZXNzYWdlKTtcbiAgIDUwMVx0ICAgICAgICAgICAgfVxuICAgNTAyXHQgICAgICAgIH0pO1xuICAgNTAzXHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3RhcmdldGluZy9pbmRleC50c1xuLi4uXG4gICAgIDJcdFxuICAgICAzXHQvKipcbiAgICAgNFx0ICogUmVnaXN0ZXIgdGFyZ2V0aW5nIGhvb2tzXG4gICAgIDVcdCAqL1xuICAgICA2XHRleHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJUYXJnZXRpbmdIb29rcygpIHtcbiAgICAgN1x0ICAgIC8vIFJlZ2lzdGVyIGEgaG9vayB0byBoaWdobGlnaHQgdmFsaWQgdGFyZ2V0cyB3aGVuIGFuIGl0ZW0gaXMgdXNlZFxuICAgICA4XHQgICAgSG9va3Mub24oJ3NyNjpwcmVJdGVtUm9sbCcsIChpdGVtLCBhY3RvcikgPT4ge1xuICAgICA5XHQgICAgICAgIC8vIE9ubHkgaGlnaGxpZ2h0IHRhcmdldHMgZm9yIGl0ZW1zIHRoYXQgY2FuIHRhcmdldCBvdGhlciBhY3RvcnNcbiAgICAxMFx0ICAgICAgICBpZiAoaXRlbS5pc1JhbmdlZFdlYXBvbigpIHx8IGl0ZW0uaXNTcGVsbCgpIHx8IGl0ZW0uaXNNYXRyaXhBY3Rpb24oKSkge1xuICAgIDExXHQgICAgICAgICAgICBUYXJnZXRpbmdTZXJ2aWNlLmhpZ2hsaWdodFZhbGlkVGFyZ2V0cyhpdGVtLCBhY3Rvcik7XG4gICAgMTJcdCAgICAgICAgfVxuICAgIDEzXHQgICAgfSk7XG4gICAgMTRcdCAgICBcbiAgICAxNVx0ICAgIC8vIFJlZ2lzdGVyIGEgaG9vayB0byBjbGVhciB0YXJnZXQgaGlnaGxpZ2h0cyB3aGVuIGFuIGl0ZW0gcm9sbCBpcyBjb21wbGV0ZVxuICAgIDE2XHQgICAgSG9va3Mub24oJ3NyNjppdGVtUm9sbCcsICgpID0+IHtcbiAgICAxN1x0ICAgICAgICBUYXJnZXRpbmdTZXJ2aWNlLmNsZWFyVGFyZ2V0SGlnaGxpZ2h0cygpO1xuICAgIDE4XHQgICAgfSk7XG4gICAgMTlcdCAgICBcbiAgICAyMFx0ICAgIC8vIFJlZ2lzdGVyIGEgaG9vayB0byBjbGVhciB0YXJnZXQgaGlnaGxpZ2h0cyB3aGVuIGFuIGl0ZW0gcm9sbCBpcyBjYW5jZWxsZWRcbiAgICAyMVx0ICAgIEhvb2tzLm9uKCdzcjY6aXRlbVJvbGxDYW5jZWwnLCAoKSA9PiB7XG4gICAgMjJcdCAgICAgICAgVGFyZ2V0aW5nU2VydmljZS5jbGVhclRhcmdldEhpZ2hsaWdodHMoKTtcbiAgICAyM1x0ICAgIH0pO1xuICAgIDI0XHQgICAgXG4gICAgMjVcdCAgICBjb25zb2xlLmxvZyhcIlNoYWRvd3J1biA2ZSB8IFRhcmdldGluZyBob29rcyByZWdpc3RlcmVkXCIpO1xuICAgIDI2XHR9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvYWN0b3IvcHJlcC9DaGFyYWN0ZXJQcmVwLnRzXG4uLi5cbiAgICAyOFx0XG4gICAgMjlcdCAgICAvKipcbiAgICAzMFx0ICAgICAqIEFsbCBkZXJpdmVkIGRhdGEgc2hvdWxkIGRlcGVuZCBvbiBiYXNpYyB2YWx1ZXMgbGlrZSBBdHRyaWJ1dGVzIG9yIFNraWxscy5cbiAgICAzMVx0ICAgICAqXG4gICAgMzJcdCAgICAgKiBJdCBzaG91bGRuJ3QgYmUgbW9kaWZpZWQgYnkgQWN0aXZlIEVmZmVjdHMsIHdoaWNoIGluc3RlYWQgc2hvdWxkIG1vZGlmeSB0aGUgZ2xvYmFsIG1vZGlmaWVycy5cbiAgICAzM1x0ICAgICAqXG4gICAgMzRcdCAgICAgKiBAcGFyYW0gc3lzdGVtXG4gICAgMzVcdCAgICAgKiBAcGFyYW0gaXRlbXNcbiAgICAzNlx0ICAgICAqL1xuICAgIDM3XHQgICAgc3RhdGljIHByZXBhcmVEZXJpdmVkRGF0YShzeXN0ZW06IFNoYWRvd3J1bi5DaGFyYWN0ZXJEYXRhLCBpdGVtczogU1I2SXRlbURhdGFXcmFwcGVyW10pIHtcbiAgICAzOFx0ICAgICAgICBBdHRyaWJ1dGVzUHJlcC5wcmVwYXJlQXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDM5XHQgICAgICAgIEF0dHJpYnV0ZXNQcmVwLnByZXBhcmVFc3NlbmNlKHN5c3RlbSwgaXRlbXMpO1xuICAgIDQwXHRcbiAgICA0MVx0ICAgICAgICAvLyBOUENQcmVwIGlzIHJlbGlhbnQgdG8gYmUgY2FsbGVkIGFmdGVyIEF0dHJpYnV0ZXNQcmVwLlxuICAgIDQyXHQgICAgICAgIE5QQ1ByZXAucHJlcGFyZU5QQ0RhdGEoc3lzdGVtKTtcbiAgICA0M1x0XG4gICAgNDRcdCAgICAgICAgU2tpbGxzUHJlcC5wcmVwYXJlU2tpbGxzKHN5c3RlbSk7XG4gICAgNDVcdFxuICAgIDQ2XHQgICAgICAgIEl0ZW1QcmVwLnByZXBhcmVBcm1vcihzeXN0ZW0sIGl0ZW1zKTtcbiAgICA0N1x0ICAgICAgICBJdGVtUHJlcC5wcmVwYXJlV2VhcG9ucyhzeXN0ZW0sIGl0ZW1zKTtcbiAgICA0OFx0XG4gICAgNDlcdCAgICAgICAgTWF0cml4UHJlcC5wcmVwYXJlTWF0cml4KHN5c3RlbSwgaXRlbXMpO1xuICAgIDUwXHQgICAgICAgIE1hdHJpeFByZXAucHJlcGFyZU1hdHJpeFRvTGltaXRzQW5kQXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDUxXHRcbiAgICA1Mlx0ICAgICAgICBHcnVudFByZXAucHJlcGFyZUNvbmRpdGlvbk1vbml0b3JzKHN5c3RlbSk7XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvYWN0b3IvcHJlcC9JQ1ByZXAudHNcbi4uLlxuICAgIDEzXHRcbiAgICAxNFx0XG4gICAgMTVcdGV4cG9ydCBjbGFzcyBJQ1ByZXAge1xuICAgIDE2XHQgICAgc3RhdGljIHByZXBhcmVCYXNlRGF0YShzeXN0ZW06IElDRGF0YSkge1xuICAgIDE3XHQgICAgICAgIE1vZGlmaWVyc1ByZXAuY2xlYXJBdHRyaWJ1dGVNb2RzKHN5c3RlbSk7XG4gICAgMThcdCAgICAgICAgTW9kaWZpZXJzUHJlcC5jbGVhckxpbWl0TW9kcyhzeXN0ZW0pO1xuICAgIDE5XHQgICAgICAgIFNraWxsc1ByZXAucHJlcGFyZVNraWxsRGF0YShzeXN0ZW0pO1xuICAgIDIwXHRcbiAgICAyMVx0ICAgICAgICBJQ1ByZXAuYWRkTWlzc2luZ1RyYWNrcyhzeXN0ZW0pO1xuICAgIDIyXHQgICAgICAgIElDUHJlcC5wcmVwYXJlTW9kaWZpZXJzKHN5c3RlbSk7XG4gICAgMjNcdCAgICAgICAgSUNQcmVwLmhpZGVNZWF0QXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDI0XHQgICAgICAgIElDUHJlcC5hZGRIb3N0QXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDI1XHQgICAgfVxuICAgIDI2XHRcbiAgICAyN1x0ICAgIHN0YXRpYyBwcmVwYXJlRGVyaXZlZERhdGEoc3lzdGVtOiBJQ0RhdGEsIGl0ZW1zOiBTUjZJdGVtRGF0YVdyYXBwZXJbXSkge1xuICAgIDI4XHQgICAgICAgIElDUHJlcC5wcmVwYXJlTWF0cml4QXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDI5XHRcbiAgICAzMFx0ICAgICAgICBTa2lsbHNQcmVwLnByZXBhcmVTa2lsbHMoc3lzdGVtKTtcbiAgICAzMVx0XG4gICAgMzJcdCAgICAgICAgSUNQcmVwLnByZXBhcmVIb3N0QXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDMzXHQgICAgICAgIElDUHJlcC5wcmVwYXJlTWVhdEF0dHJpYnV0ZXMoc3lzdGVtKTtcbiAgICAzNFx0XG4gICAgMzVcdCAgICAgICAgTWF0cml4UHJlcC5wcmVwYXJlTWF0cml4VG9MaW1pdHNBbmRBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgMzZcdFxuICAgIDM3XHQgICAgICAgIElDUHJlcC5wcmVwYXJlTWF0cml4KHN5c3RlbSk7XG4gICAgMzhcdCAgICAgICAgSUNQcmVwLnByZXBhcmVNYXRyaXhUcmFjayhzeXN0ZW0pO1xuICAgIDM5XHRcbiAgICA0MFx0ICAgICAgICBJQ1ByZXAucHJlcGFyZU1hdHJpeEluaXQoc3lzdGVtKTtcbiAgICA0MVx0ICAgICAgICBJbml0aWF0aXZlUHJlcC5wcmVwYXJlQ3VycmVudEluaXRpYXRpdmUoc3lzdGVtKTtcbiAgICA0Mlx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9tYWluLnRzXG4gICAgIDFcdGltcG9ydCB7IEhhbmRsZWJhck1hbmFnZXIgfSBmcm9tICcuL2hhbmRsZWJhcnMvSGFuZGxlYmFyTWFuYWdlcic7XG4gICAgIDJcdGltcG9ydCB7SG9va3NNYW5hZ2VyfSBmcm9tIFwiLi9ob29rc1wiO1xuICAgICAzXHRcbiAgICAgNFx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgICAgNVx0LyogIEZvdW5kcnkgVlRUIEluaXRpYWxpemF0aW9uICAgICAgICAgICAgICAgICAgKi9cbiAgICAgNlx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgICAgN1x0XG4gICAgIDhcdFxuICAgICA5XHRIb29rc01hbmFnZXIucmVnaXN0ZXJIb29rcygpO1xuICAgIDEwXHRIYW5kbGViYXJNYW5hZ2VyLnJlZ2lzdGVySGVscGVycygpOy4uLlxuUGF0aDogc3JjL21vZHVsZS9jYW52YXMudHNcbiAgICAgMVx0aW1wb3J0IHtGTEFHUywgU1lTVEVNX05BTUV9IGZyb20gJy4vY29uc3RhbnRzJztcbiAgICAgMlx0XG4gICAgIDNcdGludGVyZmFjZSBEaXN0YW5jZU9wdGlvbnMge1xuICAgICA0XHQgICAgZ3JpZFNwYWNlcz86IGJvb2xlYW5cbiAgICAgNVx0fVxuICAgICA2XHRcbiAgICAgN1x0LyoqXG4gICAgIDhcdCAqIFB1bGxlZCBmcm9tIHRoZSBGb3VuZHJ5VlRUIERORDVlIHN5c3RlbTogZ3JpZC5tanMjbWVhc3VyZURpc3RhbmNlXG4gICAgIDlcdCAqIFxuICAgIDEwXHQgKiBAcGFyYW0gc2VnbWVudHMgXG4gICAgMTFcdCAqIEBwYXJhbSBvcHRpb25zIFxuICAgIDEyXHQgKiBAcmV0dXJucyBcbiAgICAxM1x0ICovXG4gICAgMTRcdGNvbnN0IG1lYXN1cmVEaXN0YW5jZXMgPSBmdW5jdGlvbiAoc2VnbWVudHMsIG9wdGlvbnM6IERpc3RhbmNlT3B0aW9ucyA9IHt9KSB7XG4gICAgMTVcdCAgICBpZiAoIW9wdGlvbnMuZ3JpZFNwYWNlcykgcmV0dXJuIEJhc2VHcmlkLnByb3RvdHlwZS5tZWFzdXJlRGlzdGFuY2VzLmNhbGwodGhpcywgc2VnbWVudHMsIG9wdGlvbnMpO1xuICAgIDE2XHRcbiAgICAxN1x0ICAgIC8vIFRyYWNrIHRoZSB0b3RhbCBudW1iZXIgb2YgZGlhZ29uYWxzXG4gICAgMThcdCAgICBsZXQgbkRpYWdvbmFsID0gMDtcbiAgICAxOVx0ICAgIGNvbnN0IHJ1bGUgPSB0aGlzLmRpYWdvbmFsUnVsZTtcbiAgICAyMFx0ICAgIGNvbnN0IGQgPSBjYW52YXMuZGltZW5zaW9ucyBhcyBDYW52YXMuRGltZW5zaW9ucztcbiAgICAyMVx0XG4gICAgMjJcdCAgICAvLyBJdGVyYXRlIG92ZXIgbWVhc3VyZWQgc2VnbWVudHNcbiAgICAyM1x0ICAgIHJldHVybiBzZWdtZW50cy5tYXAoKHMpID0+IHtcbiAgICAyNFx0ICAgICAgICBsZXQgciA9IHMucmF5O1xuICAgIDI1XHRcbiAgICAyNlx0ICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIHRvdGFsIGRpc3RhbmNlIHRyYXZlbGVkXG4gICAgMjdcdCAgICAgICAgbGV0IG54ID0gTWF0aC5hYnMoTWF0aC5jZWlsKHIuZHggLyBkLnNpemUpKTtcbiAgICAyOFx0ICAgICAgICBsZXQgbnkgPSBNYXRoLmFicyhNYXRoLmNlaWwoci5keSAvIGQuc2l6ZSkpO1xuICAgIDI5XHRcbiAgICAzMFx0ICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIG51bWJlciBvZiBzdHJhaWdodCBhbmQgZGlhZ29uYWwgbW92ZXNcbiAgICAzMVx0ICAgICAgICBsZXQgbmQgPSBNYXRoLm1pbihueCwgbnkpO1xuICAgIDMyXHQgICAgICAgIGxldCBucyA9IE1hdGguYWJzKG55IC0gbngpO1xuICAgIDMzXHQgICAgICAgIG5EaWFnb25hbCArPSBuZDtcbiAgICAzNFx0XG4gICAgMzVcdCAgICAgICAgLy8gRXN0aW1hdGUgZGlhZ29uYWwgbGlrZSBvdGhlciBiYXR0bGUgZ3JpZCBzeXN0ZW1zIGRvLiAoRG5ENWUpXG4gICAgMzZcdCAgICAgICAgaWYgKHJ1bGUgPT09ICcxLTItMScpIHtcbiAgICAzN1x0ICAgICAgICAgICAgbGV0IG5kMTAgPSBNYXRoLmZsb29yKG5EaWFnb25hbCAvIDIpIC0gTWF0aC5mbG9vcigobkRpYWdvbmFsIC0gbmQpIC8gMik7XG4gICAgMzhcdCAgICAgICAgICAgIGxldCBzcGFjZXMgPSBuZDEwICogMiArIChuZCAtIG5kMTApICsgbnM7XG4gICAgMzlcdCAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICAgNDBcdCAgICAgICAgICAgIHJldHVybiBzcGFjZXMgKiBjYW52YXMuZGltZW5zaW9ucy5kaXN0YW5jZTtcbiAgICA0MVx0ICAgICAgICB9XG4gICAgNDJcdFxuICAgIDQzXHQgICAgICAgIC8vIFRyZWF0IGRpYWdvbmFsIGFzIHN0cmFpZ2h0IGxpbmVcbiAgICA0NFx0ICAgICAgICBlbHNlIGlmIChydWxlID09PSAnRVVDTCcpIHtcbiAgICA0NVx0ICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgICA0Nlx0ICAgICAgICAgICAgLy8gcmV0dXJuIE1hdGgucm91bmQoTWF0aC5oeXBvdChueCwgbnkpICogY2FudmFzLnNjZW5lLmRhdGEuZ3JpZERpc3RhbmNlKTtcbiAgICA0N1x0ICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoTWF0aC5oeXBvdChueCwgbnkpICogY2FudmFzLnNjZW5lPy5ncmlkLmRpc3RhbmNlKTtcbiAgICA0OFx0ICAgICAgICB9XG4gICAgNDlcdFxuICAgIDUwXHQgICAgICAgIC8vIFRyZWF0IGRpYWdvbmFsIGFzIHN0cmFpZ2h0IG1vdmVtZW50XG4gICAgNTFcdCAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgICA1Mlx0ICAgICAgICBlbHNlIHJldHVybiAobnMgKyBuZCkgKiBjYW52YXMuc2NlbmU/LmdyaWQuZGlzdGFuY2U7XG4gICAgNTNcdCAgICB9KTtcbiAgICA1NFx0fTtcbiAgICA1NVx0XG4gICAgNTZcdFxuICAgIDU3XHRleHBvcnQgZnVuY3Rpb24gY2FudmFzSW5pdCgpIHtcbiAgICA1OFx0ICAgIC8vQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgICA1OVx0ICAgIC8vIENvcHkgRG5ENWUncyBhcHByb2FjaCB0byBtb3ZlbWVudCBtZWFzdXJlbWVudCBhbmQgYWRkIGEgY3VzdG9tIGZpZWxkIHRvIHRoZSBncmlkIHRvIGJlIHVzZWQgaW4gY2FudmFzLnRzI21lYXN1cmVEaXN0YW5jZXNcbiAgICA2MFx0ICAgIGNhbnZhcy5ncmlkLmRpYWdvbmFsUnVsZSA9IGdhbWUuc2V0dGluZ3MuZ2V0KFNZU1RFTV9OQU1FLCBGTEFHUy5EaWFnb25hbE1vdmVtZW50KTtcbiAgICA2MVx0ICAgIC8vIEFkZCBhIGN1c3RvbSBtZWFzdXJlRGlzdGFuY2VzIGZ1bmN0aW9uLCBvdmVyd3JpdGluZyBkZWZhdWx0IHRvIGFkZCBtb3JlIG1vdmVtZW50IHN0eWxlcy5cbiAgICA2Mlx0ICAgIFNxdWFyZUdyaWQucHJvdG90eXBlLm1lYXN1cmVEaXN0YW5jZXMgPSBtZWFzdXJlRGlzdGFuY2VzO1xuICAgIDYzXHR9Li4uXG5QYXRoOiBzcmMvbW9kdWxlL2hlbHBlcnMudHNcbi4uLlxuICAgMzA3XHRcbiAgIDMwOFx0ICAgIC8vIFRPRE86IEZvdW5kcnkgMC45IFNob3VsZCBUb2tlbkRvY3VtZW50IGJlIHVzZWQgaW5zdGVhZCBvZiBUb2tlbj9cbiAgIDMwOVx0ICAgIC8vIFRPRE86IENoZWNrIGNhbnZhcy5zY2VuZS50b2tlbnNcbiAgIDMxMFx0ICAgIHN0YXRpYyBnZXRUb2tlbihpZD86IHN0cmluZyk6IFRva2VuIHwgdW5kZWZpbmVkIHtcbiAgIDMxMVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5IHx8ICFjYW52YXMudG9rZW5zKSByZXR1cm47XG4gICAzMTJcdFxuICAgMzEzXHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzKSB7XG4gICAzMTRcdCAgICAgICAgICAgIGlmICh0b2tlbi5pZCA9PT0gaWQpIHtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgIDMxNlx0ICAgICAgICAgICAgfVxuICAgMzE3XHQgICAgICAgIH1cbiAgIDMxOFx0ICAgIH1cbiAgIDMxOVx0XG4gICAzMjBcdCAgICAvKipcbiAgIDMyMVx0ICAgICAqIFVzZSB0aGlzIGhlbHBlciB0byBnZXQgYSB0b2tlbnMgYWN0b3IgZnJvbSBhbnkgZ2l2ZW4gc2NlbmUgaWQuXG4gICAzMjJcdCAgICAgKiBAcGFyYW0gc2NlbmVUb2tlbklkIEEgbWl4ZWQgaWQgd2l0aCB0aGUgZm9ybWF0ICc8c2NlbmVJZD4uPHRva2VuaWQ+XG4gICAzMjNcdCAgICAgKi9cbiAgIDMyNFx0ICAgIHN0YXRpYyBnZXRTY2VuZVRva2VuQWN0b3Ioc2NlbmVUb2tlbklkOiBzdHJpbmcpOiBTUjZBY3RvciB8IG51bGwge1xuICAgMzI1XHQgICAgICAgIGNvbnN0IFtzY2VuZUlkLCB0b2tlbklkXSA9IEhlbHBlcnMuZGVjb25zdHJ1Y3RTY2VuZVRva2VuSWQoc2NlbmVUb2tlbklkKTtcbiAgIDMyNlx0ICAgICAgICBjb25zdCB0b2tlbiA9IEhlbHBlcnMuZ2V0U2NlbmVUb2tlbkRvY3VtZW50KHNjZW5lSWQsIHRva2VuSWQpO1xuICAgMzI3XHQgICAgICAgIGlmICghdG9rZW4pIHJldHVybiBudWxsO1xuICAgMzI4XHQgICAgICAgIHJldHVybiB0b2tlbi5nZXRBY3RvcigpO1xuICAgMzI5XHQgICAgfVxuLi4uXG5QYXRoOiBzaGFkb3dydW42LWdlbmVzaXMtaW1wb3J0ZXIvbW9kdWxlL21haW4uanNcbiAgICAgMVx0aW1wb3J0IHsgR2VuZXNpc0ltcG9ydEZvcm0gfSBmcm9tICcuL2FwcHMvZ2VuZXNpcy1pbXBvcnQtZm9ybS5qcyc7XG4gICAgIDJcdFxuICAgICAzXHRIb29rcy5vbmNlKCdpbml0JywgKCkgPT4ge1xuICAgICA0XHQgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSBHZW5lc2lzIEltcG9ydGVyIHwgSW5pdGlhbGl6aW5nIG1vZHVsZScpO1xuICAgICA1XHR9KTtcbiAgICAgNlx0XG4gICAgIDdcdEhvb2tzLm9uY2UoJ3JlYWR5JywgKCkgPT4ge1xuICAgICA4XHQgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSBHZW5lc2lzIEltcG9ydGVyIHwgTW9kdWxlIHJlYWR5Jyk7XG4gICAgIDlcdH0pO1xuICAgIDEwXHRcbiAgICAxMVx0Ly8gUmVnaXN0ZXIgdGhlIEdlbmVzaXMgaW1wb3J0ZXIgd2l0aCB0aGUgU2hhZG93cnVuIDZlIHN5c3RlbVxuICAgIDEyXHRIb29rcy5vbigncmVuZGVyQWN0b3JTaGVldCcsIChhcHAsIGh0bWwsIGRhdGEpID0+IHtcbiAgICAxM1x0ICAgIC8vIE9ubHkgYWRkIHRoZSBidXR0b24gdG8gU2hhZG93cnVuIDZlIGNoYXJhY3RlciBzaGVldHNcbiAgICAxNFx0ICAgIGlmIChhcHAuYWN0b3IudHlwZSAhPT0gJ2NoYXJhY3RlcicgfHwgIWFwcC5hY3Rvci5zeXN0ZW0pIHJldHVybjtcbiAgICAxNVx0ICAgIFxuICAgIDE2XHQgICAgLy8gRmluZCB0aGUgaW1wb3J0IGNoYXJhY3RlciBidXR0b25cbiAgICAxN1x0ICAgIGNvbnN0IGltcG9ydEJ1dHRvbiA9IGh0bWwuZmluZCgnLmltcG9ydC1jaGFyYWN0ZXInKTtcbiAgICAxOFx0ICAgIGlmIChpbXBvcnRCdXR0b24ubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgMTlcdCAgICBcbiAgICAyMFx0ICAgIC8vIEFkZCBvdXIgb3duIGNsaWNrIGhhbmRsZXJcbiAgICAyMVx0ICAgIGltcG9ydEJ1dHRvbi5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgMjJcdCAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAyM1x0ICAgICAgICBcbiAgICAyNFx0ICAgICAgICAvLyBDcmVhdGUgYSBkaWFsb2cgdG8gY2hvb3NlIGJldHdlZW4gQ2h1bW1lciBhbmQgR2VuZXNpcyBpbXBvcnRcbiAgICAyNVx0ICAgICAgICBjb25zdCBjb250ZW50ID0gYFxuICAgIDI2XHQgICAgICAgICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tYm90dG9tOiAxMHB4O1wiPlxuICAgIDI3XHQgICAgICAgICAgICAgICAgPHA+JHtnYW1lLmkxOG4ubG9jYWxpemUoJ1NSNi5JbXBvcnRDaGFyYWN0ZXJDaG9vc2UnKX08L3A+XG4gICAgMjhcdCAgICAgICAgICAgIDwvZGl2PlxuICAgIDI5XHQgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XCI+XG4gICAgMzBcdCAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiY2h1bW1lci1pbXBvcnRcIj4ke2dhbWUuaTE4bi5sb2NhbGl6ZSgnU1I2LkNodW1tZXJJbXBvcnQnKX08L2J1dHRvbj5cbiAgICAzMVx0ICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJnZW5lc2lzLWltcG9ydFwiPiR7Z2FtZS5pMThuLmxvY2FsaXplKCdTUjYuR2VuZXNpc0ltcG9ydCcpfTwvYnV0dG9uPlxuICAgIDMyXHQgICAgICAgICAgICA8L2Rpdj5cbiAgICAzM1x0ICAgICAgICBgO1xuICAgIDM0XHRcbiAgICAzNVx0ICAgICAgICBjb25zdCBkaWFsb2cgPSBuZXcgRGlhbG9nKHtcbiAgICAzNlx0ICAgICAgICAgICAgdGl0bGU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnU1I2LkltcG9ydENoYXJhY3RlcicpLFxuICAgIDM3XHQgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LFxuICAgIDM4XHQgICAgICAgICAgICBidXR0b25zOiB7fSxcbiAgICAzOVx0ICAgICAgICAgICAgcmVuZGVyOiBodG1sID0+IHtcbiAgICA0MFx0ICAgICAgICAgICAgICAgIGh0bWwuZmluZCgnLmNodW1tZXItaW1wb3J0JykuY2xpY2soKCkgPT4ge1xuICAgIDQxXHQgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5jbG9zZSgpO1xuICAgIDQyXHQgICAgICAgICAgICAgICAgICAgIC8vIENhbGwgdGhlIHN5c3RlbSdzIENodW1tZXIgaW1wb3J0ZXJcbiAgICA0M1x0ICAgICAgICAgICAgICAgICAgICBhcHAuX29uU2hvd0ltcG9ydENoYXJhY3RlcihldmVudCk7XG4gICAgNDRcdCAgICAgICAgICAgICAgICB9KTtcbiAgICA0NVx0XG4gICAgNDZcdCAgICAgICAgICAgICAgICBodG1sLmZpbmQoJy5nZW5lc2lzLWltcG9ydCcpLmNsaWNrKCgpID0+IHtcbiAgICA0N1x0ICAgICAgICAgICAgICAgICAgICBkaWFsb2cuY2xvc2UoKTtcbiAgICA0OFx0ICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgIDQ5XHQgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnZ2VuZXNpcy1pbXBvcnQnLFxuICAgIDUwXHQgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZ2FtZS5pMThuLmxvY2FsaXplKCdTUjYuR2VuZXNpc0ltcG9ydCcpLFxuICAgIDUxXHQgICAgICAgICAgICAgICAgICAgIH07XG4gICAgNTJcdCAgICAgICAgICAgICAgICAgICAgbmV3IEdlbmVzaXNJbXBvcnRGb3JtKGFwcC5hY3Rvciwgb3B0aW9ucykucmVuZGVyKHRydWUpO1xuICAgIDUzXHQgICAgICAgICAgICAgICAgfSk7XG4gICAgNTRcdCAgICAgICAgICAgIH1cbiAgICA1NVx0ICAgICAgICB9KTtcbiAgICA1Nlx0XG4gICAgNTdcdCAgICAgICAgZGlhbG9nLnJlbmRlcih0cnVlKTtcbiAgICA1OFx0ICAgIH0pO1xuICAgIDU5XHR9KTtcbiAgICA2MFx0XG4gICAgNjFcdC8vIEV4cG9ydCB0aGUgR2VuZXNpc0ltcG9ydEZvcm0gZm9yIGV4dGVybmFsIHVzZVxuICAgIDYyXHRleHBvcnQgeyBHZW5lc2lzSW1wb3J0Rm9ybSB9O1xuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3J1bGVzL0RvY3VtZW50U2l0dWF0aW9uTW9kaWZpZXJzLnRzXG4uLi5cbiAgIDM5MFx0XG4gICAzOTFcdCAgICAvKipcbiAgIDM5Mlx0ICAgICAqIEhlbHBlciBmb3Igc2NlbmUgbW9kaWZpZXIgaW5zdGFuY2VzIHRvIGNsZWFyIGFsbCBtb2RpZmllcnMgZm9yIGFsbCBwbGFjZWQgdG9rZW5zXG4gICAzOTNcdCAgICAgKi9cbiAgIDM5NFx0ICAgIGFzeW5jIGNsZWFyQWxsVG9rZW5zT25TY2VuZSgpIHtcbiAgIDM5NVx0ICAgICAgICBpZiAoIWNhbnZhcy5yZWFkeSB8fCAhY2FudmFzLnNjZW5lKSByZXR1cm47XG4gICAzOTZcdCAgICAgICAgaWYgKCF0aGlzLmRvY3VtZW50SXNTY2VuZSkgcmV0dXJuO1xuICAgMzk3XHRcbiAgIDM5OFx0ICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IG1vZGlmaWVycyBzY2VuZSBpcyBzYW1lIHRvIGN1cnJlbnQgc2NlbmUuXG4gICAzOTlcdCAgICAgICAgY29uc3Qgc2NlbmUgPSB0aGlzLmRvY3VtZW50IGFzIFNjZW5lO1xuICAgNDAwXHQgICAgICAgIGlmIChjYW52YXMuc2NlbmUuaWQgIT09IHNjZW5lLmlkKSByZXR1cm47XG4gICA0MDFcdFxuICAgNDAyXHQgICAgICAgIC8vIFVzZSBjdXJyZW50IHNjZW5lIGZvciBlYXNlIG9mIGFjY2VzcyB0byB0b2tlbnNcbiAgIDQwM1x0ICAgICAgICBjYW52YXMuc2NlbmUudG9rZW5zLmZvckVhY2godG9rZW4gPT4gdG9rZW4uYWN0b3I/LmdldFNpdHVhdGlvbk1vZGlmaWVycygpLmNsZWFyQWxsKCkpO1xuICAgNDA0XHQgICAgfVxuICAgNDA1XHR9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvY29tYmF0L1NSNkNvbWJhdC50c1xuLi4uXG4gICAzNjVcdCAgICAgICAgbGV0IG5leHRUdXJuID0gdGhpcy5zZXR0aW5ncz8uc2tpcERlZmVhdGVkID9cbiAgIDM2Nlx0ICAgICAgICAgICAgdGhpcy5uZXh0VW5kZWZlYXRlZFR1cm5Qb3NpdGlvbiA6XG4gICAzNjdcdCAgICAgICAgICAgIHRoaXMubmV4dFZpYWJsZVR1cm5Qb3NpdGlvbjtcbiAgIDM2OFx0XG4gICAzNjlcdCAgICAgICAgLy8gU3RhcnQgb2YgdGhlIGNvbWJhdCBIYW5kbGluZ1xuICAgMzcwXHQgICAgICAgIGlmIChuZXh0Um91bmQgPT09IDAgJiYgaW5pdGlhdGl2ZVBhc3MgPT09IDApIHtcbiAgIDM3MVx0ICAgICAgICAgICAgYXdhaXQgdGhpcy5zdGFydENvbWJhdCgpO1xuICAgMzcyXHQgICAgICAgICAgICByZXR1cm47XG4gICAzNzNcdCAgICAgICAgfVxuICAgMzc0XHRcbiAgIDM3NVx0ICAgICAgICAvLyBKdXN0IHN0ZXAgZnJvbSBvbmUgY29tYmF0YW50IHRvIHRoZSBuZXh0IVxuICAgMzc2XHQgICAgICAgIGlmIChuZXh0VHVybiA8IHRoaXMudHVybnMubGVuZ3RoKSB7XG4gICAzNzdcdCAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlKHsgdHVybjogbmV4dFR1cm4gfSk7XG4gICAzNzhcdCAgICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlQWN0aW9uUGhhc2UoKTtcbiAgIDM3OVx0ICAgICAgICAgICAgcmV0dXJuO1xuICAgMzgwXHQgICAgICAgIH1cbiAgIDM4MVx0XG4gICAzODJcdCAgICAgICAgLy8gSW4gU2hhZG93cnVuIDZ0aCBFZGl0aW9uLCB0aGVyZSBhcmUgbm8gaW5pdGlhdGl2ZSBwYXNzZXNcbiAgIDM4M1x0XG4gICAzODRcdFxuICAgMzg1XHQgICAgICAgIC8vIEluaXRpYXRpdmUgUm91bmQgSGFuZGxpbmcuXG4gICAzODZcdCAgICAgICAgLy8gTk9URTogSXQncyBub3QgY2hlY2tlZCBpZiB0aGUgbmV4dCBpcyBuZWVkZWQuIFRoaXMgc2hvdWxkIHJlc3VsdCBpbiB0aGUgdXNlciBub3RpY2luZyB0aGUgdHVybiBnb2luZyB1cCwgd2hlbiBpdFxuICAgMzg3XHQgICAgICAgIC8vICAgICAgIG1heWJlIHNob3VsZG4ndCBhbmQgcmVwb3J0aW5nIGEgdW5oYW5kbGVkIGNvbWJhdCBwaGFzZSBmbG93IGNhc2UuXG4gICAzODhcdCAgICAgICAgcmV0dXJuIHRoaXMubmV4dFJvdW5kKCk7XG4gICAzODlcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvbWlncmF0b3IvVmVyc2lvbk1pZ3JhdGlvbi50c1xuLi4uXG4gICAxMzRcdFxuICAgMTM1XHQgICAgLyoqXG4gICAxMzZcdCAgICAgKiBJdGVyYXRlIHRocm91Z2ggYWxsIHNjZW5lcyBhbmQgbWlncmF0ZSBlYWNoIGlmIG5lZWRlZC5cbiAgIDEzN1x0ICAgICAqIEBwYXJhbSBnYW1lXG4gICAxMzhcdCAgICAgKiBAcGFyYW0gZW50aXR5VXBkYXRlc1xuICAgMTM5XHQgICAgICovXG4gICAxNDBcdCAgICBwcm90ZWN0ZWQgYXN5bmMgSXRlcmF0ZVNjZW5lcyhnYW1lOiBHYW1lLCBlbnRpdHlVcGRhdGVzOiBNYXA8U3lzdGVtTWlncmF0aW9uRG9jdW1lbnRzLCBEb2N1bWVudFVwZGF0ZT4pIHtcbiAgIDE0MVx0ICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC8vIGlnbm9yZSBudWxsIHN0YXRlXG4gICAxNDJcdCAgICAgICAgZm9yIChjb25zdCBzY2VuZSBvZiBnYW1lLnNjZW5lcy5jb250ZW50cykge1xuICAgMTQzXHQgICAgICAgICAgICB0cnkge1xuICAgMTQ0XHQgICAgICAgICAgICAgICAgaWYgKCEoYXdhaXQgdGhpcy5TaG91bGRNaWdyYXRlU2NlbmVEYXRhKHNjZW5lKSkpIHtcbiAgIDE0NVx0ICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgIDE0Nlx0ICAgICAgICAgICAgICAgIH1cbiAgIDE0N1x0XG4gICAxNDhcdCAgICAgICAgICAgICAgICAvLyBNaWdyYXRlIFNjZW5lRGF0YSBpdHNlbGYuXG4gICAxNDlcdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgTWlncmF0aW5nIFNjZW5lIGVudGl0eSAke3NjZW5lLm5hbWV9YCk7XG4gICAxNTBcdCAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0gYXdhaXQgdGhpcy5NaWdyYXRlU2NlbmVEYXRhKHNjZW5lKTtcbiAgIDE1MVx0XG4gICAxNTJcdCAgICAgICAgICAgICAgICBleHBhbmRPYmplY3QodXBkYXRlRGF0YSk7XG4gICAxNTNcdCAgICAgICAgICAgICAgICBlbnRpdHlVcGRhdGVzLnNldChzY2VuZSwge1xuICAgMTU0XHQgICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAxNTVcdCAgICAgICAgICAgICAgICAgICAgZW1iZWRkZWRJdGVtczogbnVsbCxcbiAgIDE1Nlx0ICAgICAgICAgICAgIC4uLiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMURNRnJSeTJSb1hBWVNCUDJ5M2JGZDMifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0iLCJmb2xkZXJSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjEyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9fX1dLCJ0aW1lc3RhbXAiOiIyMDI1LTA1LTI5VDIzOjMyOjIwLjMzMFoiLCJyZXNwb25zZV90ZXh0IjoiTm93IGxldCBtZSBsb29rIGF0IHRoZSBzcGVjaWZpYyBlcnJvciBwYXR0ZXJucyBhbmQgdGhlIG1hdHJpeCBhY3Rpb24gaW5pdGlhbGl6YXRpb24gY29kZSBtb3JlIGNsb3NlbHk6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiZDBjNGQ4OTMtOWQ4Mi00ZjVkLThiYzEtODk1MjU5ZDMzOTc1IiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxU1VOOEZuOHVZdVlyUEZXTnhtVmlGSiIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwidmlld1wiLCBcInBhdGhcIjogXCJzcmMvbW9kdWxlL2hvb2tzLnRzXCIsIFwidmlld19yYW5nZVwiOiBbNDQ1LCA0NzBdfSIsIm1jcF9zZXJ2ZXJfbmFtZSI6IiIsIm1jcF90b29sX25hbWUiOiIifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6IkxldCBtZSBhbHNvIGNoZWNrIHRoZSBob29rcy50cyBmaWxlIGZvciB0aGUgc3BlY2lmaWMgY29kZSB0aGF0IHByb2Nlc3NlcyB0b2tlbnMgYW5kIG1pZ2h0IGJlIGNhdXNpbmcgdGhlIGlzc3VlOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzOlxuICAgMzE1XHQgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAzMTZcdCAgICAgICAgfVxuICAgMzE3XHRcbiAgIDMxOFx0ICAgICAgICAvLyBFbnN1cmUgbWF0cml4IGFjdGlvbnMgYXJlIGF2YWlsYWJsZSBmb3IgYWxsIGFjdG9ycyB0aGF0IGNhbiB1c2UgdGhlIE1hdHJpeFxuICAgMzE5XHQgICAgICAgIGlmIChnYW1lLnVzZXI/LmlzR00gJiYgdGhpcy5pc093bmVyICYmICh0aGlzLmlzQ2hhcmFjdGVyKCkgfHwgdGhpcy5pc1Nwcml0ZSgpIHx8IHRoaXMuaXNJQygpKSkge1xuICAgMzIwXHQgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGFkZGVkIG1hdHJpeCBhY3Rpb25zIHRvIHRoaXMgYWN0b3JcbiAgIDMyMVx0ICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XG4gICAzMjJcdCAgICAgICAgICAgIGlmICghaGFzTWF0cml4QWN0aW9ucykge1xuICAgMzIzXHQgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byB1c2UgYSBzZXRUaW1lb3V0IHRvIGF2b2lkIGlzc3VlcyB3aXRoIHRoZSBhY3RvciBiZWluZyBsb2NrZWQgZHVyaW5nIGRhdGEgcHJlcGFyYXRpb25cbiAgIDMyNFx0ICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCksIDUwMCk7XG4gICAzMjVcdCAgICAgICAgICAgIH1cbiAgIDMyNlx0ICAgICAgICB9XG4gICAzMjdcdCAgICB9XG4gICAzMjhcdFxuICAgMzI5XHQgICAgLyoqXG4gICAzMzBcdCAgICAgKiBOT1RFOiBUaGlzIG1ldGhvZCBpcyB1bnVzZWQgYXQgdGhlIG1vbWVudCwga2VlcCBpdCBmb3IgZnV0dXJlIGluc3BpcmF0aW9uLlxuVG90YWwgbGluZXMgaW4gZmlsZTogMzAzMVxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxUW9aTU5NZnFtOFBLaTV1UkJ0eWd2MiJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSIsImZvbGRlclJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MTIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn19fV0sInRpbWVzdGFtcCI6IjIwMjUtMDUtMjlUMjM6MzI6MjMuOTk3WiIsInJlc3BvbnNlX3RleHQiOiJMZXQgbWUgYWxzbyBjaGVjayB0aGUgaG9va3MudHMgZmlsZSBmb3IgdGhlIHNwZWNpZmljIGNvZGUgdGhhdCBwcm9jZXNzZXMgdG9rZW5zIGFuZCBtaWdodCBiZSBjYXVzaW5nIHRoZSBpc3N1ZTpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiJmMTU2ZDhmZS0zNDUzLTQxM2UtOWI1Ny01NGQ5NzE4MTc2ODkiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFQVFdlUmRtd3B1RlhDMUg1TG1tUDlVIiwidG9vbF9uYW1lIjoiY29kZWJhc2UtcmV0cmlldmFsIiwiaW5wdXRfanNvbiI6IntcImluZm9ybWF0aW9uX3JlcXVlc3RcIjogXCJDb2RlIHRoYXQgYWNjZXNzZXMgdG9rZW4uYWN0b3IgcHJvcGVydHkgd2l0aG91dCBmaXJzdCBjaGVja2luZyBpZiB0aGUgYWN0b3IgZXhpc3RzLCBwYXJ0aWN1bGFybHkgYW55IGNvZGUgdGhhdCBtaWdodCBydW4gZHVyaW5nIGluaXRpYWxpemF0aW9uIG9yIHNjZW5lIGxvYWRpbmcuIExvb2sgZm9yIHBhdHRlcm5zIGxpa2UgdG9rZW4uYWN0b3Iuc29tZU1ldGhvZCgpIHdpdGhvdXQgbnVsbCBjaGVja3MuXCJ9IiwibWNwX3NlcnZlcl9uYW1lIjoiIiwibWNwX3Rvb2xfbmFtZSI6IiJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTm93IGxldCBtZSBzZWFyY2ggZm9yIGFueSBvdGhlciBjb2RlIHRoYXQgbWlnaHQgYmUgYWNjZXNzaW5nIHRva2VucyB3aXRob3V0IHByb3BlciBhY3RvciBjaGVja3M6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJIZXJlJ3MgdGhlIHJlc3VsdCBvZiBydW5uaW5nIGBjYXQgLW5gIG9uIHNyYy9tb2R1bGUvaG9va3MudHM6XG4gICA0NDVcdCAgICAgICAgaWYgKCFjYW52YXMucmVhZHkgfHwgIWdhbWUuYWN0b3JzKSByZXR1cm47XG4gICA0NDZcdFxuICAgNDQ3XHQgICAgICAgIGlmIChpdGVtLmlzSG9zdCkge1xuICAgNDQ4XHQgICAgICAgICAgICAvLyBDb2xsZWN0IGFjdG9ycyBmcm9tIHNpZGViYXIgYW5kIGFjdGl2ZSBzY2VuZSB0byB1cGRhdGUgLyByZXJlbmRlclxuICAgNDQ5XHQgICAgICAgICAgICBsZXQgY29ubmVjdGVkSUMgPSBbXG4gICA0NTBcdCAgICAgICAgICAgICAgICAvLyBBbGwgc2lkZWJhciBhY3RvcnMgc2hvdWxkIGFsc28gaW5jbHVkZSB0b2tlbnMgd2l0aCBsaW5rZWQgYWN0b3JzLlxuICAgNDUxXHQgICAgICAgICAgICAgICAgLi4uZ2FtZS5hY3RvcnMuZmlsdGVyKChhY3RvcjogU1I2QWN0b3IpID0+IGFjdG9yLmlzSUMoKSAmJiBhY3Rvci5oYXNIb3N0KCkpIGFzIFNSNkFjdG9yW10sXG4gICA0NTJcdCAgICAgICAgICAgICAgICAvLyBBbGwgdG9rZW4gYWN0b3JzIHRoYXQgYXJlbid0IGxpbmtlZC5cbiAgIDQ1M1x0ICAgICAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICA0NTRcdCAgICAgICAgICAgICAgICAuLi5jYW52YXMuc2NlbmUudG9rZW5zLmZpbHRlcih0b2tlbiA9PiAhdG9rZW4uYWN0b3JMaW5rICYmIHRva2VuLmFjdG9yPy5pc0lDKCkgJiYgdG9rZW4uYWN0b3I/Lmhhc0hvc3QoKSkubWFwKHQgPT4gdC5hY3RvcilcbiAgIDQ1NVx0ICAgICAgICAgICAgXTtcbiAgIDQ1Nlx0XG4gICA0NTdcdCAgICAgICAgICAgIC8vIFVwZGF0ZSBob3N0IGRhdGEgb24gdGhlIGljIGFjdG9yLlxuICAgNDU4XHQgICAgICAgICAgICBjb25zdCBob3N0ID0gaXRlbS5hc0hvc3Q7XG4gICA0NTlcdCAgICAgICAgICAgIGlmICghaG9zdCkgcmV0dXJuO1xuICAgNDYwXHQgICAgICAgICAgICBmb3IgKGNvbnN0IGljIG9mIGNvbm5lY3RlZElDKSB7XG4gICA0NjFcdCAgICAgICAgICAgICAgICBpZiAoIWljKSBjb250aW51ZTtcbiAgIDQ2Mlx0ICAgICAgICAgICAgICAgIGF3YWl0IGljLl91cGRhdGVJQ0hvc3REYXRhKGhvc3QpO1xuICAgNDYzXHQgICAgICAgICAgICB9XG4gICA0NjRcdCAgICAgICAgfVxuICAgNDY1XHQgICAgfVxuICAgNDY2XHRcbiAgIDQ2N1x0ICAgIHN0YXRpYyBhc3luYyByZW1vdmVEZWxldGVkSXRlbXNGcm9tTmV0d29ya3MoaXRlbTogU1I2SXRlbSwgZGF0YTogU2hhZG93cnVuLlNoYWRvd3J1bkl0ZW1EYXRhRGF0YSwgaWQ6IHN0cmluZykge1xuICAgNDY4XHQgICAgICAgIGF3YWl0IE5ldHdvcmtEZXZpY2VGbG93LmhhbmRsZU9uRGVsZXRlSXRlbShpdGVtLCBkYXRhLCBpZCk7XG4gICA0NjlcdCAgICB9XG4gICA0NzBcdFxuVG90YWwgbGluZXMgaW4gZmlsZTogNTMzXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFTVU44Rm44dVl1WXJQRldOeG1WaUZKIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozMjoyNi44NzFaIiwicmVzcG9uc2VfdGV4dCI6Ik5vdyBsZXQgbWUgc2VhcmNoIGZvciBhbnkgb3RoZXIgY29kZSB0aGF0IG1pZ2h0IGJlIGFjY2Vzc2luZyB0b2tlbnMgd2l0aG91dCBwcm9wZXIgYWN0b3IgY2hlY2tzOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjdlYjJlYWUzLWE3ZjEtNDhhNi1iZmQzLThkOWZmZGVhYmJkOCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMTV5dWl1NmRVSzFqeTNuR1VINjNDTlUiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInZpZXdcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9ob29rcy50c1wiLCBcInZpZXdfcmFuZ2VcIjogWzQ1MCwgNDYwXX0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJOb3cgbGV0IG1lIGxvb2sgYXQgdGhlIHNwZWNpZmljIGxpbmUgaW4gaG9va3MudHMgdGhhdCBtaWdodCBiZSBjYXVzaW5nIHRoZSBpc3N1ZTpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlRoZSBmb2xsb3dpbmcgY29kZSBzZWN0aW9ucyB3ZXJlIHJldHJpZXZlZDpcblBhdGg6IHNyYy9tb2R1bGUvaGVscGVycy50c1xuLi4uXG4gICAzMDdcdFxuICAgMzA4XHQgICAgLy8gVE9ETzogRm91bmRyeSAwLjkgU2hvdWxkIFRva2VuRG9jdW1lbnQgYmUgdXNlZCBpbnN0ZWFkIG9mIFRva2VuP1xuICAgMzA5XHQgICAgLy8gVE9ETzogQ2hlY2sgY2FudmFzLnNjZW5lLnRva2Vuc1xuICAgMzEwXHQgICAgc3RhdGljIGdldFRva2VuKGlkPzogc3RyaW5nKTogVG9rZW4gfCB1bmRlZmluZWQge1xuICAgMzExXHQgICAgICAgIGlmICghY2FudmFzIHx8ICFjYW52YXMucmVhZHkgfHwgIWNhbnZhcy50b2tlbnMpIHJldHVybjtcbiAgIDMxMlx0XG4gICAzMTNcdCAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiBjYW52YXMudG9rZW5zLnBsYWNlYWJsZXMpIHtcbiAgIDMxNFx0ICAgICAgICAgICAgaWYgKHRva2VuLmlkID09PSBpZCkge1xuICAgMzE1XHQgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgMzE2XHQgICAgICAgICAgICB9XG4gICAzMTdcdCAgICAgICAgfVxuICAgMzE4XHQgICAgfVxuICAgMzE5XHRcbiAgIDMyMFx0ICAgIC8qKlxuICAgMzIxXHQgICAgICogVXNlIHRoaXMgaGVscGVyIHRvIGdldCBhIHRva2VucyBhY3RvciBmcm9tIGFueSBnaXZlbiBzY2VuZSBpZC5cbiAgIDMyMlx0ICAgICAqIEBwYXJhbSBzY2VuZVRva2VuSWQgQSBtaXhlZCBpZCB3aXRoIHRoZSBmb3JtYXQgJzxzY2VuZUlkPi48dG9rZW5pZD5cbiAgIDMyM1x0ICAgICAqL1xuICAgMzI0XHQgICAgc3RhdGljIGdldFNjZW5lVG9rZW5BY3RvcihzY2VuZVRva2VuSWQ6IHN0cmluZyk6IFNSNkFjdG9yIHwgbnVsbCB7XG4gICAzMjVcdCAgICAgICAgY29uc3QgW3NjZW5lSWQsIHRva2VuSWRdID0gSGVscGVycy5kZWNvbnN0cnVjdFNjZW5lVG9rZW5JZChzY2VuZVRva2VuSWQpO1xuICAgMzI2XHQgICAgICAgIGNvbnN0IHRva2VuID0gSGVscGVycy5nZXRTY2VuZVRva2VuRG9jdW1lbnQoc2NlbmVJZCwgdG9rZW5JZCk7XG4gICAzMjdcdCAgICAgICAgaWYgKCF0b2tlbikgcmV0dXJuIG51bGw7XG4gICAzMjhcdCAgICAgICAgcmV0dXJuIHRva2VuLmdldEFjdG9yKCk7XG4gICAzMjlcdCAgICB9XG4gICAzMzBcdFxuICAgMzMxXHQgICAgc3RhdGljIGRlY29uc3RydWN0U2NlbmVUb2tlbklkKHNjZW5lVG9rZW5JZDogc3RyaW5nKTogW3NjZW5lSWQ6IHN0cmluZywgdG9rZW5JZDogc3RyaW5nXSB7XG4gICAzMzJcdCAgICAgICAgcmV0dXJuIHNjZW5lVG9rZW5JZC5zcGxpdCgnLicpIGFzIFtzY2VuZUlkOiBzdHJpbmcsIHRva2VuSWQ6IHN0cmluZ107XG4gICAzMzNcdCAgICB9XG4gICAzMzRcdFxuICAgMzM1XHQgICAgc3RhdGljIGdldFNjZW5lVG9rZW5Eb2N1bWVudChzY2VuZUlkLCB0b2tlbklkKTogVG9rZW5Eb2N1bWVudCB8IHVuZGVmaW5lZCB7XG4gICAzMzZcdCAgICAgICAgY29uc3Qgc2NlbmUgPSBnYW1lLnNjZW5lcz8uZ2V0KHNjZW5lSWQpO1xuICAgMzM3XHQgICAgICAgIGlmICghc2NlbmUpIHJldHVybjtcbiAgIDMzOFx0ICAgICAgICBjb25zdCB0b2tlbiA9IHNjZW5lLnRva2Vucy5nZXQodG9rZW5JZCk7XG4gICAzMzlcdCAgICAgICAgaWYgKCF0b2tlbikgcmV0dXJuO1xuICAgMzQwXHRcbiAgIDM0MVx0ICAgICAgICByZXR1cm4gdG9rZW47XG4gICAzNDJcdCAgICB9XG4gICAzNDNcdFxuICAgMzQ0XHQgICAgc3RhdGljIGdldFVzZXJUYXJnZXRzKHVzZXI/OiBVc2VyIHwgbnVsbCk6IFRva2VuW10ge1xuICAgMzQ1XHQgICAgICAgIHVzZXIgPSB1c2VyID8gdXNlciA6IGdhbWUudXNlcjtcbiAgIDM0Nlx0XG4gICAzNDdcdCAgICAgICAgaWYgKCF1c2VyKSByZXR1cm4gW11cbiAgIDM0OFx0XG4gICAzNDlcdCAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odXNlci50YXJnZXRzKTtcbiAgIDM1MFx0ICAgIH1cbiAgIDM1MVx0XG4gICAzNTJcdCAgICBzdGF0aWMgdXNlckhhc1RhcmdldHModXNlcj86IFVzZXIgfCBudWxsKTogYm9vbGVhbiB7XG4gICAzNTNcdCAgICAgICAgdXNlciA9IHVzZXIgPyB1c2VyIDogZ2FtZS51c2VyO1xuICAgMzU0XHRcbiAgIDM1NVx0ICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBmYWxzZTtcbiAgIDM1Nlx0XG4gICAzNTdcdCAgICAgICAgcmV0dXJuIHVzZXIudGFyZ2V0cy5zaXplID4gMDtcbiAgIDM1OFx0ICAgIH1cbi4uLlxuICAgNjYxXHRcbiAgIDY2Mlx0ICAgICAgICAvLyBJZiB3ZSBkaWQgbm90IGZpbmQgYW55dGhpbmcgb24gdGhlIGFjdG9yLCBzZWFyY2ggdGhlIGFjdGl2ZSB0b2tlbnMgKHRoZSBpdGVtIG1pZ2h0IG9ubHkgZXhpc3Qgb24gYSBub24gbGlua2VkIHRva2VuKVxuICAgNjYzXHQgICAgICAgIC8vIFRoaXMgd2lsbCBub3Qgd29yayBpZiB3ZSBhcmUgb24gYSBkaWZmZXJlbnQgc2NlbmUgb3IgdGhlIHRva2VuIGdvdCBkZWxldGVkLCB3aGljaCBpcyBleHBlY3RlZCB3aGVuIHlvdSBwdXQgYW5cbiAgIDY2NFx0ICAgICAgICAvLyBpdGVtIG9uIGEgdG9rZW4gd2l0aG91dCBsaW5raW5nIGl0LlxuICAgNjY1XHQgICAgICAgIGNvbnN0IHRva2VucyA9IGFjdG9yU291cmNlLmdldEFjdGl2ZVRva2VucygpO1xuICAgNjY2XHQgICAgICAgIGxldCB0b2tlbkl0ZW06IFNSNkl0ZW0gfCB1bmRlZmluZWQ7XG4gICA2NjdcdCAgICAgICAgdG9rZW5zLmZvckVhY2godG9rZW4gPT4ge1xuICAgNjY4XHQgICAgICAgICAgICBpZiAoIXRva2VuLmFjdG9yKSByZXR1cm47XG4gICA2NjlcdFxuICAgNjcwXHQgICAgICAgICAgICBjb25zdCBmb3VuZEl0ZW0gPSB0b2tlbi5hY3Rvci5pdGVtcy5nZXQoaXRlbUlkKTtcbiAgIDY3MVx0ICAgICAgICAgICAgaWYgKGZvdW5kSXRlbSkge1xuICAgNjcyXHQgICAgICAgICAgICAgICAgdG9rZW5JdGVtID0gZm91bmRJdGVtIGFzIHVua25vd24gYXMgU1I2SXRlbTtcbiAgIDY3M1x0ICAgICAgICAgICAgfVxuICAgNjc0XHQgICAgICAgIH0pO1xuICAgNjc1XHRcbiAgIDY3Nlx0ICAgICAgICByZXR1cm4gdG9rZW5JdGVtO1xuICAgNjc3XHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzXG4uLi5cbiAgICAzNFx0XG4gICAgMzVcdFxuICAgIDM2XHQvKipcbiAgICAzN1x0ICogVGhlIGdlbmVyYWwgU2hhZG93cnVuIGFjdG9yIGltcGxlbWVudGF0aW9uLCB3aGljaCBjdXJyZW50bHkgaGFuZGxlcyBhbGwgYWN0b3IgdHlwZXMuXG4gICAgMzhcdCAqXG4gICAgMzlcdCAqIFRvIGVhc2lseSBhY2Nlc3MgQWN0b3JEYXRhIHdpdGhvdXQgYW55IHR5cGluZyBpc3N1ZXMgdXMgdGhlIFNSNkFjdG9yLmFzQ3JpdHRlciBoZWxwZXJzLlxuICAgIDQwXHQgKiBUaGV5IGFyZSBzZXQgdXAgaW4gYSB3YXkgdGhhdCB3aWxsIGhhbmRsZSBib3RoIGVycm9yIG1hbmFnZW1lbnQgYW5kIHR5cGUgbmFycm93aW5nLlxuICAgIDQxXHQgKiBFeGFtcGxlOlxuICAgIDQyXHQgKiA8cHJlPjxjb2RlPlxuICAgIDQzXHQgKiAgICAgY29uc3QgYWN0b3IgPSBnYW1lLmFjdG9ycy5nZXQoJ3JhbmRvbUlkJyk7XG4gICAgNDRcdCAqICAgICBjb25zdCBjcml0dGVyID0gYWN0b3IuYXNDcml0dGVyKCk7XG4gICAgNDVcdCAqICAgICBpZiAoIWNyaXR0ZXIpIHJldHVybjtcbiAgICA0Nlx0ICogICAgIC8vIGNyaXR0ZXIudHlwZSA9PT0gJ2NyaXR0ZXInXG4gICAgNDdcdCAqICAgICAvLyBjcml0dGVyLnN5c3RlbSBhcyBDcml0dGVyRGF0YVxuICAgIDQ4XHQgKiA8L2NvZGU+PC9wcmU+XG4gICAgNDlcdCAqXG4gICAgNTBcdCAqL1xuICAgIDUxXHRleHBvcnQgY2xhc3MgU1I2QWN0b3IgZXh0ZW5kcyBBY3RvciB7XG4gICAgNTJcdCAgICAvKipcbiAgICA1M1x0ICAgICAqIENhY2hlIGZvciBhcm1vciBjYWxjdWxhdGlvbnMgdG8gYXZvaWQgcmVjYWxjdWxhdGluZyB1bm5lY2Vzc2FyaWx5XG4gICAgNTRcdCAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgIDU1XHQgICAgICogQHByaXZhdGVcbiAgICA1Nlx0ICAgICAqL1xuICAgIDU3XHQgICAgcHJpdmF0ZSBfYXJtb3JDYWNoZToge1xuICAgIDU4XHQgICAgICAgIGFybW9yPzogU2hhZG93cnVuLkFjdG9yQXJtb3IsXG4gICAgNTlcdCAgICAgICAgdGltZXN0YW1wOiBudW1iZXIsXG4gICAgNjBcdCAgICAgICAgZXF1aXBtZW50SGFzaDogc3RyaW5nXG4gICAgNjFcdCAgICB9ID0ge1xuICAgIDYyXHQgICAgICAgIHRpbWVzdGFtcDogMCxcbi4uLlxuICAxNDUwXHRcbiAgMTQ1MVx0ICAgIC8qKiBSZXR1cm4gZWl0aGVyIHRoZSBsaW5rZWQgdG9rZW4gb3IgdGhlIHRva2VuIG9mIHRoZSBzeW50aGV0aWMgYWN0b3IuXG4gIDE0NTJcdCAgICAgKlxuICAxNDUzXHQgICAgICogQHJldHVybiBXaWxsIHJldHVybiBudWxsIHNob3VsZCBubyB0b2tlbiBoYXZlIGJlZW4gcGxhY2VkIG9uIHNjZW5lLlxuICAxNDU0XHQgICAgICovXG4gIDE0NTVcdCAgICBnZXRUb2tlbigpOiBUb2tlbkRvY3VtZW50IHwgbnVsbCB7XG4gIDE0NTZcdCAgICAgICAgLy8gTGlua2VkIGFjdG9ycyBjYW4gb25seSBoYXZlIG9uZSB0b2tlbiwgd2hpY2ggaXNuJ3Qgc3RvcmVkIHdpdGhpbiBhY3RvciBkYXRhLi4uXG4gIDE0NTdcdCAgICAgICAgaWYgKHRoaXMuX2lzTGlua2VkVG9Ub2tlbigpICYmIHRoaXMuaGFzVG9rZW4oKSkge1xuICAxNDU4XHQgICAgICAgICAgICBjb25zdCBsaW5rZWQgPSB0cnVlO1xuICAxNDU5XHQgICAgICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmdldEFjdGl2ZVRva2VucyhsaW5rZWQpIGFzIHVua25vd24gYXMgVG9rZW5bXTtcbiAgMTQ2MFx0ICAgICAgICAgICAgLy8gVGhpcyBhc3N1bWVzIGZvciBhIHRva2VuIHRvIGV4aXN0IGFuZCBzaG91bGQgZmFpbCBpZiBub3QuXG4gIDE0NjFcdCAgICAgICAgICAgIHJldHVybiB0b2tlbnNbMF0uZG9jdW1lbnQ7XG4gIDE0NjJcdCAgICAgICAgfVxuICAxNDYzXHRcbiAgMTQ2NFx0ICAgICAgICAvLyBVbmxpbmtlZCBhY3RvcnMgY2FuIGhhdmUgbXVsdGlwbGUgYWN0aXZlIHRva2VuIGJ1dCBlYWNoIGhhdmUgdGhlaXJzIGRpcmVjdGx5IGF0dGFjaGVkLi4uXG4gIDE0NjVcdCAgICAgICAgcmV0dXJuIHRoaXMudG9rZW47XG4gIDE0NjZcdCAgICB9XG4gIDE0NjdcdFxuICAxNDY4XHQgICAgLyoqXG4gIDE0NjlcdCAgICAgKiBUaGVyZSBpcyBubyBuZWVkIGZvciBhIHRva2VuIHRvIHBsYWNlZC4gVGhlIHByb3RvdHlwZSB0b2tlbiBpcyBlbm91Z2guXG4gIDE0NzBcdCAgICAgKi9cbiAgMTQ3MVx0ICAgIF9pc0xpbmtlZFRvVG9rZW4oKTogYm9vbGVhbiB7XG4gIDE0NzJcdCAgICAgICAgLy9AdHMtZXhwZWN0LWVycm9yIC8vIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAxNDczXHQgICAgICAgIC8vIElmIGFuIGFjdG9yIGlzIGxpbmtlZCwgYWxsIGl0J3MgY29waWVzIGFsc28gY29udGFpbiB0aGlzIGxpbmtlZCBzdGF0dXMsIGV2ZW4gaWYgdGhleSdyZSBub3QuXG4gIDE0NzRcdCAgICAgICAgcmV0dXJuIHRoaXMucHJvdG90eXBlVG9rZW4uYWN0b3JMaW5rICYmICF0aGlzLnRva2VuO1xuICAxNDc1XHQgICAgfVxuICAxNDc2XHRcbiAgMTQ3N1x0ICAgIGhhc1Rva2VuKCk6IGJvb2xlYW4ge1xuICAxNDc4XHQgICAgICAgIHJldHVybiB0aGlzLmdldEFjdGl2ZVRva2VucygpLmxlbmd0aCA+IDA7XG4gIDE0NzlcdCAgICB9XG4gIDE0ODBcdFxuICAxNDgxXHQgICAgaGFzQWN0aXZlUGxheWVyT3duZXIoKTogYm9vbGVhbiB7XG4gIDE0ODJcdCAgICAgICAgY29uc3QgcGxheWVycyA9IHRoaXMuZ2V0QWN0aXZlUGxheWVyT3duZXJzKCk7XG4gIDE0ODNcdCAgICAgICAgcmV0dXJuIHBsYXllcnMubGVuZ3RoID4gMDtcbiAgMTQ4NFx0ICAgIH1cbiAgMTQ4NVx0XG4gIDE0ODZcdCAgICBnZXRBY3RpdmVQbGF5ZXIoKTogVXNlciB8IG51bGwge1xuICAxNDg3XHQgICAgICAgIGlmICghZ2FtZS51c2VycykgcmV0dXJuIG51bGw7XG4gIDE0ODhcdCAgICAgICAgaWYgKCF0aGlzLmhhc1BsYXllck93bmVyKSByZXR1cm4gbnVsbDtcbiAgMTQ4OVx0XG4gIDE0OTBcdCAgICAgICAgZm9yIChjb25zdCB1c2VyIG9mIGdhbWUudXNlcnMuY29udGVudHMpIHtcbiAgMTQ5MVx0ICAgICAgICAgICAgaWYgKCF1c2VyLmFjdGl2ZSB8fCB1c2VyLmlzR00pIHtcbiAgMTQ5Mlx0ICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAxNDkzXHQgICAgICAgICAgICB9XG4gIDE0OTRcdCAgICAgICAgICAgIGlmICh0aGlzLmlkID09PSB1c2VyLmNoYXJhY3Rlcj8uaWQpIHtcbiAgMTQ5NVx0ICAgICAgICAgICAgICAgIHJldHVybiB1c2VyO1xuICAxNDk2XHQgICAgICAgICAgICB9XG4gIDE0OTdcdCAgICAgICAgfVxuICAxNDk4XHRcbiAgMTQ5OVx0ICAgICAgICByZXR1cm4gbnVsbDtcbiAgMTUwMFx0ICAgIH1cbi4uLlxuICAyNTAwXHRcbiAgMjUwMVx0ICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBhY3Rpb25zIG9iamVjdCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gIDI1MDJcdCAgICAgICAgaWYgKCF0aGlzLnN5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMpIHtcbiAgMjUwM1x0ICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEFjdG9yICR7dGhpcy5uYW1lfSBoYXMgbm8gYWN0aW9ucyBkYXRhLCBpbml0aWFsaXppbmdgKTtcbiAgMjUwNFx0ICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGUoe1xuICAyNTA1XHQgICAgICAgICAgICAgICAgJ3N5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMnOiB7fVxuICAyNTA2XHQgICAgICAgICAgICB9KTtcbiAgMjUwN1x0ICAgICAgICAgICAgLy8gUmVzZXQgYWN0aW9ucyB0byBlbnN1cmUgdGhleSdyZSBwcm9wZXJseSBpbml0aWFsaXplZFxuICAyNTA4XHQgICAgICAgICAgICBhd2FpdCB0aGlzLnJlc2V0QWN0aW9ucygpO1xuICAyNTA5XHQgICAgICAgICAgICByZXR1cm47XG4gIDI1MTBcdCAgICAgICAgfVxuICAyNTExXHRcbiAgMjUxMlx0ICAgICAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5zeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zO1xuICAyNTEzXHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBDdXJyZW50IGFjdGlvbnMgZm9yICR7dGhpcy5uYW1lfTpgLCBhY3Rpb25zKTtcbiAgMjUxNFx0XG4gIDI1MTVcdCAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGFjdG9yIGhhcyBhdCBsZWFzdCA0IG1pbm9yIGFjdGlvbnNcbiAgMjUxNlx0ICAgICAgICBpZiAoYWN0aW9ucy5taW5vciA8IDQpIHtcbiAgMjUxN1x0ICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucz8ud2FybihnYW1lLmkxOG4uZm9ybWF0KCdTUjYuTm90RW5vdWdoTWlub3JBY3Rpb25zJywge1xuICAyNTE4XHQgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuICAyNTE5XHQgICAgICAgICAgICAgICAgY291bnQ6IGFjdGlvbnMubWlub3JcbiAgMjUyMFx0ICAgICAgICAgICAgfSkpO1xuICAyNTIxXHQgICAgICAgICAgICByZXR1cm47XG4gIDI1MjJcdCAgICAgICAgfVxuICAyNTIzXHRcbiAgMjUyNFx0ICAgICAgICAvLyBHZXQgdGhlIGFjdG9yIGZyb20gdGhlIGdhbWUuYWN0b3JzIGNvbGxlY3Rpb24gdG8gZW5zdXJlIHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgbGF0ZXN0IGRhdGFcbiAgMjUyNVx0ICAgICAgICBjb25zdCBjaGVja0FjdG9yID0gZ2FtZS5hY3RvcnMuZ2V0KHRoaXMuaWQpO1xuICAyNTI2XHQgICAgICAgIGlmIChjaGVja0FjdG9yICYmIGNoZWNrQWN0b3Iuc3lzdGVtLmluaXRpYXRpdmUgJiYgY2hlY2tBY3Rvci5zeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zKSB7XG4gIDI1MjdcdCAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBhY3RvciBoYXMgYXQgbGVhc3QgNCBtaW5vciBhY3Rpb25zIGluIHRoZSBkYXRhYmFzZVxuICAyNTI4XHQgICAgICAgICAgICBjb25zdCBkYk1pbm9yQWN0aW9ucyA9IGNoZWNrQWN0b3Iuc3lzdGVtLmluaXRpYXRpdmUuYWN0aW9ucy5taW5vcjtcbiAgMjUyOVx0ICAgICAgICAgICAgaWYgKGRiTWlub3JBY3Rpb25zIDwgNCkge1xuICAyNTMwXHQgICAgICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucz8ud2FybihnYW1lLmkxOG4uZm9ybWF0KCdTUjYuTm90RW5vdWdoTWlub3JBY3Rpb25zJywge1xuICAyNTMxXHQgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgMjUzMlx0ICAgICAgICAgICAgICAgICAgICBjb3VudDogZGJNaW5vckFjdGlvbnNcbiAgMjUzM1x0ICAgICAgICAgICAgICAgIH0pKTtcbiAgMjUzNFx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgMjUzNVx0ICAgICAgICAgICAgfVxuICAyNTM2XHQgICAgICAgIH1cbi4uLlxuICAyNzA0XHRcbiAgMjcwNVx0ICAgIC8qKlxuICAyNzA2XHQgICAgICogRmluZCBhbmQgcmVmcmVzaCBhbGwgdG9rZW4gc2hlZXRzIGZvciB0aGlzIGFjdG9yXG4gIDI3MDdcdCAgICAgKiBUaGlzIGlzIG5lZWRlZCBiZWNhdXNlIHRva2VuIHNoZWV0cyBhcmUgbm90IGF1dG9tYXRpY2FsbHkgcmVmcmVzaGVkIHdoZW4gdGhlIGFjdG9yIGlzIHVwZGF0ZWRcbiAgMjcwOFx0ICAgICAqL1xuICAyNzA5XHQgICAgcmVmcmVzaFRva2VuU2hlZXRzKCkge1xuICAyNzEwXHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBSZWZyZXNoaW5nIHRva2VuIHNoZWV0cyBmb3IgJHt0aGlzLm5hbWV9YCk7XG4gIDI3MTFcdFxuICAyNzEyXHQgICAgICAgIC8vIEdldCBhbGwgdG9rZW5zIGZvciB0aGlzIGFjdG9yXG4gIDI3MTNcdCAgICAgICAgY29uc3QgdG9rZW5zID0gdGhpcy5nZXRBY3RpdmVUb2tlbnMoKTtcbiAgMjcxNFx0ICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgRm91bmQgJHt0b2tlbnMubGVuZ3RofSB0b2tlbnMgZm9yICR7dGhpcy5uYW1lfWApO1xuICAyNzE1XHRcbiAgMjcxNlx0ICAgICAgICAvLyBSZWZyZXNoIGVhY2ggdG9rZW5cbiAgMjcxN1x0ICAgICAgICBmb3IgKGNvbnN0IHRva2VuIG9mIHRva2Vucykge1xuICAyNzE4XHQgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSB0b2tlblxuICAyNzE5XHQgICAgICAgICAgICBpZiAodG9rZW4ucmVmcmVzaCkgdG9rZW4ucmVmcmVzaCgpO1xuICAyNzIwXHRcbiAgMjcyMVx0ICAgICAgICAgICAgLy8gUmVmcmVzaCB0aGUgdG9rZW4ncyBzaGVldCBpZiBpdCdzIG9wZW5cbiAgMjcyMlx0ICAgICAgICAgICAgaWYgKHRva2VuLnNoZWV0ICYmIHRva2VuLnNoZWV0LnJlbmRlcmVkKSB7XG4gIDI3MjNcdCAgICAgICAgICAgICAgICB0b2tlbi5zaGVldC5yZW5kZXIodHJ1ZSk7XG4gIDI3MjRcdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgUmVmcmVzaGVkIHRva2VuIHNoZWV0IGZvciAke3Rva2VuLm5hbWV9YCk7XG4gIDI3MjVcdCAgICAgICAgICAgIH1cbiAgMjcyNlx0ICAgICAgICB9XG4uLi5cbiAgMjgxN1x0XG4gIDI4MThcdCAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYWN0aW9ucyBvYmplY3QgaWYgaXQgZG9lc24ndCBleGlzdFxuICAyODE5XHQgICAgICAgIGlmICghdGhpcy5zeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zKSB7XG4gIDI4MjBcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBBY3RvciAke3RoaXMubmFtZX0gaGFzIG5vIGFjdGlvbnMgZGF0YSwgaW5pdGlhbGl6aW5nYCk7XG4gIDI4MjFcdCAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlKHtcbiAgMjgyMlx0ICAgICAgICAgICAgICAgICdzeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zJzoge31cbiAgMjgyM1x0ICAgICAgICAgICAgfSk7XG4gIDI4MjRcdCAgICAgICAgICAgIC8vIFJlc2V0IGFjdGlvbnMgdG8gZW5zdXJlIHRoZXkncmUgcHJvcGVybHkgaW5pdGlhbGl6ZWRcbiAgMjgyNVx0ICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXNldEFjdGlvbnMoKTtcbiAgMjgyNlx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAyODI3XHQgICAgICAgIH1cbiAgMjgyOFx0XG4gIDI4MjlcdCAgICAgICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuc3lzdGVtLmluaXRpYXRpdmUuYWN0aW9ucztcbiAgMjgzMFx0ICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgQ3VycmVudCBhY3Rpb25zIGZvciAke3RoaXMubmFtZX06YCwgYWN0aW9ucyk7XG4gIDI4MzFcdFxuICAyODMyXHQgICAgICAgIC8vIENoZWNrIGlmIHRoZSBhY3RvciBoYXMgYXQgbGVhc3QgMSBtYWpvciBhY3Rpb25cbiAgMjgzM1x0ICAgICAgICBpZiAoYWN0aW9ucy5tYWpvciA8IDEpIHtcbiAgMjgzNFx0ICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucz8ud2FybihnYW1lLmkxOG4uZm9ybWF0KCdTUjYuTm9NYWpvckFjdGlvbnNMZWZ0Jywge1xuICAyODM1XHQgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lXG4gIDI4MzZcdCAgICAgICAgICAgIH0pKTtcbiAgMjgzN1x0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAyODM4XHQgICAgICAgIH1cbi4uLlxuICAyOTAwXHRcbiAgMjkwMVx0ICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBhY3Rpb25zIG9iamVjdCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gIDI5MDJcdCAgICAgICAgaWYgKCF0aGlzLnN5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMpIHtcbiAgMjkwM1x0ICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEFjdG9yICR7dGhpcy5uYW1lfSBoYXMgbm8gYWN0aW9ucyBkYXRhLCBpbml0aWFsaXppbmdgKTtcbiAgMjkwNFx0ICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGUoe1xuICAyOTA1XHQgICAgICAgICAgICAgICAgJ3N5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMnOiB7fVxuICAyOTA2XHQgICAgICAgICAgICB9KTtcbiAgMjkwN1x0ICAgICAgICAgICAgLy8gUmVzZXQgYWN0aW9ucyB0byBlbnN1cmUgdGhleSdyZSBwcm9wZXJseSBpbml0aWFsaXplZFxuICAyOTA4XHQgICAgICAgICAgICBhd2FpdCB0aGlzLnJlc2V0QWN0aW9ucygpO1xuICAyOTA5XHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gIDI5MTBcdCAgICAgICAgfVxuICAyOTExXHRcbiAgMjkxMlx0ICAgICAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5zeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zO1xuICAyOTEzXHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBDdXJyZW50IGFjdGlvbnMgZm9yICR7dGhpcy5uYW1lfTpgLCBhY3Rpb25zKTtcbiAgMjkxNFx0XG4gIDI5MTVcdCAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGFjdG9yIGhhcyBhdCBsZWFzdCAxIG1pbm9yIGFjdGlvblxuICAyOTE2XHQgICAgICAgIGlmIChhY3Rpb25zLm1pbm9yIDwgMSkge1xuICAyOTE3XHQgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zPy53YXJuKGdhbWUuaTE4bi5mb3JtYXQoJ1NSNi5Ob01pbm9yQWN0aW9uc0xlZnQnLCB7XG4gIDI5MThcdCAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWVcbiAgMjkxOVx0ICAgICAgICAgICAgfSkpO1xuICAyOTIwXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gIDI5MjFcdCAgICAgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3Rva2VuL1NSNlRva2VuLnRzXG4gICAgIDFcdGltcG9ydCB7RkxBR1MsIFNZU1RFTV9OQU1FfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG4gICAgIDJcdGltcG9ydCBUcmFja1R5cGUgPSBTaGFkb3dydW4uVHJhY2tUeXBlO1xuICAgICAzXHRcbiAgICAgNFx0ZXhwb3J0IGNsYXNzIFNSNlRva2VuIGV4dGVuZHMgVG9rZW4ge1xuICAgICA1XHQgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBJZ25vcmUgZ2V0QmFyQXR0cmlidXRlIGZyb20gVG9rZW5cbiAgICAgNlx0ICAgIG92ZXJyaWRlIF9kcmF3QmFyKG51bWJlcjogbnVtYmVyLCBiYXI6IFBJWEkuR3JhcGhpY3MsIGRhdGE6IFJldHVyblR5cGU8VG9rZW5bJ2dldEJhckF0dHJpYnV0ZSddPil7XG4gICAgIDdcdCAgICAgICAgY29uc3QgdG9rZW5IZWFsdGhCYXJzID0gZ2FtZS5zZXR0aW5ncy5nZXQoU1lTVEVNX05BTUUsIEZMQUdTLlRva2VuSGVhbHRoQmFycyk7XG4gICAgIDhcdCAgICAgICAgLy8gRm91bmRyeVZUVCBkcmF3cyByZXNvdXJjZSBiYXJzIGFzIGZ1bGwvZ29vZCB3aGVuIHRoZSB2YWx1ZSBpcyB0aGVcbiAgICAgOVx0ICAgICAgICAvLyBzYW1lIGFzIHRoZSBtYXggYW5kIGVtcHR5L2JhZCBhdCAwIChjb2xvcmVkIGFsb25nIGEgZ3JhZGllbnQpLlxuICAgIDEwXHQgICAgICAgIC8vIFNoYWRvd3J1biBjb25kaXRpb24gdHJhY2tlcnMgY291bnQgdXAgZnJvbSAwIHRvIHRoZSBtYXhpbXVtLlxuICAgIDExXHQgICAgICAgIC8vIFdlIGZsaXAgdGhlIHZhbHVlcyBmcm9tIFNoYWRvd3J1biBmb3JtYXQgdG8gRm91bmRyeVZUVCBmb3JtYXQgaGVyZVxuICAgIDEyXHQgICAgICAgIC8vIGZvciBkcmF3aW5nLlxuICAgIDEzXHQgICAgICAgIGlmICh0b2tlbkhlYWx0aEJhcnMgJiYgZGF0YSAmJiBkYXRhLmF0dHJpYnV0ZS5zdGFydHNXaXRoKCd0cmFjaycpKSB7XG4gICAgMTRcdCAgICAgICAgICAgIGNvbnN0IHRyYWNrID0gZGF0YSBhcyB1bmtub3duIGFzIFRyYWNrVHlwZTtcbiAgICAxNVx0ICAgICAgICAgICAgdHJhY2sudmFsdWUgPSB0cmFjay5tYXggLSB0cmFjay52YWx1ZTtcbiAgICAxNlx0ICAgICAgICB9XG4gICAgMTdcdCAgICAgICAgc3VwZXIuX2RyYXdCYXIobnVtYmVyLCBiYXIsIGRhdGEpO1xuICAgIDE4XHQgICAgfVxuICAgIDE5XHR9XG4uLi5cblBhdGg6IG1hY3Jvcy9lZGdlLWFkZC1vbmUtZGllLmpzXG4gICAgIDFcdGNvbnN0IEVER0VfQ09TVCA9IDE7XG4gICAgIDJcdFxuICAgICAzXHQvLyBHZXQgdGhlIHNlbGVjdGVkIHRva2VuJ3MgYWN0b3JcbiAgICAgNFx0Y29uc3QgYWN0b3IgPSB0b2tlbj8uYWN0b3IgfHwgY2hhcmFjdGVyO1xuICAgICA1XHRpZiAoIWFjdG9yKSB7XG4gICAgIDZcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiUGxlYXNlIHNlbGVjdCBhIHRva2VuIG9yIGFzc2lnbiBhIGNoYXJhY3RlclwiKTtcbiAgICAgN1x0ICAgIHJldHVybjtcbiAgICAgOFx0fVxuICAgICA5XHRcbiAgICAxMFx0Ly8gR2V0IGVkZ2UgZGF0YVxuICAgIDExXHRjb25zdCBlZGdlID0gYWN0b3IuZ2V0RWRnZSgpO1xuICAgIDEyXHRpZiAoIWVkZ2UpIHtcbiAgICAxM1x0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoXCJTZWxlY3RlZCBjaGFyYWN0ZXIgaGFzIG5vIEVkZ2UgYXR0cmlidXRlXCIpO1xuICAgIDE0XHQgICAgcmV0dXJuO1xuICAgIDE1XHR9XG4gICAgMTZcdFxuICAgIDE3XHQvLyBDaGVjayBpZiBhY3RvciBoYXMgZW5vdWdoIGVkZ2VcbiAgICAxOFx0aWYgKGVkZ2UudXNlcyA8IEVER0VfQ09TVCkge1xuICAgIDE5XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihgTm90IGVub3VnaCBFZGdlISBOZWVkICR7RURHRV9DT1NUfSBidXQgb25seSBoYXZlICR7ZWRnZS51c2VzfWApO1xuICAgIDIwXHQgICAgcmV0dXJuO1xuICAgIDIxXHR9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvaG9va3MudHNcbi4uLlxuICAgIDcwXHRpbXBvcnQgeyBTdWNjZXNzVGVzdEVmZmVjdHNGbG93IH0gZnJvbSAnLi9lZmZlY3QvZmxvd3MvU3VjY2Vzc1Rlc3RFZmZlY3RzRmxvdyc7XG4gICAgNzFcdGltcG9ydCB7IEpvdXJuYWxFbnJpY2hlcnMgfSBmcm9tICcuL2pvdXJuYWwvZW5yaWNoZXInO1xuICAgIDcyXHRpbXBvcnQgeyBEYXRhU3RvcmFnZSB9IGZyb20gJy4vZGF0YS9EYXRhU3RvcmFnZSc7XG4gICAgNzNcdFxuICAgIDc0XHRcbiAgICA3NVx0XG4gICAgNzZcdC8vIFJlZGVjbGFyZSBTUjVjb25maWcgYXMgYSBnbG9iYWwgYXMgZm91bmRyeS12dHQtdHlwZXMgQ09ORklHIHdpdGggU1I1IHByb3BlcnR5IGNhdXNlcyBpc3N1ZXMuXG4gICAgNzdcdGV4cG9ydCBjb25zdCBTUjZDT05GSUcgPSBTUjY7XG4gICAgNzhcdFxuICAgIDc5XHRleHBvcnQgY2xhc3MgSG9va3NNYW5hZ2VyIHtcbiAgICA4MFx0ICAgIHN0YXRpYyByZWdpc3Rlckhvb2tzKCkge1xuICAgIDgxXHQgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBSZWdpc3RlcmluZyBzeXN0ZW0gaG9va3MnKTtcbiAgICA4Mlx0ICAgICAgICAvLyBSZWdpc3RlciB5b3VyIGhpZ2hlc3QgbGV2ZWwgaG9vayBjYWxsYmFja3MgaGVyZSBmb3IgYSBxdWljayBvdmVydmlldyBvZiB3aGF0J3MgaG9va2VkIGludG8uXG4gICAgODNcdFxuICAgIDg0XHQgICAgICAgIEhvb2tzLm9uY2UoJ2luaXQnLCBIb29rc01hbmFnZXIuaW5pdCk7XG4gICAgODVcdCAgICAgICAgSG9va3Mub25jZSgnc2V0dXAnLCBBdXRvY29tcGxldGVJbmxpbmVIb29rc0Zsb3cuc2V0dXBIb29rKTtcbiAgICA4Nlx0XG4gICAgODdcdCAgICAgICAgSG9va3Mub24oJ2NhbnZhc0luaXQnLCBjYW52YXNJbml0KTtcbiAgICA4OFx0ICAgICAgICBIb29rcy5vbigncmVhZHknLCBIb29rc01hbmFnZXIucmVhZHkpO1xuICAgIDg5XHQgICAgICAgIEhvb2tzLm9uKCdob3RiYXJEcm9wJywgSG9va3NNYW5hZ2VyLmhvdGJhckRyb3ApO1xuICAgIDkwXHQgICAgICAgIEhvb2tzLm9uKCdyZW5kZXJTY2VuZUNvbnRyb2xzJywgSG9va3NNYW5hZ2VyLnJlbmRlclNjZW5lQ29udHJvbHMpO1xuICAgIDkxXHQgICAgICAgIEhvb2tzLm9uKCdnZXRTY2VuZUNvbnRyb2xCdXR0b25zJywgSG9va3NNYW5hZ2VyLmdldFNjZW5lQ29udHJvbEJ1dHRvbnMpO1xuICAgIDkyXHQgICAgICAgIEhvb2tzLm9uKCdnZXRDb21iYXRUcmFja2VyRW50cnlDb250ZXh0JywgU1I2Q29tYmF0LmFkZENvbWJhdFRyYWNrZXJDb250ZXh0T3B0aW9ucyk7XG4gICAgOTNcdCAgICAgICAgSG9va3Mub24oJ3JlbmRlckl0ZW1EaXJlY3RvcnknLCBIb29rc01hbmFnZXIucmVuZGVySXRlbURpcmVjdG9yeSk7XG4gICAgOTRcdCAgICAgICAgLy8gSG9va3Mub24oJ3JlbmRlclRva2VuSFVEJywgRW52TW9kaWZpZXJzQXBwbGljYXRpb24uYWRkVG9rZW5IVURGaWVsZHMpO1xuICAgIDk1XHQgICAgICAgIEhvb2tzLm9uKCdyZW5kZXJUb2tlbkhVRCcsIFNpdHVhdGlvbk1vZGlmaWVyc0FwcGxpY2F0aW9uLm9uUmVuZGVyVG9rZW5IVUQpO1xuICAgIDk2XHQgICAgICAgIEhvb2tzLm9uKCd1cGRhdGVJdGVtJywgSG9va3NNYW5hZ2VyLnVwZGF0ZUljQ29ubmVjdGVkVG9Ib3N0SXRlbSk7XG4gICAgOTdcdCAgICAgICAgSG9va3Mub24oJ2RlbGV0ZUl0ZW0nLCBIb29rc01hbmFnZXIucmVtb3ZlRGVsZXRlZEl0ZW1zRnJvbU5ldHdvcmtzKTtcbi4uLlxuICAgMTA3XHRcbiAgIDEwOFx0ICAgIHN0YXRpYyBpbml0KCkge1xuICAgMTA5XHQgICAgICAgIGNvbnNvbGUubG9nKGBMb2FkaW5nIFNoYWRvd3J1biA1ZSBTeXN0ZW1cbiAgIDExMFx0X19fX19fX19fX19fX19fX19fX1xuICAgMTExXHQgX19fX19fX19fX18gX19fX18gXG4gICAxMTJcdC8gIF9fX3wgX19fIFxcXFwgIF9fX3xcbiAgIDExM1x0XFxcXCBcXGAtLS58IHxfLyAvX19fIFxcXFwgXG4gICAxMTRcdCBcXGAtLS4gXFxcXCAgICAvICAgIFxcXFwgXFxcXFxuICAgMTE1XHQvXFxcXF9fLyAvIHxcXFxcIFxcXFwvXFxcXF9fLyAvXG4gICAxMTZcdFxcXFxfX19fL1xcXFxffCBcXFxcX1xcXFxfX19fLyBcbiAgIDExN1x0PT09PT09PT09PT09PT09PT09PVxuICAgMTE4XHRgKTtcbiAgIDExOVx0ICAgICAgICAvLyBDcmVhdGUgYSBzcjZlbHlzaXVtIG5hbWVzcGFjZSB3aXRoaW4gdGhlIGdhbWUgZ2xvYmFsXG4gICAxMjBcdCAgICAgICAgZ2FtZVsnc3I2ZWx5c2l1bSddID0ge1xuICAgMTIxXHQgICAgICAgICAgICAvKipcbiAgIDEyMlx0ICAgICAgICAgICAgICogU3lzdGVtIGxldmVsIERvY3VtZW50IGltcGxlbWVudGF0aW9ucy5cbiAgIDEyM1x0ICAgICAgICAgICAgICovXG4gICAxMjRcdCAgICAgICAgICAgIFNSNkFjdG9yOiBTUjZBY3RvcixcbiAgIDEyNVx0ICAgICAgICAgICAgU1I2SXRlbTogU1I2SXRlbSxcbiAgIDEyNlx0ICAgICAgICAgICAgU1I2QWN0aXZlRWZmZWN0OiBTUjZBY3RpdmVFZmZlY3QsXG4gICAxMjdcdCAgICAgICAgICAgIC8qKlxuICAgMTI4XHQgICAgICAgICAgICAgKiBNYWNybyBob29rcyB1c2VkIHdoZW4gc29tZXRoaW5nJ3MgZHJvcHBlZCBvbnRvIHRoZSBob3RiYXIuXG4gICAxMjlcdCAgICAgICAgICAgICAqL1xuICAgMTMwXHQgICAgICAgICAgICByb2xsSXRlbU1hY3JvLFxuICAgMTMxXHQgICAgICAgICAgICByb2xsU2tpbGxNYWNybyxcbiAgIDEzMlx0ICAgICAgICAgICAgLyoqXG4gICAxMzNcdCAgICAgICAgICAgICAqIFNob3VsZCB5b3Ugb25seSByZWFsbHkgbmVlZCBkaWNlIGhhbmRsaW5nLCB1c2UgdGhpcy4gSWYgeW91IG5lZWQgbW9yZSBjb21wbGV4IHRlc3RpbmcgYmVoYXZpb3VyLFxuICAgMTM0XHQgICAgICAgICAgICAgKiBjaGVjayB0aGUgVGVzdCBpbXBsZW1lbnRhdGlvbnMuXG4gICAxMzVcdCAgICAgICAgICAgICAqL1xuICAgMTM2XHQgICAgICAgICAgICBTUjZSb2xsOiBTUjZSb2xsLFxuLi4uXG4gICAzMzBcdFxuICAgMzMxXHQgICAgICAgIEhvb2tzTWFuYWdlci5jb25maWd1cmVWaXNpb24oKVxuICAgMzMyXHRcbiAgIDMzM1x0ICAgICAgICBIb29rc01hbmFnZXIuY29uZmlndXJlVGV4dEVucmljaGVycygpO1xuICAgMzM0XHRcbiAgIDMzNVx0ICAgICAgICAvLyBQcmVsb2FkIG1pZ2h0IHJlZHVjZSBsb2FkaW5nIHRpbWUgZHVyaW5nIHBsYXkuXG4gICAzMzZcdCAgICAgICAgSGFuZGxlYmFyTWFuYWdlci5sb2FkVGVtcGxhdGVzKCk7XG4gICAzMzdcdFxuICAgMzM4XHQgICAgICAgIC8vIFJlZ2lzdGVyIFRvdXJzXG4gICAzMzlcdCAgICAgICAgcmVnaXN0ZXJTUjZUb3VycygpO1xuICAgMzQwXHRcbiAgIDM0MVx0ICAgICAgICBEYXRhU3RvcmFnZS52YWxpZGF0ZSgpO1xuICAgMzQyXHQgICAgfVxuICAgMzQzXHRcbiAgIDM0NFx0ICAgIHN0YXRpYyBhc3luYyByZWFkeSgpIHtcbiAgIDM0NVx0ICAgICAgICBpZiAoZ2FtZS51c2VyPy5pc0dNKSB7XG4gICAzNDZcdCAgICAgICAgICAgIC8vIFByb2hpYml0IG1pZ3JhdGlvbiBvbiBlbXB0eSB3b3JsZHMuLi5cbiAgIDM0N1x0ICAgICAgICAgICAgaWYgKE1pZ3JhdG9yLmlzRW1wdHlXb3JsZCkge1xuICAgMzQ4XHQgICAgICAgICAgICAgICAgYXdhaXQgTWlncmF0b3IuSW5pdFdvcmxkRm9yTWlncmF0aW9uKCk7XG4gICAzNDlcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gICAzNTBcdCAgICAgICAgICAgIH1cbiAgIDM1MVx0XG4gICAzNTJcdCAgICAgICAgICAgIC8vIE9uIHBvcHVsYXRlZCB3b3JsZHMsIHRyeSBtaWdyYXRpbmdcbiAgIDM1M1x0ICAgICAgICAgICAgYXdhaXQgTWlncmF0b3IuQmVnaW5NaWdyYXRpb24oKTtcbiAgIDM1NFx0XG4gICAzNTVcdCAgICAgICAgICAgIGlmIChDaGFuZ2Vsb2dBcHBsaWNhdGlvbi5zaG93QXBwbGljYXRpb24pIHtcbiAgIDM1Nlx0ICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBDaGFuZ2Vsb2dBcHBsaWNhdGlvbigpLnJlbmRlcih0cnVlKTtcbiAgIDM1N1x0ICAgICAgICAgICAgfVxuICAgMzU4XHQgICAgICAgIH1cbi4uLlxuICAgNDcwXHRcbiAgIDQ3MVx0ICAgIC8qKlxuICAgNDcyXHQgICAgICogVGhpcyBtZXRob2QgaXMgdXNlZCBhcyBhIHNpbXBsZSBwbGFjZSB0byByZWdpc3RlciBzb2NrZXQgaG9vayBoYW5kbGVycyBmb3IgdGhlIHN5c3RlbS5cbiAgIDQ3M1x0ICAgICAqXG4gICA0NzRcdCAgICAgKiBZb3UgY2FuIHVzZSB0aGUgU29ja2V0TWVzc2FnZSBmb3Igc2VuZGluZyBtZXNzYWdlcyB1c2luZyBhIHNvY2tldCBldmVudCBtZXNzYWdlIGlkIGFuZCBnZW5lcmljIGRhdGEgb2JqZWN0LlxuICAgNDc1XHQgICAgICovXG4gICA0NzZcdCAgICBzdGF0aWMgcmVnaXN0ZXJTb2NrZXRMaXN0ZW5lcnMoKSB7XG4gICA0NzdcdCAgICAgICAgaWYgKCFnYW1lLnNvY2tldCB8fCAhZ2FtZS51c2VyKSByZXR1cm47XG4gICA0NzhcdCAgICAgICAgY29uc29sZS5sb2coJ1JlZ2lzdGVyaW5nIHNyNmVseXNpdW0gc3lzdGVtIHNvY2tldCBtZXNzYWdlcy4uLicpO1xuICAgNDc5XHQgICAgICAgIGNvbnN0IGhvb2tzOiBTaGFkb3dydW4uU29ja2V0TWVzc2FnZUhvb2tzID0ge1xuICAgNDgwXHQgICAgICAgICAgICBbRkxBR1MuYWRkTmV0d29ya0NvbnRyb2xsZXJdOiBbTmV0d29ya0RldmljZUZsb3cuX2hhbmRsZUFkZE5ldHdvcmtDb250cm9sbGVyU29ja2V0TWVzc2FnZV0sXG4gICA0ODFcdCAgICAgICAgICAgIFtGTEFHUy5Eb05leHRSb3VuZF06IFtTUjZDb21iYXQuX2hhbmRsZURvTmV4dFJvdW5kU29ja2V0TWVzc2FnZV0sXG4gICA0ODJcdCAgICAgICAgICAgIFtGTEFHUy5Eb0luaXRQYXNzXTogW1NSNkNvbWJhdC5faGFuZGxlRG9Jbml0UGFzc1NvY2tldE1lc3NhZ2VdLFxuICAgNDgzXHQgICAgICAgICAgICBbRkxBR1MuRG9OZXdBY3Rpb25QaGFzZV06IFtTUjZDb21iYXQuX2hhbmRsZURvTmV3QWN0aW9uUGhhc2VTb2NrZXRNZXNzYWdlXSxcbi4uLlxuUGF0aDogbWFjcm9zL2VkZ2UtcmVyb2xsLWZhaWxlZC5qc1xuICAgICAxXHRjb25zdCBFREdFX0NPU1QgPSA0O1xuICAgICAyXHRcbiAgICAgM1x0Ly8gR2V0IHRoZSBzZWxlY3RlZCB0b2tlbidzIGFjdG9yXG4gICAgIDRcdGNvbnN0IGFjdG9yID0gdG9rZW4/LmFjdG9yIHx8IGNoYXJhY3RlcjtcbiAgICAgNVx0aWYgKCFhY3Rvcikge1xuICAgICA2XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIlBsZWFzZSBzZWxlY3QgYSB0b2tlbiBvciBhc3NpZ24gYSBjaGFyYWN0ZXJcIik7XG4gICAgIDdcdCAgICByZXR1cm47XG4gICAgIDhcdH1cbiAgICAgOVx0XG4gICAgMTBcdC8vIEdldCBlZGdlIGRhdGFcbiAgICAxMVx0Y29uc3QgZWRnZSA9IGFjdG9yLmdldEVkZ2UoKTtcbiAgICAxMlx0aWYgKCFlZGdlKSB7XG4gICAgMTNcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiU2VsZWN0ZWQgY2hhcmFjdGVyIGhhcyBubyBFZGdlIGF0dHJpYnV0ZVwiKTtcbiAgICAxNFx0ICAgIHJldHVybjtcbiAgICAxNVx0fVxuLi4uXG5QYXRoOiBtYWNyb3MvZWRnZS1yZXJvbGwtc3I2LmpzXG4gICAgIDFcdC8vIEdldCB0aGUgc2VsZWN0ZWQgdG9rZW4ncyBhY3RvclxuICAgICAyXHRjb25zdCBhY3RvciA9IHRva2VuPy5hY3RvciB8fCBjaGFyYWN0ZXI7XG4gICAgIDNcdGlmICghYWN0b3IpIHtcbiAgICAgNFx0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoXCJQbGVhc2Ugc2VsZWN0IGEgdG9rZW4gb3IgYXNzaWduIGEgY2hhcmFjdGVyXCIpO1xuICAgICA1XHQgICAgcmV0dXJuO1xuICAgICA2XHR9XG4gICAgIDdcdFxuICAgICA4XHQvLyBHZXQgZWRnZSBkYXRhXG4gICAgIDlcdGNvbnN0IGVkZ2UgPSBhY3Rvci5nZXRFZGdlKCk7XG4gICAgMTBcdGlmICghZWRnZSkge1xuICAgIDExXHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIlNlbGVjdGVkIGNoYXJhY3RlciBoYXMgbm8gRWRnZSBhdHRyaWJ1dGVcIik7XG4gICAgMTJcdCAgICByZXR1cm47XG4gICAgMTNcdH1cbi4uLlxuUGF0aDogbWFjcm9zL2VkZ2UtYWRkLWF0dHJpYnV0ZS5qc1xuICAgICAxXHRjb25zdCBFREdFX0NPU1QgPSA0O1xuICAgICAyXHRcbiAgICAgM1x0Ly8gR2V0IHRoZSBzZWxlY3RlZCB0b2tlbidzIGFjdG9yXG4gICAgIDRcdGNvbnN0IGFjdG9yID0gdG9rZW4/LmFjdG9yIHx8IGNoYXJhY3RlcjtcbiAgICAgNVx0aWYgKCFhY3Rvcikge1xuICAgICA2XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIlBsZWFzZSBzZWxlY3QgYSB0b2tlbiBvciBhc3NpZ24gYSBjaGFyYWN0ZXJcIik7XG4gICAgIDdcdCAgICByZXR1cm47XG4gICAgIDhcdH1cbiAgICAgOVx0XG4gICAgMTBcdC8vIEdldCBlZGdlIGRhdGFcbiAgICAxMVx0Y29uc3QgZWRnZSA9IGFjdG9yLmdldEVkZ2UoKTtcbiAgICAxMlx0aWYgKCFlZGdlKSB7XG4gICAgMTNcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiU2VsZWN0ZWQgY2hhcmFjdGVyIGhhcyBubyBFZGdlIGF0dHJpYnV0ZVwiKTtcbiAgICAxNFx0ICAgIHJldHVybjtcbiAgICAxNVx0fVxuICAgIDE2XHRcbiAgICAxN1x0Ly8gQ2hlY2sgaWYgYWN0b3IgaGFzIGVub3VnaCBlZGdlXG4gICAgMThcdGlmIChlZGdlLnVzZXMgPCBFREdFX0NPU1QpIHtcbiAgICAxOVx0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoYE5vdCBlbm91Z2ggRWRnZSEgTmVlZCAke0VER0VfQ09TVH0gYnV0IG9ubHkgaGF2ZSAke2VkZ2UudXNlc31gKTtcbiAgICAyMFx0ICAgIHJldHVybjtcbiAgICAyMVx0fVxuICAgIDIyXHRcbiAgICAyM1x0Ly8gR2V0IGVkZ2UgYXR0cmlidXRlIHZhbHVlXG4gICAgMjRcdGNvbnN0IGVkZ2VBdHRyID0gYWN0b3Iuc3lzdGVtLmF0dHJpYnV0ZXMuZWRnZS52YWx1ZTtcbiAgICAyNVx0aWYgKCFlZGdlQXR0cikge1xuICAgIDI2XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIkNvdWxkIG5vdCBkZXRlcm1pbmUgRWRnZSBhdHRyaWJ1dGUgdmFsdWVcIik7XG4gICAgMjdcdCAgICByZXR1cm47XG4gICAgMjhcdH1cbi4uLlxuUGF0aDogbWFjcm9zL2VkZ2UtaGVhbC1waHlzaWNhbC5qc1xuICAgICAxXHRjb25zdCBFREdFX0NPU1QgPSA0O1xuICAgICAyXHRcbiAgICAgM1x0Ly8gR2V0IHRoZSBzZWxlY3RlZCB0b2tlbidzIGFjdG9yXG4gICAgIDRcdGNvbnN0IGFjdG9yID0gdG9rZW4/LmFjdG9yIHx8IGNoYXJhY3RlcjtcbiAgICAgNVx0aWYgKCFhY3Rvcikge1xuICAgICA2XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIlBsZWFzZSBzZWxlY3QgYSB0b2tlbiBvciBhc3NpZ24gYSBjaGFyYWN0ZXJcIik7XG4gICAgIDdcdCAgICByZXR1cm47XG4gICAgIDhcdH1cbiAgICAgOVx0XG4gICAgMTBcdC8vIEdldCBlZGdlIGRhdGFcbiAgICAxMVx0Y29uc3QgZWRnZSA9IGFjdG9yLmdldEVkZ2UoKTtcbiAgICAxMlx0aWYgKCFlZGdlKSB7XG4gICAgMTNcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiU2VsZWN0ZWQgY2hhcmFjdGVyIGhhcyBubyBFZGdlIGF0dHJpYnV0ZVwiKTtcbiAgICAxNFx0ICAgIHJldHVybjtcbiAgICAxNVx0fVxuICAgIDE2XHRcbiAgICAxN1x0Ly8gQ2hlY2sgaWYgYWN0b3IgaGFzIGVub3VnaCBlZGdlXG4gICAgMThcdGlmIChlZGdlLnVzZXMgPCBFREdFX0NPU1QpIHtcbiAgICAxOVx0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoYE5vdCBlbm91Z2ggRWRnZSEgTmVlZCAke0VER0VfQ09TVH0gYnV0IG9ubHkgaGF2ZSAke2VkZ2UudXNlc31gKTtcbiAgICAyMFx0ICAgIHJldHVybjtcbiAgICAyMVx0fVxuLi4uXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFQVFdlUmRtd3B1RlhDMUg1TG1tUDlVIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozMjo0OC42ODdaIiwicmVzcG9uc2VfdGV4dCI6Ik5vdyBsZXQgbWUgbG9vayBhdCB0aGUgc3BlY2lmaWMgbGluZSBpbiBob29rcy50cyB0aGF0IG1pZ2h0IGJlIGNhdXNpbmcgdGhlIGlzc3VlOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjBlNWExOWJlLWE4OTYtNGI1My1iMGY0LThkM2FiOGExOTQ0MiIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMUo1Q1Zvak01QUZwNDFwU1hGUzd2WXciLCJ0b29sX25hbWUiOiJjb2RlYmFzZS1yZXRyaWV2YWwiLCJpbnB1dF9qc29uIjoie1wiaW5mb3JtYXRpb25fcmVxdWVzdFwiOiBcIkNvZGUgdGhhdCBhY2Nlc3NlcyBjYW52YXMuc2NlbmUudG9rZW5zIGFuZCBpdGVyYXRlcyB0aHJvdWdoIHRoZW0sIHBhcnRpY3VsYXJseSBhbnkgY29kZSB0aGF0IG1pZ2h0IGFjY2VzcyB0b2tlbi5hY3RvciB3aXRob3V0IHByb3BlciBudWxsIGNoZWNrcy4gTG9vayBmb3IgZm9yRWFjaCwgbWFwLCBmaWx0ZXIgb3BlcmF0aW9ucyBvbiB0b2tlbnMuXCJ9IiwibWNwX3NlcnZlcl9uYW1lIjoiIiwibWNwX3Rvb2xfbmFtZSI6IiJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTGV0IG1lIGFsc28gY2hlY2sgaWYgdGhlcmUgYXJlIGFueSBvdGhlciBwbGFjZXMgd2hlcmUgdG9rZW5zIGFyZSBhY2Nlc3NlZCB3aXRob3V0IHByb3BlciBudWxsIGNoZWNrczpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IkhlcmUncyB0aGUgcmVzdWx0IG9mIHJ1bm5pbmcgYGNhdCAtbmAgb24gc3JjL21vZHVsZS9ob29rcy50czpcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIC8vIEFsbCBzaWRlYmFyIGFjdG9ycyBzaG91bGQgYWxzbyBpbmNsdWRlIHRva2VucyB3aXRoIGxpbmtlZCBhY3RvcnMuXG4gICA0NTFcdCAgICAgICAgICAgICAgICAuLi5nYW1lLmFjdG9ycy5maWx0ZXIoKGFjdG9yOiBTUjZBY3RvcikgPT4gYWN0b3IuaXNJQygpICYmIGFjdG9yLmhhc0hvc3QoKSkgYXMgU1I2QWN0b3JbXSxcbiAgIDQ1Mlx0ICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxuICAgNDUzXHQgICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgIDQ1NFx0ICAgICAgICAgICAgICAgIC4uLmNhbnZhcy5zY2VuZS50b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0b2tlbi5hY3RvckxpbmsgJiYgdG9rZW4uYWN0b3I/LmlzSUMoKSAmJiB0b2tlbi5hY3Rvcj8uaGFzSG9zdCgpKS5tYXAodCA9PiB0LmFjdG9yKVxuICAgNDU1XHQgICAgICAgICAgICBdO1xuICAgNDU2XHRcbiAgIDQ1N1x0ICAgICAgICAgICAgLy8gVXBkYXRlIGhvc3QgZGF0YSBvbiB0aGUgaWMgYWN0b3IuXG4gICA0NThcdCAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBpdGVtLmFzSG9zdDtcbiAgIDQ1OVx0ICAgICAgICAgICAgaWYgKCFob3N0KSByZXR1cm47XG4gICA0NjBcdCAgICAgICAgICAgIGZvciAoY29uc3QgaWMgb2YgY29ubmVjdGVkSUMpIHtcblRvdGFsIGxpbmVzIGluIGZpbGU6IDUzM1xuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxNXl1aXU2ZFVLMWp5M25HVUg2M0NOVSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSIsImZvbGRlclJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MTIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn19fV0sInRpbWVzdGFtcCI6IjIwMjUtMDUtMjlUMjM6MzI6NTEuNzY4WiIsInJlc3BvbnNlX3RleHQiOiJMZXQgbWUgYWxzbyBjaGVjayBpZiB0aGVyZSBhcmUgYW55IG90aGVyIHBsYWNlcyB3aGVyZSB0b2tlbnMgYXJlIGFjY2Vzc2VkIHdpdGhvdXQgcHJvcGVyIG51bGwgY2hlY2tzOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6ImI2NDUyY2IxLTEyOGEtNDgyMi1iNTRkLTMwYzUyOTRiYjJmZSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMURCS1JoU2FoMnZ3OWY5a3UxazRMWFkiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInN0cl9yZXBsYWNlXCIsIFwicGF0aFwiOiBcInNyYy9tb2R1bGUvaG9va3MudHNcIiwgXCJzdHJfcmVwbGFjZV9lbnRyaWVzXCI6IFt7XCJvbGRfc3RyXCI6IFwiICAgICAgICBpZiAoaXRlbS5pc0hvc3QpIHtcXG4gICAgICAgICAgICAvLyBDb2xsZWN0IGFjdG9ycyBmcm9tIHNpZGViYXIgYW5kIGFjdGl2ZSBzY2VuZSB0byB1cGRhdGUgLyByZXJlbmRlclxcbiAgICAgICAgICAgIGxldCBjb25uZWN0ZWRJQyA9IFtcXG4gICAgICAgICAgICAgICAgLy8gQWxsIHNpZGViYXIgYWN0b3JzIHNob3VsZCBhbHNvIGluY2x1ZGUgdG9rZW5zIHdpdGggbGlua2VkIGFjdG9ycy5cXG4gICAgICAgICAgICAgICAgLi4uZ2FtZS5hY3RvcnMuZmlsdGVyKChhY3RvcjogU1I2QWN0b3IpID0+IGFjdG9yLmlzSUMoKSAmJiBhY3Rvci5oYXNIb3N0KCkpIGFzIFNSNkFjdG9yW10sXFxuICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxcbiAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC8vIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxcbiAgICAgICAgICAgICAgICAuLi5jYW52YXMuc2NlbmUudG9rZW5zLmZpbHRlcih0b2tlbiA9PiAhdG9rZW4uYWN0b3JMaW5rICYmIHRva2VuLmFjdG9yPy5pc0lDKCkgJiYgdG9rZW4uYWN0b3I/Lmhhc0hvc3QoKSkubWFwKHQgPT4gdC5hY3RvcilcXG4gICAgICAgICAgICBdO1wiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogNDQ3LCBcIm9sZF9zdHJfZW5kX2xpbmVfbnVtYmVyXCI6IDQ1NSwgXCJuZXdfc3RyXCI6IFwiICAgICAgICBpZiAoaXRlbS5pc0hvc3QpIHtcXG4gICAgICAgICAgICAvLyBDb2xsZWN0IGFjdG9ycyBmcm9tIHNpZGViYXIgYW5kIGFjdGl2ZSBzY2VuZSB0byB1cGRhdGUgLyByZXJlbmRlclxcbiAgICAgICAgICAgIGxldCBjb25uZWN0ZWRJQyA9IFtcXG4gICAgICAgICAgICAgICAgLy8gQWxsIHNpZGViYXIgYWN0b3JzIHNob3VsZCBhbHNvIGluY2x1ZGUgdG9rZW5zIHdpdGggbGlua2VkIGFjdG9ycy5cXG4gICAgICAgICAgICAgICAgLi4uZ2FtZS5hY3RvcnMuZmlsdGVyKChhY3RvcjogU1I2QWN0b3IpID0+IGFjdG9yLmlzSUMoKSAmJiBhY3Rvci5oYXNIb3N0KCkpIGFzIFNSNkFjdG9yW10sXFxuICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxcbiAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC8vIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxcbiAgICAgICAgICAgICAgICAuLi5jYW52YXMuc2NlbmUudG9rZW5zLmZpbHRlcih0b2tlbiA9PiAhdG9rZW4uYWN0b3JMaW5rICYmIHRva2VuLmFjdG9yPy5pc0lDKCkgJiYgdG9rZW4uYWN0b3I/Lmhhc0hvc3QoKSkubWFwKHQgPT4gdC5hY3RvcikuZmlsdGVyKGFjdG9yID0+IGFjdG9yICE9PSBudWxsICYmIGFjdG9yICE9PSB1bmRlZmluZWQpXFxuICAgICAgICAgICAgXTtcIn1dfSIsIm1jcF9zZXJ2ZXJfbmFtZSI6IiIsIm1jcF90b29sX25hbWUiOiIifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6Ik5vdyBJIGhhdmUgYSBnb29kIHVuZGVyc3RhbmRpbmcgb2YgdGhlIGlzc3VlLiBMZXQgbWUgY3JlYXRlIGEgZGV0YWlsZWQgcGxhbiB0byBmaXggdGhlIHByb2JsZW0uXG5cbiMjIEFuYWx5c2lzXG5cbkJhc2VkIG9uIG15IGludmVzdGlnYXRpb24sIEkndmUgaWRlbnRpZmllZCBzZXZlcmFsIHBvdGVudGlhbCBpc3N1ZXMgdGhhdCBjb3VsZCBjYXVzZSBcImFjdG9ycyBub3QgZXhpc3RpbmdcIiBlcnJvcnMgd2hlbiBsb2FkaW5nIHRoZSBnYW1lOlxuXG4xLiAqKk1hdHJpeCBBY3Rpb25zIEluaXRpYWxpemF0aW9uKio6IEluIGBTUjZBY3Rvci50c2AgbGluZSAzMTktMzI2LCB0aGUgY29kZSBhdXRvbWF0aWNhbGx5IHRyaWVzIHRvIGFkZCBtYXRyaXggYWN0aW9ucyB0byBhY3RvcnMgZHVyaW5nIGRhdGEgcHJlcGFyYXRpb24sIGJ1dCB0aGlzIGhhcHBlbnMgd2l0aCBhIHNldFRpbWVvdXQgd2hpY2ggY291bGQgY2F1c2UgcmFjZSBjb25kaXRpb25zLlxuXG4yLiAqKlRva2VuIFByb2Nlc3NpbmcgaW4gSG9va3MqKjogSW4gYGhvb2tzLnRzYCBsaW5lIDQ1NCwgdGhlcmUncyBjb2RlIHRoYXQgZmlsdGVycyB0b2tlbnMgYW5kIGFjY2Vzc2VzIGB0b2tlbi5hY3RvcmAgd2l0aCBvcHRpb25hbCBjaGFpbmluZyAoYD8uYCksIGJ1dCB0aGVuIG1hcHMgdG8gYHQuYWN0b3JgIHdpdGhvdXQgbnVsbCBjaGVja2luZywgd2hpY2ggY291bGQgcmVzdWx0IGluIG51bGwvdW5kZWZpbmVkIGFjdG9ycyBpbiB0aGUgYXJyYXkuXG5cbjMuICoqTWlzc2luZyBOdWxsIENoZWNrcyoqOiBTZXZlcmFsIHBsYWNlcyBpbiB0aGUgY29kZSBhY2Nlc3MgYHRva2VuLmFjdG9yYCB3aXRob3V0IHByb3BlciBudWxsIGNoZWNrcywgcGFydGljdWxhcmx5IGluIGhlbHBlciBmdW5jdGlvbnMgYW5kIHRhcmdldGluZyBjb2RlLlxuXG4jIyBQbGFuXG5cbkknbGwgZml4IHRoZXNlIGlzc3VlcyBieTpcblxuMS4gKipGaXggdGhlIGhvb2tzLnRzIHRva2VuIHByb2Nlc3NpbmcqKiB0byBwcm9wZXJseSBmaWx0ZXIgb3V0IHRva2VucyB3aXRob3V0IGFjdG9yc1xuMi4gKipBZGQgYmV0dGVyIGVycm9yIGhhbmRsaW5nKiogaW4gdGhlIG1hdHJpeCBhY3Rpb25zIGluaXRpYWxpemF0aW9uIFxuMy4gKipBZGQgbnVsbCBjaGVja3MqKiBpbiBvdGhlciBwbGFjZXMgd2hlcmUgdG9rZW4uYWN0b3IgaXMgYWNjZXNzZWRcbjQuICoqSW1wcm92ZSB0aGUgbWF0cml4IGFjdGlvbnMgdGltaW5nKiogdG8gYXZvaWQgcmFjZSBjb25kaXRpb25zIGR1cmluZyBpbml0aWFsaXphdGlvblxuXG5MZXQgbWUgc3RhcnQgaW1wbGVtZW50aW5nIHRoZXNlIGZpeGVzOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogc3JjL21vZHVsZS9oZWxwZXJzLnRzXG4uLi5cbiAgIDI0N1x0XG4gICAyNDhcdCAgICBzdGF0aWMgb3JkZXJLZXlzKG9iaikge1xuICAgMjQ5XHQgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvYmopLnNvcnQoZnVuY3Rpb24ga2V5T3JkZXIoazEsIGsyKSB7XG4gICAyNTBcdCAgICAgICAgICAgIGlmIChrMSA8IGsyKSByZXR1cm4gLTE7XG4gICAyNTFcdCAgICAgICAgICAgIGlmIChrMSA+IGsyKSByZXR1cm4gKzE7XG4gICAyNTJcdCAgICAgICAgICAgIHJldHVybiAwO1xuICAgMjUzXHQgICAgICAgIH0pO1xuICAgMjU0XHRcbiAgIDI1NVx0ICAgICAgICBsZXQgaTtcbiAgIDI1Nlx0ICAgICAgICBjb25zdCBhZnRlciA9IHt9O1xuICAgMjU3XHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAyNThcdCAgICAgICAgICAgIGFmdGVyW2tleXNbaV1dID0gb2JqW2tleXNbaV1dO1xuICAgMjU5XHQgICAgICAgICAgICBkZWxldGUgb2JqW2tleXNbaV1dO1xuICAgMjYwXHQgICAgICAgIH1cbiAgIDI2MVx0XG4gICAyNjJcdCAgICAgICAgZm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgIDI2M1x0ICAgICAgICAgICAgb2JqW2tleXNbaV1dID0gYWZ0ZXJba2V5c1tpXV07XG4gICAyNjRcdCAgICAgICAgfVxuICAgMjY1XHQgICAgICAgIHJldHVybiBvYmo7XG4gICAyNjZcdCAgICB9XG4gICAyNjdcdFxuICAgMjY4XHQgICAgc3RhdGljIGhhc01vZGlmaWVycyhldmVudCkge1xuICAgMjY5XHQgICAgICAgIHJldHVybiBldmVudCAmJiAoZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQuYWx0S2V5IHx8IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSk7XG4gICAyNzBcdCAgICB9XG4gICAyNzFcdFxuICAgMjcyXHQgICAgc3RhdGljIGZpbHRlcihvYmosIGNvbXApIHtcbiAgIDI3M1x0ICAgICAgICBjb25zdCByZXRPYmogPSB7fTtcbiAgIDI3NFx0ICAgICAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsKSB7XG4gICAyNzVcdCAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKG9iaikuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAyNzZcdCAgICAgICAgICAgICAgICBpZiAoY29tcChba2V5LCB2YWx1ZV0pKSByZXRPYmpba2V5XSA9IHZhbHVlO1xuICAgMjc3XHQgICAgICAgICAgICB9KTtcbiAgIDI3OFx0ICAgICAgICB9XG4gICAyNzlcdCAgICAgICAgcmV0dXJuIHJldE9iajtcbiAgIDI4MFx0ICAgIH1cbi4uLlxuICAgMzA3XHRcbiAgIDMwOFx0ICAgIC8vIFRPRE86IEZvdW5kcnkgMC45IFNob3VsZCBUb2tlbkRvY3VtZW50IGJlIHVzZWQgaW5zdGVhZCBvZiBUb2tlbj9cbiAgIDMwOVx0ICAgIC8vIFRPRE86IENoZWNrIGNhbnZhcy5zY2VuZS50b2tlbnNcbiAgIDMxMFx0ICAgIHN0YXRpYyBnZXRUb2tlbihpZD86IHN0cmluZyk6IFRva2VuIHwgdW5kZWZpbmVkIHtcbiAgIDMxMVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5IHx8ICFjYW52YXMudG9rZW5zKSByZXR1cm47XG4gICAzMTJcdFxuICAgMzEzXHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzKSB7XG4gICAzMTRcdCAgICAgICAgICAgIGlmICh0b2tlbi5pZCA9PT0gaWQpIHtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgIDMxNlx0ICAgICAgICAgICAgfVxuICAgMzE3XHQgICAgICAgIH1cbiAgIDMxOFx0ICAgIH1cbiAgIDMxOVx0XG4gICAzMjBcdCAgICAvKipcbiAgIDMyMVx0ICAgICAqIFVzZSB0aGlzIGhlbHBlciB0byBnZXQgYSB0b2tlbnMgYWN0b3IgZnJvbSBhbnkgZ2l2ZW4gc2NlbmUgaWQuXG4gICAzMjJcdCAgICAgKiBAcGFyYW0gc2NlbmVUb2tlbklkIEEgbWl4ZWQgaWQgd2l0aCB0aGUgZm9ybWF0ICc8c2NlbmVJZD4uPHRva2VuaWQ+XG4gICAzMjNcdCAgICAgKi9cbiAgIDMyNFx0ICAgIHN0YXRpYyBnZXRTY2VuZVRva2VuQWN0b3Ioc2NlbmVUb2tlbklkOiBzdHJpbmcpOiBTUjZBY3RvciB8IG51bGwge1xuICAgMzI1XHQgICAgICAgIGNvbnN0IFtzY2VuZUlkLCB0b2tlbklkXSA9IEhlbHBlcnMuZGVjb25zdHJ1Y3RTY2VuZVRva2VuSWQoc2NlbmVUb2tlbklkKTtcbiAgIDMyNlx0ICAgICAgICBjb25zdCB0b2tlbiA9IEhlbHBlcnMuZ2V0U2NlbmVUb2tlbkRvY3VtZW50KHNjZW5lSWQsIHRva2VuSWQpO1xuICAgMzI3XHQgICAgICAgIGlmICghdG9rZW4pIHJldHVybiBudWxsO1xuICAgMzI4XHQgICAgICAgIHJldHVybiB0b2tlbi5nZXRBY3RvcigpO1xuICAgMzI5XHQgICAgfVxuICAgMzMwXHRcbiAgIDMzMVx0ICAgIHN0YXRpYyBkZWNvbnN0cnVjdFNjZW5lVG9rZW5JZChzY2VuZVRva2VuSWQ6IHN0cmluZyk6IFtzY2VuZUlkOiBzdHJpbmcsIHRva2VuSWQ6IHN0cmluZ10ge1xuICAgMzMyXHQgICAgICAgIHJldHVybiBzY2VuZVRva2VuSWQuc3BsaXQoJy4nKSBhcyBbc2NlbmVJZDogc3RyaW5nLCB0b2tlbklkOiBzdHJpbmddO1xuICAgMzMzXHQgICAgfVxuICAgMzM0XHRcbiAgIDMzNVx0ICAgIHN0YXRpYyBnZXRTY2VuZVRva2VuRG9jdW1lbnQoc2NlbmVJZCwgdG9rZW5JZCk6IFRva2VuRG9jdW1lbnQgfCB1bmRlZmluZWQge1xuICAgMzM2XHQgICAgICAgIGNvbnN0IHNjZW5lID0gZ2FtZS5zY2VuZXM/LmdldChzY2VuZUlkKTtcbiAgIDMzN1x0ICAgICAgICBpZiAoIXNjZW5lKSByZXR1cm47XG4gICAzMzhcdCAgICAgICAgY29uc3QgdG9rZW4gPSBzY2VuZS50b2tlbnMuZ2V0KHRva2VuSWQpO1xuICAgMzM5XHQgICAgICAgIGlmICghdG9rZW4pIHJldHVybjtcbiAgIDM0MFx0XG4gICAzNDFcdCAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgMzQyXHQgICAgfVxuICAgMzQzXHRcbiAgIDM0NFx0ICAgIHN0YXRpYyBnZXRVc2VyVGFyZ2V0cyh1c2VyPzogVXNlciB8IG51bGwpOiBUb2tlbltdIHtcbiAgIDM0NVx0ICAgICAgICB1c2VyID0gdXNlciA/IHVzZXIgOiBnYW1lLnVzZXI7XG4gICAzNDZcdFxuICAgMzQ3XHQgICAgICAgIGlmICghdXNlcikgcmV0dXJuIFtdXG4gICAzNDhcdFxuICAgMzQ5XHQgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHVzZXIudGFyZ2V0cyk7XG4gICAzNTBcdCAgICB9XG4gICAzNTFcdFxuICAgMzUyXHQgICAgc3RhdGljIHVzZXJIYXNUYXJnZXRzKHVzZXI/OiBVc2VyIHwgbnVsbCk6IGJvb2xlYW4ge1xuICAgMzUzXHQgICAgICAgIHVzZXIgPSB1c2VyID8gdXNlciA6IGdhbWUudXNlcjtcbiAgIDM1NFx0XG4gICAzNTVcdCAgICAgICAgaWYgKCF1c2VyKSByZXR1cm4gZmFsc2U7XG4gICAzNTZcdFxuICAgMzU3XHQgICAgICAgIHJldHVybiB1c2VyLnRhcmdldHMuc2l6ZSA+IDA7XG4gICAzNThcdCAgICB9XG4uLi5cbiAgIDQ0Nlx0XG4gICA0NDdcdCAgICAvKipcbiAgIDQ0OFx0ICAgICAqIERldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBhbnkgdG9rZW5zIHNlbGVjdGVkLlxuICAgNDQ5XHQgICAgICogQHJldHVybnMgdHJ1ZSBpZiBvbmUgb3IgbW9yZSB0b2tlbnMgaGF2ZSBiZWVuIHNlbGVjdGVkLlxuICAgNDUwXHQgICAgICovXG4gICA0NTFcdCAgICBzdGF0aWMgdXNlckhhc0NvbnRyb2xsZWRUb2tlbnMoKTogYm9vbGVhbiB7XG4gICA0NTJcdCAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5yZWFkeSB8fCAhY2FudmFzLnRva2VucykgcmV0dXJuIGZhbHNlO1xuICAgNDUzXHQgICAgICAgIHJldHVybiBjYW52YXMudG9rZW5zLmNvbnRyb2xsZWQubGVuZ3RoID4gMDtcbiAgIDQ1NFx0ICAgIH1cbiAgIDQ1NVx0XG4gICA0NTZcdCAgICAvKipcbiAgIDQ1N1x0ICAgICAqIFJldHVybiBhbGwgYWN0b3JzIGNvbm5lY3RlZCB0byBhbGwgdXNlciBjb250cm9sbGVkIHRva2Vucy5cbiAgIDQ1OFx0ICAgICAqIEByZXR1cm5zIEFuIGFycmF5IHRva2VuIGFjdG9ycy5cbiAgIDQ1OVx0ICAgICAqL1xuICAgNDYwXHQgICAgc3RhdGljIGdldENvbnRyb2xsZWRUb2tlbkFjdG9ycygpOiBTUjZBY3RvcltdIHtcbiAgIDQ2MVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5KSByZXR1cm4gW11cbiAgIDQ2Mlx0XG4gICA0NjNcdCAgICAgICAgY29uc3QgdG9rZW5zID0gSGVscGVycy5nZXRDb250cm9sbGVkVG9rZW5zKCk7XG4gICA0NjRcdCAgICAgICAgcmV0dXJuIHRva2Vucy5tYXAodG9rZW4gPT4gdG9rZW4uYWN0b3IpIGFzIFNSNkFjdG9yW107XG4gICA0NjVcdCAgICB9XG4gICA0NjZcdFxuICAgNDY3XHQgICAgLyoqXG4gICA0NjhcdCAgICAgKiByZXR1cm4gYWxsIHRva2VucyBhIHVzZXIgaGFzIHRhcmdldGVkIGF0IHRoZSBtb21lbnQuXG4gICA0NjlcdCAgICAgKiBAcmV0dXJucyBBbiBhcnJheSB0b2tlbnMuXG4gICA0NzBcdCAgICAgKi9cbiAgIDQ3MVx0ICAgIHN0YXRpYyBnZXRUYXJnZXRlZFRva2VucygpOiBUb2tlbltdIHtcbiAgIDQ3Mlx0ICAgICAgICBpZiAoIWNhbnZhcy5yZWFkeSB8fCAhZ2FtZS51c2VyKSByZXR1cm4gW107XG4gICA0NzNcdFxuICAgNDc0XHQgICAgICAgIHJldHVybiBBcnJheS5mcm9tKGdhbWUudXNlci50YXJnZXRzKTtcbiAgIDQ3NVx0ICAgIH1cbiAgIDQ3Nlx0XG4gICA0NzdcdCAgICAvKipcbiAgIDQ3OFx0ICAgICAqIFJldHVybiBlaXRoZXIgYWxsIHVzZXIgc2VsZWN0ZWQgdG9rZW4gYWN0b3JzIG9yIHRoZSB1c2VycyBnYW1lIGNoYXJhY3RlciBhY3Rvci5cbiAgIDQ3OVx0ICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIGFjdG9ycy5cbiAgIDQ4MFx0ICAgICAqL1xuICAgNDgxXHQgICAgc3RhdGljIGdldFNlbGVjdGVkQWN0b3JzT3JDaGFyYWN0ZXIoKTogU1I2QWN0b3JbXSB7XG4gICA0ODJcdCAgICAgICAgaWYgKCFnYW1lLnVzZXIpIHJldHVybiBbXTtcbiAgIDQ4M1x0XG4gICA0ODRcdCAgICAgICAgY29uc3QgYWN0b3JzID0gSGVscGVycy5nZXRDb250cm9sbGVkVG9rZW5BY3RvcnMoKTtcbiAgIDQ4NVx0XG4gICA0ODZcdCAgICAgICAgLy8gVHJ5IHRvIGRlZmF1bHQgdG8gYSB1c2VycyBjaGFyYWN0ZXIuXG4gICA0ODdcdCAgICAgICAgaWYgKGFjdG9ycy5sZW5ndGggPT09IDAgJiYgZ2FtZS51c2VyLmNoYXJhY3Rlcikge1xuICAgNDg4XHQgICAgICAgICAgICBhY3RvcnMucHVzaChnYW1lLnVzZXIuY2hhcmFjdGVyKTtcbiAgIDQ4OVx0ICAgICAgICB9XG4gICA0OTBcdFxuICAgNDkxXHQgICAgICAgIHJldHVybiBhY3RvcnMgYXMgU1I2QWN0b3JbXTtcbiAgIDQ5Mlx0ICAgIH1cbi4uLlxuICAgNTc2XHRcbiAgIDU3N1x0ICAgIHN0YXRpYyBnZXREZWZlbnNlUmF0aW5nKHRhcmdldHM6IFRva2VuRG9jdW1lbnRbXSk6IG51bWJlciB7XG4gICA1NzhcdCAgICAgICAgbGV0IGRlZmVuc2VSYXRpbmcgPSAwO1xuICAgNTc5XHQgICAgICAgIGZvcihjb25zdCB0b2tlbiBvZiB0YXJnZXRzKSB7XG4gICA1ODBcdCAgICAgICAgICAgIGxldCB0YXJnZXQgPSB0b2tlbi5hY3RvcjtcbiAgIDU4MVx0ICAgICAgICAgICAgY29uc29sZS5sb2codGFyZ2V0KTtcbiAgIDU4Mlx0ICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgNTgzXHQgICAgICAgICAgICBpZiAoJ2RlZmVuc2VfcmF0aW5nJyBpbiB0YXJnZXQuc3lzdGVtLnZhbHVlcyAmJiB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZSA+IGRlZmVuc2VSYXRpbmcpIHtcbiAgIDU4NFx0ICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgIDU4NVx0ICAgICAgICAgICAgICAgIGRlZmVuc2VSYXRpbmcgPSB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZTtcbiAgIDU4Nlx0ICAgICAgICAgICAgfVxuICAgNTg3XHQgICAgICAgIH1cbiAgIDU4OFx0ICAgICAgICByZXR1cm4gZGVmZW5zZVJhdGluZztcbiAgIDU4OVx0ICAgIH1cbiAgIDU5MFx0XG4gICA1OTFcdCAgICBzdGF0aWMgZ2V0QXR0YWNrUmF0aW5nKGFjdG9yOiBTUjZBY3Rvcik6IG51bWJlciB7XG4gICA1OTJcdCAgICAgICAgcmV0dXJuIDA7XG4gICA1OTNcdCAgICB9XG4uLi5cbiAgIDY2MVx0XG4gICA2NjJcdCAgICAgICAgLy8gSWYgd2UgZGlkIG5vdCBmaW5kIGFueXRoaW5nIG9uIHRoZSBhY3Rvciwgc2VhcmNoIHRoZSBhY3RpdmUgdG9rZW5zICh0aGUgaXRlbSBtaWdodCBvbmx5IGV4aXN0IG9uIGEgbm9uIGxpbmtlZCB0b2tlbilcbiAgIDY2M1x0ICAgICAgICAvLyBUaGlzIHdpbGwgbm90IHdvcmsgaWYgd2UgYXJlIG9uIGEgZGlmZmVyZW50IHNjZW5lIG9yIHRoZSB0b2tlbiBnb3QgZGVsZXRlZCwgd2hpY2ggaXMgZXhwZWN0ZWQgd2hlbiB5b3UgcHV0IGFuXG4gICA2NjRcdCAgICAgICAgLy8gaXRlbSBvbiBhIHRva2VuIHdpdGhvdXQgbGlua2luZyBpdC5cbiAgIDY2NVx0ICAgICAgICBjb25zdCB0b2tlbnMgPSBhY3RvclNvdXJjZS5nZXRBY3RpdmVUb2tlbnMoKTtcbiAgIDY2Nlx0ICAgICAgICBsZXQgdG9rZW5JdGVtOiBTUjZJdGVtIHwgdW5kZWZpbmVkO1xuICAgNjY3XHQgICAgICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDY2OFx0ICAgICAgICAgICAgaWYgKCF0b2tlbi5hY3RvcikgcmV0dXJuO1xuICAgNjY5XHRcbiAgIDY3MFx0ICAgICAgICAgICAgY29uc3QgZm91bmRJdGVtID0gdG9rZW4uYWN0b3IuaXRlbXMuZ2V0KGl0ZW1JZCk7XG4gICA2NzFcdCAgICAgICAgICAgIGlmIChmb3VuZEl0ZW0pIHtcbiAgIDY3Mlx0ICAgICAgICAgICAgICAgIHRva2VuSXRlbSA9IGZvdW5kSXRlbSBhcyB1bmtub3duIGFzIFNSNkl0ZW07XG4gICA2NzNcdCAgICAgICAgICAgIH1cbiAgIDY3NFx0ICAgICAgICB9KTtcbiAgIDY3NVx0XG4gICA2NzZcdCAgICAgICAgcmV0dXJuIHRva2VuSXRlbTtcbiAgIDY3N1x0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50c1xuLi4uXG4gIDI3MDRcdFxuICAyNzA1XHQgICAgLyoqXG4gIDI3MDZcdCAgICAgKiBGaW5kIGFuZCByZWZyZXNoIGFsbCB0b2tlbiBzaGVldHMgZm9yIHRoaXMgYWN0b3JcbiAgMjcwN1x0ICAgICAqIFRoaXMgaXMgbmVlZGVkIGJlY2F1c2UgdG9rZW4gc2hlZXRzIGFyZSBub3QgYXV0b21hdGljYWxseSByZWZyZXNoZWQgd2hlbiB0aGUgYWN0b3IgaXMgdXBkYXRlZFxuICAyNzA4XHQgICAgICovXG4gIDI3MDlcdCAgICByZWZyZXNoVG9rZW5TaGVldHMoKSB7XG4gIDI3MTBcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IFJlZnJlc2hpbmcgdG9rZW4gc2hlZXRzIGZvciAke3RoaXMubmFtZX1gKTtcbiAgMjcxMVx0XG4gIDI3MTJcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgZm9yIHRoaXMgYWN0b3JcbiAgMjcxM1x0ICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmdldEFjdGl2ZVRva2VucygpO1xuICAyNzE0XHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBGb3VuZCAke3Rva2Vucy5sZW5ndGh9IHRva2VucyBmb3IgJHt0aGlzLm5hbWV9YCk7XG4gIDI3MTVcdFxuICAyNzE2XHQgICAgICAgIC8vIFJlZnJlc2ggZWFjaCB0b2tlblxuICAyNzE3XHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgdG9rZW5zKSB7XG4gIDI3MThcdCAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIHRva2VuXG4gIDI3MTlcdCAgICAgICAgICAgIGlmICh0b2tlbi5yZWZyZXNoKSB0b2tlbi5yZWZyZXNoKCk7XG4gIDI3MjBcdFxuICAyNzIxXHQgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSB0b2tlbidzIHNoZWV0IGlmIGl0J3Mgb3BlblxuICAyNzIyXHQgICAgICAgICAgICBpZiAodG9rZW4uc2hlZXQgJiYgdG9rZW4uc2hlZXQucmVuZGVyZWQpIHtcbiAgMjcyM1x0ICAgICAgICAgICAgICAgIHRva2VuLnNoZWV0LnJlbmRlcih0cnVlKTtcbiAgMjcyNFx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBSZWZyZXNoZWQgdG9rZW4gc2hlZXQgZm9yICR7dG9rZW4ubmFtZX1gKTtcbiAgMjcyNVx0ICAgICAgICAgICAgfVxuICAyNzI2XHQgICAgICAgIH1cbiAgMjcyN1x0XG4gIDI3MjhcdCAgICAgICAgLy8gRmluZCBhbmQgcmVmcmVzaCBhbGwgdG9rZW4gc2hlZXRzIGluIHRoZSB1aS53aW5kb3dzIGNvbGxlY3Rpb25cbiAgMjcyOVx0ICAgICAgICBmb3IgKGNvbnN0IFtpZCwgYXBwXSBvZiBPYmplY3QuZW50cmllcyh1aS53aW5kb3dzKSkge1xuICAyNzMwXHQgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgc2hlZXQgZm9yIG9uZSBvZiBvdXIgdG9rZW5zXG4gIDI3MzFcdCAgICAgICAgICAgIGlmIChhcHAudG9rZW4gJiYgdG9rZW5zLnNvbWUodCA9PiB0LmlkID09PSBhcHAudG9rZW4uaWQpKSB7XG4gIDI3MzJcdCAgICAgICAgICAgICAgICBhcHAucmVuZGVyKHRydWUpO1xuICAyNzMzXHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IFJlZnJlc2hlZCB0b2tlbiBzaGVldCAke2lkfSBmb3IgJHthcHAudG9rZW4ubmFtZX1gKTtcbiAgMjczNFx0ICAgICAgICAgICAgfVxuICAyNzM1XHQgICAgICAgIH1cbiAgMjczNlx0ICAgIH1cbi4uLlxuICAyOTkwXHRcbiAgMjk5MVx0ICAgICAgICAvLyBSZWZyZXNoIHRoZSBjYW52YXMgaWYgaXQgZXhpc3RzXG4gIDI5OTJcdCAgICAgICAgaWYgKGNhbnZhcyAmJiBjYW52YXMudG9rZW5zICYmIHR5cGVvZiBjYW52YXMudG9rZW5zLnBsYWNlYWJsZXMgIT09ICd1bmRlZmluZWQnKSB7XG4gIDI5OTNcdCAgICAgICAgICAgIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcy5mb3JFYWNoKHRva2VuID0+IHtcbiAgMjk5NFx0ICAgICAgICAgICAgICAgIGlmICh0b2tlbi5hY3RvciAmJiB0b2tlbi5hY3Rvci5pZCA9PT0gdGhpcy5pZCAmJiB0b2tlbi5yZWZyZXNoKSB7XG4gIDI5OTVcdCAgICAgICAgICAgICAgICAgICAgdG9rZW4ucmVmcmVzaCgpO1xuICAyOTk2XHQgICAgICAgICAgICAgICAgfVxuICAyOTk3XHQgICAgICAgICAgICB9KTtcbiAgMjk5OFx0ICAgICAgICB9XG4gIDI5OTlcdFxuICAzMDAwXHQgICAgICAgIC8vIFJlZnJlc2ggdG9rZW4gc2hlZXRzXG4gIDMwMDFcdCAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW5TaGVldHMoKTtcbiAgMzAwMlx0XG4gIDMwMDNcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IENvbXBsZXRlZCByZWZyZXNoIG9mIGFsbCBzaGVldHMgZm9yICR7dGhpcy5uYW1lfWApO1xuICAzMDA0XHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3RhcmdldGluZy9UYXJnZXRpbmdTZXJ2aWNlLnRzXG4uLi5cbiAgIDEyMlx0ICAgIFxuICAgMTIzXHQgICAgLyoqXG4gICAxMjRcdCAgICAgKiBTdWdnZXN0IHRhcmdldHMgZm9yIGFuIGFjdGlvbiB3aGVuIG5vbmUgYXJlIHNlbGVjdGVkXG4gICAxMjVcdCAgICAgKiBAcGFyYW0gYWN0aW9uIFRoZSBhY3Rpb24gYmVpbmcgcGVyZm9ybWVkXG4gICAxMjZcdCAgICAgKiBAcGFyYW0gYWN0b3IgVGhlIGFjdG9yIHBlcmZvcm1pbmcgdGhlIGFjdGlvblxuICAgMTI3XHQgICAgICogQHJldHVybnMgQW4gYXJyYXkgb2Ygc3VnZ2VzdGVkIHRhcmdldCB0b2tlbnNcbiAgIDEyOFx0ICAgICAqL1xuICAgMTI5XHQgICAgc3RhdGljIHN1Z2dlc3RUYXJnZXRzRm9yQWN0aW9uKGFjdGlvbjogU1I2SXRlbSwgYWN0b3I6IFNSNkFjdG9yKTogVG9rZW5bXSB7XG4gICAxMzBcdCAgICAgICAgLy8gR2V0IHRoZSBhY3RvcidzIHRva2VuXG4gICAxMzFcdCAgICAgICAgY29uc3QgYWN0b3JUb2tlbiA9IGFjdG9yLmdldFRva2VuKCk7XG4gICAxMzJcdCAgICAgICAgaWYgKCFhY3RvclRva2VuKSByZXR1cm4gW107XG4gICAxMzNcdCAgICAgICAgXG4gICAxMzRcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgaW4gdGhlIHNjZW5lXG4gICAxMzVcdCAgICAgICAgY29uc3QgdG9rZW5zID0gY2FudmFzLnRva2Vucz8ucGxhY2VhYmxlcyB8fCBbXTtcbiAgIDEzNlx0ICAgICAgICBcbiAgIDEzN1x0ICAgICAgICAvLyBGaWx0ZXIgZm9yIHBvdGVudGlhbCB0YXJnZXRzIChleGNsdWRlIHRoZSBhY3RvcidzIG93biB0b2tlbilcbiAgIDEzOFx0ICAgICAgICBjb25zdCBwb3RlbnRpYWxUYXJnZXRzID0gdG9rZW5zLmZpbHRlcih0b2tlbiA9PiBcbiAgIDEzOVx0ICAgICAgICAgICAgdG9rZW4uaWQgIT09IGFjdG9yVG9rZW4uaWQgJiYgXG4gICAxNDBcdCAgICAgICAgICAgIHRva2VuLmFjdG9yICYmIFxuICAgMTQxXHQgICAgICAgICAgICB0aGlzLmlzVmFsaWRUYXJnZXQodG9rZW4sIGFjdGlvbiwgYWN0b3IpXG4gICAxNDJcdCAgICAgICAgKTtcbi4uLlxuICAgMTUxXHQgICAgXG4gICAxNTJcdCAgICAvKipcbiAgIDE1M1x0ICAgICAqIEhpZ2hsaWdodCB2YWxpZCB0YXJnZXRzIGZvciBhbiBhY3Rpb25cbiAgIDE1NFx0ICAgICAqIEBwYXJhbSBhY3Rpb24gVGhlIGFjdGlvbiBiZWluZyBwZXJmb3JtZWRcbiAgIDE1NVx0ICAgICAqIEBwYXJhbSBhY3RvciBUaGUgYWN0b3IgcGVyZm9ybWluZyB0aGUgYWN0aW9uXG4gICAxNTZcdCAgICAgKi9cbiAgIDE1N1x0ICAgIHN0YXRpYyBoaWdobGlnaHRWYWxpZFRhcmdldHMoYWN0aW9uOiBTUjZJdGVtLCBhY3RvcjogU1I2QWN0b3IpOiB2b2lkIHtcbiAgIDE1OFx0ICAgICAgICAvLyBHZXQgYWxsIHRva2VucyBpbiB0aGUgc2NlbmVcbiAgIDE1OVx0ICAgICAgICBjb25zdCB0b2tlbnMgPSBjYW52YXMudG9rZW5zPy5wbGFjZWFibGVzIHx8IFtdO1xuICAgMTYwXHQgICAgICAgIFxuICAgMTYxXHQgICAgICAgIC8vIFJlc2V0IGFsbCB0b2tlbiBoaWdobGlnaHRzXG4gICAxNjJcdCAgICAgICAgdG9rZW5zLmZvckVhY2godG9rZW4gPT4ge1xuICAgMTYzXHQgICAgICAgICAgICB0b2tlbi5ib3JkZXI/LnZpc2libGUgPSBmYWxzZTtcbiAgIDE2NFx0ICAgICAgICB9KTtcbiAgIDE2NVx0ICAgICAgICBcbiAgIDE2Nlx0ICAgICAgICAvLyBHZXQgdmFsaWQgdGFyZ2V0c1xuICAgMTY3XHQgICAgICAgIGNvbnN0IHZhbGlkVGFyZ2V0cyA9IHRva2Vucy5maWx0ZXIodG9rZW4gPT4gXG4gICAxNjhcdCAgICAgICAgICAgIHRva2VuLmFjdG9yICYmIFxuICAgMTY5XHQgICAgICAgICAgICB0aGlzLmlzVmFsaWRUYXJnZXQodG9rZW4sIGFjdGlvbiwgYWN0b3IpXG4gICAxNzBcdCAgICAgICAgKTtcbiAgIDE3MVx0ICAgICAgICBcbiAgIDE3Mlx0ICAgICAgICAvLyBIaWdobGlnaHQgdmFsaWQgdGFyZ2V0c1xuICAgMTczXHQgICAgICAgIHZhbGlkVGFyZ2V0cy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDE3NFx0ICAgICAgICAgICAgdG9rZW4uYm9yZGVyLnZpc2libGUgPSB0cnVlO1xuICAgMTc1XHQgICAgICAgICAgICB0b2tlbi5ib3JkZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAweDAwRkYwMDsgLy8gR3JlZW4gZm9yIHZhbGlkIHRhcmdldHNcbiAgIDE3Nlx0ICAgICAgICB9KTtcbiAgIDE3N1x0ICAgICAgICBcbiAgIDE3OFx0ICAgICAgICAvLyBGb3JjZSBhIGNhbnZhcyByZWZyZXNoXG4gICAxNzlcdCAgICAgICAgY2FudmFzLnRva2Vucz8ucmVmcmVzaCgpO1xuICAgMTgwXHQgICAgfVxuICAgMTgxXHQgICAgXG4gICAxODJcdCAgICAvKipcbiAgIDE4M1x0ICAgICAqIENsZWFyIHRhcmdldCBoaWdobGlnaHRzXG4gICAxODRcdCAgICAgKi9cbiAgIDE4NVx0ICAgIHN0YXRpYyBjbGVhclRhcmdldEhpZ2hsaWdodHMoKTogdm9pZCB7XG4gICAxODZcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgaW4gdGhlIHNjZW5lXG4gICAxODdcdCAgICAgICAgY29uc3QgdG9rZW5zID0gY2FudmFzLnRva2Vucz8ucGxhY2VhYmxlcyB8fCBbXTtcbiAgIDE4OFx0ICAgICAgICBcbiAgIDE4OVx0ICAgICAgICAvLyBSZXNldCBhbGwgdG9rZW4gaGlnaGxpZ2h0c1xuICAgMTkwXHQgICAgICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDE5MVx0ICAgICAgICAgICAgdG9rZW4uYm9yZGVyPy52aXNpYmxlID0gZmFsc2U7XG4gICAxOTJcdCAgICAgICAgfSk7XG4gICAxOTNcdCAgICAgICAgXG4gICAxOTRcdCAgICAgICAgLy8gRm9yY2UgYSBjYW52YXMgcmVmcmVzaFxuICAgMTk1XHQgICAgICAgIGNhbnZhcy50b2tlbnM/LnJlZnJlc2goKTtcbiAgIDE5Nlx0ICAgIH1cbiAgIDE5N1x0ICAgIFxuICAgMTk4XHQgICAgLyoqXG4gICAxOTlcdCAgICAgKiBHZXQgdGFyZ2V0cyBmb3IgYW4gb3Bwb3NlZCB0ZXN0XG4gICAyMDBcdCAgICAgKiBAcGFyYW0gYWN0aW9uIFRoZSBhY3Rpb24gYmVpbmcgcGVyZm9ybWVkXG4gICAyMDFcdCAgICAgKiBAcGFyYW0gYWN0b3IgVGhlIGFjdG9yIHBlcmZvcm1pbmcgdGhlIGFjdGlvblxuICAgMjAyXHQgICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgdGFyZ2V0IGFjdG9yc1xuICAgMjAzXHQgICAgICovXG4gICAyMDRcdCAgICBzdGF0aWMgZ2V0T3Bwb3NlZFRlc3RUYXJnZXRzKGFjdGlvbjogU1I2SXRlbSwgYWN0b3I6IFNSNkFjdG9yKTogU1I2QWN0b3JbXSB7XG4gICAyMDVcdCAgICAgICAgLy8gR2V0IHZhbGlkIHRhcmdldHNcbiAgIDIwNlx0ICAgICAgICBjb25zdCB2YWxpZFRhcmdldHMgPSB0aGlzLmdldFZhbGlkVGFyZ2V0c0ZvckFjdGlvbihhY3Rpb24sIGFjdG9yKTtcbiAgIDIwN1x0ICAgICAgICBcbiAgIDIwOFx0ICAgICAgICAvLyBDb252ZXJ0IHRvIGFjdG9yc1xuICAgMjA5XHQgICAgICAgIHJldHVybiB2YWxpZFRhcmdldHNcbiAgIDIxMFx0ICAgICAgICAgICAgLm1hcCh0b2tlbiA9PiB0b2tlbi5hY3RvciBhcyBTUjZBY3RvcilcbiAgIDIxMVx0ICAgICAgICAgICAgLmZpbHRlcihhY3RvciA9PiBhY3RvciAhPT0gdW5kZWZpbmVkKTtcbiAgIDIxMlx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS90ZXN0cy9UZXN0Q3JlYXRvci50c1xuLi4uXG4gICAyMTZcdFxuICAgMjE3XHQgICAgICAgIC8vIERldGVybWluZSBhY3RvcnMgdG8gcm9sbCB0ZXN0IHdpdGguXG4gICAyMThcdCAgICAgICAgbGV0IGFjdG9ycyA9IGF3YWl0IEhlbHBlcnMuZ2V0T3Bwb3NlZFRlc3RBY3RvcnModGVzdERhdGEuZGF0YSk7XG4gICAyMTlcdFxuICAgMjIwXHQgICAgICAgIC8vIEluZm9ybSB1c2VyIGFib3V0IHRva2VucyB3aXRoIGRlbGV0ZWQgc2lkZWJhciBhY3RvcnMuXG4gICAyMjFcdCAgICAgICAgLy8gVGhpcyBjYW4gYm90aCBoYXBwZW4gZm9yIGxpbmtlZCB0b2tlbnMgaW1tZWRpYXRlbHkgYW5kIHVubGlua2VkIHRva2VucyBhZnRlciByZWxvYWRpbmcuXG4gICAyMjJcdCAgICAgICAgaWYgKGFjdG9ycy5maWx0ZXIoYWN0b3IgPT4gIWFjdG9yKS5sZW5ndGggPiAwKSB7XG4gICAyMjNcdCAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnM/Lndhcm4oJ1RPS0VOLldhcm5pbmdOb0FjdG9yJywge2xvY2FsaXplOiB0cnVlfSk7XG4gICAyMjRcdCAgICAgICAgICAgIHJldHVybjtcbiAgIDIyNVx0ICAgICAgICB9XG4gICAyMjZcdFxuICAgMjI3XHQgICAgICAgIC8vIGZpbHRlciBvdXQgYWN0b3JzIGN1cnJlbnQgdXNlciBzaG91bGRuJ3QgYmUgYWJsZSB0byB0ZXN0IHdpdGguXG4gICAyMjhcdCAgICAgICAgYWN0b3JzID0gYWN0b3JzLmZpbHRlcihhY3RvciA9PiBhY3Rvci5pc093bmVyKTtcbiAgIDIyOVx0ICAgICAgICAvLyBGYWxsYmFjayB0byBwbGF5ZXIgY2hhcmFjdGVyLlxuICAgMjMwXHQgICAgICAgIGlmIChhY3RvcnMubGVuZ3RoID09PSAwICYmIGdhbWUudXNlci5jaGFyYWN0ZXIpIHtcbiAgIDIzMVx0ICAgICAgICAgICAgYWN0b3JzLnB1c2goZ2FtZS51c2VyLmNoYXJhY3Rlcik7XG4gICAyMzJcdCAgICAgICAgfVxuICAgMjMzXHRcbiAgIDIzNFx0ICAgICAgICBpZiAoYWN0b3JzLmxlbmd0aCA9PT0gMCkge1xuICAgMjM1XHQgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zPy53YXJuKGdhbWUuaTE4bi5sb2NhbGl6ZSgnU1I2Lldhcm5pbmdzLlRva2VuU2VsZWN0aW9uTmVlZGVkJykpO1xuICAgMjM2XHQgICAgICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hcHBzL2dtdG9vbHMvT3ZlcndhdGNoU2NvcmVUcmFja2VyLmpzXG4uLi5cbiAgICA4MFx0XG4gICAgODFcdCAgICAgICAgLy8gQWRkIGxpbmtlZCB0b2tlbiBhY3RvcnMuXG4gICAgODJcdCAgICAgICAgdG9rZW5zLmZpbHRlcih0b2tlbiA9PiB0b2tlbi5kb2N1bWVudC5hY3RvckxpbmspLmZvckVhY2godG9rZW4gPT4ge1xuICAgIDgzXHQgICAgICAgICAgICAvLyBEb3VibGUgY2hlY2sgdGhhdCB0aGUgYWN0b3IgYWN0dWFsbHkgbGl2ZXMgaW4gdGhlIGFjdG9ycyBjb2xsZWN0aW9uLlxuICAgIDg0XHQgICAgICAgICAgICBjb25zdCBhY3RvciA9IGdhbWUuYWN0b3JzLmdldCh0b2tlbi5kb2N1bWVudC5hY3RvcklkKTtcbiAgICA4NVx0ICAgICAgICAgICAgaWYgKCFhY3RvcikgcmV0dXJuO1xuICAgIDg2XHQgICAgICAgICAgICBpZiAodGhpcy5faXNBY3Rvck9uVHJhY2tlcihhY3RvcikpIHJldHVybjtcbiAgICA4N1x0XG4gICAgODhcdCAgICAgICAgICAgIE92ZXJ3YXRjaFNjb3JlVHJhY2tlci5hZGRlZEFjdG9ycy5wdXNoKGFjdG9yLmlkKTtcbiAgICA4OVx0ICAgICAgICB9KTtcbiAgICA5MFx0XG4gICAgOTFcdCAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICA5Mlx0ICAgIH1cbiAgICA5M1x0XG4gICAgOTRcdCAgICAvKipcbiAgICA5NVx0ICAgICAqIENoZWNrIGlmIHRoZSBnaXZlbiBhY3RvciBpcyBhbHJlYWR5IGFkZGVkIGFuZCBkaXNwbGF5ZWQgb24gdGhlIGN1cnJlbnQgdHJhY2tlci5cbiAgICA5Nlx0ICAgICAqXG4gICAgOTdcdCAgICAgKiBAcGFyYW0gYWN0b3IgQSBhY3RvcnMgY29sbGVjdGlvbiBhY3Rvci5cbiAgICA5OFx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufSBXaWxsIHJldHVybiB0cnVlIHdoZW4gdGhlIGdpdmVuIGFjdG9yIGFscmVhZHkgZXhpc3RzLlxuICAgIDk5XHQgICAgICovXG4gICAxMDBcdCAgICBfaXNBY3Rvck9uVHJhY2tlcihhY3Rvcikge1xuICAgMTAxXHQgICAgICAgIHJldHVybiB0aGlzLmFjdG9ycy5maW5kKGFjdG9yRGF0YSA9PiBhY3RvckRhdGEuX2lkID09PSBhY3Rvci5pZCkgIT09IHVuZGVmaW5lZDtcbiAgIDEwMlx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9ydWxlcy9Eb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycy50c1xuLi4uXG4gICAzOTBcdFxuICAgMzkxXHQgICAgLyoqXG4gICAzOTJcdCAgICAgKiBIZWxwZXIgZm9yIHNjZW5lIG1vZGlmaWVyIGluc3RhbmNlcyB0byBjbGVhciBhbGwgbW9kaWZpZXJzIGZvciBhbGwgcGxhY2VkIHRva2Vuc1xuICAgMzkzXHQgICAgICovXG4gICAzOTRcdCAgICBhc3luYyBjbGVhckFsbFRva2Vuc09uU2NlbmUoKSB7XG4gICAzOTVcdCAgICAgICAgaWYgKCFjYW52YXMucmVhZHkgfHwgIWNhbnZhcy5zY2VuZSkgcmV0dXJuO1xuICAgMzk2XHQgICAgICAgIGlmICghdGhpcy5kb2N1bWVudElzU2NlbmUpIHJldHVybjtcbiAgIDM5N1x0XG4gICAzOThcdCAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCBtb2RpZmllcnMgc2NlbmUgaXMgc2FtZSB0byBjdXJyZW50IHNjZW5lLlxuICAgMzk5XHQgICAgICAgIGNvbnN0IHNjZW5lID0gdGhpcy5kb2N1bWVudCBhcyBTY2VuZTtcbiAgIDQwMFx0ICAgICAgICBpZiAoY2FudmFzLnNjZW5lLmlkICE9PSBzY2VuZS5pZCkgcmV0dXJuO1xuICAgNDAxXHRcbiAgIDQwMlx0ICAgICAgICAvLyBVc2UgY3VycmVudCBzY2VuZSBmb3IgZWFzZSBvZiBhY2Nlc3MgdG8gdG9rZW5zXG4gICA0MDNcdCAgICAgICAgY2FudmFzLnNjZW5lLnRva2Vucy5mb3JFYWNoKHRva2VuID0+IHRva2VuLmFjdG9yPy5nZXRTaXR1YXRpb25Nb2RpZmllcnMoKS5jbGVhckFsbCgpKTtcbiAgIDQwNFx0ICAgIH1cbiAgIDQwNVx0fVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL2hvb2tzLnRzXG4uLi5cbiAgIDQ0Nlx0XG4gICA0NDdcdCAgICAgICAgaWYgKGl0ZW0uaXNIb3N0KSB7XG4gICA0NDhcdCAgICAgICAgICAgIC8vIENvbGxlY3QgYWN0b3JzIGZyb20gc2lkZWJhciBhbmQgYWN0aXZlIHNjZW5lIHRvIHVwZGF0ZSAvIHJlcmVuZGVyXG4gICA0NDlcdCAgICAgICAgICAgIGxldCBjb25uZWN0ZWRJQyA9IFtcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIC8vIEFsbCBzaWRlYmFyIGFjdG9ycyBzaG91bGQgYWxzbyBpbmNsdWRlIHRva2VucyB3aXRoIGxpbmtlZCBhY3RvcnMuXG4gICA0NTFcdCAgICAgICAgICAgICAgICAuLi5nYW1lLmFjdG9ycy5maWx0ZXIoKGFjdG9yOiBTUjZBY3RvcikgPT4gYWN0b3IuaXNJQygpICYmIGFjdG9yLmhhc0hvc3QoKSkgYXMgU1I2QWN0b3JbXSxcbiAgIDQ1Mlx0ICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxuICAgNDUzXHQgICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgIDQ1NFx0ICAgICAgICAgICAgICAgIC4uLmNhbnZhcy5zY2VuZS50b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0b2tlbi5hY3RvckxpbmsgJiYgdG9rZW4uYWN0b3I/LmlzSUMoKSAmJiB0b2tlbi5hY3Rvcj8uaGFzSG9zdCgpKS5tYXAodCA9PiB0LmFjdG9yKVxuICAgNDU1XHQgICAgICAgICAgICBdO1xuICAgNDU2XHRcbiAgIDQ1N1x0ICAgICAgICAgICAgLy8gVXBkYXRlIGhvc3QgZGF0YSBvbiB0aGUgaWMgYWN0b3IuXG4gICA0NThcdCAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBpdGVtLmFzSG9zdDtcbiAgIDQ1OVx0ICAgICAgICAgICAgaWYgKCFob3N0KSByZXR1cm47XG4gICA0NjBcdCAgICAgICAgICAgIGZvciAoY29uc3QgaWMgb2YgY29ubmVjdGVkSUMpIHtcbiAgIDQ2MVx0ICAgICAgICAgICAgICAgIGlmICghaWMpIGNvbnRpbnVlO1xuICAgNDYyXHQgICAgICAgICAgICAgICAgYXdhaXQgaWMuX3VwZGF0ZUlDSG9zdERhdGEoaG9zdCk7XG4gICA0NjNcdCAgICAgICAgICAgIH1cbiAgIDQ2NFx0ICAgICAgICB9XG4gICA0NjVcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvaXRlbS9mbG93cy9BY3Rpb25GbG93LnRzXG4uLi5cbiAgIDEyMFx0XG4gICAxMjFcdCAgICAgICAgLy8gQ0FTRSAtIFJldHVybiBhY3RvciBza2lsbHMgd2hlbiBhdmFpbGFibGUuXG4gICAxMjJcdCAgICAgICAgLy8gICAgICAgIHRoZSBtYWpvciB1c2UgY2FzZSBpcyBvd25lZCBpdGVtcywgd2hlcmUgdGhlIGFjdG9yIGlzIGF2YWlsYWJsZS5cbiAgIDEyM1x0ICAgICAgICBjb25zdCBhY3RpdmVTa2lsbHMgPSBhY3Rvci5nZXRBY3RpdmVTa2lsbHMoKTtcbiAgIDEyNFx0XG4gICAxMjVcdCAgICAgICAgLy8gQ29udmVydCBza2lsbCBkYXRhIHRvIGEgdmFsdWUgbGFiZWwgbWFwcGluZy5cbiAgIDEyNlx0ICAgICAgICBjb25zdCBza2lsbHM6IFJlY29yZDxzdHJpbmcsIFRyYW5zbGF0aW9uPiA9IHt9O1xuICAgMTI3XHQgICAgICAgIGZvciAoY29uc3QgW2lkLCBza2lsbF0gb2YgT2JqZWN0LmVudHJpZXMoYWN0aXZlU2tpbGxzKSkge1xuICAgMTI4XHQgICAgICAgICAgICBjb25zdCBrZXkgPSBza2lsbC5uYW1lIHx8IGlkO1xuICAgMTI5XHQgICAgICAgICAgICBjb25zdCBsYWJlbCA9IHNraWxsLmxhYmVsIHx8IHNraWxsLm5hbWU7XG4gICAxMzBcdCAgICAgICAgICAgIHNraWxsc1trZXldID0gbGFiZWwgYXMgVHJhbnNsYXRpb247XG4gICAxMzFcdCAgICAgICAgfVxuICAgMTMyXHRcbiAgIDEzM1x0ICAgICAgICBBY3Rpb25GbG93Ll9pbmplY3RNaXNzaW5nQ3VzdG9tU2tpbGwoc2tpbGxzLCBza2lsbE5hbWUpO1xuICAgMTM0XHQgICAgICAgIHJldHVybiBIZWxwZXJzLnNvcnRDb25maWdWYWx1ZXNCeVRyYW5zbGF0aW9uKHNraWxscyk7XG4gICAxMzVcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvbWlncmF0b3IvVmVyc2lvbk1pZ3JhdGlvbi50c1xuLi4uXG4gICAxNThcdFxuICAgMTU5XHQgICAgICAgICAgICAgICAgLy8gTWlncmF0ZSBlbWJlZGRlZCBUb2tlbkRvY3VtZW50IC8gQWN0b3JEYXRhIHdpdGhpbiBTY2VuZURhdGFcbiAgIDE2MFx0ICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2Ygc2NlbmUuZGF0YS50b2tlbnMpIHtcbiAgIDE2MVx0ICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBtaWdyYXRlIHRva2VucyB3aXRob3V0IG9yIGEgbGlua2VkIGFjdG9yLlxuICAgMTYyXHQgICAgICAgICAgICAgICAgICAgIGlmICghdG9rZW4uYWN0b3IgfHwgdG9rZW4uZGF0YS5hY3RvckxpbmspIGNvbnRpbnVlO1xuICAgMTYzXHRcbiAgIDE2NFx0ICAgICAgICAgICAgICAgICAgICAvL0B0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICAxNjVcdCAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kcnkudXRpbHMuaXNFbXB0eSh0b2tlbi5hY3RvcikpIGNvbnRpbnVlO1xuICAgMTY2XHRcbiAgIDE2N1x0ICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0gYXdhaXQgdGhpcy5NaWdyYXRlQWN0b3JEYXRhKHRva2VuLmFjdG9yKTtcbiAgIDE2OFx0XG4gICAxNjlcdCAgICAgICAgICAgICAgICAgICAgZXhwYW5kT2JqZWN0KHVwZGF0ZURhdGEpO1xuICAgMTcwXHQgICAgICAgICAgICAgICAgICAgIGVudGl0eVVwZGF0ZXMuc2V0KHRva2VuLmFjdG9yLCB7XG4gICAxNzFcdCAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGE6IHVwZGF0ZURhdGEuZGF0YSB8fCBudWxsLFxuICAgMTcyXHQgICAgICAgICAgICAgICAgICAgICAgICBlbWJlZGRlZEl0ZW1zOiB1cGRhdGVEYXRhLml0ZW1zIHx8IG51bGwsXG4gICAxNzNcdCAgICAgICAgICAgICAgICAgICAgICAgIGVtYmVkZGVkRWZmZWN0czogdXBkYXRlRGF0YS5lZmZlY3RzIHx8IG51bGxcbiAgIDE3NFx0ICAgICAgICAgICAgICAgICAgICB9KTtcbiAgIDE3NVx0ICAgICAgICAgICAgICAgIH1cbiAgIDE3Nlx0XG4gICAxNzdcdCAgICAgICAgICAgICAgICAvL0B0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICAxNzhcdCAgICAgICAgICAgICAgICBpZiAoZm91bmRyeS51dGlscy5pc0VtcHR5KHVwZGF0ZURhdGEpKSB7XG4gICAxNzlcdCAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAxODBcdCAgICAgICAgICAgICAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvZWZmZWN0cy50c1xuLi4uXG4gICAxNDlcdFxuICAgMTUwXHQvKipcbiAgIDE1MVx0ICogQ29sbGVjdCBhbGwgZWZmZWN0cyBmcm9tIGEgZG9jdW1lbnRzIGl0ZW1zIGFuZCBuZXN0ZWQgaXRlbXMuXG4gICAxNTJcdCAqXG4gICAxNTNcdCAqIEBwYXJhbSBkb2N1bWVudCBFaXRoZXIgYSBhY3RvciBvciBpdGVtIGRvY3VtZW50LlxuICAgMTU0XHQgKiBAcGFyYW0gb3B0aW9ucy5hcHBseVRvIEEgaXRlcmFibGUgb2YgYXBwbHktdG8gdGFyZ2V0IHZhbHVlc1xuICAgMTU1XHQgKiBAcGFyYW0gb3B0aW9ucy5uZXN0ZWRJdGVtcyBXaGV0aGVyIHRvIGluY2x1ZGUgbmVzdGVkIGl0ZW1zXG4gICAxNTZcdCAqIEByZXR1cm5zIEFuIGl0ZXJhdG9yIGVmZmVjdFxuICAgMTU3XHQgKi9cbiAgIDE1OFx0ZXhwb3J0IGZ1bmN0aW9uICphbGxBcHBsaWNhYmxlSXRlbXNFZmZlY3RzKGRvY3VtZW50OiBTUjZBY3RvcnxTUjZJdGVtLCBvcHRpb25zOiBBcHBsaWNhYmxlSXRlbUVmZmVjdE9wdGlvbnMgPSB7fSkge1xuICAgMTU5XHQgICAgY29uc3QgYXBwbHlUbyA9IG9wdGlvbnMuYXBwbHlUbyA/PyBbXTtcbiAgIDE2MFx0ICAgIGNvbnN0IG5lc3RlZEl0ZW1zID0gb3B0aW9ucy5uZXN0ZWRJdGVtcyA/PyB0cnVlO1xuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3Rlc3RzL1JhbmdlZEF0dGFja1Rlc3QudHNcbi4uLlxuICAgIDYxXHRcbiAgICA2Mlx0ICAgICAgICBpZih0aGlzLmFjdG9yKSB7XG4gICAgNjNcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBQcm9jZXNzaW5nIHRhcmdldHMgZm9yIGFjdG9yOicsIHRoaXMuYWN0b3IubmFtZSk7XG4gICAgNjRcdFxuICAgIDY1XHQgICAgICAgICAgICAvLyBNYXAgdGFyZ2V0cyB0byBkZWZlbmRlcnMgd2l0aCB0aGVpciBhY3R1YWwgRFIgdmFsdWVzXG4gICAgNjZcdCAgICAgICAgICAgIGRhdGEuZGVmZW5kZXJzID0gdGFyZ2V0cy5tYXAodG9rZW4gPT4ge1xuICAgIDY3XHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSB8IFByb2Nlc3NpbmcgdGFyZ2V0IHRva2VuOicsIHRva2VuLm5hbWUpO1xuICAgIDY4XHRcbiAgICA2OVx0ICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEFjdG9yID0gdG9rZW4uYWN0b3I7XG4gICAgNzBcdCAgICAgICAgICAgICAgICBsZXQgZHIgPSA1OyAvLyBkZWZhdWx0IERSXG4gICAgNzFcdFxuICAgIDcyXHQgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXRBY3Rvcikge1xuICAgIDczXHQgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBObyBhY3RvciBmb3VuZCBmb3IgdG9rZW46JywgdG9rZW4ubmFtZSk7XG4gICAgNzRcdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgNzVcdCAgICAgICAgICAgICAgICB9XG4gICAgNzZcdFxuICAgIDc3XHQgICAgICAgICAgICAgICAgaWYgKCEodGFyZ2V0QWN0b3IgaW5zdGFuY2VvZiBTUjZBY3RvcikpIHtcbiAgICA3OFx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2hhZG93cnVuIDZlIHwgQWN0b3IgaXMgbm90IFNSNkFjdG9yOicsIHRva2VuLm5hbWUpO1xuICAgIDc5XHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgIDgwXHQgICAgICAgICAgICAgICAgfVxuICAgIDgxXHRcbiAgICA4Mlx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBQcm9jZXNzaW5nIFNSNkFjdG9yIHRhcmdldDonLCB7XG4gICAgODNcdCAgICAgICAgICAgICAgICAgICAgbmFtZTogdGFyZ2V0QWN0b3IubmFtZSxcbiAgICA4NFx0ICAgICAgICAgICAgICAgICAgICB0eXBlOiB0YXJnZXRBY3Rvci50eXBlLFxuICAgIDg1XHQgICAgICAgICAgICAgICAgICAgIGhhc1N5c3RlbTogISF0YXJnZXRBY3Rvci5zeXN0ZW0sXG4gICAgODZcdCAgICAgICAgICAgICAgICAgICAgaGFzQXR0cmlidXRlczogISF0YXJnZXRBY3Rvci5zeXN0ZW0/LmF0dHJpYnV0ZXNcbiAgICA4N1x0ICAgICAgICAgICAgICAgIH0pO1xuLi4uXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFKNUNWb2pNNUFGcDQxcFNYRlM3dll3In19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozMzowMC4wMjNaIiwicmVzcG9uc2VfdGV4dCI6Ik5vdyBJIGhhdmUgYSBnb29kIHVuZGVyc3RhbmRpbmcgb2YgdGhlIGlzc3VlLiBMZXQgbWUgY3JlYXRlIGEgZGV0YWlsZWQgcGxhbiB0byBmaXggdGhlIHByb2JsZW0uXG5cbiMjIEFuYWx5c2lzXG5cbkJhc2VkIG9uIG15IGludmVzdGlnYXRpb24sIEkndmUgaWRlbnRpZmllZCBzZXZlcmFsIHBvdGVudGlhbCBpc3N1ZXMgdGhhdCBjb3VsZCBjYXVzZSBcImFjdG9ycyBub3QgZXhpc3RpbmdcIiBlcnJvcnMgd2hlbiBsb2FkaW5nIHRoZSBnYW1lOlxuXG4xLiAqKk1hdHJpeCBBY3Rpb25zIEluaXRpYWxpemF0aW9uKio6IEluIGBTUjZBY3Rvci50c2AgbGluZSAzMTktMzI2LCB0aGUgY29kZSBhdXRvbWF0aWNhbGx5IHRyaWVzIHRvIGFkZCBtYXRyaXggYWN0aW9ucyB0byBhY3RvcnMgZHVyaW5nIGRhdGEgcHJlcGFyYXRpb24sIGJ1dCB0aGlzIGhhcHBlbnMgd2l0aCBhIHNldFRpbWVvdXQgd2hpY2ggY291bGQgY2F1c2UgcmFjZSBjb25kaXRpb25zLlxuXG4yLiAqKlRva2VuIFByb2Nlc3NpbmcgaW4gSG9va3MqKjogSW4gYGhvb2tzLnRzYCBsaW5lIDQ1NCwgdGhlcmUncyBjb2RlIHRoYXQgZmlsdGVycyB0b2tlbnMgYW5kIGFjY2Vzc2VzIGB0b2tlbi5hY3RvcmAgd2l0aCBvcHRpb25hbCBjaGFpbmluZyAoYD8uYCksIGJ1dCB0aGVuIG1hcHMgdG8gYHQuYWN0b3JgIHdpdGhvdXQgbnVsbCBjaGVja2luZywgd2hpY2ggY291bGQgcmVzdWx0IGluIG51bGwvdW5kZWZpbmVkIGFjdG9ycyBpbiB0aGUgYXJyYXkuXG5cbjMuICoqTWlzc2luZyBOdWxsIENoZWNrcyoqOiBTZXZlcmFsIHBsYWNlcyBpbiB0aGUgY29kZSBhY2Nlc3MgYHRva2VuLmFjdG9yYCB3aXRob3V0IHByb3BlciBudWxsIGNoZWNrcywgcGFydGljdWxhcmx5IGluIGhlbHBlciBmdW5jdGlvbnMgYW5kIHRhcmdldGluZyBjb2RlLlxuXG4jIyBQbGFuXG5cbkknbGwgZml4IHRoZXNlIGlzc3VlcyBieTpcblxuMS4gKipGaXggdGhlIGhvb2tzLnRzIHRva2VuIHByb2Nlc3NpbmcqKiB0byBwcm9wZXJseSBmaWx0ZXIgb3V0IHRva2VucyB3aXRob3V0IGFjdG9yc1xuMi4gKipBZGQgYmV0dGVyIGVycm9yIGhhbmRsaW5nKiogaW4gdGhlIG1hdHJpeCBhY3Rpb25zIGluaXRpYWxpemF0aW9uIFxuMy4gKipBZGQgbnVsbCBjaGVja3MqKiBpbiBvdGhlciBwbGFjZXMgd2hlcmUgdG9rZW4uYWN0b3IgaXMgYWNjZXNzZWRcbjQuICoqSW1wcm92ZSB0aGUgbWF0cml4IGFjdGlvbnMgdGltaW5nKiogdG8gYXZvaWQgcmFjZSBjb25kaXRpb25zIGR1cmluZyBpbml0aWFsaXphdGlvblxuXG5MZXQgbWUgc3RhcnQgaW1wbGVtZW50aW5nIHRoZXNlIGZpeGVzOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6ImEzYjQxNTBkLWRiNjYtNDc5NC05OGUxLTdlMTc1Yjc5ZDI5NSIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVkxVXJESEZ4dE1McFlqWW5KVXdvQVciLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInN0cl9yZXBsYWNlXCIsIFwicGF0aFwiOiBcInNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHNcIiwgXCJzdHJfcmVwbGFjZV9lbnRyaWVzXCI6IFt7XCJvbGRfc3RyXCI6IFwiICAgICAgICAvLyBFbnN1cmUgbWF0cml4IGFjdGlvbnMgYXJlIGF2YWlsYWJsZSBmb3IgYWxsIGFjdG9ycyB0aGF0IGNhbiB1c2UgdGhlIE1hdHJpeFxcbiAgICAgICAgaWYgKGdhbWUudXNlcj8uaXNHTSAmJiB0aGlzLmlzT3duZXIgJiYgKHRoaXMuaXNDaGFyYWN0ZXIoKSB8fCB0aGlzLmlzU3ByaXRlKCkgfHwgdGhpcy5pc0lDKCkpKSB7XFxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXFxuICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XFxuICAgICAgICAgICAgaWYgKCFoYXNNYXRyaXhBY3Rpb25zKSB7XFxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gdXNlIGEgc2V0VGltZW91dCB0byBhdm9pZCBpc3N1ZXMgd2l0aCB0aGUgYWN0b3IgYmVpbmcgbG9ja2VkIGR1cmluZyBkYXRhIHByZXBhcmF0aW9uXFxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCksIDUwMCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVwiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogMzE4LCBcIm9sZF9zdHJfZW5kX2xpbmVfbnVtYmVyXCI6IDMyNiwgXCJuZXdfc3RyXCI6IFwiICAgICAgICAvLyBFbnN1cmUgbWF0cml4IGFjdGlvbnMgYXJlIGF2YWlsYWJsZSBmb3IgYWxsIGFjdG9ycyB0aGF0IGNhbiB1c2UgdGhlIE1hdHJpeFxcbiAgICAgICAgaWYgKGdhbWUudXNlcj8uaXNHTSAmJiB0aGlzLmlzT3duZXIgJiYgKHRoaXMuaXNDaGFyYWN0ZXIoKSB8fCB0aGlzLmlzU3ByaXRlKCkgfHwgdGhpcy5pc0lDKCkpKSB7XFxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXFxuICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XFxuICAgICAgICAgICAgaWYgKCFoYXNNYXRyaXhBY3Rpb25zKSB7XFxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gdXNlIGEgc2V0VGltZW91dCB0byBhdm9pZCBpc3N1ZXMgd2l0aCB0aGUgYWN0b3IgYmVpbmcgbG9ja2VkIGR1cmluZyBkYXRhIHByZXBhcmF0aW9uXFxuICAgICAgICAgICAgICAgIC8vIEFsc28gYWRkIGVycm9yIGhhbmRsaW5nIHRvIHByZXZlbnQgY3Jhc2hlcyBkdXJpbmcgaW5pdGlhbGl6YXRpb25cXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XFxuICAgICAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5zdXJlTWF0cml4QWN0aW9ucygpO1xcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IEZhaWxlZCB0byBlbnN1cmUgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH0sIDUwMCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVwifV19IiwibWNwX3NlcnZlcl9uYW1lIjoiIiwibWNwX3Rvb2xfbmFtZSI6IiJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTm93IGxldCBtZSBmaXggdGhlIG1hdHJpeCBhY3Rpb25zIGluaXRpYWxpemF0aW9uIHRvIGJlIG1vcmUgcm9idXN0IGFuZCBhdm9pZCByYWNlIGNvbmRpdGlvbnM6XG4ifSx7ImlkIjoyLCJ0eXBlIjoyLCJjb250ZW50IjoiIn0seyJpZCI6MywidHlwZSI6MywiY29udGVudCI6IiJ9XSwic2Vlbl9zdGF0ZSI6InNlZW4iLCJzdHJ1Y3R1cmVkX3JlcXVlc3Rfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjoxLCJ0b29sX3Jlc3VsdF9ub2RlIjp7ImNvbnRlbnQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tb2R1bGUvaG9va3MudHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlIGZvciBlbnRyeSB3aXRoIGluZGV4IFswXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgNDQzXHQgICAgICovXG4gICA0NDRcdCAgICBzdGF0aWMgYXN5bmMgdXBkYXRlSWNDb25uZWN0ZWRUb0hvc3RJdGVtKGl0ZW06IFNSNkl0ZW0sIGRhdGE6IFNoYWRvd3J1bi5TaGFkb3dydW5JdGVtRGF0YURhdGEsIGlkOiBzdHJpbmcpIHtcbiAgIDQ0NVx0ICAgICAgICBpZiAoIWNhbnZhcy5yZWFkeSB8fCAhZ2FtZS5hY3RvcnMpIHJldHVybjtcbiAgIDQ0Nlx0XG4gICA0NDdcdCAgICAgICAgaWYgKGl0ZW0uaXNIb3N0KSB7XG4gICA0NDhcdCAgICAgICAgICAgIC8vIENvbGxlY3QgYWN0b3JzIGZyb20gc2lkZWJhciBhbmQgYWN0aXZlIHNjZW5lIHRvIHVwZGF0ZSAvIHJlcmVuZGVyXG4gICA0NDlcdCAgICAgICAgICAgIGxldCBjb25uZWN0ZWRJQyA9IFtcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIC8vIEFsbCBzaWRlYmFyIGFjdG9ycyBzaG91bGQgYWxzbyBpbmNsdWRlIHRva2VucyB3aXRoIGxpbmtlZCBhY3RvcnMuXG4gICA0NTFcdCAgICAgICAgICAgICAgICAuLi5nYW1lLmFjdG9ycy5maWx0ZXIoKGFjdG9yOiBTUjZBY3RvcikgPT4gYWN0b3IuaXNJQygpICYmIGFjdG9yLmhhc0hvc3QoKSkgYXMgU1I2QWN0b3JbXSxcbiAgIDQ1Mlx0ICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxuICAgNDUzXHQgICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgIDQ1NFx0ICAgICAgICAgICAgICAgIC4uLmNhbnZhcy5zY2VuZS50b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0b2tlbi5hY3RvckxpbmsgJiYgdG9rZW4uYWN0b3I/LmlzSUMoKSAmJiB0b2tlbi5hY3Rvcj8uaGFzSG9zdCgpKS5tYXAodCA9PiB0LmFjdG9yKS5maWx0ZXIoYWN0b3IgPT4gYWN0b3IgIT09IG51bGwgJiYgYWN0b3IgIT09IHVuZGVmaW5lZClcbiAgIDQ1NVx0ICAgICAgICAgICAgXTtcbiAgIDQ1Nlx0XG4gICA0NTdcdCAgICAgICAgICAgIC8vIFVwZGF0ZSBob3N0IGRhdGEgb24gdGhlIGljIGFjdG9yLlxuICAgNDU4XHQgICAgICAgICAgICBjb25zdCBob3N0ID0gaXRlbS5hc0hvc3Q7XG4gICA0NTlcdCAgICAgICAgICAgIGlmICghaG9zdCkgcmV0dXJuO1xuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFEQktSaFNhaDJ2dzlmOWt1MWs0TFhZIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozMzoxMi4wOTRaIiwicmVzcG9uc2VfdGV4dCI6Ik5vdyBsZXQgbWUgZml4IHRoZSBtYXRyaXggYWN0aW9ucyBpbml0aWFsaXphdGlvbiB0byBiZSBtb3JlIHJvYnVzdCBhbmQgYXZvaWQgcmFjZSBjb25kaXRpb25zOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6ImY0ODFlMzE3LWE5NDAtNDg3Ni1iZDUxLTMyMTI1NTc3Yzg2MyIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVhLTXJ0YWZMYmZyUlNSQW1vUmFoQVEiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInZpZXdcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50c1wiLCBcInZpZXdfcmFuZ2VcIjogWzI3NDAsIDI4MDBdfSIsIm1jcF9zZXJ2ZXJfbmFtZSI6IiIsIm1jcF90b29sX25hbWUiOiIifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6Ik5vdyBsZXQgbWUgaW1wcm92ZSB0aGUgYGVuc3VyZU1hdHJpeEFjdGlvbnNgIG1ldGhvZCB0byBiZSBtb3JlIHJvYnVzdDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAzMTRcdCAgICAgICAgICAgICAgICBJQ1ByZXAucHJlcGFyZURlcml2ZWREYXRhKHRoaXMuc3lzdGVtLCBpdGVtRGF0YVdyYXBwZXJzKTtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgMzE2XHQgICAgICAgIH1cbiAgIDMxN1x0XG4gICAzMThcdCAgICAgICAgLy8gRW5zdXJlIG1hdHJpeCBhY3Rpb25zIGFyZSBhdmFpbGFibGUgZm9yIGFsbCBhY3RvcnMgdGhhdCBjYW4gdXNlIHRoZSBNYXRyaXhcbiAgIDMxOVx0ICAgICAgICBpZiAoZ2FtZS51c2VyPy5pc0dNICYmIHRoaXMuaXNPd25lciAmJiAodGhpcy5pc0NoYXJhY3RlcigpIHx8IHRoaXMuaXNTcHJpdGUoKSB8fCB0aGlzLmlzSUMoKSkpIHtcbiAgIDMyMFx0ICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXG4gICAzMjFcdCAgICAgICAgICAgIGNvbnN0IGhhc01hdHJpeEFjdGlvbnMgPSB0aGlzLmdldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycpO1xuICAgMzIyXHQgICAgICAgICAgICBpZiAoIWhhc01hdHJpeEFjdGlvbnMpIHtcbiAgIDMyM1x0ICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gdXNlIGEgc2V0VGltZW91dCB0byBhdm9pZCBpc3N1ZXMgd2l0aCB0aGUgYWN0b3IgYmVpbmcgbG9ja2VkIGR1cmluZyBkYXRhIHByZXBhcmF0aW9uXG4gICAzMjRcdCAgICAgICAgICAgICAgICAvLyBBbHNvIGFkZCBlcnJvciBoYW5kbGluZyB0byBwcmV2ZW50IGNyYXNoZXMgZHVyaW5nIGluaXRpYWxpemF0aW9uXG4gICAzMjVcdCAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgIDMyNlx0ICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgMzI3XHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuc3VyZU1hdHJpeEFjdGlvbnMoKTtcbiAgIDMyOFx0ICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgMzI5XHQgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IEZhaWxlZCB0byBlbnN1cmUgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XG4gICAzMzBcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgMzMxXHQgICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgIDMzMlx0ICAgICAgICAgICAgfVxuICAgMzMzXHQgICAgICAgIH1cbiAgIDMzNFx0ICAgIH1cbiAgIDMzNVx0XG4gICAzMzZcdCAgICAvKipcbiAgIDMzN1x0ICAgICAqIE5PVEU6IFRoaXMgbWV0aG9kIGlzIHVudXNlZCBhdCB0aGUgbW9tZW50LCBrZWVwIGl0IGZvciBmdXR1cmUgaW5zcGlyYXRpb24uXG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVkxVXJESEZ4dE1McFlqWW5KVXdvQVcifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0iLCJmb2xkZXJSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjEyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9fX1dLCJ0aW1lc3RhbXAiOiIyMDI1LTA1LTI5VDIzOjMzOjE5LjkxNFoiLCJyZXNwb25zZV90ZXh0IjoiTm93IGxldCBtZSBpbXByb3ZlIHRoZSBgZW5zdXJlTWF0cml4QWN0aW9uc2AgbWV0aG9kIHRvIGJlIG1vcmUgcm9idXN0OlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjY3ODBjZmU4LTNkODItNDVkYS04ODE1LTFiZTc4ZjU2Yzg1ZCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVdFWWFOZW9mTUNYNDlDVXpFelppZU4iLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInN0cl9yZXBsYWNlXCIsIFwicGF0aFwiOiBcInNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHNcIiwgXCJzdHJfcmVwbGFjZV9lbnRyaWVzXCI6IFt7XCJvbGRfc3RyXCI6IFwiICAgIGFzeW5jIGVuc3VyZU1hdHJpeEFjdGlvbnMoKSB7XFxuICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgRW5zdXJpbmcgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfSAoJHt0aGlzLmlkfSlgKTtcXG5cXG4gICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxcbiAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XFxuICAgICAgICBpZiAoaGFzTWF0cml4QWN0aW9ucykge1xcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCAke3RoaXMubmFtZX0gYWxyZWFkeSBoYXMgbWF0cml4IGFjdGlvbnMgZmxhZyBzZXRgKTtcXG4gICAgICAgICAgICByZXR1cm47XFxuICAgICAgICB9XFxuXFxuICAgICAgICAvLyBHZXQgdGhlIG1hdHJpeCBhY3Rpb25zIGNvbXBlbmRpdW1cXG4gICAgICAgIGNvbnN0IG1hdHJpeFBhY2sgPSBnYW1lLnBhY2tzLmdldChcXFwic3I2ZWx5c2l1bS5tYXRyaXgtYWN0aW9uc1xcXCIpO1xcbiAgICAgICAgaWYgKCFtYXRyaXhQYWNrKSB7XFxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcXFwiU2hhZG93cnVuIDZlIHwgTWF0cml4IEFjdGlvbnMgY29tcGVuZGl1bSBub3QgZm91bmRcXFwiKTtcXG4gICAgICAgICAgICByZXR1cm47XFxuICAgICAgICB9XFxuXFxuICAgICAgICAvLyBHZXQgYWxsIG1hdHJpeCBhY3Rpb25zXFxuICAgICAgICBhd2FpdCBtYXRyaXhQYWNrLmdldEluZGV4KCk7XFxuICAgICAgICBjb25zdCBtYXRyaXhBY3Rpb25zID0gYXdhaXQgUHJvbWlzZS5hbGwoXFxuICAgICAgICAgICAgQXJyYXkuZnJvbShtYXRyaXhQYWNrLmluZGV4KS5tYXAoaSA9PiBtYXRyaXhQYWNrLmdldERvY3VtZW50KGkuX2lkKSlcXG4gICAgICAgICk7XFxuXFxuICAgICAgICAvLyBHZXQgZXhpc3RpbmcgYWN0aW9uIG5hbWVzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nTmFtZXMgPSB0aGlzLml0ZW1zXFxuICAgICAgICAgICAgLmZpbHRlcihpID0+IGkudHlwZSA9PT0gXFxcImFjdGlvblxcXCIpXFxuICAgICAgICAgICAgLm1hcChpID0+IGkubmFtZS50b0xvd2VyQ2FzZSgpKTtcXG5cXG4gICAgICAgIC8vIEZpbHRlciBvdXQgYWN0aW9ucyB0aGUgYWN0b3IgYWxyZWFkeSBoYXNcXG4gICAgICAgIGNvbnN0IGFjdGlvbnNUb0FkZCA9IG1hdHJpeEFjdGlvbnMuZmlsdGVyKFxcbiAgICAgICAgICAgIGEgPT4gIWV4aXN0aW5nTmFtZXMuaW5jbHVkZXMoYS5uYW1lLnRvTG93ZXJDYXNlKCkpXFxuICAgICAgICApO1xcblxcbiAgICAgICAgaWYgKGFjdGlvbnNUb0FkZC5sZW5ndGggPT09IDApIHtcXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIGFsbCBtYXRyaXggYWN0aW9uc2ApO1xcbiAgICAgICAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IHdlJ3ZlIGNoZWNrZWQgZm9yIG1hdHJpeCBhY3Rpb25zXFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcXG4gICAgICAgICAgICByZXR1cm47XFxuICAgICAgICB9XFxuXFxuICAgICAgICAvLyBBZGQgdGhlIGFjdGlvbnNcXG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRW1iZWRkZWREb2N1bWVudHMoXFxuICAgICAgICAgICAgXFxcIkl0ZW1cXFwiLFxcbiAgICAgICAgICAgIGFjdGlvbnNUb0FkZC5tYXAoYSA9PiBhLnRvT2JqZWN0KCkpXFxuICAgICAgICApO1xcblxcbiAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEFkZGVkICR7YWN0aW9uc1RvQWRkLmxlbmd0aH0gbWF0cml4IGFjdGlvbnMgdG8gJHt0aGlzLm5hbWV9YCk7XFxuXFxuICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBhZGRlZCBtYXRyaXggYWN0aW9uc1xcbiAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcIiwgXCJvbGRfc3RyX3N0YXJ0X2xpbmVfbnVtYmVyXCI6IDI3NTEsIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogMjgwMCwgXCJuZXdfc3RyXCI6IFwiICAgIGFzeW5jIGVuc3VyZU1hdHJpeEFjdGlvbnMoKSB7XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBFbnN1cmluZyBtYXRyaXggYWN0aW9ucyBmb3IgYWN0b3IgJHt0aGlzLm5hbWV9ICgke3RoaXMuaWR9KWApO1xcblxcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGFjdG9yIHN0aWxsIGV4aXN0cyBhbmQgaXMgdmFsaWRcXG4gICAgICAgICAgICBpZiAoIXRoaXMuaWQgfHwgIXRoaXMubmFtZSkge1xcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IEFjdG9yIGlzIGludmFsaWQsIHNraXBwaW5nIG1hdHJpeCBhY3Rpb25zIGluaXRpYWxpemF0aW9uYCk7XFxuICAgICAgICAgICAgICAgIHJldHVybjtcXG4gICAgICAgICAgICB9XFxuXFxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXFxuICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XFxuICAgICAgICAgICAgaWYgKGhhc01hdHJpeEFjdGlvbnMpIHtcXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8ICR7dGhpcy5uYW1lfSBhbHJlYWR5IGhhcyBtYXRyaXggYWN0aW9ucyBmbGFnIHNldGApO1xcbiAgICAgICAgICAgICAgICByZXR1cm47XFxuICAgICAgICAgICAgfVxcblxcbiAgICAgICAgICAgIC8vIEdldCB0aGUgbWF0cml4IGFjdGlvbnMgY29tcGVuZGl1bVxcbiAgICAgICAgICAgIGNvbnN0IG1hdHJpeFBhY2sgPSBnYW1lLnBhY2tzLmdldChcXFwic3I2ZWx5c2l1bS5tYXRyaXgtYWN0aW9uc1xcXCIpO1xcbiAgICAgICAgICAgIGlmICghbWF0cml4UGFjaykge1xcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFxcXCJTaGFkb3dydW4gNmUgfCBNYXRyaXggQWN0aW9ucyBjb21wZW5kaXVtIG5vdCBmb3VuZFxcXCIpO1xcbiAgICAgICAgICAgICAgICByZXR1cm47XFxuICAgICAgICAgICAgfVxcblxcbiAgICAgICAgICAgIC8vIEdldCBhbGwgbWF0cml4IGFjdGlvbnNcXG4gICAgICAgICAgICBhd2FpdCBtYXRyaXhQYWNrLmdldEluZGV4KCk7XFxuICAgICAgICAgICAgY29uc3QgbWF0cml4QWN0aW9ucyA9IGF3YWl0IFByb21pc2UuYWxsKFxcbiAgICAgICAgICAgICAgICBBcnJheS5mcm9tKG1hdHJpeFBhY2suaW5kZXgpLm1hcChpID0+IG1hdHJpeFBhY2suZ2V0RG9jdW1lbnQoaS5faWQpKVxcbiAgICAgICAgICAgICk7XFxuXFxuICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBudWxsL3VuZGVmaW5lZCBhY3Rpb25zXFxuICAgICAgICAgICAgY29uc3QgdmFsaWRNYXRyaXhBY3Rpb25zID0gbWF0cml4QWN0aW9ucy5maWx0ZXIoYWN0aW9uID0+IGFjdGlvbiAmJiBhY3Rpb24ubmFtZSk7XFxuICAgICAgICAgICAgaWYgKHZhbGlkTWF0cml4QWN0aW9ucy5sZW5ndGggPT09IDApIHtcXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBTaGFkb3dydW4gNmUgfCBObyB2YWxpZCBtYXRyaXggYWN0aW9ucyBmb3VuZCBpbiBjb21wZW5kaXVtYCk7XFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XFxuICAgICAgICAgICAgICAgIHJldHVybjtcXG4gICAgICAgICAgICB9XFxuXFxuICAgICAgICAgICAgLy8gR2V0IGV4aXN0aW5nIGFjdGlvbiBuYW1lcyB0byBhdm9pZCBkdXBsaWNhdGVzXFxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdOYW1lcyA9IHRoaXMuaXRlbXNcXG4gICAgICAgICAgICAgICAgLmZpbHRlcihpID0+IGkgJiYgaS50eXBlID09PSBcXFwiYWN0aW9uXFxcIiAmJiBpLm5hbWUpXFxuICAgICAgICAgICAgICAgIC5tYXAoaSA9PiBpLm5hbWUudG9Mb3dlckNhc2UoKSk7XFxuXFxuICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBhY3Rpb25zIHRoZSBhY3RvciBhbHJlYWR5IGhhc1xcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbnNUb0FkZCA9IHZhbGlkTWF0cml4QWN0aW9ucy5maWx0ZXIoXFxuICAgICAgICAgICAgICAgIGEgPT4gYSAmJiBhLm5hbWUgJiYgIWV4aXN0aW5nTmFtZXMuaW5jbHVkZXMoYS5uYW1lLnRvTG93ZXJDYXNlKCkpXFxuICAgICAgICAgICAgKTtcXG5cXG4gICAgICAgICAgICBpZiAoYWN0aW9uc1RvQWRkLmxlbmd0aCA9PT0gMCkge1xcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIGFsbCBtYXRyaXggYWN0aW9uc2ApO1xcbiAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBjaGVja2VkIGZvciBtYXRyaXggYWN0aW9uc1xcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycsIHRydWUpO1xcbiAgICAgICAgICAgICAgICByZXR1cm47XFxuICAgICAgICAgICAgfVxcblxcbiAgICAgICAgICAgIC8vIEFkZCB0aGUgYWN0aW9uc1xcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRW1iZWRkZWREb2N1bWVudHMoXFxuICAgICAgICAgICAgICAgIFxcXCJJdGVtXFxcIixcXG4gICAgICAgICAgICAgICAgYWN0aW9uc1RvQWRkLm1hcChhID0+IGEudG9PYmplY3QoKSlcXG4gICAgICAgICAgICApO1xcblxcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBBZGRlZCAke2FjdGlvbnNUb0FkZC5sZW5ndGh9IG1hdHJpeCBhY3Rpb25zIHRvICR7dGhpcy5uYW1lfWApO1xcblxcbiAgICAgICAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IHdlJ3ZlIGFkZGVkIG1hdHJpeCBhY3Rpb25zXFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XFxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgU2hhZG93cnVuIDZlIHwgRXJyb3IgZW5zdXJpbmcgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XFxuICAgICAgICAgICAgLy8gU2V0IHRoZSBmbGFnIGFueXdheSB0byBwcmV2ZW50IHJlcGVhdGVkIGF0dGVtcHRzXFxuICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcXG4gICAgICAgICAgICB9IGNhdGNoIChmbGFnRXJyb3IpIHtcXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgU2hhZG93cnVuIDZlIHwgRmFpbGVkIHRvIHNldCBtYXRyaXggYWN0aW9ucyBmbGFnIGZvciAke3RoaXMubmFtZX06YCwgZmxhZ0Vycm9yKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XCJ9XX0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJMZXQgbWUgYWRkIGJldHRlciBlcnJvciBoYW5kbGluZyBhbmQgdmFsaWRhdGlvbiB0byB0aGUgYGVuc3VyZU1hdHJpeEFjdGlvbnNgIG1ldGhvZDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IkhlcmUncyB0aGUgcmVzdWx0IG9mIHJ1bm5pbmcgYGNhdCAtbmAgb24gc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50czpcbiAgMjc0MFx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBSZWZyZXNoZWQgdG9rZW4gc2hlZXQgJHtpZH0gZm9yICR7YXBwLnRva2VuLm5hbWV9YCk7XG4gIDI3NDFcdCAgICAgICAgICAgIH1cbiAgMjc0Mlx0ICAgICAgICB9XG4gIDI3NDNcdCAgICB9XG4gIDI3NDRcdFxuICAyNzQ1XHQgICAgLyoqXG4gIDI3NDZcdCAgICAgKiBFbnN1cmVzIHRoYXQgdGhlIGFjdG9yIGhhcyBhY2Nlc3MgdG8gYWxsIG1hdHJpeCBhY3Rpb25zIGZyb20gdGhlIG1hdHJpeC1hY3Rpb25zIGNvbXBlbmRpdW0uXG4gIDI3NDdcdCAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIGFkZCBhbnkgbWlzc2luZyBtYXRyaXggYWN0aW9ucyB0byB0aGUgYWN0b3IuXG4gIDI3NDhcdCAgICAgKlxuICAyNzQ5XHQgICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XG4gIDI3NTBcdCAgICAgKi9cbiAgMjc1MVx0ICAgIGFzeW5jIGVuc3VyZU1hdHJpeEFjdGlvbnMoKSB7XG4gIDI3NTJcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEVuc3VyaW5nIG1hdHJpeCBhY3Rpb25zIGZvciBhY3RvciAke3RoaXMubmFtZX0gKCR7dGhpcy5pZH0pYCk7XG4gIDI3NTNcdFxuICAyNzU0XHQgICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxuICAyNzU1XHQgICAgICAgIGNvbnN0IGhhc01hdHJpeEFjdGlvbnMgPSB0aGlzLmdldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycpO1xuICAyNzU2XHQgICAgICAgIGlmIChoYXNNYXRyaXhBY3Rpb25zKSB7XG4gIDI3NTdcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCAke3RoaXMubmFtZX0gYWxyZWFkeSBoYXMgbWF0cml4IGFjdGlvbnMgZmxhZyBzZXRgKTtcbiAgMjc1OFx0ICAgICAgICAgICAgcmV0dXJuO1xuICAyNzU5XHQgICAgICAgIH1cbiAgMjc2MFx0XG4gIDI3NjFcdCAgICAgICAgLy8gR2V0IHRoZSBtYXRyaXggYWN0aW9ucyBjb21wZW5kaXVtXG4gIDI3NjJcdCAgICAgICAgY29uc3QgbWF0cml4UGFjayA9IGdhbWUucGFja3MuZ2V0KFwic3I2ZWx5c2l1bS5tYXRyaXgtYWN0aW9uc1wiKTtcbiAgMjc2M1x0ICAgICAgICBpZiAoIW1hdHJpeFBhY2spIHtcbiAgMjc2NFx0ICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlNoYWRvd3J1biA2ZSB8IE1hdHJpeCBBY3Rpb25zIGNvbXBlbmRpdW0gbm90IGZvdW5kXCIpO1xuICAyNzY1XHQgICAgICAgICAgICByZXR1cm47XG4gIDI3NjZcdCAgICAgICAgfVxuICAyNzY3XHRcbiAgMjc2OFx0ICAgICAgICAvLyBHZXQgYWxsIG1hdHJpeCBhY3Rpb25zXG4gIDI3NjlcdCAgICAgICAgYXdhaXQgbWF0cml4UGFjay5nZXRJbmRleCgpO1xuICAyNzcwXHQgICAgICAgIGNvbnN0IG1hdHJpeEFjdGlvbnMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgMjc3MVx0ICAgICAgICAgICAgQXJyYXkuZnJvbShtYXRyaXhQYWNrLmluZGV4KS5tYXAoaSA9PiBtYXRyaXhQYWNrLmdldERvY3VtZW50KGkuX2lkKSlcbiAgMjc3Mlx0ICAgICAgICApO1xuICAyNzczXHRcbiAgMjc3NFx0ICAgICAgICAvLyBHZXQgZXhpc3RpbmcgYWN0aW9uIG5hbWVzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcbiAgMjc3NVx0ICAgICAgICBjb25zdCBleGlzdGluZ05hbWVzID0gdGhpcy5pdGVtc1xuICAyNzc2XHQgICAgICAgICAgICAuZmlsdGVyKGkgPT4gaS50eXBlID09PSBcImFjdGlvblwiKVxuICAyNzc3XHQgICAgICAgICAgICAubWFwKGkgPT4gaS5uYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAyNzc4XHRcbiAgMjc3OVx0ICAgICAgICAvLyBGaWx0ZXIgb3V0IGFjdGlvbnMgdGhlIGFjdG9yIGFscmVhZHkgaGFzXG4gIDI3ODBcdCAgICAgICAgY29uc3QgYWN0aW9uc1RvQWRkID0gbWF0cml4QWN0aW9ucy5maWx0ZXIoXG4gIDI3ODFcdCAgICAgICAgICAgIGEgPT4gIWV4aXN0aW5nTmFtZXMuaW5jbHVkZXMoYS5uYW1lLnRvTG93ZXJDYXNlKCkpXG4gIDI3ODJcdCAgICAgICAgKTtcbiAgMjc4M1x0XG4gIDI3ODRcdCAgICAgICAgaWYgKGFjdGlvbnNUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgMjc4NVx0ICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8ICR7dGhpcy5uYW1lfSBhbHJlYWR5IGhhcyBhbGwgbWF0cml4IGFjdGlvbnNgKTtcbiAgMjc4Nlx0ICAgICAgICAgICAgLy8gU2V0IHRoZSBmbGFnIHRvIGluZGljYXRlIHRoYXQgd2UndmUgY2hlY2tlZCBmb3IgbWF0cml4IGFjdGlvbnNcbiAgMjc4N1x0ICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcbiAgMjc4OFx0ICAgICAgICAgICAgcmV0dXJuO1xuICAyNzg5XHQgICAgICAgIH1cbiAgMjc5MFx0XG4gIDI3OTFcdCAgICAgICAgLy8gQWRkIHRoZSBhY3Rpb25zXG4gIDI3OTJcdCAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVFbWJlZGRlZERvY3VtZW50cyhcbiAgMjc5M1x0ICAgICAgICAgICAgXCJJdGVtXCIsXG4gIDI3OTRcdCAgICAgICAgICAgIGFjdGlvbnNUb0FkZC5tYXAoYSA9PiBhLnRvT2JqZWN0KCkpXG4gIDI3OTVcdCAgICAgICAgKTtcbiAgMjc5Nlx0XG4gIDI3OTdcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEFkZGVkICR7YWN0aW9uc1RvQWRkLmxlbmd0aH0gbWF0cml4IGFjdGlvbnMgdG8gJHt0aGlzLm5hbWV9YCk7XG4gIDI3OThcdFxuICAyNzk5XHQgICAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IHdlJ3ZlIGFkZGVkIG1hdHJpeCBhY3Rpb25zXG4gIDI4MDBcdCAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcblRvdGFsIGxpbmVzIGluIGZpbGU6IDMwMzhcbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVhLTXJ0YWZMYmZyUlNSQW1vUmFoQVEifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0iLCJmb2xkZXJSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjEyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9fX1dLCJ0aW1lc3RhbXAiOiIyMDI1LTA1LTI5VDIzOjMzOjIzLjE0N1oiLCJyZXNwb25zZV90ZXh0IjoiTGV0IG1lIGFkZCBiZXR0ZXIgZXJyb3IgaGFuZGxpbmcgYW5kIHZhbGlkYXRpb24gdG8gdGhlIGBlbnN1cmVNYXRyaXhBY3Rpb25zYCBtZXRob2Q6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiYjZmZGI3MTEtZWIwNC00YWQ0LTlhYTQtMjZlNTQ0OTNlYjA5IiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxTjhHdXlyQkVudDFEUTJHeE4xaDlpVCIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwic3RyX3JlcGxhY2VcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9oZWxwZXJzLnRzXCIsIFwic3RyX3JlcGxhY2VfZW50cmllc1wiOiBbe1wib2xkX3N0clwiOiBcIiAgICAvKipcXG4gICAgICogUmV0dXJuIGFsbCBhY3RvcnMgY29ubmVjdGVkIHRvIGFsbCB1c2VyIGNvbnRyb2xsZWQgdG9rZW5zLlxcbiAgICAgKiBAcmV0dXJucyBBbiBhcnJheSB0b2tlbiBhY3RvcnMuXFxuICAgICAqL1xcbiAgICBzdGF0aWMgZ2V0Q29udHJvbGxlZFRva2VuQWN0b3JzKCk6IFNSNkFjdG9yW10ge1xcbiAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5yZWFkeSkgcmV0dXJuIFtdXFxuXFxuICAgICAgICBjb25zdCB0b2tlbnMgPSBIZWxwZXJzLmdldENvbnRyb2xsZWRUb2tlbnMoKTtcXG4gICAgICAgIHJldHVybiB0b2tlbnMubWFwKHRva2VuID0+IHRva2VuLmFjdG9yKSBhcyBTUjZBY3RvcltdO1xcbiAgICB9XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiA0NTYsIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogNDY1LCBcIm5ld19zdHJcIjogXCIgICAgLyoqXFxuICAgICAqIFJldHVybiBhbGwgYWN0b3JzIGNvbm5lY3RlZCB0byBhbGwgdXNlciBjb250cm9sbGVkIHRva2Vucy5cXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgdG9rZW4gYWN0b3JzLlxcbiAgICAgKi9cXG4gICAgc3RhdGljIGdldENvbnRyb2xsZWRUb2tlbkFjdG9ycygpOiBTUjZBY3RvcltdIHtcXG4gICAgICAgIGlmICghY2FudmFzIHx8ICFjYW52YXMucmVhZHkpIHJldHVybiBbXVxcblxcbiAgICAgICAgY29uc3QgdG9rZW5zID0gSGVscGVycy5nZXRDb250cm9sbGVkVG9rZW5zKCk7XFxuICAgICAgICByZXR1cm4gdG9rZW5zLm1hcCh0b2tlbiA9PiB0b2tlbi5hY3RvcikuZmlsdGVyKGFjdG9yID0+IGFjdG9yICE9PSBudWxsICYmIGFjdG9yICE9PSB1bmRlZmluZWQpIGFzIFNSNkFjdG9yW107XFxuICAgIH1cIn1dfSIsIm1jcF9zZXJ2ZXJfbmFtZSI6IiIsIm1jcF90b29sX25hbWUiOiIifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6Ik5vdyBsZXQgbWUgZml4IHRoZSBpc3N1ZSBpbiB0aGUgaGVscGVycy50cyBmaWxlIHdoZXJlIGBnZXRDb250cm9sbGVkVG9rZW5BY3RvcnNgIGRvZXNuJ3QgY2hlY2sgZm9yIG51bGwgYWN0b3JzOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZSBmb3IgZW50cnkgd2l0aCBpbmRleCBbMF06XG5SZXBsYWNlbWVudCBzdWNjZXNzZnVsLlxuRWRpdGVkIHNlY3Rpb24gYWZ0ZXIgSURFIGF1dG8tZm9ybWF0dGluZyB3YXMgYXBwbGllZDpcbiAgMjc0N1x0ICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgYWRkIGFueSBtaXNzaW5nIG1hdHJpeCBhY3Rpb25zIHRvIHRoZSBhY3Rvci5cbiAgMjc0OFx0ICAgICAqXG4gIDI3NDlcdCAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgMjc1MFx0ICAgICAqL1xuICAyNzUxXHQgICAgYXN5bmMgZW5zdXJlTWF0cml4QWN0aW9ucygpIHtcbiAgMjc1Mlx0ICAgICAgICB0cnkge1xuICAyNzUzXHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgRW5zdXJpbmcgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfSAoJHt0aGlzLmlkfSlgKTtcbiAgMjc1NFx0XG4gIDI3NTVcdCAgICAgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgdGhlIGFjdG9yIHN0aWxsIGV4aXN0cyBhbmQgaXMgdmFsaWRcbiAgMjc1Nlx0ICAgICAgICAgICAgaWYgKCF0aGlzLmlkIHx8ICF0aGlzLm5hbWUpIHtcbiAgMjc1N1x0ICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgU2hhZG93cnVuIDZlIHwgQWN0b3IgaXMgaW52YWxpZCwgc2tpcHBpbmcgbWF0cml4IGFjdGlvbnMgaW5pdGlhbGl6YXRpb25gKTtcbiAgMjc1OFx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgMjc1OVx0ICAgICAgICAgICAgfVxuICAyNzYwXHRcbiAgMjc2MVx0ICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXG4gIDI3NjJcdCAgICAgICAgICAgIGNvbnN0IGhhc01hdHJpeEFjdGlvbnMgPSB0aGlzLmdldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycpO1xuICAyNzYzXHQgICAgICAgICAgICBpZiAoaGFzTWF0cml4QWN0aW9ucykge1xuICAyNzY0XHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8ICR7dGhpcy5uYW1lfSBhbHJlYWR5IGhhcyBtYXRyaXggYWN0aW9ucyBmbGFnIHNldGApO1xuICAyNzY1XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAyNzY2XHQgICAgICAgICAgICB9XG4gIDI3NjdcdFxuICAyNzY4XHQgICAgICAgICAgICAvLyBHZXQgdGhlIG1hdHJpeCBhY3Rpb25zIGNvbXBlbmRpdW1cbiAgMjc2OVx0ICAgICAgICAgICAgY29uc3QgbWF0cml4UGFjayA9IGdhbWUucGFja3MuZ2V0KFwic3I2ZWx5c2l1bS5tYXRyaXgtYWN0aW9uc1wiKTtcbiAgMjc3MFx0ICAgICAgICAgICAgaWYgKCFtYXRyaXhQYWNrKSB7XG4gIDI3NzFcdCAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiU2hhZG93cnVuIDZlIHwgTWF0cml4IEFjdGlvbnMgY29tcGVuZGl1bSBub3QgZm91bmRcIik7XG4gIDI3NzJcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gIDI3NzNcdCAgICAgICAgICAgIH1cbiAgMjc3NFx0XG4gIDI3NzVcdCAgICAgICAgICAgIC8vIEdldCBhbGwgbWF0cml4IGFjdGlvbnNcbiAgMjc3Nlx0ICAgICAgICAgICAgYXdhaXQgbWF0cml4UGFjay5nZXRJbmRleCgpO1xuICAyNzc3XHQgICAgICAgICAgICBjb25zdCBtYXRyaXhBY3Rpb25zID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gIDI3NzhcdCAgICAgICAgICAgICAgICBBcnJheS5mcm9tKG1hdHJpeFBhY2suaW5kZXgpLm1hcChpID0+IG1hdHJpeFBhY2suZ2V0RG9jdW1lbnQoaS5faWQpKVxuICAyNzc5XHQgICAgICAgICAgICApO1xuICAyNzgwXHRcbiAgMjc4MVx0ICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBudWxsL3VuZGVmaW5lZCBhY3Rpb25zXG4gIDI3ODJcdCAgICAgICAgICAgIGNvbnN0IHZhbGlkTWF0cml4QWN0aW9ucyA9IG1hdHJpeEFjdGlvbnMuZmlsdGVyKGFjdGlvbiA9PiBhY3Rpb24gJiYgYWN0aW9uLm5hbWUpO1xuICAyNzgzXHQgICAgICAgICAgICBpZiAodmFsaWRNYXRyaXhBY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAyNzg0XHQgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBTaGFkb3dydW4gNmUgfCBObyB2YWxpZCBtYXRyaXggYWN0aW9ucyBmb3VuZCBpbiBjb21wZW5kaXVtYCk7XG4gIDI3ODVcdCAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycsIHRydWUpO1xuICAyNzg2XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAyNzg3XHQgICAgICAgICAgICB9XG4gIDI3ODhcdFxuICAyNzg5XHQgICAgICAgICAgICAvLyBHZXQgZXhpc3RpbmcgYWN0aW9uIG5hbWVzIHRvIGF2b2lkIGR1cGxpY2F0ZXNcbiAgMjc5MFx0ICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdOYW1lcyA9IHRoaXMuaXRlbXNcbiAgMjc5MVx0ICAgICAgICAgICAgICAgIC5maWx0ZXIoaSA9PiBpICYmIGkudHlwZSA9PT0gXCJhY3Rpb25cIiAmJiBpLm5hbWUpXG4gIDI3OTJcdCAgICAgICAgICAgICAgICAubWFwKGkgPT4gaS5uYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAyNzkzXHRcbiAgMjc5NFx0ICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBhY3Rpb25zIHRoZSBhY3RvciBhbHJlYWR5IGhhc1xuICAyNzk1XHQgICAgICAgICAgICBjb25zdCBhY3Rpb25zVG9BZGQgPSB2YWxpZE1hdHJpeEFjdGlvbnMuZmlsdGVyKFxuICAyNzk2XHQgICAgICAgICAgICAgICAgYSA9PiBhICYmIGEubmFtZSAmJiAhZXhpc3RpbmdOYW1lcy5pbmNsdWRlcyhhLm5hbWUudG9Mb3dlckNhc2UoKSlcbiAgMjc5N1x0ICAgICAgICAgICAgKTtcbiAgMjc5OFx0XG4gIDI3OTlcdCAgICAgICAgICAgIGlmIChhY3Rpb25zVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gIDI4MDBcdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIGFsbCBtYXRyaXggYWN0aW9uc2ApO1xuICAyODAxXHQgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBmbGFnIHRvIGluZGljYXRlIHRoYXQgd2UndmUgY2hlY2tlZCBmb3IgbWF0cml4IGFjdGlvbnNcbiAgMjgwMlx0ICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI4MDNcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gIDI4MDRcdCAgICAgICAgICAgIH1cbiAgMjgwNVx0XG4gIDI4MDZcdCAgICAgICAgICAgIC8vIEFkZCB0aGUgYWN0aW9uc1xuICAyODA3XHQgICAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUVtYmVkZGVkRG9jdW1lbnRzKFxuICAyODA4XHQgICAgICAgICAgICAgICAgXCJJdGVtXCIsXG4gIDI4MDlcdCAgICAgICAgICAgICAgICBhY3Rpb25zVG9BZGQubWFwKGEgPT4gYS50b09iamVjdCgpKVxuICAyODEwXHQgICAgICAgICAgICApO1xuICAyODExXHRcbiAgMjgxMlx0ICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEFkZGVkICR7YWN0aW9uc1RvQWRkLmxlbmd0aH0gbWF0cml4IGFjdGlvbnMgdG8gJHt0aGlzLm5hbWV9YCk7XG4gIDI4MTNcdFxuICAyODE0XHQgICAgICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBhZGRlZCBtYXRyaXggYWN0aW9uc1xuICAyODE1XHQgICAgICAgICAgICBhd2FpdCB0aGlzLnNldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycsIHRydWUpO1xuICAyODE2XHQgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gIDI4MTdcdCAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFNoYWRvd3J1biA2ZSB8IEVycm9yIGVuc3VyaW5nIG1hdHJpeCBhY3Rpb25zIGZvciBhY3RvciAke3RoaXMubmFtZX06YCwgZXJyb3IpO1xuICAyODE4XHQgICAgICAgICAgICAvLyBTZXQgdGhlIGZsYWcgYW55d2F5IHRvIHByZXZlbnQgcmVwZWF0ZWQgYXR0ZW1wdHNcbiAgMjgxOVx0ICAgICAgICAgICAgdHJ5IHtcbiAgMjgyMFx0ICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI4MjFcdCAgICAgICAgICAgIH0gY2F0Y2ggKGZsYWdFcnJvcikge1xuICAyODIyXHQgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgU2hhZG93cnVuIDZlIHwgRmFpbGVkIHRvIHNldCBtYXRyaXggYWN0aW9ucyBmbGFnIGZvciAke3RoaXMubmFtZX06YCwgZmxhZ0Vycm9yKTtcbiAgMjgyM1x0ICAgICAgICAgICAgfVxuICAyODI0XHQgICAgICAgIH1cbiAgMjgyNVx0ICAgIH1cbiAgMjgyNlx0XG4gIDI4MjdcdCAgICBhc3luYyBuZXdTY2VuZVNldHVwKCkge1xuICAyODI4XHQgICAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxV0VZYU5lb2ZNQ1g0OUNVekV6WmllTiJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSIsImZvbGRlclJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MTIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn19fV0sInRpbWVzdGFtcCI6IjIwMjUtMDUtMjlUMjM6MzM6MzguMjA1WiIsInJlc3BvbnNlX3RleHQiOiJOb3cgbGV0IG1lIGZpeCB0aGUgaXNzdWUgaW4gdGhlIGhlbHBlcnMudHMgZmlsZSB3aGVyZSBgZ2V0Q29udHJvbGxlZFRva2VuQWN0b3JzYCBkb2Vzbid0IGNoZWNrIGZvciBudWxsIGFjdG9yczpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI1Y2M5NWM3MC1mMTJjLTRjMGUtYjQ2ZC00OWE0MzI4ZTY0NDgiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFQTjlDdnIxOUtFcEs2Vm5pdFF3bTNNIiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJzdHJfcmVwbGFjZVwiLCBcInBhdGhcIjogXCJzcmMvbW9kdWxlL2hlbHBlcnMudHNcIiwgXCJzdHJfcmVwbGFjZV9lbnRyaWVzXCI6IFt7XCJvbGRfc3RyXCI6IFwiICAgIHN0YXRpYyBnZXREZWZlbnNlUmF0aW5nKHRhcmdldHM6IFRva2VuRG9jdW1lbnRbXSk6IG51bWJlciB7XFxuICAgICAgICBsZXQgZGVmZW5zZVJhdGluZyA9IDA7XFxuICAgICAgICBmb3IoY29uc3QgdG9rZW4gb2YgdGFyZ2V0cykge1xcbiAgICAgICAgICAgIGxldCB0YXJnZXQgPSB0b2tlbi5hY3RvcjtcXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0YXJnZXQpO1xcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcXG4gICAgICAgICAgICBpZiAoJ2RlZmVuc2VfcmF0aW5nJyBpbiB0YXJnZXQuc3lzdGVtLnZhbHVlcyAmJiB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZSA+IGRlZmVuc2VSYXRpbmcpIHtcXG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxcbiAgICAgICAgICAgICAgICBkZWZlbnNlUmF0aW5nID0gdGFyZ2V0LnN5c3RlbS52YWx1ZXMuZGVmZW5zZV9yYXRpbmcudmFsdWU7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIGRlZmVuc2VSYXRpbmc7XFxuICAgIH1cIiwgXCJvbGRfc3RyX3N0YXJ0X2xpbmVfbnVtYmVyXCI6IDU3NywgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiA1ODksIFwibmV3X3N0clwiOiBcIiAgICBzdGF0aWMgZ2V0RGVmZW5zZVJhdGluZyh0YXJnZXRzOiBUb2tlbkRvY3VtZW50W10pOiBudW1iZXIge1xcbiAgICAgICAgbGV0IGRlZmVuc2VSYXRpbmcgPSAwO1xcbiAgICAgICAgZm9yKGNvbnN0IHRva2VuIG9mIHRhcmdldHMpIHtcXG4gICAgICAgICAgICBsZXQgdGFyZ2V0ID0gdG9rZW4uYWN0b3I7XFxuICAgICAgICAgICAgaWYgKCF0YXJnZXQpIHtcXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdTaGFkb3dydW4gNmUgfCBUb2tlbiBoYXMgbm8gYWN0b3I6JywgdG9rZW4ubmFtZSk7XFxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0YXJnZXQpO1xcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcXG4gICAgICAgICAgICBpZiAodGFyZ2V0LnN5c3RlbSAmJiB0YXJnZXQuc3lzdGVtLnZhbHVlcyAmJiAnZGVmZW5zZV9yYXRpbmcnIGluIHRhcmdldC5zeXN0ZW0udmFsdWVzICYmIHRhcmdldC5zeXN0ZW0udmFsdWVzLmRlZmVuc2VfcmF0aW5nLnZhbHVlID4gZGVmZW5zZVJhdGluZykge1xcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXFxuICAgICAgICAgICAgICAgIGRlZmVuc2VSYXRpbmcgPSB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gZGVmZW5zZVJhdGluZztcXG4gICAgfVwifV19IiwibWNwX3NlcnZlcl9uYW1lIjoiIiwibWNwX3Rvb2xfbmFtZSI6IiJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTm93IGxldCBtZSBmaXggdGhlIGBnZXREZWZlbnNlUmF0aW5nYCBmdW5jdGlvbiB0aGF0IGFjY2Vzc2VzIGB0b2tlbi5hY3RvcmAgd2l0aG91dCBudWxsIGNoZWNraW5nOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbW9kdWxlL2hlbHBlcnMudHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlIGZvciBlbnRyeSB3aXRoIGluZGV4IFswXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgNDUyXHQgICAgICAgIGlmICghY2FudmFzIHx8ICFjYW52YXMucmVhZHkgfHwgIWNhbnZhcy50b2tlbnMpIHJldHVybiBmYWxzZTtcbiAgIDQ1M1x0ICAgICAgICByZXR1cm4gY2FudmFzLnRva2Vucy5jb250cm9sbGVkLmxlbmd0aCA+IDA7XG4gICA0NTRcdCAgICB9XG4gICA0NTVcdFxuICAgNDU2XHQgICAgLyoqXG4gICA0NTdcdCAgICAgKiBSZXR1cm4gYWxsIGFjdG9ycyBjb25uZWN0ZWQgdG8gYWxsIHVzZXIgY29udHJvbGxlZCB0b2tlbnMuXG4gICA0NThcdCAgICAgKiBAcmV0dXJucyBBbiBhcnJheSB0b2tlbiBhY3RvcnMuXG4gICA0NTlcdCAgICAgKi9cbiAgIDQ2MFx0ICAgIHN0YXRpYyBnZXRDb250cm9sbGVkVG9rZW5BY3RvcnMoKTogU1I2QWN0b3JbXSB7XG4gICA0NjFcdCAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5yZWFkeSkgcmV0dXJuIFtdXG4gICA0NjJcdFxuICAgNDYzXHQgICAgICAgIGNvbnN0IHRva2VucyA9IEhlbHBlcnMuZ2V0Q29udHJvbGxlZFRva2VucygpO1xuICAgNDY0XHQgICAgICAgIHJldHVybiB0b2tlbnMubWFwKHRva2VuID0+IHRva2VuLmFjdG9yKS5maWx0ZXIoYWN0b3IgPT4gYWN0b3IgIT09IG51bGwgJiYgYWN0b3IgIT09IHVuZGVmaW5lZCkgYXMgU1I2QWN0b3JbXTtcbiAgIDQ2NVx0ICAgIH1cbiAgIDQ2Nlx0XG4gICA0NjdcdCAgICAvKipcbiAgIDQ2OFx0ICAgICAqIHJldHVybiBhbGwgdG9rZW5zIGEgdXNlciBoYXMgdGFyZ2V0ZWQgYXQgdGhlIG1vbWVudC5cbiAgIDQ2OVx0ICAgICAqIEByZXR1cm5zIEFuIGFycmF5IHRva2Vucy5cblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxTjhHdXlyQkVudDFEUTJHeE4xaDlpVCJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSIsImZvbGRlclJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MTIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn19fV0sInRpbWVzdGFtcCI6IjIwMjUtMDUtMjlUMjM6MzM6NDUuMTk3WiIsInJlc3BvbnNlX3RleHQiOiJOb3cgbGV0IG1lIGZpeCB0aGUgYGdldERlZmVuc2VSYXRpbmdgIGZ1bmN0aW9uIHRoYXQgYWNjZXNzZXMgYHRva2VuLmFjdG9yYCB3aXRob3V0IG51bGwgY2hlY2tpbmc6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiNDNhOWEyMTMtNjgyMy00YmE5LTg5Y2ItMTdkM2I3ODQ3ZjZjIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxV3hSQW9EOHh4WHc0QXFFVmVWWlFQcSIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwic3RyX3JlcGxhY2VcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9ydWxlcy9Eb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycy50c1wiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCIgICAgICAgIC8vIFVzZSBjdXJyZW50IHNjZW5lIGZvciBlYXNlIG9mIGFjY2VzcyB0byB0b2tlbnNcXG4gICAgICAgIGNhbnZhcy5zY2VuZS50b2tlbnMuZm9yRWFjaCh0b2tlbiA9PiB0b2tlbi5hY3Rvcj8uZ2V0U2l0dWF0aW9uTW9kaWZpZXJzKCkuY2xlYXJBbGwoKSk7XCIsIFwib2xkX3N0cl9zdGFydF9saW5lX251bWJlclwiOiA0MDIsIFwib2xkX3N0cl9lbmRfbGluZV9udW1iZXJcIjogNDAzLCBcIm5ld19zdHJcIjogXCIgICAgICAgIC8vIFVzZSBjdXJyZW50IHNjZW5lIGZvciBlYXNlIG9mIGFjY2VzcyB0byB0b2tlbnNcXG4gICAgICAgIGNhbnZhcy5zY2VuZS50b2tlbnMuZm9yRWFjaCh0b2tlbiA9PiB7XFxuICAgICAgICAgICAgaWYgKHRva2VuLmFjdG9yKSB7XFxuICAgICAgICAgICAgICAgIHRva2VuLmFjdG9yLmdldFNpdHVhdGlvbk1vZGlmaWVycygpLmNsZWFyQWxsKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSk7XCJ9XX0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJOb3cgbGV0IG1lIGZpeCB0aGUgaXNzdWUgaW4gdGhlIERvY3VtZW50U2l0dWF0aW9uTW9kaWZpZXJzIHdoZXJlIGl0IGFjY2Vzc2VzIGB0b2tlbi5hY3RvcmAgd2l0aG91dCBudWxsIGNoZWNraW5nOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbW9kdWxlL2hlbHBlcnMudHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlIGZvciBlbnRyeSB3aXRoIGluZGV4IFswXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgNTczXHRcbiAgIDU3NFx0ICAgICAgICByZXR1cm4gYWN0b3IubmFtZSBhcyBzdHJpbmc7XG4gICA1NzVcdCAgICB9XG4gICA1NzZcdFxuICAgNTc3XHQgICAgc3RhdGljIGdldERlZmVuc2VSYXRpbmcodGFyZ2V0czogVG9rZW5Eb2N1bWVudFtdKTogbnVtYmVyIHtcbiAgIDU3OFx0ICAgICAgICBsZXQgZGVmZW5zZVJhdGluZyA9IDA7XG4gICA1NzlcdCAgICAgICAgZm9yKGNvbnN0IHRva2VuIG9mIHRhcmdldHMpIHtcbiAgIDU4MFx0ICAgICAgICAgICAgbGV0IHRhcmdldCA9IHRva2VuLmFjdG9yO1xuICAgNTgxXHQgICAgICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgNTgyXHQgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdTaGFkb3dydW4gNmUgfCBUb2tlbiBoYXMgbm8gYWN0b3I6JywgdG9rZW4ubmFtZSk7XG4gICA1ODNcdCAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgIDU4NFx0ICAgICAgICAgICAgfVxuICAgNTg1XHQgICAgICAgICAgICBjb25zb2xlLmxvZyh0YXJnZXQpO1xuICAgNTg2XHQgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICA1ODdcdCAgICAgICAgICAgIGlmICh0YXJnZXQuc3lzdGVtICYmIHRhcmdldC5zeXN0ZW0udmFsdWVzICYmICdkZWZlbnNlX3JhdGluZycgaW4gdGFyZ2V0LnN5c3RlbS52YWx1ZXMgJiYgdGFyZ2V0LnN5c3RlbS52YWx1ZXMuZGVmZW5zZV9yYXRpbmcudmFsdWUgPiBkZWZlbnNlUmF0aW5nKSB7XG4gICA1ODhcdCAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICA1ODlcdCAgICAgICAgICAgICAgICBkZWZlbnNlUmF0aW5nID0gdGFyZ2V0LnN5c3RlbS52YWx1ZXMuZGVmZW5zZV9yYXRpbmcudmFsdWU7XG4gICA1OTBcdCAgICAgICAgICAgIH1cbiAgIDU5MVx0ICAgICAgICB9XG4gICA1OTJcdCAgICAgICAgcmV0dXJuIGRlZmVuc2VSYXRpbmc7XG4gICA1OTNcdCAgICB9XG4gICA1OTRcdFxuICAgNTk1XHQgICAgc3RhdGljIGdldEF0dGFja1JhdGluZyhhY3RvcjogU1I2QWN0b3IpOiBudW1iZXIge1xuICAgNTk2XHQgICAgICAgIHJldHVybiAwO1xuICAgNTk3XHQgICAgfVxuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFQTjlDdnIxOUtFcEs2Vm5pdFF3bTNNIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozMzo1My40MzNaIiwicmVzcG9uc2VfdGV4dCI6Ik5vdyBsZXQgbWUgZml4IHRoZSBpc3N1ZSBpbiB0aGUgRG9jdW1lbnRTaXR1YXRpb25Nb2RpZmllcnMgd2hlcmUgaXQgYWNjZXNzZXMgYHRva2VuLmFjdG9yYCB3aXRob3V0IG51bGwgY2hlY2tpbmc6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiOWEzN2JlMDctODM3Ni00MTBjLWJjZDgtMmMxOTEzODNiNTMyIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxOVVmNXFQRVl4N2FyTlZqRWZFNUR0TSIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwic3RyX3JlcGxhY2VcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50c1wiLCBcInN0cl9yZXBsYWNlX2VudHJpZXNcIjogW3tcIm9sZF9zdHJcIjogXCIgICAgICAgIC8vIFJlZnJlc2ggdGhlIGNhbnZhcyBpZiBpdCBleGlzdHNcXG4gICAgICAgIGlmIChjYW52YXMgJiYgY2FudmFzLnRva2VucyAmJiB0eXBlb2YgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzICE9PSAndW5kZWZpbmVkJykge1xcbiAgICAgICAgICAgIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcy5mb3JFYWNoKHRva2VuID0+IHtcXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuLmFjdG9yICYmIHRva2VuLmFjdG9yLmlkID09PSB0aGlzLmlkICYmIHRva2VuLnJlZnJlc2gpIHtcXG4gICAgICAgICAgICAgICAgICAgIHRva2VuLnJlZnJlc2goKTtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgfVwiLCBcIm9sZF9zdHJfc3RhcnRfbGluZV9udW1iZXJcIjogMjk5MSwgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiAyOTk4LCBcIm5ld19zdHJcIjogXCIgICAgICAgIC8vIFJlZnJlc2ggdGhlIGNhbnZhcyBpZiBpdCBleGlzdHNcXG4gICAgICAgIGlmIChjYW52YXMgJiYgY2FudmFzLnRva2VucyAmJiB0eXBlb2YgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzICE9PSAndW5kZWZpbmVkJykge1xcbiAgICAgICAgICAgIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcy5mb3JFYWNoKHRva2VuID0+IHtcXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuLmFjdG9yICYmIHRva2VuLmFjdG9yLmlkID09PSB0aGlzLmlkICYmIHRva2VuLnJlZnJlc2gpIHtcXG4gICAgICAgICAgICAgICAgICAgIHRva2VuLnJlZnJlc2goKTtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgfVwifV19IiwibWNwX3NlcnZlcl9uYW1lIjoiIiwibWNwX3Rvb2xfbmFtZSI6IiJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTm93IGxldCBtZSBmaXggdGhlIGlzc3VlIGluIHRoZSBTUjZBY3Rvci50cyB3aGVyZSBpdCBhY2Nlc3NlcyB0b2tlbi5hY3RvciB3aXRob3V0IG51bGwgY2hlY2tpbmcgaW4gdGhlIHJlZnJlc2ggbWV0aG9kczpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21vZHVsZS9ydWxlcy9Eb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycy50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAzOThcdCAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCBtb2RpZmllcnMgc2NlbmUgaXMgc2FtZSB0byBjdXJyZW50IHNjZW5lLlxuICAgMzk5XHQgICAgICAgIGNvbnN0IHNjZW5lID0gdGhpcy5kb2N1bWVudCBhcyBTY2VuZTtcbiAgIDQwMFx0ICAgICAgICBpZiAoY2FudmFzLnNjZW5lLmlkICE9PSBzY2VuZS5pZCkgcmV0dXJuO1xuICAgNDAxXHRcbiAgIDQwMlx0ICAgICAgICAvLyBVc2UgY3VycmVudCBzY2VuZSBmb3IgZWFzZSBvZiBhY2Nlc3MgdG8gdG9rZW5zXG4gICA0MDNcdCAgICAgICAgY2FudmFzLnNjZW5lLnRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDQwNFx0ICAgICAgICAgICAgaWYgKHRva2VuLmFjdG9yKSB7XG4gICA0MDVcdCAgICAgICAgICAgICAgICB0b2tlbi5hY3Rvci5nZXRTaXR1YXRpb25Nb2RpZmllcnMoKS5jbGVhckFsbCgpO1xuICAgNDA2XHQgICAgICAgICAgICB9XG4gICA0MDdcdCAgICAgICAgfSk7XG4gICA0MDhcdCAgICB9XG4gICA0MDlcdH1cbiAgIDQxMFx0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVd4UkFvRDh4eFh3NEFxRVZlVlpRUHEifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0iLCJmb2xkZXJSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjEyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9fX1dLCJ0aW1lc3RhbXAiOiIyMDI1LTA1LTI5VDIzOjMzOjU5LjU0MFoiLCJyZXNwb25zZV90ZXh0IjoiTm93IGxldCBtZSBmaXggdGhlIGlzc3VlIGluIHRoZSBTUjZBY3Rvci50cyB3aGVyZSBpdCBhY2Nlc3NlcyB0b2tlbi5hY3RvciB3aXRob3V0IG51bGwgY2hlY2tpbmcgaW4gdGhlIHJlZnJlc2ggbWV0aG9kczpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI1MDk2ZTY0Ni1iOTQ5LTRlMmMtYTdmMS0xMTYyYThlMjE2ZGYiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFUUzZ0c3Y1cU1kQkJrSHVvZ1V3MnZXIiwidG9vbF9uYW1lIjoic3RyLXJlcGxhY2UtZWRpdG9yIiwiaW5wdXRfanNvbiI6IntcImNvbW1hbmRcIjogXCJzdHJfcmVwbGFjZVwiLCBcInBhdGhcIjogXCJzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzXCIsIFwic3RyX3JlcGxhY2VfZW50cmllc1wiOiBbe1wib2xkX3N0clwiOiBcIiAgICAgICAgLy8gRW5zdXJlIG1hdHJpeCBhY3Rpb25zIGFyZSBhdmFpbGFibGUgZm9yIGFsbCBhY3RvcnMgdGhhdCBjYW4gdXNlIHRoZSBNYXRyaXhcXG4gICAgICAgIGlmIChnYW1lLnVzZXI/LmlzR00gJiYgdGhpcy5pc093bmVyICYmICh0aGlzLmlzQ2hhcmFjdGVyKCkgfHwgdGhpcy5pc1Nwcml0ZSgpIHx8IHRoaXMuaXNJQygpKSkge1xcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxcbiAgICAgICAgICAgIGNvbnN0IGhhc01hdHJpeEFjdGlvbnMgPSB0aGlzLmdldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycpO1xcbiAgICAgICAgICAgIGlmICghaGFzTWF0cml4QWN0aW9ucykge1xcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHVzZSBhIHNldFRpbWVvdXQgdG8gYXZvaWQgaXNzdWVzIHdpdGggdGhlIGFjdG9yIGJlaW5nIGxvY2tlZCBkdXJpbmcgZGF0YSBwcmVwYXJhdGlvblxcbiAgICAgICAgICAgICAgICAvLyBBbHNvIGFkZCBlcnJvciBoYW5kbGluZyB0byBwcmV2ZW50IGNyYXNoZXMgZHVyaW5nIGluaXRpYWxpemF0aW9uXFxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuc3VyZU1hdHJpeEFjdGlvbnMoKTtcXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBTaGFkb3dydW4gNmUgfCBGYWlsZWQgdG8gZW5zdXJlIG1hdHJpeCBhY3Rpb25zIGZvciBhY3RvciAke3RoaXMubmFtZX06YCwgZXJyb3IpO1xcbiAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9LCA1MDApO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cIiwgXCJvbGRfc3RyX3N0YXJ0X2xpbmVfbnVtYmVyXCI6IDMxOCwgXCJvbGRfc3RyX2VuZF9saW5lX251bWJlclwiOiAzMzMsIFwibmV3X3N0clwiOiBcIiAgICAgICAgLy8gRW5zdXJlIG1hdHJpeCBhY3Rpb25zIGFyZSBhdmFpbGFibGUgZm9yIGFsbCBhY3RvcnMgdGhhdCBjYW4gdXNlIHRoZSBNYXRyaXhcXG4gICAgICAgIC8vIE9ubHkgcnVuIHRoaXMgaWYgdGhlIGdhbWUgaXMgZnVsbHkgcmVhZHkgYW5kIG5vdCBkdXJpbmcgbWlncmF0aW9uXFxuICAgICAgICBpZiAoZ2FtZS5yZWFkeSAmJiBnYW1lLnVzZXI/LmlzR00gJiYgdGhpcy5pc093bmVyICYmICh0aGlzLmlzQ2hhcmFjdGVyKCkgfHwgdGhpcy5pc1Nwcml0ZSgpIHx8IHRoaXMuaXNJQygpKSkge1xcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxcbiAgICAgICAgICAgIGNvbnN0IGhhc01hdHJpeEFjdGlvbnMgPSB0aGlzLmdldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycpO1xcbiAgICAgICAgICAgIGlmICghaGFzTWF0cml4QWN0aW9ucykge1xcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHVzZSBhIHNldFRpbWVvdXQgdG8gYXZvaWQgaXNzdWVzIHdpdGggdGhlIGFjdG9yIGJlaW5nIGxvY2tlZCBkdXJpbmcgZGF0YSBwcmVwYXJhdGlvblxcbiAgICAgICAgICAgICAgICAvLyBBbHNvIGFkZCBlcnJvciBoYW5kbGluZyB0byBwcmV2ZW50IGNyYXNoZXMgZHVyaW5nIGluaXRpYWxpemF0aW9uXFxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEb3VibGUtY2hlY2sgdGhhdCB0aGUgZ2FtZSBpcyBzdGlsbCByZWFkeSBhbmQgdGhlIGFjdG9yIGlzIHZhbGlkXFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWUucmVhZHkgJiYgdGhpcy5pZCAmJiB0aGlzLm5hbWUpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IEZhaWxlZCB0byBlbnN1cmUgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH0sIDUwMCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVwifV19IiwibWNwX3NlcnZlcl9uYW1lIjoiIiwibWNwX3Rvb2xfbmFtZSI6IiJ9fSx7ImlkIjowLCJ0eXBlIjowLCJjb250ZW50IjoiTm93IGxldCBtZSBhbHNvIGFkZCBhIGNoZWNrIHRvIHByZXZlbnQgdGhlIG1hdHJpeCBhY3Rpb25zIGluaXRpYWxpemF0aW9uIGZyb20gcnVubmluZyBkdXJpbmcgd29ybGQgbWlncmF0aW9uIG9yIHdoZW4gdGhlIGdhbWUgaXMgbm90IGZ1bGx5IHJlYWR5OlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiU3VjY2Vzc2Z1bGx5IGVkaXRlZCB0aGUgZmlsZSBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzLlxuUmVzdWx0IGZvciBzdHJfcmVwbGFjZSBmb3IgZW50cnkgd2l0aCBpbmRleCBbMF06XG5SZXBsYWNlbWVudCBzdWNjZXNzZnVsLlxuRWRpdGVkIHNlY3Rpb24gYWZ0ZXIgSURFIGF1dG8tZm9ybWF0dGluZyB3YXMgYXBwbGllZDpcbiAgMzAxOFx0ICAgICAgICBmb3IgKGNvbnN0IHRva2VuIG9mIHRoaXMuZ2V0QWN0aXZlVG9rZW5zKCkpIHtcbiAgMzAxOVx0ICAgICAgICAgICAgaWYgKHRva2VuLnJlZnJlc2gpIHRva2VuLnJlZnJlc2goKTtcbiAgMzAyMFx0ICAgICAgICB9XG4gIDMwMjFcdFxuICAzMDIyXHQgICAgICAgIC8vIFJlZnJlc2ggdGhlIGNhbnZhcyBpZiBpdCBleGlzdHNcbiAgMzAyM1x0ICAgICAgICBpZiAoY2FudmFzICYmIGNhbnZhcy50b2tlbnMgJiYgdHlwZW9mIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgMzAyNFx0ICAgICAgICAgICAgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzLmZvckVhY2godG9rZW4gPT4ge1xuICAzMDI1XHQgICAgICAgICAgICAgICAgaWYgKHRva2VuLmFjdG9yICYmIHRva2VuLmFjdG9yLmlkID09PSB0aGlzLmlkICYmIHRva2VuLnJlZnJlc2gpIHtcbiAgMzAyNlx0ICAgICAgICAgICAgICAgICAgICB0b2tlbi5yZWZyZXNoKCk7XG4gIDMwMjdcdCAgICAgICAgICAgICAgICB9XG4gIDMwMjhcdCAgICAgICAgICAgIH0pO1xuICAzMDI5XHQgICAgICAgIH1cbiAgMzAzMFx0XG4gIDMwMzFcdCAgICAgICAgLy8gUmVmcmVzaCB0b2tlbiBzaGVldHNcbiAgMzAzMlx0ICAgICAgICB0aGlzLnJlZnJlc2hUb2tlblNoZWV0cygpO1xuICAzMDMzXHRcblxuUmV2aWV3IHRoZSBjaGFuZ2VzIGFuZCBtYWtlIHN1cmUgdGhleSBhcmUgYXMgZXhwZWN0ZWQgKGNvcnJlY3QgaW5kZW50YXRpb24sIG5vIGR1cGxpY2F0ZSBsaW5lcywgZXRjKS5cbkVkaXQgdGhlIGZpbGUgYWdhaW4gaWYgbmVjZXNzYXJ5LlxuIiwiaXNfZXJyb3IiOmZhbHNlLCJyZXF1ZXN0X2lkIjoiIiwidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxOVVmNXFQRVl4N2FyTlZqRWZFNUR0TSJ9fSx7ImlkIjoyLCJ0eXBlIjo0LCJpZGVfc3RhdGVfbm9kZSI6eyJ3b3Jrc3BhY2VGb2xkZXJzIjpbeyJyZXBvc2l0b3J5Um9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSIsImZvbGRlclJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifV0sIndvcmtzcGFjZUZvbGRlcnNVbmNoYW5nZWQiOmZhbHNlLCJjdXJyZW50VGVybWluYWwiOnsidGVybWluYWxJZCI6MTIsImN1cnJlbnRXb3JraW5nRGlyZWN0b3J5IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn19fV0sInRpbWVzdGFtcCI6IjIwMjUtMDUtMjlUMjM6MzQ6MDQuNzU0WiIsInJlc3BvbnNlX3RleHQiOiJOb3cgbGV0IG1lIGFsc28gYWRkIGEgY2hlY2sgdG8gcHJldmVudCB0aGUgbWF0cml4IGFjdGlvbnMgaW5pdGlhbGl6YXRpb24gZnJvbSBydW5uaW5nIGR1cmluZyB3b3JsZCBtaWdyYXRpb24gb3Igd2hlbiB0aGUgZ2FtZSBpcyBub3QgZnVsbHkgcmVhZHk6XG4iLCJ3b3Jrc3BhY2VfZmlsZV9jaHVua3MiOltdfSx7InN0YXR1cyI6InN1Y2Nlc3MiLCJyZXF1ZXN0X2lkIjoiZTQzZjRlZDQtN2ZkOC00Y2U3LWExZDUtMjQ1NTAwM2Y3NzVhIiwicmVxdWVzdF9tZXNzYWdlIjoiIiwic3RydWN0dXJlZF9vdXRwdXRfbm9kZXMiOlt7ImlkIjoxLCJ0eXBlIjo1LCJjb250ZW50IjoiIiwidG9vbF91c2UiOnsidG9vbF91c2VfaWQiOiJ0b29sdV92cnR4XzAxWFJ3NW5jY2RtSGd6TkZkQWQ3QmdxdyIsInRvb2xfbmFtZSI6InN0ci1yZXBsYWNlLWVkaXRvciIsImlucHV0X2pzb24iOiJ7XCJjb21tYW5kXCI6IFwidmlld1wiLCBcInBhdGhcIjogXCJzcmMvbW9kdWxlL3RhcmdldGluZy9UYXJnZXRpbmdTZXJ2aWNlLnRzXCIsIFwidmlld19yYW5nZVwiOiBbMTM1LCAxNDVdfSIsIm1jcF9zZXJ2ZXJfbmFtZSI6IiIsIm1jcF90b29sX25hbWUiOiIifX0seyJpZCI6MCwidHlwZSI6MCwiY29udGVudCI6Ik5vdyBsZXQgbWUgY2hlY2sgaWYgdGhlcmUgYXJlIGFueSBvdGhlciBwbGFjZXMgaW4gdGhlIHRhcmdldGluZyBzZXJ2aWNlIHRoYXQgbWlnaHQgbmVlZCBudWxsIGNoZWNrczpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAzMTRcdCAgICAgICAgICAgICAgICBJQ1ByZXAucHJlcGFyZURlcml2ZWREYXRhKHRoaXMuc3lzdGVtLCBpdGVtRGF0YVdyYXBwZXJzKTtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgMzE2XHQgICAgICAgIH1cbiAgIDMxN1x0XG4gICAzMThcdCAgICAgICAgLy8gRW5zdXJlIG1hdHJpeCBhY3Rpb25zIGFyZSBhdmFpbGFibGUgZm9yIGFsbCBhY3RvcnMgdGhhdCBjYW4gdXNlIHRoZSBNYXRyaXhcbiAgIDMxOVx0ICAgICAgICAvLyBPbmx5IHJ1biB0aGlzIGlmIHRoZSBnYW1lIGlzIGZ1bGx5IHJlYWR5IGFuZCBub3QgZHVyaW5nIG1pZ3JhdGlvblxuICAgMzIwXHQgICAgICAgIGlmIChnYW1lLnJlYWR5ICYmIGdhbWUudXNlcj8uaXNHTSAmJiB0aGlzLmlzT3duZXIgJiYgKHRoaXMuaXNDaGFyYWN0ZXIoKSB8fCB0aGlzLmlzU3ByaXRlKCkgfHwgdGhpcy5pc0lDKCkpKSB7XG4gICAzMjFcdCAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxuICAgMzIyXHQgICAgICAgICAgICBjb25zdCBoYXNNYXRyaXhBY3Rpb25zID0gdGhpcy5nZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnKTtcbiAgIDMyM1x0ICAgICAgICAgICAgaWYgKCFoYXNNYXRyaXhBY3Rpb25zKSB7XG4gICAzMjRcdCAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHVzZSBhIHNldFRpbWVvdXQgdG8gYXZvaWQgaXNzdWVzIHdpdGggdGhlIGFjdG9yIGJlaW5nIGxvY2tlZCBkdXJpbmcgZGF0YSBwcmVwYXJhdGlvblxuICAgMzI1XHQgICAgICAgICAgICAgICAgLy8gQWxzbyBhZGQgZXJyb3IgaGFuZGxpbmcgdG8gcHJldmVudCBjcmFzaGVzIGR1cmluZyBpbml0aWFsaXphdGlvblxuICAgMzI2XHQgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAzMjdcdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgIDMyOFx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG91YmxlLWNoZWNrIHRoYXQgdGhlIGdhbWUgaXMgc3RpbGwgcmVhZHkgYW5kIHRoZSBhY3RvciBpcyB2YWxpZFxuICAgMzI5XHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZS5yZWFkeSAmJiB0aGlzLmlkICYmIHRoaXMubmFtZSkge1xuICAgMzMwXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCk7XG4gICAzMzFcdCAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgIDMzMlx0ICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgMzMzXHQgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IEZhaWxlZCB0byBlbnN1cmUgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XG4gICAzMzRcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgMzM1XHQgICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgIDMzNlx0ICAgICAgICAgICAgfVxuICAgMzM3XHQgICAgICAgIH1cbiAgIDMzOFx0ICAgIH1cbiAgIDMzOVx0XG4gICAzNDBcdCAgICAvKipcbiAgIDM0MVx0ICAgICAqIE5PVEU6IFRoaXMgbWV0aG9kIGlzIHVudXNlZCBhdCB0aGUgbW9tZW50LCBrZWVwIGl0IGZvciBmdXR1cmUgaW5zcGlyYXRpb24uXG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVRTNnRzdjVxTWRCQmtIdW9nVXcydlcifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0iLCJmb2xkZXJSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjEyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9fX1dLCJ0aW1lc3RhbXAiOiIyMDI1LTA1LTI5VDIzOjM0OjE0LjgwNFoiLCJyZXNwb25zZV90ZXh0IjoiTm93IGxldCBtZSBjaGVjayBpZiB0aGVyZSBhcmUgYW55IG90aGVyIHBsYWNlcyBpbiB0aGUgdGFyZ2V0aW5nIHNlcnZpY2UgdGhhdCBtaWdodCBuZWVkIG51bGwgY2hlY2tzOlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJzdGF0dXMiOiJzdWNjZXNzIiwicmVxdWVzdF9pZCI6IjYyNzJlN2ZkLWE2N2ItNDYxNC04YmJjLTRmZGMyNDQ3ZWU2NCIsInJlcXVlc3RfbWVzc2FnZSI6IiIsInN0cnVjdHVyZWRfb3V0cHV0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6NSwiY29udGVudCI6IiIsInRvb2xfdXNlIjp7InRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVVhUUN6dXlwQlUzTUVlTmk3dnF3eVQiLCJ0b29sX25hbWUiOiJzdHItcmVwbGFjZS1lZGl0b3IiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcInZpZXdcIiwgXCJwYXRoXCI6IFwic3JjL21vZHVsZS9hcHBzL2dtdG9vbHMvT3ZlcndhdGNoU2NvcmVUcmFja2VyLmpzXCIsIFwidmlld19yYW5nZVwiOiBbODAsIDk1XX0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJUaGUgdGFyZ2V0aW5nIHNlcnZpY2UgYWxyZWFkeSBoYXMgcHJvcGVyIG51bGwgY2hlY2tzIGZvciBgdG9rZW4uYWN0b3JgLiBMZXQgbWUgYWxzbyBjaGVjayBpZiB0aGVyZSBhcmUgYW55IGlzc3VlcyBpbiB0aGUgT3ZlcndhdGNoU2NvcmVUcmFja2VyOlxuIn0seyJpZCI6MiwidHlwZSI6MiwiY29udGVudCI6IiJ9LHsiaWQiOjMsInR5cGUiOjMsImNvbnRlbnQiOiIifV0sInNlZW5fc3RhdGUiOiJzZWVuIiwic3RydWN0dXJlZF9yZXF1ZXN0X25vZGVzIjpbeyJpZCI6MSwidHlwZSI6MSwidG9vbF9yZXN1bHRfbm9kZSI6eyJjb250ZW50IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbW9kdWxlL3RhcmdldGluZy9UYXJnZXRpbmdTZXJ2aWNlLnRzOlxuICAgMTM1XHQgICAgICAgIGNvbnN0IHRva2VucyA9IGNhbnZhcy50b2tlbnM/LnBsYWNlYWJsZXMgfHwgW107XG4gICAxMzZcdCAgICAgICAgXG4gICAxMzdcdCAgICAgICAgLy8gRmlsdGVyIGZvciBwb3RlbnRpYWwgdGFyZ2V0cyAoZXhjbHVkZSB0aGUgYWN0b3IncyBvd24gdG9rZW4pXG4gICAxMzhcdCAgICAgICAgY29uc3QgcG90ZW50aWFsVGFyZ2V0cyA9IHRva2Vucy5maWx0ZXIodG9rZW4gPT4gXG4gICAxMzlcdCAgICAgICAgICAgIHRva2VuLmlkICE9PSBhY3RvclRva2VuLmlkICYmIFxuICAgMTQwXHQgICAgICAgICAgICB0b2tlbi5hY3RvciAmJiBcbiAgIDE0MVx0ICAgICAgICAgICAgdGhpcy5pc1ZhbGlkVGFyZ2V0KHRva2VuLCBhY3Rpb24sIGFjdG9yKVxuICAgMTQyXHQgICAgICAgICk7XG4gICAxNDNcdCAgICAgICAgXG4gICAxNDRcdCAgICAgICAgLy8gU29ydCBieSBkaXN0YW5jZSB0byB0aGUgYWN0b3JcbiAgIDE0NVx0ICAgICAgICByZXR1cm4gcG90ZW50aWFsVGFyZ2V0cy5zb3J0KChhLCBiKSA9PiB7XG5Ub3RhbCBsaW5lcyBpbiBmaWxlOiAyNTJcbiIsImlzX2Vycm9yIjpmYWxzZSwicmVxdWVzdF9pZCI6IiIsInRvb2xfdXNlX2lkIjoidG9vbHVfdnJ0eF8wMVhSdzVuY2NkbUhnek5GZEFkN0JncXcifX0seyJpZCI6MiwidHlwZSI6NCwiaWRlX3N0YXRlX25vZGUiOnsid29ya3NwYWNlRm9sZGVycyI6W3sicmVwb3NpdG9yeVJvb3QiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0iLCJmb2xkZXJSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIn1dLCJ3b3Jrc3BhY2VGb2xkZXJzVW5jaGFuZ2VkIjpmYWxzZSwiY3VycmVudFRlcm1pbmFsIjp7InRlcm1pbmFsSWQiOjEyLCJjdXJyZW50V29ya2luZ0RpcmVjdG9yeSI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9fX1dLCJ0aW1lc3RhbXAiOiIyMDI1LTA1LTI5VDIzOjM0OjE4LjIzOFoiLCJyZXNwb25zZV90ZXh0IjoiVGhlIHRhcmdldGluZyBzZXJ2aWNlIGFscmVhZHkgaGFzIHByb3BlciBudWxsIGNoZWNrcyBmb3IgYHRva2VuLmFjdG9yYC4gTGV0IG1lIGFsc28gY2hlY2sgaWYgdGhlcmUgYXJlIGFueSBpc3N1ZXMgaW4gdGhlIE92ZXJ3YXRjaFNjb3JlVHJhY2tlcjpcbiIsIndvcmtzcGFjZV9maWxlX2NodW5rcyI6W119LHsic3RhdHVzIjoic3VjY2VzcyIsInJlcXVlc3RfaWQiOiI0OTljMTk4NS0wYzM2LTQ2YjYtOTA3YS0zZTUwODk0ZDUzOWUiLCJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJzdHJ1Y3R1cmVkX291dHB1dF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjUsImNvbnRlbnQiOiIiLCJ0b29sX3VzZSI6eyJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFRVGRKVFN2eDJ2RjVZaDlKQjlhQnpnIiwidG9vbF9uYW1lIjoibGF1bmNoLXByb2Nlc3MiLCJpbnB1dF9qc29uIjoie1wiY29tbWFuZFwiOiBcIm5wbSBydW4gYnVpbGRcIiwgXCJ3YWl0XCI6IHRydWUsIFwibWF4X3dhaXRfc2Vjb25kc1wiOiA2MH0iLCJtY3Bfc2VydmVyX25hbWUiOiIiLCJtY3BfdG9vbF9uYW1lIjoiIn19LHsiaWQiOjAsInR5cGUiOjAsImNvbnRlbnQiOiJUaGUgT3ZlcndhdGNoU2NvcmVUcmFja2VyIGFscmVhZHkgaGFzIHByb3BlciBjaGVja3MuIE5vdyBsZXQgbWUgY3JlYXRlIGEgc3VtbWFyeSBvZiB0aGUgY2hhbmdlcyBJJ3ZlIG1hZGUgYW5kIHRlc3QgdGhlbTpcblxuIyMgU3VtbWFyeSBvZiBDaGFuZ2VzIE1hZGVcblxuSSd2ZSBpZGVudGlmaWVkIGFuZCBmaXhlZCBzZXZlcmFsIHBvdGVudGlhbCBpc3N1ZXMgdGhhdCBjb3VsZCBjYXVzZSBcImFjdG9ycyBub3QgZXhpc3RpbmdcIiBlcnJvcnMgd2hlbiBsb2FkaW5nIHRoZSBnYW1lOlxuXG4jIyMgMS4gKipGaXhlZCBUb2tlbiBQcm9jZXNzaW5nIGluIEhvb2tzKiogKGBzcmMvbW9kdWxlL2hvb2tzLnRzYClcbi0gKipJc3N1ZSoqOiBMaW5lIDQ1NCB3YXMgbWFwcGluZyBgdG9rZW4uYWN0b3JgIHdpdGhvdXQgZmlsdGVyaW5nIG91dCBudWxsL3VuZGVmaW5lZCBhY3RvcnMgZmlyc3Rcbi0gKipGaXgqKjogQWRkZWQgYC5maWx0ZXIoYWN0b3IgPT4gYWN0b3IgIT09IG51bGwgJiYgYWN0b3IgIT09IHVuZGVmaW5lZClgIGFmdGVyIHRoZSBtYXAgb3BlcmF0aW9uXG5cbiMjIyAyLiAqKkVuaGFuY2VkIE1hdHJpeCBBY3Rpb25zIEluaXRpYWxpemF0aW9uKiogKGBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzYClcbi0gKipJc3N1ZSoqOiBNYXRyaXggYWN0aW9ucyB3ZXJlIGJlaW5nIGluaXRpYWxpemVkIGR1cmluZyBkYXRhIHByZXBhcmF0aW9uIHdpdGhvdXQgcHJvcGVyIGVycm9yIGhhbmRsaW5nIGFuZCB2YWxpZGF0aW9uXG4tICoqRml4ZXMqKjpcbiAgLSBBZGRlZCBgZ2FtZS5yZWFkeWAgY2hlY2sgdG8gcHJldmVudCBpbml0aWFsaXphdGlvbiBkdXJpbmcgd29ybGQgbG9hZGluZy9taWdyYXRpb25cbiAgLSBBZGRlZCBjb21wcmVoZW5zaXZlIGVycm9yIGhhbmRsaW5nIHdpdGggdHJ5LWNhdGNoIGJsb2Nrc1xuICAtIEFkZGVkIHZhbGlkYXRpb24gZm9yIGFjdG9yIGV4aXN0ZW5jZSBiZWZvcmUgcHJvY2Vzc2luZ1xuICAtIEFkZGVkIG51bGwgY2hlY2tzIGZvciBtYXRyaXggYWN0aW9ucyBmcm9tIGNvbXBlbmRpdW1cbiAgLSBBZGRlZCBmYWxsYmFjayBmbGFnIHNldHRpbmcgdG8gcHJldmVudCByZXBlYXRlZCBmYWlsZWQgYXR0ZW1wdHNcblxuIyMjIDMuICoqRml4ZWQgSGVscGVyIEZ1bmN0aW9ucyoqIChgc3JjL21vZHVsZS9oZWxwZXJzLnRzYClcbi0gKipJc3N1ZSoqOiBgZ2V0Q29udHJvbGxlZFRva2VuQWN0b3JzKClgIHdhcyBtYXBwaW5nIHRva2VucyB3aXRob3V0IGZpbHRlcmluZyBvdXQgbnVsbCBhY3RvcnNcbi0gKipGaXgqKjogQWRkZWQgYC5maWx0ZXIoYWN0b3IgPT4gYWN0b3IgIT09IG51bGwgJiYgYWN0b3IgIT09IHVuZGVmaW5lZClgIGFmdGVyIG1hcHBpbmdcbi0gKipJc3N1ZSoqOiBgZ2V0RGVmZW5zZVJhdGluZygpYCB3YXMgYWNjZXNzaW5nIGB0b2tlbi5hY3RvcmAgd2l0aG91dCBudWxsIGNoZWNraW5nXG4tICoqRml4Kio6IEFkZGVkIG51bGwgY2hlY2sgYW5kIGVhcmx5IGNvbnRpbnVlIGZvciB0b2tlbnMgd2l0aG91dCBhY3RvcnNcblxuIyMjIDQuICoqRml4ZWQgRG9jdW1lbnRTaXR1YXRpb25Nb2RpZmllcnMqKiAoYHNyYy9tb2R1bGUvcnVsZXMvRG9jdW1lbnRTaXR1YXRpb25Nb2RpZmllcnMudHNgKVxuLSAqKklzc3VlKio6IFVzaW5nIG9wdGlvbmFsIGNoYWluaW5nIGA/LmAgYnV0IG5vdCBoYW5kbGluZyB0aGUgY2FzZSB3aGVyZSBhY3RvciBpcyBudWxsXG4tICoqRml4Kio6IEFkZGVkIGV4cGxpY2l0IG51bGwgY2hlY2sgYmVmb3JlIGNhbGxpbmcgYGdldFNpdHVhdGlvbk1vZGlmaWVycygpYFxuXG4jIyMgS2V5IEltcHJvdmVtZW50czpcbjEuICoqTnVsbCBTYWZldHkqKjogQWxsIHRva2VuLmFjdG9yIGFjY2Vzc2VzIG5vdyBoYXZlIHByb3BlciBudWxsIGNoZWNrc1xuMi4gKipFcnJvciBIYW5kbGluZyoqOiBNYXRyaXggYWN0aW9ucyBpbml0aWFsaXphdGlvbiBpcyB3cmFwcGVkIGluIHRyeS1jYXRjaCBibG9ja3NcbjMuICoqVGltaW5nKio6IE1hdHJpeCBhY3Rpb25zIG9ubHkgaW5pdGlhbGl6ZSB3aGVuIGdhbWUgaXMgZnVsbHkgcmVhZHlcbjQuICoqVmFsaWRhdGlvbioqOiBBZGRlZCB2YWxpZGF0aW9uIGZvciBhY3RvciBleGlzdGVuY2UgYW5kIHZhbGlkaXR5XG41LiAqKlJlc2lsaWVuY2UqKjogQWRkZWQgZmFsbGJhY2sgbWVjaGFuaXNtcyB0byBwcmV2ZW50IHJlcGVhdGVkIGZhaWx1cmVzXG5cblRoZXNlIGNoYW5nZXMgc2hvdWxkIHJlc29sdmUgdGhlIFwiYWN0b3JzIG5vdCBleGlzdGluZ1wiIGVycm9ycyBieSBlbnN1cmluZyB0aGF0OlxuLSBUb2tlbnMgd2l0aG91dCBsaW5rZWQgYWN0b3JzIGFyZSBwcm9wZXJseSBmaWx0ZXJlZCBvdXRcbi0gTWF0cml4IGFjdGlvbnMgaW5pdGlhbGl6YXRpb24gZG9lc24ndCBydW4gZHVyaW5nIHdvcmxkIGxvYWRpbmdcbi0gQWxsIGFjdG9yIGFjY2Vzc2VzIGFyZSBudWxsLXNhZmVcbi0gRXJyb3JzIGFyZSBjYXVnaHQgYW5kIGxvZ2dlZCBpbnN0ZWFkIG9mIGNyYXNoaW5nIHRoZSBzeXN0ZW1cblxuTGV0IG1lIHJ1biBhIHF1aWNrIHRlc3QgdG8gbWFrZSBzdXJlIHRoZSBzeW50YXggaXMgY29ycmVjdDpcbiJ9LHsiaWQiOjIsInR5cGUiOjIsImNvbnRlbnQiOiIifSx7ImlkIjozLCJ0eXBlIjozLCJjb250ZW50IjoiIn1dLCJzZWVuX3N0YXRlIjoic2VlbiIsInN0cnVjdHVyZWRfcmVxdWVzdF9ub2RlcyI6W3siaWQiOjEsInR5cGUiOjEsInRvb2xfcmVzdWx0X25vZGUiOnsiY29udGVudCI6IkhlcmUncyB0aGUgcmVzdWx0IG9mIHJ1bm5pbmcgYGNhdCAtbmAgb24gc3JjL21vZHVsZS9hcHBzL2dtdG9vbHMvT3ZlcndhdGNoU2NvcmVUcmFja2VyLmpzOlxuICAgIDgwXHRcbiAgICA4MVx0ICAgICAgICAvLyBBZGQgbGlua2VkIHRva2VuIGFjdG9ycy5cbiAgICA4Mlx0ICAgICAgICB0b2tlbnMuZmlsdGVyKHRva2VuID0+IHRva2VuLmRvY3VtZW50LmFjdG9yTGluaykuZm9yRWFjaCh0b2tlbiA9PiB7XG4gICAgODNcdCAgICAgICAgICAgIC8vIERvdWJsZSBjaGVjayB0aGF0IHRoZSBhY3RvciBhY3R1YWxseSBsaXZlcyBpbiB0aGUgYWN0b3JzIGNvbGxlY3Rpb24uXG4gICAgODRcdCAgICAgICAgICAgIGNvbnN0IGFjdG9yID0gZ2FtZS5hY3RvcnMuZ2V0KHRva2VuLmRvY3VtZW50LmFjdG9ySWQpO1xuICAgIDg1XHQgICAgICAgICAgICBpZiAoIWFjdG9yKSByZXR1cm47XG4gICAgODZcdCAgICAgICAgICAgIGlmICh0aGlzLl9pc0FjdG9yT25UcmFja2VyKGFjdG9yKSkgcmV0dXJuO1xuICAgIDg3XHRcbiAgICA4OFx0ICAgICAgICAgICAgT3ZlcndhdGNoU2NvcmVUcmFja2VyLmFkZGVkQWN0b3JzLnB1c2goYWN0b3IuaWQpO1xuICAgIDg5XHQgICAgICAgIH0pO1xuICAgIDkwXHRcbiAgICA5MVx0ICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIDkyXHQgICAgfVxuICAgIDkzXHRcbiAgICA5NFx0ICAgIC8qKlxuICAgIDk1XHQgICAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIGFjdG9yIGlzIGFscmVhZHkgYWRkZWQgYW5kIGRpc3BsYXllZCBvbiB0aGUgY3VycmVudCB0cmFja2VyLlxuVG90YWwgbGluZXMgaW4gZmlsZTogMTY1XG4iLCJpc19lcnJvciI6ZmFsc2UsInJlcXVlc3RfaWQiOiIiLCJ0b29sX3VzZV9pZCI6InRvb2x1X3ZydHhfMDFVYVFDenV5cEJVM01FZU5pN3Zxd3lUIn19LHsiaWQiOjIsInR5cGUiOjQsImlkZV9zdGF0ZV9ub2RlIjp7IndvcmtzcGFjZUZvbGRlcnMiOlt7InJlcG9zaXRvcnlSb290IjoiQzovVXNlcnMvSkMgTXVycmF5L3Byb2plY3RzL2dhbWVzL2ZvdW5kcnl2dHQvc2hhZG93cnVuNi1lbHlzaXVtIiwiZm9sZGVyUm9vdCI6IkM6L1VzZXJzL0pDIE11cnJheS9wcm9qZWN0cy9nYW1lcy9mb3VuZHJ5dnR0L3NoYWRvd3J1bjYtZWx5c2l1bSJ9XSwid29ya3NwYWNlRm9sZGVyc1VuY2hhbmdlZCI6ZmFsc2UsImN1cnJlbnRUZXJtaW5hbCI6eyJ0ZXJtaW5hbElkIjoxMiwiY3VycmVudFdvcmtpbmdEaXJlY3RvcnkiOiJDOi9Vc2Vycy9KQyBNdXJyYXkvcHJvamVjdHMvZ2FtZXMvZm91bmRyeXZ0dC9zaGFkb3dydW42LWVseXNpdW0ifX19XSwidGltZXN0YW1wIjoiMjAyNS0wNS0yOVQyMzozNDoyMS44NDBaIiwicmVzcG9uc2VfdGV4dCI6IlRoZSBPdmVyd2F0Y2hTY29yZVRyYWNrZXIgYWxyZWFkeSBoYXMgcHJvcGVyIGNoZWNrcy4gTm93IGxldCBtZSBjcmVhdGUgYSBzdW1tYXJ5IG9mIHRoZSBjaGFuZ2VzIEkndmUgbWFkZSBhbmQgdGVzdCB0aGVtOlxuXG4jIyBTdW1tYXJ5IG9mIENoYW5nZXMgTWFkZVxuXG5JJ3ZlIGlkZW50aWZpZWQgYW5kIGZpeGVkIHNldmVyYWwgcG90ZW50aWFsIGlzc3VlcyB0aGF0IGNvdWxkIGNhdXNlIFwiYWN0b3JzIG5vdCBleGlzdGluZ1wiIGVycm9ycyB3aGVuIGxvYWRpbmcgdGhlIGdhbWU6XG5cbiMjIyAxLiAqKkZpeGVkIFRva2VuIFByb2Nlc3NpbmcgaW4gSG9va3MqKiAoYHNyYy9tb2R1bGUvaG9va3MudHNgKVxuLSAqKklzc3VlKio6IExpbmUgNDU0IHdhcyBtYXBwaW5nIGB0b2tlbi5hY3RvcmAgd2l0aG91dCBmaWx0ZXJpbmcgb3V0IG51bGwvdW5kZWZpbmVkIGFjdG9ycyBmaXJzdFxuLSAqKkZpeCoqOiBBZGRlZCBgLmZpbHRlcihhY3RvciA9PiBhY3RvciAhPT0gbnVsbCAmJiBhY3RvciAhPT0gdW5kZWZpbmVkKWAgYWZ0ZXIgdGhlIG1hcCBvcGVyYXRpb25cblxuIyMjIDIuICoqRW5oYW5jZWQgTWF0cml4IEFjdGlvbnMgSW5pdGlhbGl6YXRpb24qKiAoYHNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHNgKVxuLSAqKklzc3VlKio6IE1hdHJpeCBhY3Rpb25zIHdlcmUgYmVpbmcgaW5pdGlhbGl6ZWQgZHVyaW5nIGRhdGEgcHJlcGFyYXRpb24gd2l0aG91dCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcgYW5kIHZhbGlkYXRpb25cbi0gKipGaXhlcyoqOlxuICAtIEFkZGVkIGBnYW1lLnJlYWR5YCBjaGVjayB0byBwcmV2ZW50IGluaXRpYWxpemF0aW9uIGR1cmluZyB3b3JsZCBsb2FkaW5nL21pZ3JhdGlvblxuICAtIEFkZGVkIGNvbXByZWhlbnNpdmUgZXJyb3IgaGFuZGxpbmcgd2l0aCB0cnktY2F0Y2ggYmxvY2tzXG4gIC0gQWRkZWQgdmFsaWRhdGlvbiBmb3IgYWN0b3IgZXhpc3RlbmNlIGJlZm9yZSBwcm9jZXNzaW5nXG4gIC0gQWRkZWQgbnVsbCBjaGVja3MgZm9yIG1hdHJpeCBhY3Rpb25zIGZyb20gY29tcGVuZGl1bVxuICAtIEFkZGVkIGZhbGxiYWNrIGZsYWcgc2V0dGluZyB0byBwcmV2ZW50IHJlcGVhdGVkIGZhaWxlZCBhdHRlbXB0c1xuXG4jIyMgMy4gKipGaXhlZCBIZWxwZXIgRnVuY3Rpb25zKiogKGBzcmMvbW9kdWxlL2hlbHBlcnMudHNgKVxuLSAqKklzc3VlKio6IGBnZXRDb250cm9sbGVkVG9rZW5BY3RvcnMoKWAgd2FzIG1hcHBpbmcgdG9rZW5zIHdpdGhvdXQgZmlsdGVyaW5nIG91dCBudWxsIGFjdG9yc1xuLSAqKkZpeCoqOiBBZGRlZCBgLmZpbHRlcihhY3RvciA9PiBhY3RvciAhPT0gbnVsbCAmJiBhY3RvciAhPT0gdW5kZWZpbmVkKWAgYWZ0ZXIgbWFwcGluZ1xuLSAqKklzc3VlKio6IGBnZXREZWZlbnNlUmF0aW5nKClgIHdhcyBhY2Nlc3NpbmcgYHRva2VuLmFjdG9yYCB3aXRob3V0IG51bGwgY2hlY2tpbmdcbi0gKipGaXgqKjogQWRkZWQgbnVsbCBjaGVjayBhbmQgZWFybHkgY29udGludWUgZm9yIHRva2VucyB3aXRob3V0IGFjdG9yc1xuXG4jIyMgNC4gKipGaXhlZCBEb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycyoqIChgc3JjL21vZHVsZS9ydWxlcy9Eb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycy50c2ApXG4tICoqSXNzdWUqKjogVXNpbmcgb3B0aW9uYWwgY2hhaW5pbmcgYD8uYCBidXQgbm90IGhhbmRsaW5nIHRoZSBjYXNlIHdoZXJlIGFjdG9yIGlzIG51bGxcbi0gKipGaXgqKjogQWRkZWQgZXhwbGljaXQgbnVsbCBjaGVjayBiZWZvcmUgY2FsbGluZyBgZ2V0U2l0dWF0aW9uTW9kaWZpZXJzKClgXG5cbiMjIyBLZXkgSW1wcm92ZW1lbnRzOlxuMS4gKipOdWxsIFNhZmV0eSoqOiBBbGwgdG9rZW4uYWN0b3IgYWNjZXNzZXMgbm93IGhhdmUgcHJvcGVyIG51bGwgY2hlY2tzXG4yLiAqKkVycm9yIEhhbmRsaW5nKio6IE1hdHJpeCBhY3Rpb25zIGluaXRpYWxpemF0aW9uIGlzIHdyYXBwZWQgaW4gdHJ5LWNhdGNoIGJsb2Nrc1xuMy4gKipUaW1pbmcqKjogTWF0cml4IGFjdGlvbnMgb25seSBpbml0aWFsaXplIHdoZW4gZ2FtZSBpcyBmdWxseSByZWFkeVxuNC4gKipWYWxpZGF0aW9uKio6IEFkZGVkIHZhbGlkYXRpb24gZm9yIGFjdG9yIGV4aXN0ZW5jZSBhbmQgdmFsaWRpdHlcbjUuICoqUmVzaWxpZW5jZSoqOiBBZGRlZCBmYWxsYmFjayBtZWNoYW5pc21zIHRvIHByZXZlbnQgcmVwZWF0ZWQgZmFpbHVyZXNcblxuVGhlc2UgY2hhbmdlcyBzaG91bGQgcmVzb2x2ZSB0aGUgXCJhY3RvcnMgbm90IGV4aXN0aW5nXCIgZXJyb3JzIGJ5IGVuc3VyaW5nIHRoYXQ6XG4tIFRva2VucyB3aXRob3V0IGxpbmtlZCBhY3RvcnMgYXJlIHByb3Blcmx5IGZpbHRlcmVkIG91dFxuLSBNYXRyaXggYWN0aW9ucyBpbml0aWFsaXphdGlvbiBkb2Vzbid0IHJ1biBkdXJpbmcgd29ybGQgbG9hZGluZ1xuLSBBbGwgYWN0b3IgYWNjZXNzZXMgYXJlIG51bGwtc2FmZVxuLSBFcnJvcnMgYXJlIGNhdWdodCBhbmQgbG9nZ2VkIGluc3RlYWQgb2YgY3Jhc2hpbmcgdGhlIHN5c3RlbVxuXG5MZXQgbWUgcnVuIGEgcXVpY2sgdGVzdCB0byBtYWtlIHN1cmUgdGhlIHN5bnRheCBpcyBjb3JyZWN0OlxuIiwid29ya3NwYWNlX2ZpbGVfY2h1bmtzIjpbXX0seyJyZXF1ZXN0X2lkIjoiNGFiNmQyNWUtY2EzYi00N2NlLTljZWMtYTRjNGRlODUzNzhmIiwic3RhdHVzIjoiY2FuY2VsbGVkIiwiY2hhdEl0ZW1UeXBlIjoiYWdlbnRpYy10dXJuLWRlbGltaXRlciJ9LHsicmVxdWVzdF9pZCI6IjZmNmE1MjdkLTIyNjEtNGVlMS05ODk5LWViYzU3MDg1NzZhYiIsInV1aWQiOiI1ZmVjMDgxMy0zYTRmLTRjM2YtYjQ5MC00NjNlYTc1ZGFjNzgiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDgzNjA2MzM0MTQsInRvVGltZXN0YW1wIjoxNzQ4NTYxNjc4Njc1LCJzZWVuX3N0YXRlIjoic2VlbiJ9LHsicmVxdWVzdF9pZCI6ImYzMTJmOTk0LWJhZWYtNGM5MS05ZjI2LTAzZjlkZTBkMWEwOSIsInV1aWQiOiIyODI1Zjk3MC1kZmU4LTQzODgtODA0Mi03MTM2ZGFkZGNlMWIiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDg1NjE2Nzg2NzUsInRvVGltZXN0YW1wIjoxNzQ4Njc2MDg4NDM4LCJzZWVuX3N0YXRlIjoic2VlbiJ9LHsicmVxdWVzdF9pZCI6IjRkODY3MWRjLTIxNjItNDVkNi05ZGJjLTczMzlkMzhlY2I5YyIsInV1aWQiOiJkZTE3OTNhZi1lMmYxLTRiMDktOTZlOC05MTlkMGFhNWMyNTUiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDg2NzYwODg0MzgsInRvVGltZXN0YW1wIjoxNzQ4ODIwNTg4NzY5LCJzZWVuX3N0YXRlIjoic2VlbiJ9LHsicmVxdWVzdF9pZCI6IjBkZDk3ZmRjLTliYWItNGNlNS1hNGM5LWY0YWRmYWU1YTQ5YyIsInV1aWQiOiIxYzk0YmQwNi02NmRkLTQ4N2QtODI3YS0wNzhhNWNjMjhhMGYiLCJjaGF0SXRlbVR5cGUiOiJhZ2VudGljLWNoZWNrcG9pbnQtZGVsaW1pdGVyIiwic3RhdHVzIjoic3VjY2VzcyIsImZyb21UaW1lc3RhbXAiOjE3NDg4MjA1ODg3NjksInRvVGltZXN0YW1wIjoxNzQ4OTAyMDU5ODI4LCJzZWVuX3N0YXRlIjoic2VlbiJ9XSwiZmVlZGJhY2tTdGF0ZXMiOnsidGVtcC1mZS1mMTg0OTAyYS04NmI2LTRjNDEtODVhZS0zYTI3YTk0YTI0NjUiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWQzYjQzMWI1LTNhMWItNDc2YS05MGM2LTM0YjZkZjZmN2E3NiI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtNTBjMGMxZmMtYmQ5MS00ZmFkLWExNjEtYjhkMGFjMzI2Yjk1Ijp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1iNzIzNzQ4NC1lNmEzLTRiMGItYTY4NS1mNTRlMTBlNmEzNGEiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTkzNDQ0NWQ0LThmMjAtNDY0Mi1iZTg4LTQ0ZDM1ZDk2ZTI1OSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtMGRhYTY1YjgtM2QwYi00YTEzLTliNzQtYWM1ZmVjZGRiZmYxIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS0xZGIzODIwZi00YjEzLTRjZjYtYmU1OC00MzFjOWFmMTJkOTUiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWNlNWI3ZjM0LTI4MmUtNDg0NS1iMzc5LWY1YWE3ZjcyYTgzZSI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtYjk2NGViNDgtOTViMi00MDdlLTljNDgtZDRkMWUxYjc5Yzc5Ijp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1lNWVjMTcyZS0yZGJlLTRjN2UtYjk4Mi0xMzU3MTU5ZWQ1MWQiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLWJjYTkwODI5LWY3NTQtNDJkZS1hODMxLTNhYjBmZGRiNWE1OCI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtY2UzOTFmYjYtOTE2NS00ZWQ1LTg5ODktZTA0NmYzNmU5NmIxIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS0wNjY4ZWM1Zi03NGNkLTRmZTgtYjg0OS00YzE3YTYxNTBlZTgiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTViMTBlZTg1LTMwNTMtNDE3YS04YjkxLTc3MDllZmQ1M2NlNCI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtMTI2MGEyMzQtZDJmMC00YmRhLWJjZDAtOWNiNWU3ZjQ2ZTg2Ijp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1iMWZlNjYyZS1jNDAwLTRhMmItOWQ0NC1mZjQ2MDQwNzg1MWUiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9LCJ0ZW1wLWZlLTY2NmM4MGI3LTVlYWItNDU4Ni1hOTlhLTYzMDE1ZmIzNjJmOCI6eyJzZWxlY3RlZFJhdGluZyI6MCwiZmVlZGJhY2tOb3RlIjoiIn0sInRlbXAtZmUtY2FiMjNmZjgtYzA0ZS00ZGZmLWE3YmYtMGNlNmU2ZWZmZDAyIjp7InNlbGVjdGVkUmF0aW5nIjowLCJmZWVkYmFja05vdGUiOiIifSwidGVtcC1mZS1iNzYzYzY3OC00OWJiLTQ5OTYtYjIyZS0wOWRiYTdmNTg3MjEiOnsic2VsZWN0ZWRSYXRpbmciOjAsImZlZWRiYWNrTm90ZSI6IiJ9fSwidG9vbFVzZVN0YXRlcyI6eyI2MGE0MGM2OS1lOTY1LTQyYzYtODg1MC1mOWI5ZGE2NWMyMGM7dG9vbHVfdnJ0eF8wMVRzTEtTRmVZM2ZtN3JZYnBSejE2TEQiOnsicmVxdWVzdElkIjoiNjBhNDBjNjktZTk2NS00MmM2LTg4NTAtZjliOWRhNjVjMjBjIiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMVRzTEtTRmVZM2ZtN3JZYnBSejE2TEQiLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJUaGUgZm9sbG93aW5nIGNvZGUgc2VjdGlvbnMgd2VyZSByZXRyaWV2ZWQ6XG5QYXRoOiBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzXG4uLi5cbiAgIDMxN1x0XG4gICAzMThcdCAgICAgICAgLy8gRW5zdXJlIG1hdHJpeCBhY3Rpb25zIGFyZSBhdmFpbGFibGUgZm9yIGFsbCBhY3RvcnMgdGhhdCBjYW4gdXNlIHRoZSBNYXRyaXhcbiAgIDMxOVx0ICAgICAgICBpZiAoZ2FtZS51c2VyPy5pc0dNICYmIHRoaXMuaXNPd25lciAmJiAodGhpcy5pc0NoYXJhY3RlcigpIHx8IHRoaXMuaXNTcHJpdGUoKSB8fCB0aGlzLmlzSUMoKSkpIHtcbiAgIDMyMFx0ICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXG4gICAzMjFcdCAgICAgICAgICAgIGNvbnN0IGhhc01hdHJpeEFjdGlvbnMgPSB0aGlzLmdldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycpO1xuICAgMzIyXHQgICAgICAgICAgICBpZiAoIWhhc01hdHJpeEFjdGlvbnMpIHtcbiAgIDMyM1x0ICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gdXNlIGEgc2V0VGltZW91dCB0byBhdm9pZCBpc3N1ZXMgd2l0aCB0aGUgYWN0b3IgYmVpbmcgbG9ja2VkIGR1cmluZyBkYXRhIHByZXBhcmF0aW9uXG4gICAzMjRcdCAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZW5zdXJlTWF0cml4QWN0aW9ucygpLCA1MDApO1xuICAgMzI1XHQgICAgICAgICAgICB9XG4gICAzMjZcdCAgICAgICAgfVxuICAgMzI3XHQgICAgfVxuICAgMzI4XHRcbiAgIDMyOVx0ICAgIC8qKlxuICAgMzMwXHQgICAgICogTk9URTogVGhpcyBtZXRob2QgaXMgdW51c2VkIGF0IHRoZSBtb21lbnQsIGtlZXAgaXQgZm9yIGZ1dHVyZSBpbnNwaXJhdGlvbi5cbiAgIDMzMVx0ICAgICAqL1xuICAgMzMyXHQgICAgYXBwbHlPdmVycmlkZUFjdGl2ZUVmZmVjdHMoKSB7XG4gICAzMzNcdCAgICAgICAgY29uc3QgY2hhbmdlcyA9IHRoaXMuZWZmZWN0cy5yZWR1Y2UoKGNoYW5nZXM6IEVmZmVjdENoYW5nZURhdGFbXSwgZWZmZWN0KSA9PiB7XG4gICAzMzRcdCAgICAgICAgICAgIGlmIChlZmZlY3QuZGF0YS5kaXNhYmxlZCkgcmV0dXJuIGNoYW5nZXM7XG4uLi5cbiAgMTQ1MFx0XG4gIDE0NTFcdCAgICAvKiogUmV0dXJuIGVpdGhlciB0aGUgbGlua2VkIHRva2VuIG9yIHRoZSB0b2tlbiBvZiB0aGUgc3ludGhldGljIGFjdG9yLlxuICAxNDUyXHQgICAgICpcbiAgMTQ1M1x0ICAgICAqIEByZXR1cm4gV2lsbCByZXR1cm4gbnVsbCBzaG91bGQgbm8gdG9rZW4gaGF2ZSBiZWVuIHBsYWNlZCBvbiBzY2VuZS5cbiAgMTQ1NFx0ICAgICAqL1xuICAxNDU1XHQgICAgZ2V0VG9rZW4oKTogVG9rZW5Eb2N1bWVudCB8IG51bGwge1xuICAxNDU2XHQgICAgICAgIC8vIExpbmtlZCBhY3RvcnMgY2FuIG9ubHkgaGF2ZSBvbmUgdG9rZW4sIHdoaWNoIGlzbid0IHN0b3JlZCB3aXRoaW4gYWN0b3IgZGF0YS4uLlxuICAxNDU3XHQgICAgICAgIGlmICh0aGlzLl9pc0xpbmtlZFRvVG9rZW4oKSAmJiB0aGlzLmhhc1Rva2VuKCkpIHtcbiAgMTQ1OFx0ICAgICAgICAgICAgY29uc3QgbGlua2VkID0gdHJ1ZTtcbiAgMTQ1OVx0ICAgICAgICAgICAgY29uc3QgdG9rZW5zID0gdGhpcy5nZXRBY3RpdmVUb2tlbnMobGlua2VkKSBhcyB1bmtub3duIGFzIFRva2VuW107XG4gIDE0NjBcdCAgICAgICAgICAgIC8vIFRoaXMgYXNzdW1lcyBmb3IgYSB0b2tlbiB0byBleGlzdCBhbmQgc2hvdWxkIGZhaWwgaWYgbm90LlxuICAxNDYxXHQgICAgICAgICAgICByZXR1cm4gdG9rZW5zWzBdLmRvY3VtZW50O1xuICAxNDYyXHQgICAgICAgIH1cbiAgMTQ2M1x0XG4gIDE0NjRcdCAgICAgICAgLy8gVW5saW5rZWQgYWN0b3JzIGNhbiBoYXZlIG11bHRpcGxlIGFjdGl2ZSB0b2tlbiBidXQgZWFjaCBoYXZlIHRoZWlycyBkaXJlY3RseSBhdHRhY2hlZC4uLlxuICAxNDY1XHQgICAgICAgIHJldHVybiB0aGlzLnRva2VuO1xuICAxNDY2XHQgICAgfVxuICAxNDY3XHRcbiAgMTQ2OFx0ICAgIC8qKlxuICAxNDY5XHQgICAgICogVGhlcmUgaXMgbm8gbmVlZCBmb3IgYSB0b2tlbiB0byBwbGFjZWQuIFRoZSBwcm90b3R5cGUgdG9rZW4gaXMgZW5vdWdoLlxuICAxNDcwXHQgICAgICovXG4gIDE0NzFcdCAgICBfaXNMaW5rZWRUb1Rva2VuKCk6IGJvb2xlYW4ge1xuICAxNDcyXHQgICAgICAgIC8vQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgMTQ3M1x0ICAgICAgICAvLyBJZiBhbiBhY3RvciBpcyBsaW5rZWQsIGFsbCBpdCdzIGNvcGllcyBhbHNvIGNvbnRhaW4gdGhpcyBsaW5rZWQgc3RhdHVzLCBldmVuIGlmIHRoZXkncmUgbm90LlxuICAxNDc0XHQgICAgICAgIHJldHVybiB0aGlzLnByb3RvdHlwZVRva2VuLmFjdG9yTGluayAmJiAhdGhpcy50b2tlbjtcbiAgMTQ3NVx0ICAgIH1cbiAgMTQ3Nlx0XG4gIDE0NzdcdCAgICBoYXNUb2tlbigpOiBib29sZWFuIHtcbiAgMTQ3OFx0ICAgICAgICByZXR1cm4gdGhpcy5nZXRBY3RpdmVUb2tlbnMoKS5sZW5ndGggPiAwO1xuICAxNDc5XHQgICAgfVxuICAxNDgwXHRcbiAgMTQ4MVx0ICAgIGhhc0FjdGl2ZVBsYXllck93bmVyKCk6IGJvb2xlYW4ge1xuICAxNDgyXHQgICAgICAgIGNvbnN0IHBsYXllcnMgPSB0aGlzLmdldEFjdGl2ZVBsYXllck93bmVycygpO1xuICAxNDgzXHQgICAgICAgIHJldHVybiBwbGF5ZXJzLmxlbmd0aCA+IDA7XG4gIDE0ODRcdCAgICB9XG4gIDE0ODVcdFxuICAxNDg2XHQgICAgZ2V0QWN0aXZlUGxheWVyKCk6IFVzZXIgfCBudWxsIHtcbiAgMTQ4N1x0ICAgICAgICBpZiAoIWdhbWUudXNlcnMpIHJldHVybiBudWxsO1xuICAxNDg4XHQgICAgICAgIGlmICghdGhpcy5oYXNQbGF5ZXJPd25lcikgcmV0dXJuIG51bGw7XG4gIDE0ODlcdFxuICAxNDkwXHQgICAgICAgIGZvciAoY29uc3QgdXNlciBvZiBnYW1lLnVzZXJzLmNvbnRlbnRzKSB7XG4gIDE0OTFcdCAgICAgICAgICAgIGlmICghdXNlci5hY3RpdmUgfHwgdXNlci5pc0dNKSB7XG4gIDE0OTJcdCAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgMTQ5M1x0ICAgICAgICAgICAgfVxuICAxNDk0XHQgICAgICAgICAgICBpZiAodGhpcy5pZCA9PT0gdXNlci5jaGFyYWN0ZXI/LmlkKSB7XG4gIDE0OTVcdCAgICAgICAgICAgICAgICByZXR1cm4gdXNlcjtcbiAgMTQ5Nlx0ICAgICAgICAgICAgfVxuICAxNDk3XHQgICAgICAgIH1cbiAgMTQ5OFx0XG4gIDE0OTlcdCAgICAgICAgcmV0dXJuIG51bGw7XG4gIDE1MDBcdCAgICB9XG4uLi5cbiAgMTc5N1x0XG4gIDE3OThcdCAgICAvKipcbiAgMTc5OVx0ICAgICAqIFRoZSBtYXRyaXggZGVwZW5kcyBvbiBhY3RvciB0eXBlIGFuZCBwb3NzaWJseSBlcXVpcHBlZCBtYXRyaXggZGV2aWNlLlxuICAxODAwXHQgICAgICpcbiAgMTgwMVx0ICAgICAqIFVzZSB0aGlzIG1ldGhvZCBmb3Igd2hlbmV2ZXIgeW91IG5lZWQgdG8gYWNjZXNzIHRoaXMgYWN0b3JzIG1hdHJpeCBkYW1hZ2UgdHJhY2sgYXMgaXQncyBzb3VyY2UgbWlnaHQgZGlmZmVyLlxuICAxODAyXHQgICAgICovXG4gIDE4MDNcdCAgICBnZXRNYXRyaXhUcmFjaygpOiBTaGFkb3dydW4uQ29uZGl0aW9uRGF0YSB8IHVuZGVmaW5lZCB7XG4gIDE4MDRcdCAgICAgICAgLy8gU29tZSBhY3RvcnMgd2lsbCBoYXZlIGEgZGlyZWN0IG1hdHJpeCB0cmFjay5cbiAgMTgwNVx0ICAgICAgICBpZiAoXCJ0cmFja1wiIGluIHRoaXMuc3lzdGVtICYmIFwibWF0cml4XCIgaW4gdGhpcy5zeXN0ZW0udHJhY2spIHtcbiAgMTgwNlx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3lzdGVtLnRyYWNrLm1hdHJpeDtcbiAgMTgwN1x0ICAgICAgICB9XG4gIDE4MDhcdFxuICAxODA5XHQgICAgICAgIC8vIFNvbWUgYWN0b3JzIHdpbGwgaGF2ZSBhIHBlcnNvbmFsIG1hdHJpeCBjb25kaXRpb24gbW9uaXRvciwgbGlrZSBhIGRldmljZSBjb25kaXRpb24gbW9uaXRvci5cbiAgMTgxMFx0ICAgICAgICBpZiAodGhpcy5pc01hdHJpeEFjdG9yKSB7XG4gIDE4MTFcdCAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgaXNNYXRyaXhBY3RvciBjaGVja3MgZm9yIHRoZSBtYXRyaXggYXR0cmlidXRlXG4gIDE4MTJcdCAgICAgICAgICAgIHJldHVybiB0aGlzLnN5c3RlbS5tYXRyaXguY29uZGl0aW9uX21vbml0b3I7XG4gIDE4MTNcdCAgICAgICAgfVxuLi4uXG4gIDIyODlcdCAgICAgICAgaWYgKCF0YXJnZXQuYWN0b3IgfHwgIXRhcmdldC5hY3Rvci5pc01hdHJpeEFjdG9yKSByZXR1cm4gMDtcbiAgMjI5MFx0XG4gIDIyOTFcdFxuICAyMjkyXHQgICAgICAgIGNvbnN0IHNjZW5lID0gb3B0aW9ucz8uc2NlbmUgfHwgY2FudmFzLnNjZW5lIGFzIFNjZW5lO1xuICAyMjkzXHQgICAgICAgIC8vIElmIGFuIGFjdG9yIGhhcyBiZWVuIHRhcmdldGVkLCB0aGV5IG1pZ2h0IGhhdmUgYSBkZXZpY2UuIElmIGFuIGl0ZW0gLyBob3N0IGhhcyBiZWVuIHRhcmdldGVkIHRoZXkgZG9uJ3QuXG4gIDIyOTRcdCAgICAgICAgaXRlbSA9IGl0ZW0gfHwgdGFyZ2V0IGluc3RhbmNlb2YgU1I2QWN0b3IgPyB0YXJnZXQuYWN0b3IuZ2V0TWF0cml4RGV2aWNlKCkgOiB1bmRlZmluZWQ7XG4gIDIyOTVcdFxuICAyMjk2XHQgICAgICAgIGNvbnN0IG1hcmtJZCA9IEhlbHBlcnMuYnVpbGRNYXJrSWQoc2NlbmUuaWQgYXMgc3RyaW5nLCB0YXJnZXQuaWQsIGl0ZW0/LmlkIGFzIHN0cmluZyk7XG4gIDIyOTdcdCAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFya3NCeUlkKG1hcmtJZCk7XG4gIDIyOThcdCAgICB9XG4gIDIyOTlcdFxuICAyMzAwXHQgICAgZ2V0TWFya3NCeUlkKG1hcmtJZDogc3RyaW5nKTogbnVtYmVyIHtcbiAgMjMwMVx0ICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXhEYXRhPy5tYXJrc1ttYXJrSWRdIHx8IDA7XG4gIDIzMDJcdCAgICB9XG4uLi5cbiAgMjczN1x0XG4gIDI3MzhcdCAgICAvKipcbiAgMjczOVx0ICAgICAqIEVuc3VyZXMgdGhhdCB0aGUgYWN0b3IgaGFzIGFjY2VzcyB0byBhbGwgbWF0cml4IGFjdGlvbnMgZnJvbSB0aGUgbWF0cml4LWFjdGlvbnMgY29tcGVuZGl1bS5cbiAgMjc0MFx0ICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgYWRkIGFueSBtaXNzaW5nIG1hdHJpeCBhY3Rpb25zIHRvIHRoZSBhY3Rvci5cbiAgMjc0MVx0ICAgICAqXG4gIDI3NDJcdCAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgMjc0M1x0ICAgICAqL1xuICAyNzQ0XHQgICAgYXN5bmMgZW5zdXJlTWF0cml4QWN0aW9ucygpIHtcbiAgMjc0NVx0ICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgRW5zdXJpbmcgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfSAoJHt0aGlzLmlkfSlgKTtcbiAgMjc0Nlx0XG4gIDI3NDdcdCAgICAgICAgLy8gQ2hlY2sgaWYgd2UndmUgYWxyZWFkeSBhZGRlZCBtYXRyaXggYWN0aW9ucyB0byB0aGlzIGFjdG9yXG4gIDI3NDhcdCAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XG4gIDI3NDlcdCAgICAgICAgaWYgKGhhc01hdHJpeEFjdGlvbnMpIHtcbiAgMjc1MFx0ICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8ICR7dGhpcy5uYW1lfSBhbHJlYWR5IGhhcyBtYXRyaXggYWN0aW9ucyBmbGFnIHNldGApO1xuICAyNzUxXHQgICAgICAgICAgICByZXR1cm47XG4gIDI3NTJcdCAgICAgICAgfVxuICAyNzUzXHRcbiAgMjc1NFx0ICAgICAgICAvLyBHZXQgdGhlIG1hdHJpeCBhY3Rpb25zIGNvbXBlbmRpdW1cbiAgMjc1NVx0ICAgICAgICBjb25zdCBtYXRyaXhQYWNrID0gZ2FtZS5wYWNrcy5nZXQoXCJzcjZlbHlzaXVtLm1hdHJpeC1hY3Rpb25zXCIpO1xuICAyNzU2XHQgICAgICAgIGlmICghbWF0cml4UGFjaykge1xuICAyNzU3XHQgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiU2hhZG93cnVuIDZlIHwgTWF0cml4IEFjdGlvbnMgY29tcGVuZGl1bSBub3QgZm91bmRcIik7XG4gIDI3NThcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjc1OVx0ICAgICAgICB9XG4gIDI3NjBcdFxuICAyNzYxXHQgICAgICAgIC8vIEdldCBhbGwgbWF0cml4IGFjdGlvbnNcbiAgMjc2Mlx0ICAgICAgICBhd2FpdCBtYXRyaXhQYWNrLmdldEluZGV4KCk7XG4gIDI3NjNcdCAgICAgICAgY29uc3QgbWF0cml4QWN0aW9ucyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAyNzY0XHQgICAgICAgICAgICBBcnJheS5mcm9tKG1hdHJpeFBhY2suaW5kZXgpLm1hcChpID0+IG1hdHJpeFBhY2suZ2V0RG9jdW1lbnQoaS5faWQpKVxuICAyNzY1XHQgICAgICAgICk7XG4gIDI3NjZcdFxuICAyNzY3XHQgICAgICAgIC8vIEdldCBleGlzdGluZyBhY3Rpb24gbmFtZXMgdG8gYXZvaWQgZHVwbGljYXRlc1xuICAyNzY4XHQgICAgICAgIGNvbnN0IGV4aXN0aW5nTmFtZXMgPSB0aGlzLml0ZW1zXG4gIDI3NjlcdCAgICAgICAgICAgIC5maWx0ZXIoaSA9PiBpLnR5cGUgPT09IFwiYWN0aW9uXCIpXG4gIDI3NzBcdCAgICAgICAgICAgIC5tYXAoaSA9PiBpLm5hbWUudG9Mb3dlckNhc2UoKSk7XG4gIDI3NzFcdFxuICAyNzcyXHQgICAgICAgIC8vIEZpbHRlciBvdXQgYWN0aW9ucyB0aGUgYWN0b3IgYWxyZWFkeSBoYXNcbiAgMjc3M1x0ICAgICAgICBjb25zdCBhY3Rpb25zVG9BZGQgPSBtYXRyaXhBY3Rpb25zLmZpbHRlcihcbiAgMjc3NFx0ICAgICAgICAgICAgYSA9PiAhZXhpc3RpbmdOYW1lcy5pbmNsdWRlcyhhLm5hbWUudG9Mb3dlckNhc2UoKSlcbiAgMjc3NVx0ICAgICAgICApO1xuICAyNzc2XHRcbiAgMjc3N1x0ICAgICAgICBpZiAoYWN0aW9uc1RvQWRkLmxlbmd0aCA9PT0gMCkge1xuICAyNzc4XHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIGFsbCBtYXRyaXggYWN0aW9uc2ApO1xuICAyNzc5XHQgICAgICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBjaGVja2VkIGZvciBtYXRyaXggYWN0aW9uc1xuICAyNzgwXHQgICAgICAgICAgICBhd2FpdCB0aGlzLnNldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycsIHRydWUpO1xuICAyNzgxXHQgICAgICAgICAgICByZXR1cm47XG4gIDI3ODJcdCAgICAgICAgfVxuICAyNzgzXHRcbiAgMjc4NFx0ICAgICAgICAvLyBBZGQgdGhlIGFjdGlvbnNcbiAgMjc4NVx0ICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUVtYmVkZGVkRG9jdW1lbnRzKFxuICAyNzg2XHQgICAgICAgICAgICBcIkl0ZW1cIixcbiAgMjc4N1x0ICAgICAgICAgICAgYWN0aW9uc1RvQWRkLm1hcChhID0+IGEudG9PYmplY3QoKSlcbiAgMjc4OFx0ICAgICAgICApO1xuICAyNzg5XHRcbiAgMjc5MFx0ICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgQWRkZWQgJHthY3Rpb25zVG9BZGQubGVuZ3RofSBtYXRyaXggYWN0aW9ucyB0byAke3RoaXMubmFtZX1gKTtcbiAgMjc5MVx0XG4gIDI3OTJcdCAgICAgICAgLy8gU2V0IHRoZSBmbGFnIHRvIGluZGljYXRlIHRoYXQgd2UndmUgYWRkZWQgbWF0cml4IGFjdGlvbnNcbiAgMjc5M1x0ICAgICAgICBhd2FpdCB0aGlzLnNldEZsYWcoJ3NyNmVseXNpdW0nLCAnaGFzTWF0cml4QWN0aW9ucycsIHRydWUpO1xuICAyNzk0XHQgICAgfVxuICAyNzk1XHRcbiAgMjc5Nlx0ICAgIGFzeW5jIG5ld1NjZW5lU2V0dXAoKSB7XG4gIDI3OTdcdCAgICAgICAgY29uc3QgdXBkYXRlRGF0YTogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAyNzk4XHRcbiAgMjc5OVx0ICAgICAgICB1cGRhdGVEYXRhWydzeXN0ZW0uYXR0cmlidXRlcy5lZGdlLnVzZXMnXSA9IHRoaXMuZ2V0RWRnZSgpLnZhbHVlO1xuICAyODAwXHRcbiAgMjgwMVx0ICAgICAgICBpZih1cGRhdGVEYXRhKSBhd2FpdCB0aGlzLnVwZGF0ZSh1cGRhdGVEYXRhKTtcbiAgMjgwMlx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9wcmVwL2Z1bmN0aW9ucy9Jbml0aWF0aXZlUHJlcC50c1xuLi4uXG4gICAgOTRcdFxuICAgIDk1XHQgICAgc3RhdGljIHByZXBhcmVNYXRyaXhJbml0KHN5c3RlbTogQWN0b3JUeXBlc0RhdGEgJiBNYXRyaXhBY3RvckRhdGEpIHtcbiAgICA5Nlx0ICAgICAgICBjb25zdCB7IGluaXRpYXRpdmUsIGF0dHJpYnV0ZXMsIG1vZGlmaWVycywgbWF0cml4IH0gPSBzeXN0ZW07XG4gICAgOTdcdCAgICAgICAgaWYgKG1hdHJpeCkge1xuICAgIDk4XHRcbiAgICA5OVx0ICAgICAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguYmFzZS5iYXNlID0gYXR0cmlidXRlcy5pbnR1aXRpb24udmFsdWUgKyBzeXN0ZW0ubWF0cml4LmRhdGFfcHJvY2Vzc2luZy52YWx1ZTtcbiAgIDEwMFx0ICAgICAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguYmFzZS5tb2QgPSBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydChpbml0aWF0aXZlLm1hdHJpeC5iYXNlLm1vZCwgXCJTUjYuQm9udXNcIiwgTnVtYmVyKG1vZGlmaWVyc1snbWF0cml4X2luaXRpYXRpdmUnXSkpO1xuICAgMTAxXHQgICAgICAgICAgICBpbml0aWF0aXZlLm1hdHJpeC5iYXNlLnZhbHVlID0gSGVscGVycy5jYWxjVG90YWwoaW5pdGlhdGl2ZS5tYXRyaXguYmFzZSk7XG4gICAxMDJcdFxuICAgMTAzXHQgICAgICAgICAgICBpbml0aWF0aXZlLm1hdHJpeC5kaWNlLmJhc2UgPSAobWF0cml4LmhvdF9zaW0gPyA0IDogMyk7XG4gICAxMDRcdCAgICAgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmRpY2UubW9kID0gUGFydHNMaXN0LkFkZFVuaXF1ZVBhcnQoaW5pdGlhdGl2ZS5tYXRyaXguZGljZS5tb2QsIFwiU1I2LkJvbnVzXCIsIE51bWJlcihtb2RpZmllcnNbJ21hdHJpeF9pbml0aWF0aXZlX2RpY2UnXSkpO1xuICAgMTA1XHQgICAgICAgICAgICBpbml0aWF0aXZlLm1hdHJpeC5kaWNlLnZhbHVlID0gSGVscGVycy5jYWxjVG90YWwoaW5pdGlhdGl2ZS5tYXRyaXguZGljZSwge21pbjogMCwgbWF4OiA1fSk7XG4gICAxMDZcdCAgICAgICAgfVxuICAgMTA3XHQgICAgfVxuICAgMTA4XHR9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvYWN0b3IvcHJlcC9mdW5jdGlvbnMvTWF0cml4UHJlcC50c1xuLi4uXG4gICAgIDlcdFxuICAgIDEwXHRleHBvcnQgY2xhc3MgTWF0cml4UHJlcCB7XG4gICAgMTFcdCAgICAvKipcbiAgICAxMlx0ICAgICAqIFByZXBhcmUgTWF0cml4IGRhdGEgb24gdGhlIGFjdG9yXG4gICAgMTNcdCAgICAgKiAtIGlmIGFuIGl0ZW0gaXMgZXF1aXBwZWQsIGl0IHdpbGwgdXNlIHRoYXQgZGF0YVxuICAgIDE0XHQgICAgICogLSBpZiBpdCBpc24ndCBhbmQgcGxheWVyIGlzIHRlY2hub21hbmNlciwgaXQgd2lsbCB1c2UgdGhhdCBkYXRhXG4gICAgMTVcdCAgICAgKi9cbiAgICAxNlx0ICAgIHN0YXRpYyBwcmVwYXJlTWF0cml4KHN5c3RlbTogQWN0b3JUeXBlc0RhdGEgJiBNYXRyaXhBY3RvckRhdGEsIGl0ZW1zOiBTUjZJdGVtRGF0YVdyYXBwZXJbXSkge1xuICAgIDE3XHQgICAgICAgIGNvbnN0IHsgbWF0cml4LCBhdHRyaWJ1dGVzLCBtb2RpZmllcnMgfSA9IHN5c3RlbTtcbiAgICAxOFx0XG4gICAgMTlcdCAgICAgICAgY29uc3QgTWF0cml4TGlzdCA9IFsnZmlyZXdhbGwnLCAnc2xlYXplJywgJ2RhdGFfcHJvY2Vzc2luZycsICdhdHRhY2snXTtcbiAgICAyMFx0XG4gICAgMjFcdCAgICAgICAgLy8gY2xlYXIgbWF0cml4IGRhdGEgdG8gZGVmYXVsdHNcbiAgICAyMlx0ICAgICAgICBNYXRyaXhMaXN0LmZvckVhY2goKGtleSkgPT4ge1xuICAgIDIzXHQgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IG5ldyBQYXJ0c0xpc3QobWF0cml4W2tleV0ubW9kKTtcbiAgICAyNFx0ICAgICAgICAgICAgaWYgKG1hdHJpeFtrZXldLnRlbXApIHBhcnRzLmFkZFVuaXF1ZVBhcnQoJ1NSNi5UZW1wb3JhcnknLCBtYXRyaXhba2V5XS50ZW1wKTtcbiAgICAyNVx0ICAgICAgICAgICAgLy8gTEVHQUNZIGZyb20gd2hlbiB0aGUgc2hlZXQgdXNlZCAnbW9kLlRlbXBvcmFyeSdcbiAgICAyNlx0ICAgICAgICAgICAgcGFydHMucmVtb3ZlUGFydCgnVGVtcG9yYXJ5Jyk7XG4gICAgMjdcdCAgICAgICAgICAgIG1hdHJpeFtrZXldLm1vZCA9IHBhcnRzLmxpc3Q7XG4gICAgMjhcdCAgICAgICAgICAgIG1hdHJpeFtrZXldLnZhbHVlID0gcGFydHMudG90YWw7XG4gICAgMjlcdCAgICAgICAgfSk7XG4uLi5cbiAgICAzOFx0XG4gICAgMzlcdCAgICAgICAgaWYgKGRldmljZSkge1xuICAgIDQwXHQgICAgICAgICAgICBtYXRyaXguZGV2aWNlID0gZGV2aWNlLmdldElkKCk7XG4gICAgNDFcdFxuICAgIDQyXHQgICAgICAgICAgICBjb25zdCBjb25kaXRpb25Nb25pdG9yID0gZGV2aWNlLmdldENvbmRpdGlvbk1vbml0b3IoKTtcbiAgICA0M1x0XG4gICAgNDRcdCAgICAgICAgICAgIG1hdHJpeC5jb25kaXRpb25fbW9uaXRvci5tYXggPSBjb25kaXRpb25Nb25pdG9yLm1heCArIE51bWJlcihtb2RpZmllcnMubWF0cml4X3RyYWNrKTtcbiAgICA0NVx0ICAgICAgICAgICAgbWF0cml4LmNvbmRpdGlvbl9tb25pdG9yLnZhbHVlID0gY29uZGl0aW9uTW9uaXRvci52YWx1ZTtcbiAgICA0Nlx0ICAgICAgICAgICAgbWF0cml4LnJhdGluZyA9IGRldmljZS5nZXRSYXRpbmcoKTtcbiAgICA0N1x0ICAgICAgICAgICAgbWF0cml4LmlzX2N5YmVyZGVjayA9IGRldmljZS5pc0N5YmVyZGVjaygpO1xuICAgIDQ4XHQgICAgICAgICAgICBtYXRyaXgubmFtZSA9IGRldmljZS5nZXROYW1lKCk7XG4gICAgNDlcdCAgICAgICAgICAgIG1hdHJpeC5pdGVtID0gZGV2aWNlLmdldERhdGEoKTtcbiAgICA1MFx0ICAgICAgICAgICAgY29uc3QgZGV2aWNlQXR0cyA9IGRldmljZS5nZXRBU0RGKCk7XG4gICAgNTFcdCAgICAgICAgICAgIGlmIChkZXZpY2VBdHRzKSB7XG4gICAgNTJcdCAgICAgICAgICAgICAgICAvLyBzZXR1cCB0aGUgYWN0dWFsIG1hdHJpeCBhdHRyaWJ1dGVzIGZvciB0aGUgYWN0b3JcbiAgICA1M1x0ICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRldmljZUF0dHMpKSB7XG4gICAgNTRcdCAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlICYmIG1hdHJpeFtrZXldKSB7XG4gICAgNTVcdCAgICAgICAgICAgICAgICAgICAgICAgIG1hdHJpeFtrZXldLmJhc2UgPSB2YWx1ZS52YWx1ZTtcbiAgICA1Nlx0ICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4W2tleV0uZGV2aWNlX2F0dCA9IHZhbHVlLmRldmljZV9hdHQ7XG4gICAgNTdcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgIDU4XHQgICAgICAgICAgICAgICAgfVxuICAgIDU5XHQgICAgICAgICAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvYWN0b3IvcHJlcC9JQ1ByZXAudHNcbi4uLlxuICAgIDQzXHRcbiAgICA0NFx0ICAgIC8qKlxuICAgIDQ1XHQgICAgICogT24gaW5pdGlhbCBhY3RvciBjcmVhdGlvbiB0aGUgbWF0cml4IHRyYWNrIHdpbGwgYmUgbWlzc2luZy5cbiAgICA0Nlx0ICAgICAqXG4gICAgNDdcdCAgICAgKiBUaGlzIGlzIGludGVudGlvbmFsIGFzIG5vdCB0byBwb2xsdXRlIHRlbXBsYXRlLmpzb24gd2l0aCBhY3RvciB0eXBlIHNwZWNpZmljIGRhdGEuXG4gICAgNDhcdCAgICAgKlxuICAgIDQ5XHQgICAgICovXG4gICAgNTBcdCAgICBzdGF0aWMgYWRkTWlzc2luZ1RyYWNrcyhzeXN0ZW06IElDRGF0YSkge1xuICAgIDUxXHQgICAgICAgIC8vIE5ld2x5IGNyZWF0ZWQgYWN0b3JzIFNIT1VMRCBoYXZlIHRoaXMgYnkgdGVtcGxhdGUuXG4gICAgNTJcdCAgICAgICAgLy8gTGVnYWN5IGFjdG9ycyBNSUdIVCBub3QgaGF2ZSBpdCwgdGhlcmVmb3JlIG1ha2Ugc3VyZSBpdCdzIHRoZXJlLlxuICAgIDUzXHQgICAgICAgIGNvbnN0IHRyYWNrID0gc3lzdGVtLnRyYWNrIHx8IHt9O1xuICAgIDU0XHQgICAgICAgIGlmICghdHJhY2subWF0cml4KSB0cmFjay5tYXRyaXggPSBEYXRhRGVmYXVsdHMudHJhY2tEYXRhKCk7XG4gICAgNTVcdCAgICAgICAgc3lzdGVtLnRyYWNrID0gdHJhY2s7XG4gICAgNTZcdCAgICB9XG4gICAgNTdcdFxuICAgIDU4XHQgICAgLyoqXG4gICAgNTlcdCAgICAgKiBBZGQgSUMgbW9kaWZpZXJzIG9ubHkgdG8gdGhlIG1pc2MgdGFiLlxuICAgIDYwXHQgICAgICogQHBhcmFtIHN5c3RlbVxuICAgIDYxXHQgICAgICovXG4gICAgNjJcdCAgICBzdGF0aWMgcHJlcGFyZU1vZGlmaWVycyhzeXN0ZW06IElDRGF0YSkge1xuICAgIDYzXHQgICAgICAgIGxldCBtb2RpZmllcnMgPSBNb2RpZmllcnNQcmVwLmNvbW1vbk1vZGlmaWVycyBhcyBzdHJpbmdbXTtcbiAgICA2NFx0ICAgICAgICBtb2RpZmllcnMgPSBtb2RpZmllcnMuY29uY2F0KE1vZGlmaWVyc1ByZXAubWF0cml4TW9kaWZpZXJzIGFzIHN0cmluZ1tdKTtcbiAgICA2NVx0ICAgICAgICBNb2RpZmllcnNQcmVwLnNldHVwTW9kaWZpZXJzKHN5c3RlbSwgbW9kaWZpZXJzKTtcbiAgICA2Nlx0ICAgIH1cbi4uLlxuICAgIDg1XHRcbiAgICA4Nlx0ICAgIHN0YXRpYyBwcmVwYXJlTWF0cml4SW5pdChzeXN0ZW06IElDRGF0YSkge1xuICAgIDg3XHQgICAgICAgIGNvbnN0IHsgaW5pdGlhdGl2ZSwgbW9kaWZpZXJzLCBob3N0IH0gPSBzeXN0ZW07XG4gICAgODhcdFxuICAgIDg5XHRcbiAgICA5MFx0ICAgICAgICAvLyBTZXQgY3VycmVudCBpbml0aWF0aXZlIHRvIG1hdHJpeFxuICAgIDkxXHQgICAgICAgIGluaXRpYXRpdmUucGVyY2VwdGlvbiA9ICdtYXRyaXgnO1xuICAgIDkyXHRcbiAgICA5M1x0ICAgICAgICAvLyBQcmVwYXJlIHVzZWQgaW5pdGlhdGl2ZSBwYXJ0c1xuICAgIDk0XHQgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmJhc2UuYmFzZSA9IE1hdHJpeFJ1bGVzLmdldElDSW5pdGlhdGl2ZUJhc2UoaG9zdC5yYXRpbmcpO1xuICAgIDk1XHQgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmJhc2UubW9kID0gUGFydHNMaXN0LkFkZFVuaXF1ZVBhcnQoaW5pdGlhdGl2ZS5tYXRyaXguYmFzZS5tb2QsIFwiU1I2LkJvbnVzXCIsIE51bWJlcihtb2RpZmllcnNbJ21hdHJpeF9pbml0aWF0aXZlJ10pKTtcbiAgICA5Nlx0XG4gICAgOTdcdCAgICAgICAgaW5pdGlhdGl2ZS5tYXRyaXguZGljZS5iYXNlID0gTWF0cml4UnVsZXMuZ2V0SUNJbml0aWF0aXZlRGljZSgpO1xuICAgIDk4XHQgICAgICAgIGluaXRpYXRpdmUubWF0cml4LmRpY2UubW9kID0gUGFydHNMaXN0LkFkZFVuaXF1ZVBhcnQoaW5pdGlhdGl2ZS5tYXRyaXguZGljZS5tb2QsIFwiU1I2LkJvbnVzXCIsIE51bWJlcihtb2RpZmllcnNbJ21hdHJpeF9pbml0aWF0aXZlX2RpY2UnXSkpO1xuICAgIDk5XHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL2hlbHBlcnMudHNcbi4uLlxuICAgMzA3XHRcbiAgIDMwOFx0ICAgIC8vIFRPRE86IEZvdW5kcnkgMC45IFNob3VsZCBUb2tlbkRvY3VtZW50IGJlIHVzZWQgaW5zdGVhZCBvZiBUb2tlbj9cbiAgIDMwOVx0ICAgIC8vIFRPRE86IENoZWNrIGNhbnZhcy5zY2VuZS50b2tlbnNcbiAgIDMxMFx0ICAgIHN0YXRpYyBnZXRUb2tlbihpZD86IHN0cmluZyk6IFRva2VuIHwgdW5kZWZpbmVkIHtcbiAgIDMxMVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5IHx8ICFjYW52YXMudG9rZW5zKSByZXR1cm47XG4gICAzMTJcdFxuICAgMzEzXHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzKSB7XG4gICAzMTRcdCAgICAgICAgICAgIGlmICh0b2tlbi5pZCA9PT0gaWQpIHtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgIDMxNlx0ICAgICAgICAgICAgfVxuICAgMzE3XHQgICAgICAgIH1cbiAgIDMxOFx0ICAgIH1cbiAgIDMxOVx0XG4gICAzMjBcdCAgICAvKipcbiAgIDMyMVx0ICAgICAqIFVzZSB0aGlzIGhlbHBlciB0byBnZXQgYSB0b2tlbnMgYWN0b3IgZnJvbSBhbnkgZ2l2ZW4gc2NlbmUgaWQuXG4gICAzMjJcdCAgICAgKiBAcGFyYW0gc2NlbmVUb2tlbklkIEEgbWl4ZWQgaWQgd2l0aCB0aGUgZm9ybWF0ICc8c2NlbmVJZD4uPHRva2VuaWQ+XG4gICAzMjNcdCAgICAgKi9cbiAgIDMyNFx0ICAgIHN0YXRpYyBnZXRTY2VuZVRva2VuQWN0b3Ioc2NlbmVUb2tlbklkOiBzdHJpbmcpOiBTUjZBY3RvciB8IG51bGwge1xuICAgMzI1XHQgICAgICAgIGNvbnN0IFtzY2VuZUlkLCB0b2tlbklkXSA9IEhlbHBlcnMuZGVjb25zdHJ1Y3RTY2VuZVRva2VuSWQoc2NlbmVUb2tlbklkKTtcbiAgIDMyNlx0ICAgICAgICBjb25zdCB0b2tlbiA9IEhlbHBlcnMuZ2V0U2NlbmVUb2tlbkRvY3VtZW50KHNjZW5lSWQsIHRva2VuSWQpO1xuICAgMzI3XHQgICAgICAgIGlmICghdG9rZW4pIHJldHVybiBudWxsO1xuICAgMzI4XHQgICAgICAgIHJldHVybiB0b2tlbi5nZXRBY3RvcigpO1xuICAgMzI5XHQgICAgfVxuLi4uXG5QYXRoOiBwYWNrcy9fc291cmNlL3N5c3RlbS1tYWNyb3MvYWRkX21hdHJpeF9hY3Rpb25zLmpzb25cbiAgICAgMVx0e1xuICAgICAyXHQgIFwiX2lkXCI6IFwiYWRkTWF0cml4QWN0aW9uc1wiLFxuICAgICAzXHQgIFwibmFtZVwiOiBcIkFkZCBNYXRyaXggQWN0aW9ucyB0byBTZWxlY3RlZCBBY3RvcnNcIixcbiAgICAgNFx0ICBcInR5cGVcIjogXCJzY3JpcHRcIixcbiAgICAgNVx0ICBcImltZ1wiOiBcImljb25zL3N2Zy9kaWNlLXRhcmdldC5zdmdcIixcbiAgICAgNlx0ICBcInNjb3BlXCI6IFwiZ2xvYmFsXCIsXG4uLi5cbiAgICAgOFx0ICBcImZvbGRlclwiOiBudWxsLFxuICAgICA5XHQgIFwic29ydFwiOiAwLFxuICAgIDEwXHQgIFwib3duZXJzaGlwXCI6IHtcbiAgICAxMVx0ICAgIFwiZGVmYXVsdFwiOiAwXG4gICAgMTJcdCAgfSxcbiAgICAxM1x0ICBcImZsYWdzXCI6IHt9LFxuICAgIDE0XHQgIFwiX3N0YXRzXCI6IHtcbiAgICAxNVx0ICAgIFwic3lzdGVtSWRcIjogXCJzcjZlbHlzaXVtXCIsXG4gICAgMTZcdCAgICBcInN5c3RlbVZlcnNpb25cIjogXCIwLjI0LjBcIixcbiAgICAxN1x0ICAgIFwiY29yZVZlcnNpb25cIjogXCIxMVwiLFxuICAgIDE4XHQgICAgXCJjcmVhdGVkVGltZVwiOiAxNzE4NTYwMDAwMDAwLFxuICAgIDE5XHQgICAgXCJtb2RpZmllZFRpbWVcIjogMTcxODU2MDAwMDAwMCxcbiAgICAyMFx0ICAgIFwibGFzdE1vZGlmaWVkQnlcIjogXCJkZXZlbG9wZXJcIlxuICAgIDIxXHQgIH0sXG4gICAgMjJcdCAgXCJfa2V5XCI6IFwiIW1hY3JvcyFhZGRNYXRyaXhBY3Rpb25zXCJcbiAgICAyM1x0fVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL2l0ZW0vZmxvd3MvQWN0aW9uRmxvdy50c1xuICAgICAxXHQvKipcbiAgICAgMlx0ICogSGFuZGxlIGFsbCB0aGluZ3MgcmVsYXRlZCB0byB0aGUgYWN0aW9uIHRlbXBsYXRlICh0ZW1wbGF0ZS5qc29uKVxuICAgICAzXHQgKi9cbiAgICAgNFx0aW1wb3J0IHsgU1I2QWN0b3IgfSBmcm9tIFwiLi4vLi4vYWN0b3IvU1I2QWN0b3JcIjtcbiAgICAgNVx0aW1wb3J0IHsgSGVscGVycyB9IGZyb20gXCIuLi8uLi9oZWxwZXJzXCI7XG4gICAgIDZcdGltcG9ydCB7IFNSNkl0ZW0gfSBmcm9tIFwiLi4vU1I2SXRlbVwiO1xuICAgICA3XHRpbXBvcnQgeyBQYXJ0c0xpc3QgfSBmcm9tIFwiLi4vLi4vcGFydHMvUGFydHNMaXN0XCI7XG4gICAgIDhcdGltcG9ydCB7IFNSNiB9IGZyb20gXCIuLi8uLi9jb25maWdcIjtcbiAgICAgOVx0aW1wb3J0IHsgRGF0YURlZmF1bHRzIH0gZnJvbSBcIi4uLy4uL2RhdGEvRGF0YURlZmF1bHRzXCI7XG4gICAgMTBcdGltcG9ydCB7IFRyYW5zbGF0aW9uIH0gZnJvbSBcIi4uLy4uL3V0aWxzL3N0cmluZ3NcIjtcbiAgICAxMVx0XG4gICAgMTJcdGV4cG9ydCBjbGFzcyBBY3Rpb25GbG93IHtcbiAgICAxM1x0ICAgIC8qKlxuICAgIDE0XHQgICAgICogQ2FsY3VsYXRlIGFjdGlvbiBkYW1hZ2UgY29uZmlndXJhdGlvbiBiYXNlZCBvbiBmbGF0IGRhbWFnZSBmaWVsZCBhbmQgcG9zc2libGUgZHluYW1pYyBhdHRyaWJ1dGUgbW9kaWZpY2F0aW9uLlxuICAgIDE1XHQgICAgICpcbiAgICAxNlx0ICAgICAqIEBwYXJhbSBkYW1hZ2UgVGhlIGRhbWFnZSBmaWVsZCBhcyBkZWZpbmVkIHdpdGhpbiB0aGUgQWN0aW9uRGF0YVxuICAgIDE3XHQgICAgICogQHBhcmFtIGFjdG9yIFRoZSBhY3RvciB0byB1c2Ugc2hvdWxkIGEgZHluYW1pYyBjYWxjdWxhdGlvbiBiZSBuZWVkZWQuXG4gICAgMThcdCAgICAgKiBAcGFyYW0gaXRlbVxuICAgIDE5XHQgICAgICovXG4gICAgMjBcdCAgICBzdGF0aWMgY2FsY0RhbWFnZURhdGEoZGFtYWdlOiBTaGFkb3dydW4uRGFtYWdlRGF0YSwgYWN0b3I/OiBTUjZBY3RvciwgaXRlbT86IFNSNkl0ZW0pOiBTaGFkb3dydW4uRGFtYWdlRGF0YSB7XG4gICAgMjFcdCAgICAgICAgLy8gQXZvaWQgbWFuaXB1bGF0aW9uIG9uIG9yaWdpbmFsIGRhdGEsIHdoaWNoIG1pZ2h0IGNvbWUgZnJvbSBkYXRhYmFzZSB2YWx1ZXMuXG4gICAgMjJcdCAgICAgICAgZGFtYWdlID0gZm91bmRyeS51dGlscy5kdXBsaWNhdGUoZGFtYWdlKTtcbiAgICAyM1x0XG4gICAgMjRcdCAgICAgICAgaWYgKCFhY3RvcikgcmV0dXJuIGRhbWFnZTtcbiAgICAyNVx0XG4gICAgMjZcdCAgICAgICAgaWYgKGl0ZW0pIHtcbiAgICAyN1x0ICAgICAgICAgICAgZGFtYWdlLnNvdXJjZSA9IEFjdGlvbkZsb3cuX2RhbWFnZVNvdXJjZShhY3RvciwgaXRlbSk7XG4gICAgMjhcdCAgICAgICAgfVxuICAgIDI5XHRcbiAgICAzMFx0ICAgICAgICB0aGlzLl9hcHBseU1vZGlmaWFibGVWYWx1ZShkYW1hZ2UsIGFjdG9yKTtcbiAgICAzMVx0ICAgICAgICBkYW1hZ2UudmFsdWUgPSBIZWxwZXJzLmNhbGNUb3RhbChkYW1hZ2UsIHsgbWluOiAwIH0pO1xuICAgIDMyXHRcbiAgICAzM1x0ICAgICAgICB0aGlzLl9hcHBseU1vZGlmaWFibGVWYWx1ZShkYW1hZ2UuYXAsIGFjdG9yKTtcbiAgICAzNFx0ICAgICAgICBkYW1hZ2UuYXAudmFsdWUgPSBIZWxwZXJzLmNhbGNUb3RhbChkYW1hZ2UuYXAsIHsgbWluOiAwIH0pO1xuICAgIDM1XHRcbiAgICAzNlx0ICAgICAgICByZXR1cm4gZGFtYWdlO1xuICAgIDM3XHQgICAgfVxuICAgIDM4XHRcbiAgICAzOVx0ICAgIHN0YXRpYyBfYXBwbHlNb2RpZmlhYmxlVmFsdWUodmFsdWU6IFNoYWRvd3J1bi5Nb2RpZmlhYmxlVmFsdWVMaW5rZWQsIGFjdG9yOiBTUjZBY3Rvcikge1xuICAgIDQwXHQgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGFjdG9yLmZpbmRBdHRyaWJ1dGUodmFsdWUuYXR0cmlidXRlKTtcbiAgICA0MVx0ICAgICAgICBpZiAoIWF0dHJpYnV0ZSkgcmV0dXJuO1xuICAgIDQyXHRcbiAgICA0M1x0ICAgICAgICBpZiAoIXZhbHVlLmJhc2VfZm9ybXVsYV9vcGVyYXRvcikge1xuICAgIDQ0XHQgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBVbnN1cHBvcnRlZCBmb3JtdWxhIG9wZXJhdG9yOiAnJHt2YWx1ZS5iYXNlX2Zvcm11bGFfb3BlcmF0b3J9JyB1c2VkLiBGYWxsaW5nIGJhY2sgdG8gJ2FkZCcuYCk7XG4gICAgNDVcdCAgICAgICAgICAgIHZhbHVlLmJhc2VfZm9ybXVsYV9vcGVyYXRvciA9ICdhZGQnO1xuICAgIDQ2XHQgICAgICAgIH1cbiAgICA0N1x0XG4gICAgNDhcdCAgICAgICAgLy8gQXZvaWQgYWx0ZXJpbmcgYmFzZSBPUiB2YWx1ZSBmaWVsZHMgYW5kIHJhaXNpbmcgdGhlIHJlc3VsdGluZyBkYW1hZ2Ugb24gbXVsdGlwbGUgZnVuY3Rpb24gY2FsbHMuXG4gICAgNDlcdCAgICAgICAgc3dpdGNoICh2YWx1ZS5iYXNlX2Zvcm11bGFfb3BlcmF0b3IpIHtcbiAgICA1MFx0ICAgICAgICAgICAgY2FzZSBcImFkZFwiOlxuICAgIDUxXHQgICAgICAgICAgICAgICAgUGFydHNMaXN0LkFkZFVuaXF1ZVBhcnQodmFsdWUubW9kLCBhdHRyaWJ1dGUubGFiZWwsIGF0dHJpYnV0ZS52YWx1ZSk7XG4gICAgNTJcdCAgICAgICAgICAgICAgICBicmVhaztcbiAgICA1M1x0ICAgICAgICAgICAgY2FzZSBcInN1YnRyYWN0XCI6XG4gICAgNTRcdCAgICAgICAgICAgICAgICBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydCh2YWx1ZS5tb2QsIGF0dHJpYnV0ZS5sYWJlbCwgLWF0dHJpYnV0ZS52YWx1ZSk7XG4gICAgNTVcdCAgICAgICAgICAgICAgICBicmVhaztcbiAgICA1Nlx0ICAgICAgICAgICAgY2FzZSBcIm11bHRpcGx5XCI6XG4gICAgNTdcdCAgICAgICAgICAgICAgICBQYXJ0c0xpc3QuQWRkVW5pcXVlUGFydCh2YWx1ZS5tb2QsICdTUjYuVmFsdWUnLCAodmFsdWUuYmFzZSAqIGF0dHJpYnV0ZS52YWx1ZSkgLSB2YWx1ZS5iYXNlKTtcbiAgICA1OFx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgIDU5XHQgICAgICAgICAgICBjYXNlIFwiZGl2aWRlXCI6XG4gICAgNjBcdCAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYmFzZSBmcm9tIHZhbHVlIGJ5IG1vZGlmeWluZy5cbiAgICA2MVx0ICAgICAgICAgICAgICAgIFBhcnRzTGlzdC5BZGRVbmlxdWVQYXJ0KHZhbHVlLm1vZCwgJ1NSNi5CYXNlVmFsdWUnLCB2YWx1ZS5iYXNlICogLTEpO1xuICAgIDYyXHQgICAgICAgICAgICAgICAgLy8gQWRkIGRpdmlzaW9uIHJlc3VsdCBhcyBtb2RpZmllciBvbiB6ZXJvLlxuICAgIDYzXHQgICAgICAgICAgICAgICAgY29uc3QgZGVub21pbmF0b3IgPSBhdHRyaWJ1dGUudmFsdWUgPT09IDAgPyAxIDogYXR0cmlidXRlLnZhbHVlO1xuICAgIDY0XHQgICAgICAgICAgICAgICAgUGFydHNMaXN0LkFkZFVuaXF1ZVBhcnQodmFsdWUubW9kLCAnU1I2LlZhbHVlJywgTWF0aC5mbG9vcih2YWx1ZS5iYXNlIC8gZGVub21pbmF0b3IpKTtcbiAgICA2NVx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgIDY2XHQgICAgICAgIH1cbiAgICA2N1x0ICAgIH1cbiAgICA2OFx0XG4gICAgNjlcdCAgICAvKipcbiAgICA3MFx0ICAgICAqIERhbWFnZSB0aGF0J3MgY2F1c2VkIGJ5IGFuIGl0ZW0gY2FuIGxhdGVyIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIGhvdyB0aGF0IGRhbWFnZSBzaG91bGQgYmUgYXBwbGllZFxuICAgIDcxXHQgICAgICpcbiAgICA3Mlx0ICAgICAqIEBwYXJhbSBhY3RvciBUaGUgYWN0b3IgdXNlZCB0byBkZXRlcm1pbmUgZGFtYWdlXG4gICAgNzNcdCAgICAgKiBAcGFyYW0gaXRlbSBUaGUgaXRlbSBmcm9tIHdoaWNoIGRhbWFnZSdzIGJlZW4gZGV0ZXJtaW5lZCBmcm9tLlxuICAgIDc0XHQgICAgICovXG4gICAgNzVcdCAgICBzdGF0aWMgX2RhbWFnZVNvdXJjZShhY3RvcjogU1I2QWN0b3IsIGl0ZW06IFNSNkl0ZW0pOiBTaGFkb3dydW4uRGFtYWdlU291cmNlIHtcbiAgICA3Nlx0ICAgICAgICByZXR1cm4ge1xuICAgIDc3XHQgICAgICAgICAgICBhY3RvcklkOiBhY3Rvci5pZCB8fCAnJyxcbiAgICA3OFx0ICAgICAgICAgICAgaXRlbUlkOiBpdGVtLmlkIHx8ICcnLFxuICAgIDc5XHQgICAgICAgICAgICBpdGVtTmFtZTogaXRlbS5uYW1lIHx8ICcnLFxuICAgIDgwXHQgICAgICAgICAgICBpdGVtVHlwZTogaXRlbS50eXBlXG4gICAgODFcdCAgICAgICAgfVxuICAgIDgyXHQgICAgfVxuLi4uXG4gICAxMTNcdCAgICAgICAgLy8gICAgICAgIFRoZSBtYWpvciB1c2UgY2FzZSBpcyB0aGUgc2lkZWJhciBpdGVtIGNyZWF0aW9uLCB3aGVyZSBubyBhY3RvciBpcyBhdmFpbGFibGUuXG4gICAxMTRcdCAgICAgICAgaWYgKCFhY3RvciB8fCBhY3Rvci5pc0lDKCkpIHtcbiAgIDExNVx0ICAgICAgICAgICAgLy8gSW5qZWN0IHRoaXMgaXRlbXMgY3VzdG9tIHNraWxsIGludG8gdGhlIGdsb2JhbCBza2lsbCBsaXN0LlxuICAgMTE2XHQgICAgICAgICAgICBjb25zdCBnbG9iYWxTa2lsbHMgPSBmb3VuZHJ5LnV0aWxzLmRlZXBDbG9uZShTUjYuYWN0aXZlU2tpbGxzKTtcbiAgIDExN1x0ICAgICAgICAgICAgQWN0aW9uRmxvdy5faW5qZWN0TWlzc2luZ0N1c3RvbVNraWxsKGdsb2JhbFNraWxscywgc2tpbGxOYW1lKTtcbiAgIDExOFx0ICAgICAgICAgICAgcmV0dXJuIEhlbHBlcnMuc29ydENvbmZpZ1ZhbHVlc0J5VHJhbnNsYXRpb24oZ2xvYmFsU2tpbGxzKTtcbiAgIDExOVx0ICAgICAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvaXRlbS9mbG93cy9BY3Rpb25SZXN1bHRGbG93LnRzXG4uLi5cbiAgICA0M1x0ICAgIC8qKlxuICAgIDQ0XHQgICAgICogTWF0cml4IE1hcmtzIGFyZSBwbGFjZWQgb24gZWl0aGVyIGFjdG9ycyAocGVyc29uYSwgaWMpIG9yIGl0ZW1zIChkZXZpY2UsIGhvc3QsIHRlY2hub2xvZ3kpLlxuICAgIDQ1XHQgICAgICovXG4gICAgNDZcdCAgICBzdGF0aWMgYXN5bmMgcGxhY2VNYXRyaXhNYXJrcyhhY3RpdmU6IFNSNkFjdG9yLCB0YXJnZXRzOiBUb2tlbltdLCBtYXJrczogbnVtYmVyKSB7XG4gICAgNDdcdCAgICAgICAgaWYgKCFNYXRyaXhSdWxlcy5pc1ZhbGlkTWFya3NDb3VudChtYXJrcykpIHtcbiAgICA0OFx0ICAgICAgICAgICAgcmV0dXJuIHVpLm5vdGlmaWNhdGlvbnM/Lndhcm4oZ2FtZS5pMThuLmxvY2FsaXplKFwiU1I2Lldhcm5pbmdzLkludmFsaWRNYXJrc0NvdW50XCIpKTtcbiAgICA0OVx0ICAgICAgICB9XG4gICAgNTBcdFxuICAgIDUxXHQgICAgICAgIGZvciAoY29uc3QgdGFyZ2V0IG9mIHRhcmdldHMpIHtcbiAgICA1Mlx0ICAgICAgICAgICAgYXdhaXQgYWN0aXZlLnNldE1hcmtzKHRhcmdldCwgbWFya3MpO1xuICAgIDUzXHQgICAgICAgIH1cbiAgICA1NFx0ICAgIH1cbiAgICA1NVx0XG4gICAgNTZcdCAgICAvKipcbiAgICA1N1x0ICAgICAqIE1vZGlmeSB0aGUgYWN0b3JzIGNvbWJhdGFudCBhY2NvcmRpbmcgdGhlIHRlc3QgZGVmaW5lZCBpbml0aWF0aXZlIG1vZGlmaWVyLlxuICAgIDU4XHQgICAgICpcbiAgICA1OVx0ICAgICAqIEBwYXJhbSB0ZXN0IFRoZSB0ZXN0IGluc3RhbmNlIGNhdXNpbmcgdGhlIGluaXRpYXRpdmUgbW9kaWZpY2F0aW9uXG4gICAgNjBcdCAgICAgKi9cbiAgICA2MVx0ICAgIHN0YXRpYyBhc3luYyBfY2FzdEluaXRNb2RpZmllckFjdGlvbih0ZXN0OiBQaHlzaWNhbERlZmVuc2VUZXN0KSB7XG4gICAgNjJcdCAgICAgICAgaWYgKCEodGVzdCBpbnN0YW5jZW9mIFBoeXNpY2FsRGVmZW5zZVRlc3QpKSByZXR1cm47XG4gICAgNjNcdFxuICAgIDY0XHQgICAgICAgIGlmICghdGVzdC5kYXRhLmluaU1vZCkgcmV0dXJuO1xuICAgIDY1XHQgICAgICAgIGF3YWl0IHRlc3QuYWN0b3I/LmNoYW5nZUNvbWJhdEluaXRpYXRpdmUodGVzdC5kYXRhLmluaU1vZCk7XG4gICAgNjZcdCAgICB9XG4gICAgNjdcdH1cbi4uLlxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiZDc3ZGNlN2EtZDJhZS00YzU0LWI3MmMtN2NkOTUwYmM0MDhlO3Rvb2x1X3ZydHhfMDFETUZyUnkyUm9YQVlTQlAyeTNiRmQzIjp7InJlcXVlc3RJZCI6ImQ3N2RjZTdhLWQyYWUtNGM1NC1iNzJjLTdjZDk1MGJjNDA4ZSIsInRvb2xVc2VJZCI6InRvb2x1X3ZydHhfMDFETUZyUnkyUm9YQVlTQlAyeTNiRmQzIiwicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogc3JjL21vZHVsZS9ob29rcy50c1xuLi4uXG4gICAgNzBcdGltcG9ydCB7IFN1Y2Nlc3NUZXN0RWZmZWN0c0Zsb3cgfSBmcm9tICcuL2VmZmVjdC9mbG93cy9TdWNjZXNzVGVzdEVmZmVjdHNGbG93JztcbiAgICA3MVx0aW1wb3J0IHsgSm91cm5hbEVucmljaGVycyB9IGZyb20gJy4vam91cm5hbC9lbnJpY2hlcic7XG4gICAgNzJcdGltcG9ydCB7IERhdGFTdG9yYWdlIH0gZnJvbSAnLi9kYXRhL0RhdGFTdG9yYWdlJztcbiAgICA3M1x0XG4gICAgNzRcdFxuICAgIDc1XHRcbiAgICA3Nlx0Ly8gUmVkZWNsYXJlIFNSNWNvbmZpZyBhcyBhIGdsb2JhbCBhcyBmb3VuZHJ5LXZ0dC10eXBlcyBDT05GSUcgd2l0aCBTUjUgcHJvcGVydHkgY2F1c2VzIGlzc3Vlcy5cbiAgICA3N1x0ZXhwb3J0IGNvbnN0IFNSNkNPTkZJRyA9IFNSNjtcbiAgICA3OFx0XG4gICAgNzlcdGV4cG9ydCBjbGFzcyBIb29rc01hbmFnZXIge1xuICAgIDgwXHQgICAgc3RhdGljIHJlZ2lzdGVySG9va3MoKSB7XG4gICAgODFcdCAgICAgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSB8IFJlZ2lzdGVyaW5nIHN5c3RlbSBob29rcycpO1xuICAgIDgyXHQgICAgICAgIC8vIFJlZ2lzdGVyIHlvdXIgaGlnaGVzdCBsZXZlbCBob29rIGNhbGxiYWNrcyBoZXJlIGZvciBhIHF1aWNrIG92ZXJ2aWV3IG9mIHdoYXQncyBob29rZWQgaW50by5cbiAgICA4M1x0XG4gICAgODRcdCAgICAgICAgSG9va3Mub25jZSgnaW5pdCcsIEhvb2tzTWFuYWdlci5pbml0KTtcbiAgICA4NVx0ICAgICAgICBIb29rcy5vbmNlKCdzZXR1cCcsIEF1dG9jb21wbGV0ZUlubGluZUhvb2tzRmxvdy5zZXR1cEhvb2spO1xuICAgIDg2XHRcbiAgICA4N1x0ICAgICAgICBIb29rcy5vbignY2FudmFzSW5pdCcsIGNhbnZhc0luaXQpO1xuICAgIDg4XHQgICAgICAgIEhvb2tzLm9uKCdyZWFkeScsIEhvb2tzTWFuYWdlci5yZWFkeSk7XG4gICAgODlcdCAgICAgICAgSG9va3Mub24oJ2hvdGJhckRyb3AnLCBIb29rc01hbmFnZXIuaG90YmFyRHJvcCk7XG4gICAgOTBcdCAgICAgICAgSG9va3Mub24oJ3JlbmRlclNjZW5lQ29udHJvbHMnLCBIb29rc01hbmFnZXIucmVuZGVyU2NlbmVDb250cm9scyk7XG4gICAgOTFcdCAgICAgICAgSG9va3Mub24oJ2dldFNjZW5lQ29udHJvbEJ1dHRvbnMnLCBIb29rc01hbmFnZXIuZ2V0U2NlbmVDb250cm9sQnV0dG9ucyk7XG4gICAgOTJcdCAgICAgICAgSG9va3Mub24oJ2dldENvbWJhdFRyYWNrZXJFbnRyeUNvbnRleHQnLCBTUjZDb21iYXQuYWRkQ29tYmF0VHJhY2tlckNvbnRleHRPcHRpb25zKTtcbiAgICA5M1x0ICAgICAgICBIb29rcy5vbigncmVuZGVySXRlbURpcmVjdG9yeScsIEhvb2tzTWFuYWdlci5yZW5kZXJJdGVtRGlyZWN0b3J5KTtcbiAgICA5NFx0ICAgICAgICAvLyBIb29rcy5vbigncmVuZGVyVG9rZW5IVUQnLCBFbnZNb2RpZmllcnNBcHBsaWNhdGlvbi5hZGRUb2tlbkhVREZpZWxkcyk7XG4gICAgOTVcdCAgICAgICAgSG9va3Mub24oJ3JlbmRlclRva2VuSFVEJywgU2l0dWF0aW9uTW9kaWZpZXJzQXBwbGljYXRpb24ub25SZW5kZXJUb2tlbkhVRCk7XG4gICAgOTZcdCAgICAgICAgSG9va3Mub24oJ3VwZGF0ZUl0ZW0nLCBIb29rc01hbmFnZXIudXBkYXRlSWNDb25uZWN0ZWRUb0hvc3RJdGVtKTtcbiAgICA5N1x0ICAgICAgICBIb29rcy5vbignZGVsZXRlSXRlbScsIEhvb2tzTWFuYWdlci5yZW1vdmVEZWxldGVkSXRlbXNGcm9tTmV0d29ya3MpO1xuLi4uXG4gICAxMDdcdFxuICAgMTA4XHQgICAgc3RhdGljIGluaXQoKSB7XG4gICAxMDlcdCAgICAgICAgY29uc29sZS5sb2coYExvYWRpbmcgU2hhZG93cnVuIDVlIFN5c3RlbVxuICAgMTEwXHRfX19fX19fX19fX19fX19fX19fXG4gICAxMTFcdCBfX19fX19fX19fXyBfX19fXyBcbiAgIDExMlx0LyAgX19ffCBfX18gXFxcXCAgX19ffFxuICAgMTEzXHRcXFxcIFxcYC0tLnwgfF8vIC9fX18gXFxcXCBcbiAgIDExNFx0IFxcYC0tLiBcXFxcICAgIC8gICAgXFxcXCBcXFxcXG4gICAxMTVcdC9cXFxcX18vIC8gfFxcXFwgXFxcXC9cXFxcX18vIC9cbiAgIDExNlx0XFxcXF9fX18vXFxcXF98IFxcXFxfXFxcXF9fX18vIFxuICAgMTE3XHQ9PT09PT09PT09PT09PT09PT09XG4gICAxMThcdGApO1xuICAgMTE5XHQgICAgICAgIC8vIENyZWF0ZSBhIHNyNmVseXNpdW0gbmFtZXNwYWNlIHdpdGhpbiB0aGUgZ2FtZSBnbG9iYWxcbiAgIDEyMFx0ICAgICAgICBnYW1lWydzcjZlbHlzaXVtJ10gPSB7XG4gICAxMjFcdCAgICAgICAgICAgIC8qKlxuICAgMTIyXHQgICAgICAgICAgICAgKiBTeXN0ZW0gbGV2ZWwgRG9jdW1lbnQgaW1wbGVtZW50YXRpb25zLlxuICAgMTIzXHQgICAgICAgICAgICAgKi9cbiAgIDEyNFx0ICAgICAgICAgICAgU1I2QWN0b3I6IFNSNkFjdG9yLFxuICAgMTI1XHQgICAgICAgICAgICBTUjZJdGVtOiBTUjZJdGVtLFxuICAgMTI2XHQgICAgICAgICAgICBTUjZBY3RpdmVFZmZlY3Q6IFNSNkFjdGl2ZUVmZmVjdCxcbiAgIDEyN1x0ICAgICAgICAgICAgLyoqXG4gICAxMjhcdCAgICAgICAgICAgICAqIE1hY3JvIGhvb2tzIHVzZWQgd2hlbiBzb21ldGhpbmcncyBkcm9wcGVkIG9udG8gdGhlIGhvdGJhci5cbiAgIDEyOVx0ICAgICAgICAgICAgICovXG4gICAxMzBcdCAgICAgICAgICAgIHJvbGxJdGVtTWFjcm8sXG4gICAxMzFcdCAgICAgICAgICAgIHJvbGxTa2lsbE1hY3JvLFxuICAgMTMyXHQgICAgICAgICAgICAvKipcbiAgIDEzM1x0ICAgICAgICAgICAgICogU2hvdWxkIHlvdSBvbmx5IHJlYWxseSBuZWVkIGRpY2UgaGFuZGxpbmcsIHVzZSB0aGlzLiBJZiB5b3UgbmVlZCBtb3JlIGNvbXBsZXggdGVzdGluZyBiZWhhdmlvdXIsXG4gICAxMzRcdCAgICAgICAgICAgICAqIGNoZWNrIHRoZSBUZXN0IGltcGxlbWVudGF0aW9ucy5cbiAgIDEzNVx0ICAgICAgICAgICAgICovXG4gICAxMzZcdCAgICAgICAgICAgIFNSNlJvbGw6IFNSNlJvbGwsXG4uLi5cbiAgIDMzMFx0XG4gICAzMzFcdCAgICAgICAgSG9va3NNYW5hZ2VyLmNvbmZpZ3VyZVZpc2lvbigpXG4gICAzMzJcdFxuICAgMzMzXHQgICAgICAgIEhvb2tzTWFuYWdlci5jb25maWd1cmVUZXh0RW5yaWNoZXJzKCk7XG4gICAzMzRcdFxuICAgMzM1XHQgICAgICAgIC8vIFByZWxvYWQgbWlnaHQgcmVkdWNlIGxvYWRpbmcgdGltZSBkdXJpbmcgcGxheS5cbiAgIDMzNlx0ICAgICAgICBIYW5kbGViYXJNYW5hZ2VyLmxvYWRUZW1wbGF0ZXMoKTtcbiAgIDMzN1x0XG4gICAzMzhcdCAgICAgICAgLy8gUmVnaXN0ZXIgVG91cnNcbiAgIDMzOVx0ICAgICAgICByZWdpc3RlclNSNlRvdXJzKCk7XG4gICAzNDBcdFxuICAgMzQxXHQgICAgICAgIERhdGFTdG9yYWdlLnZhbGlkYXRlKCk7XG4gICAzNDJcdCAgICB9XG4gICAzNDNcdFxuICAgMzQ0XHQgICAgc3RhdGljIGFzeW5jIHJlYWR5KCkge1xuICAgMzQ1XHQgICAgICAgIGlmIChnYW1lLnVzZXI/LmlzR00pIHtcbiAgIDM0Nlx0ICAgICAgICAgICAgLy8gUHJvaGliaXQgbWlncmF0aW9uIG9uIGVtcHR5IHdvcmxkcy4uLlxuICAgMzQ3XHQgICAgICAgICAgICBpZiAoTWlncmF0b3IuaXNFbXB0eVdvcmxkKSB7XG4gICAzNDhcdCAgICAgICAgICAgICAgICBhd2FpdCBNaWdyYXRvci5Jbml0V29ybGRGb3JNaWdyYXRpb24oKTtcbiAgIDM0OVx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDM1MFx0ICAgICAgICAgICAgfVxuICAgMzUxXHRcbiAgIDM1Mlx0ICAgICAgICAgICAgLy8gT24gcG9wdWxhdGVkIHdvcmxkcywgdHJ5IG1pZ3JhdGluZ1xuICAgMzUzXHQgICAgICAgICAgICBhd2FpdCBNaWdyYXRvci5CZWdpbk1pZ3JhdGlvbigpO1xuICAgMzU0XHRcbiAgIDM1NVx0ICAgICAgICAgICAgaWYgKENoYW5nZWxvZ0FwcGxpY2F0aW9uLnNob3dBcHBsaWNhdGlvbikge1xuICAgMzU2XHQgICAgICAgICAgICAgICAgYXdhaXQgbmV3IENoYW5nZWxvZ0FwcGxpY2F0aW9uKCkucmVuZGVyKHRydWUpO1xuICAgMzU3XHQgICAgICAgICAgICB9XG4gICAzNThcdCAgICAgICAgfVxuLi4uXG4gICA0NDZcdFxuICAgNDQ3XHQgICAgICAgIGlmIChpdGVtLmlzSG9zdCkge1xuICAgNDQ4XHQgICAgICAgICAgICAvLyBDb2xsZWN0IGFjdG9ycyBmcm9tIHNpZGViYXIgYW5kIGFjdGl2ZSBzY2VuZSB0byB1cGRhdGUgLyByZXJlbmRlclxuICAgNDQ5XHQgICAgICAgICAgICBsZXQgY29ubmVjdGVkSUMgPSBbXG4gICA0NTBcdCAgICAgICAgICAgICAgICAvLyBBbGwgc2lkZWJhciBhY3RvcnMgc2hvdWxkIGFsc28gaW5jbHVkZSB0b2tlbnMgd2l0aCBsaW5rZWQgYWN0b3JzLlxuICAgNDUxXHQgICAgICAgICAgICAgICAgLi4uZ2FtZS5hY3RvcnMuZmlsdGVyKChhY3RvcjogU1I2QWN0b3IpID0+IGFjdG9yLmlzSUMoKSAmJiBhY3Rvci5oYXNIb3N0KCkpIGFzIFNSNkFjdG9yW10sXG4gICA0NTJcdCAgICAgICAgICAgICAgICAvLyBBbGwgdG9rZW4gYWN0b3JzIHRoYXQgYXJlbid0IGxpbmtlZC5cbiAgIDQ1M1x0ICAgICAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICA0NTRcdCAgICAgICAgICAgICAgICAuLi5jYW52YXMuc2NlbmUudG9rZW5zLmZpbHRlcih0b2tlbiA9PiAhdG9rZW4uYWN0b3JMaW5rICYmIHRva2VuLmFjdG9yPy5pc0lDKCkgJiYgdG9rZW4uYWN0b3I/Lmhhc0hvc3QoKSkubWFwKHQgPT4gdC5hY3RvcilcbiAgIDQ1NVx0ICAgICAgICAgICAgXTtcbiAgIDQ1Nlx0XG4gICA0NTdcdCAgICAgICAgICAgIC8vIFVwZGF0ZSBob3N0IGRhdGEgb24gdGhlIGljIGFjdG9yLlxuICAgNDU4XHQgICAgICAgICAgICBjb25zdCBob3N0ID0gaXRlbS5hc0hvc3Q7XG4gICA0NTlcdCAgICAgICAgICAgIGlmICghaG9zdCkgcmV0dXJuO1xuICAgNDYwXHQgICAgICAgICAgICBmb3IgKGNvbnN0IGljIG9mIGNvbm5lY3RlZElDKSB7XG4gICA0NjFcdCAgICAgICAgICAgICAgICBpZiAoIWljKSBjb250aW51ZTtcbiAgIDQ2Mlx0ICAgICAgICAgICAgICAgIGF3YWl0IGljLl91cGRhdGVJQ0hvc3REYXRhKGhvc3QpO1xuICAgNDYzXHQgICAgICAgICAgICB9XG4gICA0NjRcdCAgICAgICAgfVxuICAgNDY1XHQgICAgfVxuLi4uXG4gICA0NzBcdFxuICAgNDcxXHQgICAgLyoqXG4gICA0NzJcdCAgICAgKiBUaGlzIG1ldGhvZCBpcyB1c2VkIGFzIGEgc2ltcGxlIHBsYWNlIHRvIHJlZ2lzdGVyIHNvY2tldCBob29rIGhhbmRsZXJzIGZvciB0aGUgc3lzdGVtLlxuICAgNDczXHQgICAgICpcbiAgIDQ3NFx0ICAgICAqIFlvdSBjYW4gdXNlIHRoZSBTb2NrZXRNZXNzYWdlIGZvciBzZW5kaW5nIG1lc3NhZ2VzIHVzaW5nIGEgc29ja2V0IGV2ZW50IG1lc3NhZ2UgaWQgYW5kIGdlbmVyaWMgZGF0YSBvYmplY3QuXG4gICA0NzVcdCAgICAgKi9cbiAgIDQ3Nlx0ICAgIHN0YXRpYyByZWdpc3RlclNvY2tldExpc3RlbmVycygpIHtcbiAgIDQ3N1x0ICAgICAgICBpZiAoIWdhbWUuc29ja2V0IHx8ICFnYW1lLnVzZXIpIHJldHVybjtcbiAgIDQ3OFx0ICAgICAgICBjb25zb2xlLmxvZygnUmVnaXN0ZXJpbmcgc3I2ZWx5c2l1bSBzeXN0ZW0gc29ja2V0IG1lc3NhZ2VzLi4uJyk7XG4gICA0NzlcdCAgICAgICAgY29uc3QgaG9va3M6IFNoYWRvd3J1bi5Tb2NrZXRNZXNzYWdlSG9va3MgPSB7XG4gICA0ODBcdCAgICAgICAgICAgIFtGTEFHUy5hZGROZXR3b3JrQ29udHJvbGxlcl06IFtOZXR3b3JrRGV2aWNlRmxvdy5faGFuZGxlQWRkTmV0d29ya0NvbnRyb2xsZXJTb2NrZXRNZXNzYWdlXSxcbiAgIDQ4MVx0ICAgICAgICAgICAgW0ZMQUdTLkRvTmV4dFJvdW5kXTogW1NSNkNvbWJhdC5faGFuZGxlRG9OZXh0Um91bmRTb2NrZXRNZXNzYWdlXSxcbiAgIDQ4Mlx0ICAgICAgICAgICAgW0ZMQUdTLkRvSW5pdFBhc3NdOiBbU1I2Q29tYmF0Ll9oYW5kbGVEb0luaXRQYXNzU29ja2V0TWVzc2FnZV0sXG4gICA0ODNcdCAgICAgICAgICAgIFtGTEFHUy5Eb05ld0FjdGlvblBoYXNlXTogW1NSNkNvbWJhdC5faGFuZGxlRG9OZXdBY3Rpb25QaGFzZVNvY2tldE1lc3NhZ2VdLFxuLi4uXG4gICA0ODhcdFxuICAgNDg5XHQgICAgICAgIGdhbWUuc29ja2V0Lm9uKFNZU1RFTV9TT0NLRVQsIGFzeW5jIChtZXNzYWdlOiBTaGFkb3dydW4uU29ja2V0TWVzc2FnZURhdGEpID0+IHtcbiAgIDQ5MFx0ICAgICAgICAgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSB8IFJlY2VpdmVkIHN5c3RlbSBzb2NrZXQgbWVzc2FnZS4nLCBtZXNzYWdlKTtcbiAgIDQ5MVx0XG4gICA0OTJcdCAgICAgICAgICAgIGNvbnN0IGhhbmRsZXJzID0gaG9va3NbbWVzc2FnZS50eXBlXTtcbiAgIDQ5M1x0ICAgICAgICAgICAgaWYgKCFoYW5kbGVycyB8fCBoYW5kbGVycy5sZW5ndGggPT09IDApIHJldHVybiBjb25zb2xlLndhcm4oJ1NoYWRvd3J1biA2ZSB8IFN5c3RlbSBzb2NrZXQgbWVzc2FnZSBoYXMgbm8gcmVnaXN0ZXJlZCBoYW5kbGVyIScsIG1lc3NhZ2UpO1xuICAgNDk0XHQgICAgICAgICAgICAvLyBJbiBjYXNlIG9mIHRhcmdldGVkIHNvY2tldCBtZXNzYWdlIG9ubHkgZXhlY3V0ZSB3aXRoIHRhcmdldCB1c2VyIChpbnRlbmRlZCBmb3IgR00gdXNhZ2UpXG4gICA0OTVcdCAgICAgICAgICAgIGlmIChtZXNzYWdlLnVzZXJJZCAmJiBnYW1lLnVzZXI/LmlkICE9PSBtZXNzYWdlLnVzZXJJZCkgcmV0dXJuO1xuICAgNDk2XHQgICAgICAgICAgICBpZiAobWVzc2FnZS51c2VySWQgJiYgZ2FtZS51c2VyPy5pZCkgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSB8IEdNIGlzIGhhbmRsaW5nIHN5c3RlbSBzb2NrZXQgbWVzc2FnZScpO1xuICAgNDk3XHRcbiAgIDQ5OFx0ICAgICAgICAgICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKSB7XG4gICA0OTlcdCAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKGBTaGFkb3dydW4gNmUgfCBIYW5kb3ZlciBzeXN0ZW0gc29ja2V0IG1lc3NhZ2UgdG8gaGFuZGxlcjogJHtoYW5kbGVyLm5hbWV9YCk7XG4gICA1MDBcdCAgICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVyKG1lc3NhZ2UpO1xuICAgNTAxXHQgICAgICAgICAgICB9XG4gICA1MDJcdCAgICAgICAgfSk7XG4gICA1MDNcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvdGFyZ2V0aW5nL2luZGV4LnRzXG4uLi5cbiAgICAgMlx0XG4gICAgIDNcdC8qKlxuICAgICA0XHQgKiBSZWdpc3RlciB0YXJnZXRpbmcgaG9va3NcbiAgICAgNVx0ICovXG4gICAgIDZcdGV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclRhcmdldGluZ0hvb2tzKCkge1xuICAgICA3XHQgICAgLy8gUmVnaXN0ZXIgYSBob29rIHRvIGhpZ2hsaWdodCB2YWxpZCB0YXJnZXRzIHdoZW4gYW4gaXRlbSBpcyB1c2VkXG4gICAgIDhcdCAgICBIb29rcy5vbignc3I2OnByZUl0ZW1Sb2xsJywgKGl0ZW0sIGFjdG9yKSA9PiB7XG4gICAgIDlcdCAgICAgICAgLy8gT25seSBoaWdobGlnaHQgdGFyZ2V0cyBmb3IgaXRlbXMgdGhhdCBjYW4gdGFyZ2V0IG90aGVyIGFjdG9yc1xuICAgIDEwXHQgICAgICAgIGlmIChpdGVtLmlzUmFuZ2VkV2VhcG9uKCkgfHwgaXRlbS5pc1NwZWxsKCkgfHwgaXRlbS5pc01hdHJpeEFjdGlvbigpKSB7XG4gICAgMTFcdCAgICAgICAgICAgIFRhcmdldGluZ1NlcnZpY2UuaGlnaGxpZ2h0VmFsaWRUYXJnZXRzKGl0ZW0sIGFjdG9yKTtcbiAgICAxMlx0ICAgICAgICB9XG4gICAgMTNcdCAgICB9KTtcbiAgICAxNFx0ICAgIFxuICAgIDE1XHQgICAgLy8gUmVnaXN0ZXIgYSBob29rIHRvIGNsZWFyIHRhcmdldCBoaWdobGlnaHRzIHdoZW4gYW4gaXRlbSByb2xsIGlzIGNvbXBsZXRlXG4gICAgMTZcdCAgICBIb29rcy5vbignc3I2Oml0ZW1Sb2xsJywgKCkgPT4ge1xuICAgIDE3XHQgICAgICAgIFRhcmdldGluZ1NlcnZpY2UuY2xlYXJUYXJnZXRIaWdobGlnaHRzKCk7XG4gICAgMThcdCAgICB9KTtcbiAgICAxOVx0ICAgIFxuICAgIDIwXHQgICAgLy8gUmVnaXN0ZXIgYSBob29rIHRvIGNsZWFyIHRhcmdldCBoaWdobGlnaHRzIHdoZW4gYW4gaXRlbSByb2xsIGlzIGNhbmNlbGxlZFxuICAgIDIxXHQgICAgSG9va3Mub24oJ3NyNjppdGVtUm9sbENhbmNlbCcsICgpID0+IHtcbiAgICAyMlx0ICAgICAgICBUYXJnZXRpbmdTZXJ2aWNlLmNsZWFyVGFyZ2V0SGlnaGxpZ2h0cygpO1xuICAgIDIzXHQgICAgfSk7XG4gICAgMjRcdCAgICBcbiAgICAyNVx0ICAgIGNvbnNvbGUubG9nKFwiU2hhZG93cnVuIDZlIHwgVGFyZ2V0aW5nIGhvb2tzIHJlZ2lzdGVyZWRcIik7XG4gICAgMjZcdH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9wcmVwL0NoYXJhY3RlclByZXAudHNcbi4uLlxuICAgIDI4XHRcbiAgICAyOVx0ICAgIC8qKlxuICAgIDMwXHQgICAgICogQWxsIGRlcml2ZWQgZGF0YSBzaG91bGQgZGVwZW5kIG9uIGJhc2ljIHZhbHVlcyBsaWtlIEF0dHJpYnV0ZXMgb3IgU2tpbGxzLlxuICAgIDMxXHQgICAgICpcbiAgICAzMlx0ICAgICAqIEl0IHNob3VsZG4ndCBiZSBtb2RpZmllZCBieSBBY3RpdmUgRWZmZWN0cywgd2hpY2ggaW5zdGVhZCBzaG91bGQgbW9kaWZ5IHRoZSBnbG9iYWwgbW9kaWZpZXJzLlxuICAgIDMzXHQgICAgICpcbiAgICAzNFx0ICAgICAqIEBwYXJhbSBzeXN0ZW1cbiAgICAzNVx0ICAgICAqIEBwYXJhbSBpdGVtc1xuICAgIDM2XHQgICAgICovXG4gICAgMzdcdCAgICBzdGF0aWMgcHJlcGFyZURlcml2ZWREYXRhKHN5c3RlbTogU2hhZG93cnVuLkNoYXJhY3RlckRhdGEsIGl0ZW1zOiBTUjZJdGVtRGF0YVdyYXBwZXJbXSkge1xuICAgIDM4XHQgICAgICAgIEF0dHJpYnV0ZXNQcmVwLnByZXBhcmVBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgMzlcdCAgICAgICAgQXR0cmlidXRlc1ByZXAucHJlcGFyZUVzc2VuY2Uoc3lzdGVtLCBpdGVtcyk7XG4gICAgNDBcdFxuICAgIDQxXHQgICAgICAgIC8vIE5QQ1ByZXAgaXMgcmVsaWFudCB0byBiZSBjYWxsZWQgYWZ0ZXIgQXR0cmlidXRlc1ByZXAuXG4gICAgNDJcdCAgICAgICAgTlBDUHJlcC5wcmVwYXJlTlBDRGF0YShzeXN0ZW0pO1xuICAgIDQzXHRcbiAgICA0NFx0ICAgICAgICBTa2lsbHNQcmVwLnByZXBhcmVTa2lsbHMoc3lzdGVtKTtcbiAgICA0NVx0XG4gICAgNDZcdCAgICAgICAgSXRlbVByZXAucHJlcGFyZUFybW9yKHN5c3RlbSwgaXRlbXMpO1xuICAgIDQ3XHQgICAgICAgIEl0ZW1QcmVwLnByZXBhcmVXZWFwb25zKHN5c3RlbSwgaXRlbXMpO1xuICAgIDQ4XHRcbiAgICA0OVx0ICAgICAgICBNYXRyaXhQcmVwLnByZXBhcmVNYXRyaXgoc3lzdGVtLCBpdGVtcyk7XG4gICAgNTBcdCAgICAgICAgTWF0cml4UHJlcC5wcmVwYXJlTWF0cml4VG9MaW1pdHNBbmRBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgNTFcdFxuICAgIDUyXHQgICAgICAgIEdydW50UHJlcC5wcmVwYXJlQ29uZGl0aW9uTW9uaXRvcnMoc3lzdGVtKTtcbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9wcmVwL0lDUHJlcC50c1xuLi4uXG4gICAgMTNcdFxuICAgIDE0XHRcbiAgICAxNVx0ZXhwb3J0IGNsYXNzIElDUHJlcCB7XG4gICAgMTZcdCAgICBzdGF0aWMgcHJlcGFyZUJhc2VEYXRhKHN5c3RlbTogSUNEYXRhKSB7XG4gICAgMTdcdCAgICAgICAgTW9kaWZpZXJzUHJlcC5jbGVhckF0dHJpYnV0ZU1vZHMoc3lzdGVtKTtcbiAgICAxOFx0ICAgICAgICBNb2RpZmllcnNQcmVwLmNsZWFyTGltaXRNb2RzKHN5c3RlbSk7XG4gICAgMTlcdCAgICAgICAgU2tpbGxzUHJlcC5wcmVwYXJlU2tpbGxEYXRhKHN5c3RlbSk7XG4gICAgMjBcdFxuICAgIDIxXHQgICAgICAgIElDUHJlcC5hZGRNaXNzaW5nVHJhY2tzKHN5c3RlbSk7XG4gICAgMjJcdCAgICAgICAgSUNQcmVwLnByZXBhcmVNb2RpZmllcnMoc3lzdGVtKTtcbiAgICAyM1x0ICAgICAgICBJQ1ByZXAuaGlkZU1lYXRBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgMjRcdCAgICAgICAgSUNQcmVwLmFkZEhvc3RBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgMjVcdCAgICB9XG4gICAgMjZcdFxuICAgIDI3XHQgICAgc3RhdGljIHByZXBhcmVEZXJpdmVkRGF0YShzeXN0ZW06IElDRGF0YSwgaXRlbXM6IFNSNkl0ZW1EYXRhV3JhcHBlcltdKSB7XG4gICAgMjhcdCAgICAgICAgSUNQcmVwLnByZXBhcmVNYXRyaXhBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgMjlcdFxuICAgIDMwXHQgICAgICAgIFNraWxsc1ByZXAucHJlcGFyZVNraWxscyhzeXN0ZW0pO1xuICAgIDMxXHRcbiAgICAzMlx0ICAgICAgICBJQ1ByZXAucHJlcGFyZUhvc3RBdHRyaWJ1dGVzKHN5c3RlbSk7XG4gICAgMzNcdCAgICAgICAgSUNQcmVwLnByZXBhcmVNZWF0QXR0cmlidXRlcyhzeXN0ZW0pO1xuICAgIDM0XHRcbiAgICAzNVx0ICAgICAgICBNYXRyaXhQcmVwLnByZXBhcmVNYXRyaXhUb0xpbWl0c0FuZEF0dHJpYnV0ZXMoc3lzdGVtKTtcbiAgICAzNlx0XG4gICAgMzdcdCAgICAgICAgSUNQcmVwLnByZXBhcmVNYXRyaXgoc3lzdGVtKTtcbiAgICAzOFx0ICAgICAgICBJQ1ByZXAucHJlcGFyZU1hdHJpeFRyYWNrKHN5c3RlbSk7XG4gICAgMzlcdFxuICAgIDQwXHQgICAgICAgIElDUHJlcC5wcmVwYXJlTWF0cml4SW5pdChzeXN0ZW0pO1xuICAgIDQxXHQgICAgICAgIEluaXRpYXRpdmVQcmVwLnByZXBhcmVDdXJyZW50SW5pdGlhdGl2ZShzeXN0ZW0pO1xuICAgIDQyXHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL21haW4udHNcbiAgICAgMVx0aW1wb3J0IHsgSGFuZGxlYmFyTWFuYWdlciB9IGZyb20gJy4vaGFuZGxlYmFycy9IYW5kbGViYXJNYW5hZ2VyJztcbiAgICAgMlx0aW1wb3J0IHtIb29rc01hbmFnZXJ9IGZyb20gXCIuL2hvb2tzXCI7XG4gICAgIDNcdFxuICAgICA0XHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAgICA1XHQvKiAgRm91bmRyeSBWVFQgSW5pdGlhbGl6YXRpb24gICAgICAgICAgICAgICAgICAqL1xuICAgICA2XHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAgICA3XHRcbiAgICAgOFx0XG4gICAgIDlcdEhvb2tzTWFuYWdlci5yZWdpc3Rlckhvb2tzKCk7XG4gICAgMTBcdEhhbmRsZWJhck1hbmFnZXIucmVnaXN0ZXJIZWxwZXJzKCk7Li4uXG5QYXRoOiBzcmMvbW9kdWxlL2NhbnZhcy50c1xuICAgICAxXHRpbXBvcnQge0ZMQUdTLCBTWVNURU1fTkFNRX0gZnJvbSAnLi9jb25zdGFudHMnO1xuICAgICAyXHRcbiAgICAgM1x0aW50ZXJmYWNlIERpc3RhbmNlT3B0aW9ucyB7XG4gICAgIDRcdCAgICBncmlkU3BhY2VzPzogYm9vbGVhblxuICAgICA1XHR9XG4gICAgIDZcdFxuICAgICA3XHQvKipcbiAgICAgOFx0ICogUHVsbGVkIGZyb20gdGhlIEZvdW5kcnlWVFQgRE5ENWUgc3lzdGVtOiBncmlkLm1qcyNtZWFzdXJlRGlzdGFuY2VcbiAgICAgOVx0ICogXG4gICAgMTBcdCAqIEBwYXJhbSBzZWdtZW50cyBcbiAgICAxMVx0ICogQHBhcmFtIG9wdGlvbnMgXG4gICAgMTJcdCAqIEByZXR1cm5zIFxuICAgIDEzXHQgKi9cbiAgICAxNFx0Y29uc3QgbWVhc3VyZURpc3RhbmNlcyA9IGZ1bmN0aW9uIChzZWdtZW50cywgb3B0aW9uczogRGlzdGFuY2VPcHRpb25zID0ge30pIHtcbiAgICAxNVx0ICAgIGlmICghb3B0aW9ucy5ncmlkU3BhY2VzKSByZXR1cm4gQmFzZUdyaWQucHJvdG90eXBlLm1lYXN1cmVEaXN0YW5jZXMuY2FsbCh0aGlzLCBzZWdtZW50cywgb3B0aW9ucyk7XG4gICAgMTZcdFxuICAgIDE3XHQgICAgLy8gVHJhY2sgdGhlIHRvdGFsIG51bWJlciBvZiBkaWFnb25hbHNcbiAgICAxOFx0ICAgIGxldCBuRGlhZ29uYWwgPSAwO1xuICAgIDE5XHQgICAgY29uc3QgcnVsZSA9IHRoaXMuZGlhZ29uYWxSdWxlO1xuICAgIDIwXHQgICAgY29uc3QgZCA9IGNhbnZhcy5kaW1lbnNpb25zIGFzIENhbnZhcy5EaW1lbnNpb25zO1xuICAgIDIxXHRcbiAgICAyMlx0ICAgIC8vIEl0ZXJhdGUgb3ZlciBtZWFzdXJlZCBzZWdtZW50c1xuICAgIDIzXHQgICAgcmV0dXJuIHNlZ21lbnRzLm1hcCgocykgPT4ge1xuICAgIDI0XHQgICAgICAgIGxldCByID0gcy5yYXk7XG4gICAgMjVcdFxuICAgIDI2XHQgICAgICAgIC8vIERldGVybWluZSB0aGUgdG90YWwgZGlzdGFuY2UgdHJhdmVsZWRcbiAgICAyN1x0ICAgICAgICBsZXQgbnggPSBNYXRoLmFicyhNYXRoLmNlaWwoci5keCAvIGQuc2l6ZSkpO1xuICAgIDI4XHQgICAgICAgIGxldCBueSA9IE1hdGguYWJzKE1hdGguY2VpbChyLmR5IC8gZC5zaXplKSk7XG4gICAgMjlcdFxuICAgIDMwXHQgICAgICAgIC8vIERldGVybWluZSB0aGUgbnVtYmVyIG9mIHN0cmFpZ2h0IGFuZCBkaWFnb25hbCBtb3Zlc1xuICAgIDMxXHQgICAgICAgIGxldCBuZCA9IE1hdGgubWluKG54LCBueSk7XG4gICAgMzJcdCAgICAgICAgbGV0IG5zID0gTWF0aC5hYnMobnkgLSBueCk7XG4gICAgMzNcdCAgICAgICAgbkRpYWdvbmFsICs9IG5kO1xuICAgIDM0XHRcbiAgICAzNVx0ICAgICAgICAvLyBFc3RpbWF0ZSBkaWFnb25hbCBsaWtlIG90aGVyIGJhdHRsZSBncmlkIHN5c3RlbXMgZG8uIChEbkQ1ZSlcbiAgICAzNlx0ICAgICAgICBpZiAocnVsZSA9PT0gJzEtMi0xJykge1xuICAgIDM3XHQgICAgICAgICAgICBsZXQgbmQxMCA9IE1hdGguZmxvb3IobkRpYWdvbmFsIC8gMikgLSBNYXRoLmZsb29yKChuRGlhZ29uYWwgLSBuZCkgLyAyKTtcbiAgICAzOFx0ICAgICAgICAgICAgbGV0IHNwYWNlcyA9IG5kMTAgKiAyICsgKG5kIC0gbmQxMCkgKyBucztcbiAgICAzOVx0ICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgICA0MFx0ICAgICAgICAgICAgcmV0dXJuIHNwYWNlcyAqIGNhbnZhcy5kaW1lbnNpb25zLmRpc3RhbmNlO1xuICAgIDQxXHQgICAgICAgIH1cbiAgICA0Mlx0XG4gICAgNDNcdCAgICAgICAgLy8gVHJlYXQgZGlhZ29uYWwgYXMgc3RyYWlnaHQgbGluZVxuICAgIDQ0XHQgICAgICAgIGVsc2UgaWYgKHJ1bGUgPT09ICdFVUNMJykge1xuICAgIDQ1XHQgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAgIDQ2XHQgICAgICAgICAgICAvLyByZXR1cm4gTWF0aC5yb3VuZChNYXRoLmh5cG90KG54LCBueSkgKiBjYW52YXMuc2NlbmUuZGF0YS5ncmlkRGlzdGFuY2UpO1xuICAgIDQ3XHQgICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChNYXRoLmh5cG90KG54LCBueSkgKiBjYW52YXMuc2NlbmU/LmdyaWQuZGlzdGFuY2UpO1xuICAgIDQ4XHQgICAgICAgIH1cbiAgICA0OVx0XG4gICAgNTBcdCAgICAgICAgLy8gVHJlYXQgZGlhZ29uYWwgYXMgc3RyYWlnaHQgbW92ZW1lbnRcbiAgICA1MVx0ICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAgIDUyXHQgICAgICAgIGVsc2UgcmV0dXJuIChucyArIG5kKSAqIGNhbnZhcy5zY2VuZT8uZ3JpZC5kaXN0YW5jZTtcbiAgICA1M1x0ICAgIH0pO1xuICAgIDU0XHR9O1xuICAgIDU1XHRcbiAgICA1Nlx0XG4gICAgNTdcdGV4cG9ydCBmdW5jdGlvbiBjYW52YXNJbml0KCkge1xuICAgIDU4XHQgICAgLy9AdHMtZXhwZWN0LWVycm9yIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAgIDU5XHQgICAgLy8gQ29weSBEbkQ1ZSdzIGFwcHJvYWNoIHRvIG1vdmVtZW50IG1lYXN1cmVtZW50IGFuZCBhZGQgYSBjdXN0b20gZmllbGQgdG8gdGhlIGdyaWQgdG8gYmUgdXNlZCBpbiBjYW52YXMudHMjbWVhc3VyZURpc3RhbmNlc1xuICAgIDYwXHQgICAgY2FudmFzLmdyaWQuZGlhZ29uYWxSdWxlID0gZ2FtZS5zZXR0aW5ncy5nZXQoU1lTVEVNX05BTUUsIEZMQUdTLkRpYWdvbmFsTW92ZW1lbnQpO1xuICAgIDYxXHQgICAgLy8gQWRkIGEgY3VzdG9tIG1lYXN1cmVEaXN0YW5jZXMgZnVuY3Rpb24sIG92ZXJ3cml0aW5nIGRlZmF1bHQgdG8gYWRkIG1vcmUgbW92ZW1lbnQgc3R5bGVzLlxuICAgIDYyXHQgICAgU3F1YXJlR3JpZC5wcm90b3R5cGUubWVhc3VyZURpc3RhbmNlcyA9IG1lYXN1cmVEaXN0YW5jZXM7XG4gICAgNjNcdH0uLi5cblBhdGg6IHNyYy9tb2R1bGUvaGVscGVycy50c1xuLi4uXG4gICAzMDdcdFxuICAgMzA4XHQgICAgLy8gVE9ETzogRm91bmRyeSAwLjkgU2hvdWxkIFRva2VuRG9jdW1lbnQgYmUgdXNlZCBpbnN0ZWFkIG9mIFRva2VuP1xuICAgMzA5XHQgICAgLy8gVE9ETzogQ2hlY2sgY2FudmFzLnNjZW5lLnRva2Vuc1xuICAgMzEwXHQgICAgc3RhdGljIGdldFRva2VuKGlkPzogc3RyaW5nKTogVG9rZW4gfCB1bmRlZmluZWQge1xuICAgMzExXHQgICAgICAgIGlmICghY2FudmFzIHx8ICFjYW52YXMucmVhZHkgfHwgIWNhbnZhcy50b2tlbnMpIHJldHVybjtcbiAgIDMxMlx0XG4gICAzMTNcdCAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiBjYW52YXMudG9rZW5zLnBsYWNlYWJsZXMpIHtcbiAgIDMxNFx0ICAgICAgICAgICAgaWYgKHRva2VuLmlkID09PSBpZCkge1xuICAgMzE1XHQgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgMzE2XHQgICAgICAgICAgICB9XG4gICAzMTdcdCAgICAgICAgfVxuICAgMzE4XHQgICAgfVxuICAgMzE5XHRcbiAgIDMyMFx0ICAgIC8qKlxuICAgMzIxXHQgICAgICogVXNlIHRoaXMgaGVscGVyIHRvIGdldCBhIHRva2VucyBhY3RvciBmcm9tIGFueSBnaXZlbiBzY2VuZSBpZC5cbiAgIDMyMlx0ICAgICAqIEBwYXJhbSBzY2VuZVRva2VuSWQgQSBtaXhlZCBpZCB3aXRoIHRoZSBmb3JtYXQgJzxzY2VuZUlkPi48dG9rZW5pZD5cbiAgIDMyM1x0ICAgICAqL1xuICAgMzI0XHQgICAgc3RhdGljIGdldFNjZW5lVG9rZW5BY3RvcihzY2VuZVRva2VuSWQ6IHN0cmluZyk6IFNSNkFjdG9yIHwgbnVsbCB7XG4gICAzMjVcdCAgICAgICAgY29uc3QgW3NjZW5lSWQsIHRva2VuSWRdID0gSGVscGVycy5kZWNvbnN0cnVjdFNjZW5lVG9rZW5JZChzY2VuZVRva2VuSWQpO1xuICAgMzI2XHQgICAgICAgIGNvbnN0IHRva2VuID0gSGVscGVycy5nZXRTY2VuZVRva2VuRG9jdW1lbnQoc2NlbmVJZCwgdG9rZW5JZCk7XG4gICAzMjdcdCAgICAgICAgaWYgKCF0b2tlbikgcmV0dXJuIG51bGw7XG4gICAzMjhcdCAgICAgICAgcmV0dXJuIHRva2VuLmdldEFjdG9yKCk7XG4gICAzMjlcdCAgICB9XG4uLi5cblBhdGg6IHNoYWRvd3J1bjYtZ2VuZXNpcy1pbXBvcnRlci9tb2R1bGUvbWFpbi5qc1xuICAgICAxXHRpbXBvcnQgeyBHZW5lc2lzSW1wb3J0Rm9ybSB9IGZyb20gJy4vYXBwcy9nZW5lc2lzLWltcG9ydC1mb3JtLmpzJztcbiAgICAgMlx0XG4gICAgIDNcdEhvb2tzLm9uY2UoJ2luaXQnLCAoKSA9PiB7XG4gICAgIDRcdCAgICBjb25zb2xlLmxvZygnU2hhZG93cnVuIDZlIEdlbmVzaXMgSW1wb3J0ZXIgfCBJbml0aWFsaXppbmcgbW9kdWxlJyk7XG4gICAgIDVcdH0pO1xuICAgICA2XHRcbiAgICAgN1x0SG9va3Mub25jZSgncmVhZHknLCAoKSA9PiB7XG4gICAgIDhcdCAgICBjb25zb2xlLmxvZygnU2hhZG93cnVuIDZlIEdlbmVzaXMgSW1wb3J0ZXIgfCBNb2R1bGUgcmVhZHknKTtcbiAgICAgOVx0fSk7XG4gICAgMTBcdFxuICAgIDExXHQvLyBSZWdpc3RlciB0aGUgR2VuZXNpcyBpbXBvcnRlciB3aXRoIHRoZSBTaGFkb3dydW4gNmUgc3lzdGVtXG4gICAgMTJcdEhvb2tzLm9uKCdyZW5kZXJBY3RvclNoZWV0JywgKGFwcCwgaHRtbCwgZGF0YSkgPT4ge1xuICAgIDEzXHQgICAgLy8gT25seSBhZGQgdGhlIGJ1dHRvbiB0byBTaGFkb3dydW4gNmUgY2hhcmFjdGVyIHNoZWV0c1xuICAgIDE0XHQgICAgaWYgKGFwcC5hY3Rvci50eXBlICE9PSAnY2hhcmFjdGVyJyB8fCAhYXBwLmFjdG9yLnN5c3RlbSkgcmV0dXJuO1xuICAgIDE1XHQgICAgXG4gICAgMTZcdCAgICAvLyBGaW5kIHRoZSBpbXBvcnQgY2hhcmFjdGVyIGJ1dHRvblxuICAgIDE3XHQgICAgY29uc3QgaW1wb3J0QnV0dG9uID0gaHRtbC5maW5kKCcuaW1wb3J0LWNoYXJhY3RlcicpO1xuICAgIDE4XHQgICAgaWYgKGltcG9ydEJ1dHRvbi5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICAxOVx0ICAgIFxuICAgIDIwXHQgICAgLy8gQWRkIG91ciBvd24gY2xpY2sgaGFuZGxlclxuICAgIDIxXHQgICAgaW1wb3J0QnV0dG9uLm9mZignY2xpY2snKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAyMlx0ICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIDIzXHQgICAgICAgIFxuICAgIDI0XHQgICAgICAgIC8vIENyZWF0ZSBhIGRpYWxvZyB0byBjaG9vc2UgYmV0d2VlbiBDaHVtbWVyIGFuZCBHZW5lc2lzIGltcG9ydFxuICAgIDI1XHQgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBgXG4gICAgMjZcdCAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDEwcHg7XCI+XG4gICAgMjdcdCAgICAgICAgICAgICAgICA8cD4ke2dhbWUuaTE4bi5sb2NhbGl6ZSgnU1I2LkltcG9ydENoYXJhY3RlckNob29zZScpfTwvcD5cbiAgICAyOFx0ICAgICAgICAgICAgPC9kaXY+XG4gICAgMjlcdCAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcIj5cbiAgICAzMFx0ICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJjaHVtbWVyLWltcG9ydFwiPiR7Z2FtZS5pMThuLmxvY2FsaXplKCdTUjYuQ2h1bW1lckltcG9ydCcpfTwvYnV0dG9uPlxuICAgIDMxXHQgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImdlbmVzaXMtaW1wb3J0XCI+JHtnYW1lLmkxOG4ubG9jYWxpemUoJ1NSNi5HZW5lc2lzSW1wb3J0Jyl9PC9idXR0b24+XG4gICAgMzJcdCAgICAgICAgICAgIDwvZGl2PlxuICAgIDMzXHQgICAgICAgIGA7XG4gICAgMzRcdFxuICAgIDM1XHQgICAgICAgIGNvbnN0IGRpYWxvZyA9IG5ldyBEaWFsb2coe1xuICAgIDM2XHQgICAgICAgICAgICB0aXRsZTogZ2FtZS5pMThuLmxvY2FsaXplKCdTUjYuSW1wb3J0Q2hhcmFjdGVyJyksXG4gICAgMzdcdCAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgMzhcdCAgICAgICAgICAgIGJ1dHRvbnM6IHt9LFxuICAgIDM5XHQgICAgICAgICAgICByZW5kZXI6IGh0bWwgPT4ge1xuICAgIDQwXHQgICAgICAgICAgICAgICAgaHRtbC5maW5kKCcuY2h1bW1lci1pbXBvcnQnKS5jbGljaygoKSA9PiB7XG4gICAgNDFcdCAgICAgICAgICAgICAgICAgICAgZGlhbG9nLmNsb3NlKCk7XG4gICAgNDJcdCAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbCB0aGUgc3lzdGVtJ3MgQ2h1bW1lciBpbXBvcnRlclxuICAgIDQzXHQgICAgICAgICAgICAgICAgICAgIGFwcC5fb25TaG93SW1wb3J0Q2hhcmFjdGVyKGV2ZW50KTtcbiAgICA0NFx0ICAgICAgICAgICAgICAgIH0pO1xuICAgIDQ1XHRcbiAgICA0Nlx0ICAgICAgICAgICAgICAgIGh0bWwuZmluZCgnLmdlbmVzaXMtaW1wb3J0JykuY2xpY2soKCkgPT4ge1xuICAgIDQ3XHQgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5jbG9zZSgpO1xuICAgIDQ4XHQgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgNDlcdCAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdnZW5lc2lzLWltcG9ydCcsXG4gICAgNTBcdCAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1NSNi5HZW5lc2lzSW1wb3J0JyksXG4gICAgNTFcdCAgICAgICAgICAgICAgICAgICAgfTtcbiAgICA1Mlx0ICAgICAgICAgICAgICAgICAgICBuZXcgR2VuZXNpc0ltcG9ydEZvcm0oYXBwLmFjdG9yLCBvcHRpb25zKS5yZW5kZXIodHJ1ZSk7XG4gICAgNTNcdCAgICAgICAgICAgICAgICB9KTtcbiAgICA1NFx0ICAgICAgICAgICAgfVxuICAgIDU1XHQgICAgICAgIH0pO1xuICAgIDU2XHRcbiAgICA1N1x0ICAgICAgICBkaWFsb2cucmVuZGVyKHRydWUpO1xuICAgIDU4XHQgICAgfSk7XG4gICAgNTlcdH0pO1xuICAgIDYwXHRcbiAgICA2MVx0Ly8gRXhwb3J0IHRoZSBHZW5lc2lzSW1wb3J0Rm9ybSBmb3IgZXh0ZXJuYWwgdXNlXG4gICAgNjJcdGV4cG9ydCB7IEdlbmVzaXNJbXBvcnRGb3JtIH07XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvcnVsZXMvRG9jdW1lbnRTaXR1YXRpb25Nb2RpZmllcnMudHNcbi4uLlxuICAgMzkwXHRcbiAgIDM5MVx0ICAgIC8qKlxuICAgMzkyXHQgICAgICogSGVscGVyIGZvciBzY2VuZSBtb2RpZmllciBpbnN0YW5jZXMgdG8gY2xlYXIgYWxsIG1vZGlmaWVycyBmb3IgYWxsIHBsYWNlZCB0b2tlbnNcbiAgIDM5M1x0ICAgICAqL1xuICAgMzk0XHQgICAgYXN5bmMgY2xlYXJBbGxUb2tlbnNPblNjZW5lKCkge1xuICAgMzk1XHQgICAgICAgIGlmICghY2FudmFzLnJlYWR5IHx8ICFjYW52YXMuc2NlbmUpIHJldHVybjtcbiAgIDM5Nlx0ICAgICAgICBpZiAoIXRoaXMuZG9jdW1lbnRJc1NjZW5lKSByZXR1cm47XG4gICAzOTdcdFxuICAgMzk4XHQgICAgICAgIC8vIFZhbGlkYXRlIHRoYXQgbW9kaWZpZXJzIHNjZW5lIGlzIHNhbWUgdG8gY3VycmVudCBzY2VuZS5cbiAgIDM5OVx0ICAgICAgICBjb25zdCBzY2VuZSA9IHRoaXMuZG9jdW1lbnQgYXMgU2NlbmU7XG4gICA0MDBcdCAgICAgICAgaWYgKGNhbnZhcy5zY2VuZS5pZCAhPT0gc2NlbmUuaWQpIHJldHVybjtcbiAgIDQwMVx0XG4gICA0MDJcdCAgICAgICAgLy8gVXNlIGN1cnJlbnQgc2NlbmUgZm9yIGVhc2Ugb2YgYWNjZXNzIHRvIHRva2Vuc1xuICAgNDAzXHQgICAgICAgIGNhbnZhcy5zY2VuZS50b2tlbnMuZm9yRWFjaCh0b2tlbiA9PiB0b2tlbi5hY3Rvcj8uZ2V0U2l0dWF0aW9uTW9kaWZpZXJzKCkuY2xlYXJBbGwoKSk7XG4gICA0MDRcdCAgICB9XG4gICA0MDVcdH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9jb21iYXQvU1I2Q29tYmF0LnRzXG4uLi5cbiAgIDM2NVx0ICAgICAgICBsZXQgbmV4dFR1cm4gPSB0aGlzLnNldHRpbmdzPy5za2lwRGVmZWF0ZWQgP1xuICAgMzY2XHQgICAgICAgICAgICB0aGlzLm5leHRVbmRlZmVhdGVkVHVyblBvc2l0aW9uIDpcbiAgIDM2N1x0ICAgICAgICAgICAgdGhpcy5uZXh0VmlhYmxlVHVyblBvc2l0aW9uO1xuICAgMzY4XHRcbiAgIDM2OVx0ICAgICAgICAvLyBTdGFydCBvZiB0aGUgY29tYmF0IEhhbmRsaW5nXG4gICAzNzBcdCAgICAgICAgaWYgKG5leHRSb3VuZCA9PT0gMCAmJiBpbml0aWF0aXZlUGFzcyA9PT0gMCkge1xuICAgMzcxXHQgICAgICAgICAgICBhd2FpdCB0aGlzLnN0YXJ0Q29tYmF0KCk7XG4gICAzNzJcdCAgICAgICAgICAgIHJldHVybjtcbiAgIDM3M1x0ICAgICAgICB9XG4gICAzNzRcdFxuICAgMzc1XHQgICAgICAgIC8vIEp1c3Qgc3RlcCBmcm9tIG9uZSBjb21iYXRhbnQgdG8gdGhlIG5leHQhXG4gICAzNzZcdCAgICAgICAgaWYgKG5leHRUdXJuIDwgdGhpcy50dXJucy5sZW5ndGgpIHtcbiAgIDM3N1x0ICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGUoeyB0dXJuOiBuZXh0VHVybiB9KTtcbiAgIDM3OFx0ICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVBY3Rpb25QaGFzZSgpO1xuICAgMzc5XHQgICAgICAgICAgICByZXR1cm47XG4gICAzODBcdCAgICAgICAgfVxuICAgMzgxXHRcbiAgIDM4Mlx0ICAgICAgICAvLyBJbiBTaGFkb3dydW4gNnRoIEVkaXRpb24sIHRoZXJlIGFyZSBubyBpbml0aWF0aXZlIHBhc3Nlc1xuICAgMzgzXHRcbiAgIDM4NFx0XG4gICAzODVcdCAgICAgICAgLy8gSW5pdGlhdGl2ZSBSb3VuZCBIYW5kbGluZy5cbiAgIDM4Nlx0ICAgICAgICAvLyBOT1RFOiBJdCdzIG5vdCBjaGVja2VkIGlmIHRoZSBuZXh0IGlzIG5lZWRlZC4gVGhpcyBzaG91bGQgcmVzdWx0IGluIHRoZSB1c2VyIG5vdGljaW5nIHRoZSB0dXJuIGdvaW5nIHVwLCB3aGVuIGl0XG4gICAzODdcdCAgICAgICAgLy8gICAgICAgbWF5YmUgc2hvdWxkbid0IGFuZCByZXBvcnRpbmcgYSB1bmhhbmRsZWQgY29tYmF0IHBoYXNlIGZsb3cgY2FzZS5cbiAgIDM4OFx0ICAgICAgICByZXR1cm4gdGhpcy5uZXh0Um91bmQoKTtcbiAgIDM4OVx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9taWdyYXRvci9WZXJzaW9uTWlncmF0aW9uLnRzXG4uLi5cbiAgIDEzNFx0XG4gICAxMzVcdCAgICAvKipcbiAgIDEzNlx0ICAgICAqIEl0ZXJhdGUgdGhyb3VnaCBhbGwgc2NlbmVzIGFuZCBtaWdyYXRlIGVhY2ggaWYgbmVlZGVkLlxuICAgMTM3XHQgICAgICogQHBhcmFtIGdhbWVcbiAgIDEzOFx0ICAgICAqIEBwYXJhbSBlbnRpdHlVcGRhdGVzXG4gICAxMzlcdCAgICAgKi9cbiAgIDE0MFx0ICAgIHByb3RlY3RlZCBhc3luYyBJdGVyYXRlU2NlbmVzKGdhbWU6IEdhbWUsIGVudGl0eVVwZGF0ZXM6IE1hcDxTeXN0ZW1NaWdyYXRpb25Eb2N1bWVudHMsIERvY3VtZW50VXBkYXRlPikge1xuICAgMTQxXHQgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLy8gaWdub3JlIG51bGwgc3RhdGVcbiAgIDE0Mlx0ICAgICAgICBmb3IgKGNvbnN0IHNjZW5lIG9mIGdhbWUuc2NlbmVzLmNvbnRlbnRzKSB7XG4gICAxNDNcdCAgICAgICAgICAgIHRyeSB7XG4gICAxNDRcdCAgICAgICAgICAgICAgICBpZiAoIShhd2FpdCB0aGlzLlNob3VsZE1pZ3JhdGVTY2VuZURhdGEoc2NlbmUpKSkge1xuICAgMTQ1XHQgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgMTQ2XHQgICAgICAgICAgICAgICAgfVxuICAgMTQ3XHRcbiAgIDE0OFx0ICAgICAgICAgICAgICAgIC8vIE1pZ3JhdGUgU2NlbmVEYXRhIGl0c2VsZi5cbiAgIDE0OVx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBNaWdyYXRpbmcgU2NlbmUgZW50aXR5ICR7c2NlbmUubmFtZX1gKTtcbiAgIDE1MFx0ICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSBhd2FpdCB0aGlzLk1pZ3JhdGVTY2VuZURhdGEoc2NlbmUpO1xuICAgMTUxXHRcbiAgIDE1Mlx0ICAgICAgICAgICAgICAgIGV4cGFuZE9iamVjdCh1cGRhdGVEYXRhKTtcbiAgIDE1M1x0ICAgICAgICAgICAgICAgIGVudGl0eVVwZGF0ZXMuc2V0KHNjZW5lLCB7XG4gICAxNTRcdCAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YSxcbiAgIDE1NVx0ICAgICAgICAgICAgICAgICAgICBlbWJlZGRlZEl0ZW1zOiBudWxsLFxuICAgMTU2XHQgICAgICAgICAgICAgLi4uIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiOTMzOTY0ZWYtMjdmNi00N2FiLWE1MzEtNDczYzE3Yjg4MzdjO3Rvb2x1X3ZydHhfMDFRb1pNTk1mcW04UEtpNXVSQnR5Z3YyIjp7InJlcXVlc3RJZCI6IjkzMzk2NGVmLTI3ZjYtNDdhYi1hNTMxLTQ3M2MxN2I4ODM3YyIsInRvb2xVc2VJZCI6InRvb2x1X3ZydHhfMDFRb1pNTk1mcW04UEtpNXVSQnR5Z3YyIiwicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbW9kdWxlL2FjdG9yL1NSNkFjdG9yLnRzOlxuICAgMzE1XHQgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAzMTZcdCAgICAgICAgfVxuICAgMzE3XHRcbiAgIDMxOFx0ICAgICAgICAvLyBFbnN1cmUgbWF0cml4IGFjdGlvbnMgYXJlIGF2YWlsYWJsZSBmb3IgYWxsIGFjdG9ycyB0aGF0IGNhbiB1c2UgdGhlIE1hdHJpeFxuICAgMzE5XHQgICAgICAgIGlmIChnYW1lLnVzZXI/LmlzR00gJiYgdGhpcy5pc093bmVyICYmICh0aGlzLmlzQ2hhcmFjdGVyKCkgfHwgdGhpcy5pc1Nwcml0ZSgpIHx8IHRoaXMuaXNJQygpKSkge1xuICAgMzIwXHQgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGFkZGVkIG1hdHJpeCBhY3Rpb25zIHRvIHRoaXMgYWN0b3JcbiAgIDMyMVx0ICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XG4gICAzMjJcdCAgICAgICAgICAgIGlmICghaGFzTWF0cml4QWN0aW9ucykge1xuICAgMzIzXHQgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byB1c2UgYSBzZXRUaW1lb3V0IHRvIGF2b2lkIGlzc3VlcyB3aXRoIHRoZSBhY3RvciBiZWluZyBsb2NrZWQgZHVyaW5nIGRhdGEgcHJlcGFyYXRpb25cbiAgIDMyNFx0ICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCksIDUwMCk7XG4gICAzMjVcdCAgICAgICAgICAgIH1cbiAgIDMyNlx0ICAgICAgICB9XG4gICAzMjdcdCAgICB9XG4gICAzMjhcdFxuICAgMzI5XHQgICAgLyoqXG4gICAzMzBcdCAgICAgKiBOT1RFOiBUaGlzIG1ldGhvZCBpcyB1bnVzZWQgYXQgdGhlIG1vbWVudCwga2VlcCBpdCBmb3IgZnV0dXJlIGluc3BpcmF0aW9uLlxuVG90YWwgbGluZXMgaW4gZmlsZTogMzAzMVxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiZDBjNGQ4OTMtOWQ4Mi00ZjVkLThiYzEtODk1MjU5ZDMzOTc1O3Rvb2x1X3ZydHhfMDFTVU44Rm44dVl1WXJQRldOeG1WaUZKIjp7InJlcXVlc3RJZCI6ImQwYzRkODkzLTlkODItNGY1ZC04YmMxLTg5NTI1OWQzMzk3NSIsInRvb2xVc2VJZCI6InRvb2x1X3ZydHhfMDFTVU44Rm44dVl1WXJQRldOeG1WaUZKIiwicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiSGVyZSdzIHRoZSByZXN1bHQgb2YgcnVubmluZyBgY2F0IC1uYCBvbiBzcmMvbW9kdWxlL2hvb2tzLnRzOlxuICAgNDQ1XHQgICAgICAgIGlmICghY2FudmFzLnJlYWR5IHx8ICFnYW1lLmFjdG9ycykgcmV0dXJuO1xuICAgNDQ2XHRcbiAgIDQ0N1x0ICAgICAgICBpZiAoaXRlbS5pc0hvc3QpIHtcbiAgIDQ0OFx0ICAgICAgICAgICAgLy8gQ29sbGVjdCBhY3RvcnMgZnJvbSBzaWRlYmFyIGFuZCBhY3RpdmUgc2NlbmUgdG8gdXBkYXRlIC8gcmVyZW5kZXJcbiAgIDQ0OVx0ICAgICAgICAgICAgbGV0IGNvbm5lY3RlZElDID0gW1xuICAgNDUwXHQgICAgICAgICAgICAgICAgLy8gQWxsIHNpZGViYXIgYWN0b3JzIHNob3VsZCBhbHNvIGluY2x1ZGUgdG9rZW5zIHdpdGggbGlua2VkIGFjdG9ycy5cbiAgIDQ1MVx0ICAgICAgICAgICAgICAgIC4uLmdhbWUuYWN0b3JzLmZpbHRlcigoYWN0b3I6IFNSNkFjdG9yKSA9PiBhY3Rvci5pc0lDKCkgJiYgYWN0b3IuaGFzSG9zdCgpKSBhcyBTUjZBY3RvcltdLFxuICAgNDUyXHQgICAgICAgICAgICAgICAgLy8gQWxsIHRva2VuIGFjdG9ycyB0aGF0IGFyZW4ndCBsaW5rZWQuXG4gICA0NTNcdCAgICAgICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC8vIFRPRE86IGZvdW5kcnktdnR0LXR5cGVzIHYxMFxuICAgNDU0XHQgICAgICAgICAgICAgICAgLi4uY2FudmFzLnNjZW5lLnRva2Vucy5maWx0ZXIodG9rZW4gPT4gIXRva2VuLmFjdG9yTGluayAmJiB0b2tlbi5hY3Rvcj8uaXNJQygpICYmIHRva2VuLmFjdG9yPy5oYXNIb3N0KCkpLm1hcCh0ID0+IHQuYWN0b3IpXG4gICA0NTVcdCAgICAgICAgICAgIF07XG4gICA0NTZcdFxuICAgNDU3XHQgICAgICAgICAgICAvLyBVcGRhdGUgaG9zdCBkYXRhIG9uIHRoZSBpYyBhY3Rvci5cbiAgIDQ1OFx0ICAgICAgICAgICAgY29uc3QgaG9zdCA9IGl0ZW0uYXNIb3N0O1xuICAgNDU5XHQgICAgICAgICAgICBpZiAoIWhvc3QpIHJldHVybjtcbiAgIDQ2MFx0ICAgICAgICAgICAgZm9yIChjb25zdCBpYyBvZiBjb25uZWN0ZWRJQykge1xuICAgNDYxXHQgICAgICAgICAgICAgICAgaWYgKCFpYykgY29udGludWU7XG4gICA0NjJcdCAgICAgICAgICAgICAgICBhd2FpdCBpYy5fdXBkYXRlSUNIb3N0RGF0YShob3N0KTtcbiAgIDQ2M1x0ICAgICAgICAgICAgfVxuICAgNDY0XHQgICAgICAgIH1cbiAgIDQ2NVx0ICAgIH1cbiAgIDQ2Nlx0XG4gICA0NjdcdCAgICBzdGF0aWMgYXN5bmMgcmVtb3ZlRGVsZXRlZEl0ZW1zRnJvbU5ldHdvcmtzKGl0ZW06IFNSNkl0ZW0sIGRhdGE6IFNoYWRvd3J1bi5TaGFkb3dydW5JdGVtRGF0YURhdGEsIGlkOiBzdHJpbmcpIHtcbiAgIDQ2OFx0ICAgICAgICBhd2FpdCBOZXR3b3JrRGV2aWNlRmxvdy5oYW5kbGVPbkRlbGV0ZUl0ZW0oaXRlbSwgZGF0YSwgaWQpO1xuICAgNDY5XHQgICAgfVxuICAgNDcwXHRcblRvdGFsIGxpbmVzIGluIGZpbGU6IDUzM1xuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiZjE1NmQ4ZmUtMzQ1My00MTNlLTliNTctNTRkOTcxODE3Njg5O3Rvb2x1X3ZydHhfMDFQVFdlUmRtd3B1RlhDMUg1TG1tUDlVIjp7InJlcXVlc3RJZCI6ImYxNTZkOGZlLTM0NTMtNDEzZS05YjU3LTU0ZDk3MTgxNzY4OSIsInRvb2xVc2VJZCI6InRvb2x1X3ZydHhfMDFQVFdlUmRtd3B1RlhDMUg1TG1tUDlVIiwicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogc3JjL21vZHVsZS9oZWxwZXJzLnRzXG4uLi5cbiAgIDMwN1x0XG4gICAzMDhcdCAgICAvLyBUT0RPOiBGb3VuZHJ5IDAuOSBTaG91bGQgVG9rZW5Eb2N1bWVudCBiZSB1c2VkIGluc3RlYWQgb2YgVG9rZW4/XG4gICAzMDlcdCAgICAvLyBUT0RPOiBDaGVjayBjYW52YXMuc2NlbmUudG9rZW5zXG4gICAzMTBcdCAgICBzdGF0aWMgZ2V0VG9rZW4oaWQ/OiBzdHJpbmcpOiBUb2tlbiB8IHVuZGVmaW5lZCB7XG4gICAzMTFcdCAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5yZWFkeSB8fCAhY2FudmFzLnRva2VucykgcmV0dXJuO1xuICAgMzEyXHRcbiAgIDMxM1x0ICAgICAgICBmb3IgKGNvbnN0IHRva2VuIG9mIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcykge1xuICAgMzE0XHQgICAgICAgICAgICBpZiAodG9rZW4uaWQgPT09IGlkKSB7XG4gICAzMTVcdCAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW47XG4gICAzMTZcdCAgICAgICAgICAgIH1cbiAgIDMxN1x0ICAgICAgICB9XG4gICAzMThcdCAgICB9XG4gICAzMTlcdFxuICAgMzIwXHQgICAgLyoqXG4gICAzMjFcdCAgICAgKiBVc2UgdGhpcyBoZWxwZXIgdG8gZ2V0IGEgdG9rZW5zIGFjdG9yIGZyb20gYW55IGdpdmVuIHNjZW5lIGlkLlxuICAgMzIyXHQgICAgICogQHBhcmFtIHNjZW5lVG9rZW5JZCBBIG1peGVkIGlkIHdpdGggdGhlIGZvcm1hdCAnPHNjZW5lSWQ+Ljx0b2tlbmlkPlxuICAgMzIzXHQgICAgICovXG4gICAzMjRcdCAgICBzdGF0aWMgZ2V0U2NlbmVUb2tlbkFjdG9yKHNjZW5lVG9rZW5JZDogc3RyaW5nKTogU1I2QWN0b3IgfCBudWxsIHtcbiAgIDMyNVx0ICAgICAgICBjb25zdCBbc2NlbmVJZCwgdG9rZW5JZF0gPSBIZWxwZXJzLmRlY29uc3RydWN0U2NlbmVUb2tlbklkKHNjZW5lVG9rZW5JZCk7XG4gICAzMjZcdCAgICAgICAgY29uc3QgdG9rZW4gPSBIZWxwZXJzLmdldFNjZW5lVG9rZW5Eb2N1bWVudChzY2VuZUlkLCB0b2tlbklkKTtcbiAgIDMyN1x0ICAgICAgICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcbiAgIDMyOFx0ICAgICAgICByZXR1cm4gdG9rZW4uZ2V0QWN0b3IoKTtcbiAgIDMyOVx0ICAgIH1cbiAgIDMzMFx0XG4gICAzMzFcdCAgICBzdGF0aWMgZGVjb25zdHJ1Y3RTY2VuZVRva2VuSWQoc2NlbmVUb2tlbklkOiBzdHJpbmcpOiBbc2NlbmVJZDogc3RyaW5nLCB0b2tlbklkOiBzdHJpbmddIHtcbiAgIDMzMlx0ICAgICAgICByZXR1cm4gc2NlbmVUb2tlbklkLnNwbGl0KCcuJykgYXMgW3NjZW5lSWQ6IHN0cmluZywgdG9rZW5JZDogc3RyaW5nXTtcbiAgIDMzM1x0ICAgIH1cbiAgIDMzNFx0XG4gICAzMzVcdCAgICBzdGF0aWMgZ2V0U2NlbmVUb2tlbkRvY3VtZW50KHNjZW5lSWQsIHRva2VuSWQpOiBUb2tlbkRvY3VtZW50IHwgdW5kZWZpbmVkIHtcbiAgIDMzNlx0ICAgICAgICBjb25zdCBzY2VuZSA9IGdhbWUuc2NlbmVzPy5nZXQoc2NlbmVJZCk7XG4gICAzMzdcdCAgICAgICAgaWYgKCFzY2VuZSkgcmV0dXJuO1xuICAgMzM4XHQgICAgICAgIGNvbnN0IHRva2VuID0gc2NlbmUudG9rZW5zLmdldCh0b2tlbklkKTtcbiAgIDMzOVx0ICAgICAgICBpZiAoIXRva2VuKSByZXR1cm47XG4gICAzNDBcdFxuICAgMzQxXHQgICAgICAgIHJldHVybiB0b2tlbjtcbiAgIDM0Mlx0ICAgIH1cbiAgIDM0M1x0XG4gICAzNDRcdCAgICBzdGF0aWMgZ2V0VXNlclRhcmdldHModXNlcj86IFVzZXIgfCBudWxsKTogVG9rZW5bXSB7XG4gICAzNDVcdCAgICAgICAgdXNlciA9IHVzZXIgPyB1c2VyIDogZ2FtZS51c2VyO1xuICAgMzQ2XHRcbiAgIDM0N1x0ICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBbXVxuICAgMzQ4XHRcbiAgIDM0OVx0ICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh1c2VyLnRhcmdldHMpO1xuICAgMzUwXHQgICAgfVxuICAgMzUxXHRcbiAgIDM1Mlx0ICAgIHN0YXRpYyB1c2VySGFzVGFyZ2V0cyh1c2VyPzogVXNlciB8IG51bGwpOiBib29sZWFuIHtcbiAgIDM1M1x0ICAgICAgICB1c2VyID0gdXNlciA/IHVzZXIgOiBnYW1lLnVzZXI7XG4gICAzNTRcdFxuICAgMzU1XHQgICAgICAgIGlmICghdXNlcikgcmV0dXJuIGZhbHNlO1xuICAgMzU2XHRcbiAgIDM1N1x0ICAgICAgICByZXR1cm4gdXNlci50YXJnZXRzLnNpemUgPiAwO1xuICAgMzU4XHQgICAgfVxuLi4uXG4gICA2NjFcdFxuICAgNjYyXHQgICAgICAgIC8vIElmIHdlIGRpZCBub3QgZmluZCBhbnl0aGluZyBvbiB0aGUgYWN0b3IsIHNlYXJjaCB0aGUgYWN0aXZlIHRva2VucyAodGhlIGl0ZW0gbWlnaHQgb25seSBleGlzdCBvbiBhIG5vbiBsaW5rZWQgdG9rZW4pXG4gICA2NjNcdCAgICAgICAgLy8gVGhpcyB3aWxsIG5vdCB3b3JrIGlmIHdlIGFyZSBvbiBhIGRpZmZlcmVudCBzY2VuZSBvciB0aGUgdG9rZW4gZ290IGRlbGV0ZWQsIHdoaWNoIGlzIGV4cGVjdGVkIHdoZW4geW91IHB1dCBhblxuICAgNjY0XHQgICAgICAgIC8vIGl0ZW0gb24gYSB0b2tlbiB3aXRob3V0IGxpbmtpbmcgaXQuXG4gICA2NjVcdCAgICAgICAgY29uc3QgdG9rZW5zID0gYWN0b3JTb3VyY2UuZ2V0QWN0aXZlVG9rZW5zKCk7XG4gICA2NjZcdCAgICAgICAgbGV0IHRva2VuSXRlbTogU1I2SXRlbSB8IHVuZGVmaW5lZDtcbiAgIDY2N1x0ICAgICAgICB0b2tlbnMuZm9yRWFjaCh0b2tlbiA9PiB7XG4gICA2NjhcdCAgICAgICAgICAgIGlmICghdG9rZW4uYWN0b3IpIHJldHVybjtcbiAgIDY2OVx0XG4gICA2NzBcdCAgICAgICAgICAgIGNvbnN0IGZvdW5kSXRlbSA9IHRva2VuLmFjdG9yLml0ZW1zLmdldChpdGVtSWQpO1xuICAgNjcxXHQgICAgICAgICAgICBpZiAoZm91bmRJdGVtKSB7XG4gICA2NzJcdCAgICAgICAgICAgICAgICB0b2tlbkl0ZW0gPSBmb3VuZEl0ZW0gYXMgdW5rbm93biBhcyBTUjZJdGVtO1xuICAgNjczXHQgICAgICAgICAgICB9XG4gICA2NzRcdCAgICAgICAgfSk7XG4gICA2NzVcdFxuICAgNjc2XHQgICAgICAgIHJldHVybiB0b2tlbkl0ZW07XG4gICA2NzdcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHNcbi4uLlxuICAgIDM0XHRcbiAgICAzNVx0XG4gICAgMzZcdC8qKlxuICAgIDM3XHQgKiBUaGUgZ2VuZXJhbCBTaGFkb3dydW4gYWN0b3IgaW1wbGVtZW50YXRpb24sIHdoaWNoIGN1cnJlbnRseSBoYW5kbGVzIGFsbCBhY3RvciB0eXBlcy5cbiAgICAzOFx0ICpcbiAgICAzOVx0ICogVG8gZWFzaWx5IGFjY2VzcyBBY3RvckRhdGEgd2l0aG91dCBhbnkgdHlwaW5nIGlzc3VlcyB1cyB0aGUgU1I2QWN0b3IuYXNDcml0dGVyIGhlbHBlcnMuXG4gICAgNDBcdCAqIFRoZXkgYXJlIHNldCB1cCBpbiBhIHdheSB0aGF0IHdpbGwgaGFuZGxlIGJvdGggZXJyb3IgbWFuYWdlbWVudCBhbmQgdHlwZSBuYXJyb3dpbmcuXG4gICAgNDFcdCAqIEV4YW1wbGU6XG4gICAgNDJcdCAqIDxwcmU+PGNvZGU+XG4gICAgNDNcdCAqICAgICBjb25zdCBhY3RvciA9IGdhbWUuYWN0b3JzLmdldCgncmFuZG9tSWQnKTtcbiAgICA0NFx0ICogICAgIGNvbnN0IGNyaXR0ZXIgPSBhY3Rvci5hc0NyaXR0ZXIoKTtcbiAgICA0NVx0ICogICAgIGlmICghY3JpdHRlcikgcmV0dXJuO1xuICAgIDQ2XHQgKiAgICAgLy8gY3JpdHRlci50eXBlID09PSAnY3JpdHRlcidcbiAgICA0N1x0ICogICAgIC8vIGNyaXR0ZXIuc3lzdGVtIGFzIENyaXR0ZXJEYXRhXG4gICAgNDhcdCAqIDwvY29kZT48L3ByZT5cbiAgICA0OVx0ICpcbiAgICA1MFx0ICovXG4gICAgNTFcdGV4cG9ydCBjbGFzcyBTUjZBY3RvciBleHRlbmRzIEFjdG9yIHtcbiAgICA1Mlx0ICAgIC8qKlxuICAgIDUzXHQgICAgICogQ2FjaGUgZm9yIGFybW9yIGNhbGN1bGF0aW9ucyB0byBhdm9pZCByZWNhbGN1bGF0aW5nIHVubmVjZXNzYXJpbHlcbiAgICA1NFx0ICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgNTVcdCAgICAgKiBAcHJpdmF0ZVxuICAgIDU2XHQgICAgICovXG4gICAgNTdcdCAgICBwcml2YXRlIF9hcm1vckNhY2hlOiB7XG4gICAgNThcdCAgICAgICAgYXJtb3I/OiBTaGFkb3dydW4uQWN0b3JBcm1vcixcbiAgICA1OVx0ICAgICAgICB0aW1lc3RhbXA6IG51bWJlcixcbiAgICA2MFx0ICAgICAgICBlcXVpcG1lbnRIYXNoOiBzdHJpbmdcbiAgICA2MVx0ICAgIH0gPSB7XG4gICAgNjJcdCAgICAgICAgdGltZXN0YW1wOiAwLFxuLi4uXG4gIDE0NTBcdFxuICAxNDUxXHQgICAgLyoqIFJldHVybiBlaXRoZXIgdGhlIGxpbmtlZCB0b2tlbiBvciB0aGUgdG9rZW4gb2YgdGhlIHN5bnRoZXRpYyBhY3Rvci5cbiAgMTQ1Mlx0ICAgICAqXG4gIDE0NTNcdCAgICAgKiBAcmV0dXJuIFdpbGwgcmV0dXJuIG51bGwgc2hvdWxkIG5vIHRva2VuIGhhdmUgYmVlbiBwbGFjZWQgb24gc2NlbmUuXG4gIDE0NTRcdCAgICAgKi9cbiAgMTQ1NVx0ICAgIGdldFRva2VuKCk6IFRva2VuRG9jdW1lbnQgfCBudWxsIHtcbiAgMTQ1Nlx0ICAgICAgICAvLyBMaW5rZWQgYWN0b3JzIGNhbiBvbmx5IGhhdmUgb25lIHRva2VuLCB3aGljaCBpc24ndCBzdG9yZWQgd2l0aGluIGFjdG9yIGRhdGEuLi5cbiAgMTQ1N1x0ICAgICAgICBpZiAodGhpcy5faXNMaW5rZWRUb1Rva2VuKCkgJiYgdGhpcy5oYXNUb2tlbigpKSB7XG4gIDE0NThcdCAgICAgICAgICAgIGNvbnN0IGxpbmtlZCA9IHRydWU7XG4gIDE0NTlcdCAgICAgICAgICAgIGNvbnN0IHRva2VucyA9IHRoaXMuZ2V0QWN0aXZlVG9rZW5zKGxpbmtlZCkgYXMgdW5rbm93biBhcyBUb2tlbltdO1xuICAxNDYwXHQgICAgICAgICAgICAvLyBUaGlzIGFzc3VtZXMgZm9yIGEgdG9rZW4gdG8gZXhpc3QgYW5kIHNob3VsZCBmYWlsIGlmIG5vdC5cbiAgMTQ2MVx0ICAgICAgICAgICAgcmV0dXJuIHRva2Vuc1swXS5kb2N1bWVudDtcbiAgMTQ2Mlx0ICAgICAgICB9XG4gIDE0NjNcdFxuICAxNDY0XHQgICAgICAgIC8vIFVubGlua2VkIGFjdG9ycyBjYW4gaGF2ZSBtdWx0aXBsZSBhY3RpdmUgdG9rZW4gYnV0IGVhY2ggaGF2ZSB0aGVpcnMgZGlyZWN0bHkgYXR0YWNoZWQuLi5cbiAgMTQ2NVx0ICAgICAgICByZXR1cm4gdGhpcy50b2tlbjtcbiAgMTQ2Nlx0ICAgIH1cbiAgMTQ2N1x0XG4gIDE0NjhcdCAgICAvKipcbiAgMTQ2OVx0ICAgICAqIFRoZXJlIGlzIG5vIG5lZWQgZm9yIGEgdG9rZW4gdG8gcGxhY2VkLiBUaGUgcHJvdG90eXBlIHRva2VuIGlzIGVub3VnaC5cbiAgMTQ3MFx0ICAgICAqL1xuICAxNDcxXHQgICAgX2lzTGlua2VkVG9Ub2tlbigpOiBib29sZWFuIHtcbiAgMTQ3Mlx0ICAgICAgICAvL0B0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gIDE0NzNcdCAgICAgICAgLy8gSWYgYW4gYWN0b3IgaXMgbGlua2VkLCBhbGwgaXQncyBjb3BpZXMgYWxzbyBjb250YWluIHRoaXMgbGlua2VkIHN0YXR1cywgZXZlbiBpZiB0aGV5J3JlIG5vdC5cbiAgMTQ3NFx0ICAgICAgICByZXR1cm4gdGhpcy5wcm90b3R5cGVUb2tlbi5hY3RvckxpbmsgJiYgIXRoaXMudG9rZW47XG4gIDE0NzVcdCAgICB9XG4gIDE0NzZcdFxuICAxNDc3XHQgICAgaGFzVG9rZW4oKTogYm9vbGVhbiB7XG4gIDE0NzhcdCAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWN0aXZlVG9rZW5zKCkubGVuZ3RoID4gMDtcbiAgMTQ3OVx0ICAgIH1cbiAgMTQ4MFx0XG4gIDE0ODFcdCAgICBoYXNBY3RpdmVQbGF5ZXJPd25lcigpOiBib29sZWFuIHtcbiAgMTQ4Mlx0ICAgICAgICBjb25zdCBwbGF5ZXJzID0gdGhpcy5nZXRBY3RpdmVQbGF5ZXJPd25lcnMoKTtcbiAgMTQ4M1x0ICAgICAgICByZXR1cm4gcGxheWVycy5sZW5ndGggPiAwO1xuICAxNDg0XHQgICAgfVxuICAxNDg1XHRcbiAgMTQ4Nlx0ICAgIGdldEFjdGl2ZVBsYXllcigpOiBVc2VyIHwgbnVsbCB7XG4gIDE0ODdcdCAgICAgICAgaWYgKCFnYW1lLnVzZXJzKSByZXR1cm4gbnVsbDtcbiAgMTQ4OFx0ICAgICAgICBpZiAoIXRoaXMuaGFzUGxheWVyT3duZXIpIHJldHVybiBudWxsO1xuICAxNDg5XHRcbiAgMTQ5MFx0ICAgICAgICBmb3IgKGNvbnN0IHVzZXIgb2YgZ2FtZS51c2Vycy5jb250ZW50cykge1xuICAxNDkxXHQgICAgICAgICAgICBpZiAoIXVzZXIuYWN0aXZlIHx8IHVzZXIuaXNHTSkge1xuICAxNDkyXHQgICAgICAgICAgICAgICAgY29udGludWU7XG4gIDE0OTNcdCAgICAgICAgICAgIH1cbiAgMTQ5NFx0ICAgICAgICAgICAgaWYgKHRoaXMuaWQgPT09IHVzZXIuY2hhcmFjdGVyPy5pZCkge1xuICAxNDk1XHQgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXI7XG4gIDE0OTZcdCAgICAgICAgICAgIH1cbiAgMTQ5N1x0ICAgICAgICB9XG4gIDE0OThcdFxuICAxNDk5XHQgICAgICAgIHJldHVybiBudWxsO1xuICAxNTAwXHQgICAgfVxuLi4uXG4gIDI1MDBcdFxuICAyNTAxXHQgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGFjdGlvbnMgb2JqZWN0IGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgMjUwMlx0ICAgICAgICBpZiAoIXRoaXMuc3lzdGVtLmluaXRpYXRpdmUuYWN0aW9ucykge1xuICAyNTAzXHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgQWN0b3IgJHt0aGlzLm5hbWV9IGhhcyBubyBhY3Rpb25zIGRhdGEsIGluaXRpYWxpemluZ2ApO1xuICAyNTA0XHQgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZSh7XG4gIDI1MDVcdCAgICAgICAgICAgICAgICAnc3lzdGVtLmluaXRpYXRpdmUuYWN0aW9ucyc6IHt9XG4gIDI1MDZcdCAgICAgICAgICAgIH0pO1xuICAyNTA3XHQgICAgICAgICAgICAvLyBSZXNldCBhY3Rpb25zIHRvIGVuc3VyZSB0aGV5J3JlIHByb3Blcmx5IGluaXRpYWxpemVkXG4gIDI1MDhcdCAgICAgICAgICAgIGF3YWl0IHRoaXMucmVzZXRBY3Rpb25zKCk7XG4gIDI1MDlcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjUxMFx0ICAgICAgICB9XG4gIDI1MTFcdFxuICAyNTEyXHQgICAgICAgIGNvbnN0IGFjdGlvbnMgPSB0aGlzLnN5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnM7XG4gIDI1MTNcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEN1cnJlbnQgYWN0aW9ucyBmb3IgJHt0aGlzLm5hbWV9OmAsIGFjdGlvbnMpO1xuICAyNTE0XHRcbiAgMjUxNVx0ICAgICAgICAvLyBDaGVjayBpZiB0aGUgYWN0b3IgaGFzIGF0IGxlYXN0IDQgbWlub3IgYWN0aW9uc1xuICAyNTE2XHQgICAgICAgIGlmIChhY3Rpb25zLm1pbm9yIDwgNCkge1xuICAyNTE3XHQgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zPy53YXJuKGdhbWUuaTE4bi5mb3JtYXQoJ1NSNi5Ob3RFbm91Z2hNaW5vckFjdGlvbnMnLCB7XG4gIDI1MThcdCAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gIDI1MTlcdCAgICAgICAgICAgICAgICBjb3VudDogYWN0aW9ucy5taW5vclxuICAyNTIwXHQgICAgICAgICAgICB9KSk7XG4gIDI1MjFcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjUyMlx0ICAgICAgICB9XG4gIDI1MjNcdFxuICAyNTI0XHQgICAgICAgIC8vIEdldCB0aGUgYWN0b3IgZnJvbSB0aGUgZ2FtZS5hY3RvcnMgY29sbGVjdGlvbiB0byBlbnN1cmUgd2UncmUgd29ya2luZyB3aXRoIHRoZSBsYXRlc3QgZGF0YVxuICAyNTI1XHQgICAgICAgIGNvbnN0IGNoZWNrQWN0b3IgPSBnYW1lLmFjdG9ycy5nZXQodGhpcy5pZCk7XG4gIDI1MjZcdCAgICAgICAgaWYgKGNoZWNrQWN0b3IgJiYgY2hlY2tBY3Rvci5zeXN0ZW0uaW5pdGlhdGl2ZSAmJiBjaGVja0FjdG9yLnN5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMpIHtcbiAgMjUyN1x0ICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGFjdG9yIGhhcyBhdCBsZWFzdCA0IG1pbm9yIGFjdGlvbnMgaW4gdGhlIGRhdGFiYXNlXG4gIDI1MjhcdCAgICAgICAgICAgIGNvbnN0IGRiTWlub3JBY3Rpb25zID0gY2hlY2tBY3Rvci5zeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zLm1pbm9yO1xuICAyNTI5XHQgICAgICAgICAgICBpZiAoZGJNaW5vckFjdGlvbnMgPCA0KSB7XG4gIDI1MzBcdCAgICAgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zPy53YXJuKGdhbWUuaTE4bi5mb3JtYXQoJ1NSNi5Ob3RFbm91Z2hNaW5vckFjdGlvbnMnLCB7XG4gIDI1MzFcdCAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuICAyNTMyXHQgICAgICAgICAgICAgICAgICAgIGNvdW50OiBkYk1pbm9yQWN0aW9uc1xuICAyNTMzXHQgICAgICAgICAgICAgICAgfSkpO1xuICAyNTM0XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAyNTM1XHQgICAgICAgICAgICB9XG4gIDI1MzZcdCAgICAgICAgfVxuLi4uXG4gIDI3MDRcdFxuICAyNzA1XHQgICAgLyoqXG4gIDI3MDZcdCAgICAgKiBGaW5kIGFuZCByZWZyZXNoIGFsbCB0b2tlbiBzaGVldHMgZm9yIHRoaXMgYWN0b3JcbiAgMjcwN1x0ICAgICAqIFRoaXMgaXMgbmVlZGVkIGJlY2F1c2UgdG9rZW4gc2hlZXRzIGFyZSBub3QgYXV0b21hdGljYWxseSByZWZyZXNoZWQgd2hlbiB0aGUgYWN0b3IgaXMgdXBkYXRlZFxuICAyNzA4XHQgICAgICovXG4gIDI3MDlcdCAgICByZWZyZXNoVG9rZW5TaGVldHMoKSB7XG4gIDI3MTBcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IFJlZnJlc2hpbmcgdG9rZW4gc2hlZXRzIGZvciAke3RoaXMubmFtZX1gKTtcbiAgMjcxMVx0XG4gIDI3MTJcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgZm9yIHRoaXMgYWN0b3JcbiAgMjcxM1x0ICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmdldEFjdGl2ZVRva2VucygpO1xuICAyNzE0XHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBGb3VuZCAke3Rva2Vucy5sZW5ndGh9IHRva2VucyBmb3IgJHt0aGlzLm5hbWV9YCk7XG4gIDI3MTVcdFxuICAyNzE2XHQgICAgICAgIC8vIFJlZnJlc2ggZWFjaCB0b2tlblxuICAyNzE3XHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgdG9rZW5zKSB7XG4gIDI3MThcdCAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIHRva2VuXG4gIDI3MTlcdCAgICAgICAgICAgIGlmICh0b2tlbi5yZWZyZXNoKSB0b2tlbi5yZWZyZXNoKCk7XG4gIDI3MjBcdFxuICAyNzIxXHQgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSB0b2tlbidzIHNoZWV0IGlmIGl0J3Mgb3BlblxuICAyNzIyXHQgICAgICAgICAgICBpZiAodG9rZW4uc2hlZXQgJiYgdG9rZW4uc2hlZXQucmVuZGVyZWQpIHtcbiAgMjcyM1x0ICAgICAgICAgICAgICAgIHRva2VuLnNoZWV0LnJlbmRlcih0cnVlKTtcbiAgMjcyNFx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBSZWZyZXNoZWQgdG9rZW4gc2hlZXQgZm9yICR7dG9rZW4ubmFtZX1gKTtcbiAgMjcyNVx0ICAgICAgICAgICAgfVxuICAyNzI2XHQgICAgICAgIH1cbi4uLlxuICAyODE3XHRcbiAgMjgxOFx0ICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBhY3Rpb25zIG9iamVjdCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gIDI4MTlcdCAgICAgICAgaWYgKCF0aGlzLnN5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMpIHtcbiAgMjgyMFx0ICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEFjdG9yICR7dGhpcy5uYW1lfSBoYXMgbm8gYWN0aW9ucyBkYXRhLCBpbml0aWFsaXppbmdgKTtcbiAgMjgyMVx0ICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGUoe1xuICAyODIyXHQgICAgICAgICAgICAgICAgJ3N5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnMnOiB7fVxuICAyODIzXHQgICAgICAgICAgICB9KTtcbiAgMjgyNFx0ICAgICAgICAgICAgLy8gUmVzZXQgYWN0aW9ucyB0byBlbnN1cmUgdGhleSdyZSBwcm9wZXJseSBpbml0aWFsaXplZFxuICAyODI1XHQgICAgICAgICAgICBhd2FpdCB0aGlzLnJlc2V0QWN0aW9ucygpO1xuICAyODI2XHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gIDI4MjdcdCAgICAgICAgfVxuICAyODI4XHRcbiAgMjgyOVx0ICAgICAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5zeXN0ZW0uaW5pdGlhdGl2ZS5hY3Rpb25zO1xuICAyODMwXHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBDdXJyZW50IGFjdGlvbnMgZm9yICR7dGhpcy5uYW1lfTpgLCBhY3Rpb25zKTtcbiAgMjgzMVx0XG4gIDI4MzJcdCAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGFjdG9yIGhhcyBhdCBsZWFzdCAxIG1ham9yIGFjdGlvblxuICAyODMzXHQgICAgICAgIGlmIChhY3Rpb25zLm1ham9yIDwgMSkge1xuICAyODM0XHQgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zPy53YXJuKGdhbWUuaTE4bi5mb3JtYXQoJ1NSNi5Ob01ham9yQWN0aW9uc0xlZnQnLCB7XG4gIDI4MzVcdCAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWVcbiAgMjgzNlx0ICAgICAgICAgICAgfSkpO1xuICAyODM3XHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gIDI4MzhcdCAgICAgICAgfVxuLi4uXG4gIDI5MDBcdFxuICAyOTAxXHQgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGFjdGlvbnMgb2JqZWN0IGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgMjkwMlx0ICAgICAgICBpZiAoIXRoaXMuc3lzdGVtLmluaXRpYXRpdmUuYWN0aW9ucykge1xuICAyOTAzXHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgQWN0b3IgJHt0aGlzLm5hbWV9IGhhcyBubyBhY3Rpb25zIGRhdGEsIGluaXRpYWxpemluZ2ApO1xuICAyOTA0XHQgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZSh7XG4gIDI5MDVcdCAgICAgICAgICAgICAgICAnc3lzdGVtLmluaXRpYXRpdmUuYWN0aW9ucyc6IHt9XG4gIDI5MDZcdCAgICAgICAgICAgIH0pO1xuICAyOTA3XHQgICAgICAgICAgICAvLyBSZXNldCBhY3Rpb25zIHRvIGVuc3VyZSB0aGV5J3JlIHByb3Blcmx5IGluaXRpYWxpemVkXG4gIDI5MDhcdCAgICAgICAgICAgIGF3YWl0IHRoaXMucmVzZXRBY3Rpb25zKCk7XG4gIDI5MDlcdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgMjkxMFx0ICAgICAgICB9XG4gIDI5MTFcdFxuICAyOTEyXHQgICAgICAgIGNvbnN0IGFjdGlvbnMgPSB0aGlzLnN5c3RlbS5pbml0aWF0aXZlLmFjdGlvbnM7XG4gIDI5MTNcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IEN1cnJlbnQgYWN0aW9ucyBmb3IgJHt0aGlzLm5hbWV9OmAsIGFjdGlvbnMpO1xuICAyOTE0XHRcbiAgMjkxNVx0ICAgICAgICAvLyBDaGVjayBpZiB0aGUgYWN0b3IgaGFzIGF0IGxlYXN0IDEgbWlub3IgYWN0aW9uXG4gIDI5MTZcdCAgICAgICAgaWYgKGFjdGlvbnMubWlub3IgPCAxKSB7XG4gIDI5MTdcdCAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnM/Lndhcm4oZ2FtZS5pMThuLmZvcm1hdCgnU1I2Lk5vTWlub3JBY3Rpb25zTGVmdCcsIHtcbiAgMjkxOFx0ICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZVxuICAyOTE5XHQgICAgICAgICAgICB9KSk7XG4gIDI5MjBcdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgMjkyMVx0ICAgICAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvdG9rZW4vU1I2VG9rZW4udHNcbiAgICAgMVx0aW1wb3J0IHtGTEFHUywgU1lTVEVNX05BTUV9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcbiAgICAgMlx0aW1wb3J0IFRyYWNrVHlwZSA9IFNoYWRvd3J1bi5UcmFja1R5cGU7XG4gICAgIDNcdFxuICAgICA0XHRleHBvcnQgY2xhc3MgU1I2VG9rZW4gZXh0ZW5kcyBUb2tlbiB7XG4gICAgIDVcdCAgICAvLyBAdHMtZXhwZWN0LWVycm9yIElnbm9yZSBnZXRCYXJBdHRyaWJ1dGUgZnJvbSBUb2tlblxuICAgICA2XHQgICAgb3ZlcnJpZGUgX2RyYXdCYXIobnVtYmVyOiBudW1iZXIsIGJhcjogUElYSS5HcmFwaGljcywgZGF0YTogUmV0dXJuVHlwZTxUb2tlblsnZ2V0QmFyQXR0cmlidXRlJ10+KXtcbiAgICAgN1x0ICAgICAgICBjb25zdCB0b2tlbkhlYWx0aEJhcnMgPSBnYW1lLnNldHRpbmdzLmdldChTWVNURU1fTkFNRSwgRkxBR1MuVG9rZW5IZWFsdGhCYXJzKTtcbiAgICAgOFx0ICAgICAgICAvLyBGb3VuZHJ5VlRUIGRyYXdzIHJlc291cmNlIGJhcnMgYXMgZnVsbC9nb29kIHdoZW4gdGhlIHZhbHVlIGlzIHRoZVxuICAgICA5XHQgICAgICAgIC8vIHNhbWUgYXMgdGhlIG1heCBhbmQgZW1wdHkvYmFkIGF0IDAgKGNvbG9yZWQgYWxvbmcgYSBncmFkaWVudCkuXG4gICAgMTBcdCAgICAgICAgLy8gU2hhZG93cnVuIGNvbmRpdGlvbiB0cmFja2VycyBjb3VudCB1cCBmcm9tIDAgdG8gdGhlIG1heGltdW0uXG4gICAgMTFcdCAgICAgICAgLy8gV2UgZmxpcCB0aGUgdmFsdWVzIGZyb20gU2hhZG93cnVuIGZvcm1hdCB0byBGb3VuZHJ5VlRUIGZvcm1hdCBoZXJlXG4gICAgMTJcdCAgICAgICAgLy8gZm9yIGRyYXdpbmcuXG4gICAgMTNcdCAgICAgICAgaWYgKHRva2VuSGVhbHRoQmFycyAmJiBkYXRhICYmIGRhdGEuYXR0cmlidXRlLnN0YXJ0c1dpdGgoJ3RyYWNrJykpIHtcbiAgICAxNFx0ICAgICAgICAgICAgY29uc3QgdHJhY2sgPSBkYXRhIGFzIHVua25vd24gYXMgVHJhY2tUeXBlO1xuICAgIDE1XHQgICAgICAgICAgICB0cmFjay52YWx1ZSA9IHRyYWNrLm1heCAtIHRyYWNrLnZhbHVlO1xuICAgIDE2XHQgICAgICAgIH1cbiAgICAxN1x0ICAgICAgICBzdXBlci5fZHJhd0JhcihudW1iZXIsIGJhciwgZGF0YSk7XG4gICAgMThcdCAgICB9XG4gICAgMTlcdH1cbi4uLlxuUGF0aDogbWFjcm9zL2VkZ2UtYWRkLW9uZS1kaWUuanNcbiAgICAgMVx0Y29uc3QgRURHRV9DT1NUID0gMTtcbiAgICAgMlx0XG4gICAgIDNcdC8vIEdldCB0aGUgc2VsZWN0ZWQgdG9rZW4ncyBhY3RvclxuICAgICA0XHRjb25zdCBhY3RvciA9IHRva2VuPy5hY3RvciB8fCBjaGFyYWN0ZXI7XG4gICAgIDVcdGlmICghYWN0b3IpIHtcbiAgICAgNlx0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoXCJQbGVhc2Ugc2VsZWN0IGEgdG9rZW4gb3IgYXNzaWduIGEgY2hhcmFjdGVyXCIpO1xuICAgICA3XHQgICAgcmV0dXJuO1xuICAgICA4XHR9XG4gICAgIDlcdFxuICAgIDEwXHQvLyBHZXQgZWRnZSBkYXRhXG4gICAgMTFcdGNvbnN0IGVkZ2UgPSBhY3Rvci5nZXRFZGdlKCk7XG4gICAgMTJcdGlmICghZWRnZSkge1xuICAgIDEzXHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIlNlbGVjdGVkIGNoYXJhY3RlciBoYXMgbm8gRWRnZSBhdHRyaWJ1dGVcIik7XG4gICAgMTRcdCAgICByZXR1cm47XG4gICAgMTVcdH1cbiAgICAxNlx0XG4gICAgMTdcdC8vIENoZWNrIGlmIGFjdG9yIGhhcyBlbm91Z2ggZWRnZVxuICAgIDE4XHRpZiAoZWRnZS51c2VzIDwgRURHRV9DT1NUKSB7XG4gICAgMTlcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKGBOb3QgZW5vdWdoIEVkZ2UhIE5lZWQgJHtFREdFX0NPU1R9IGJ1dCBvbmx5IGhhdmUgJHtlZGdlLnVzZXN9YCk7XG4gICAgMjBcdCAgICByZXR1cm47XG4gICAgMjFcdH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9ob29rcy50c1xuLi4uXG4gICAgNzBcdGltcG9ydCB7IFN1Y2Nlc3NUZXN0RWZmZWN0c0Zsb3cgfSBmcm9tICcuL2VmZmVjdC9mbG93cy9TdWNjZXNzVGVzdEVmZmVjdHNGbG93JztcbiAgICA3MVx0aW1wb3J0IHsgSm91cm5hbEVucmljaGVycyB9IGZyb20gJy4vam91cm5hbC9lbnJpY2hlcic7XG4gICAgNzJcdGltcG9ydCB7IERhdGFTdG9yYWdlIH0gZnJvbSAnLi9kYXRhL0RhdGFTdG9yYWdlJztcbiAgICA3M1x0XG4gICAgNzRcdFxuICAgIDc1XHRcbiAgICA3Nlx0Ly8gUmVkZWNsYXJlIFNSNWNvbmZpZyBhcyBhIGdsb2JhbCBhcyBmb3VuZHJ5LXZ0dC10eXBlcyBDT05GSUcgd2l0aCBTUjUgcHJvcGVydHkgY2F1c2VzIGlzc3Vlcy5cbiAgICA3N1x0ZXhwb3J0IGNvbnN0IFNSNkNPTkZJRyA9IFNSNjtcbiAgICA3OFx0XG4gICAgNzlcdGV4cG9ydCBjbGFzcyBIb29rc01hbmFnZXIge1xuICAgIDgwXHQgICAgc3RhdGljIHJlZ2lzdGVySG9va3MoKSB7XG4gICAgODFcdCAgICAgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSB8IFJlZ2lzdGVyaW5nIHN5c3RlbSBob29rcycpO1xuICAgIDgyXHQgICAgICAgIC8vIFJlZ2lzdGVyIHlvdXIgaGlnaGVzdCBsZXZlbCBob29rIGNhbGxiYWNrcyBoZXJlIGZvciBhIHF1aWNrIG92ZXJ2aWV3IG9mIHdoYXQncyBob29rZWQgaW50by5cbiAgICA4M1x0XG4gICAgODRcdCAgICAgICAgSG9va3Mub25jZSgnaW5pdCcsIEhvb2tzTWFuYWdlci5pbml0KTtcbiAgICA4NVx0ICAgICAgICBIb29rcy5vbmNlKCdzZXR1cCcsIEF1dG9jb21wbGV0ZUlubGluZUhvb2tzRmxvdy5zZXR1cEhvb2spO1xuICAgIDg2XHRcbiAgICA4N1x0ICAgICAgICBIb29rcy5vbignY2FudmFzSW5pdCcsIGNhbnZhc0luaXQpO1xuICAgIDg4XHQgICAgICAgIEhvb2tzLm9uKCdyZWFkeScsIEhvb2tzTWFuYWdlci5yZWFkeSk7XG4gICAgODlcdCAgICAgICAgSG9va3Mub24oJ2hvdGJhckRyb3AnLCBIb29rc01hbmFnZXIuaG90YmFyRHJvcCk7XG4gICAgOTBcdCAgICAgICAgSG9va3Mub24oJ3JlbmRlclNjZW5lQ29udHJvbHMnLCBIb29rc01hbmFnZXIucmVuZGVyU2NlbmVDb250cm9scyk7XG4gICAgOTFcdCAgICAgICAgSG9va3Mub24oJ2dldFNjZW5lQ29udHJvbEJ1dHRvbnMnLCBIb29rc01hbmFnZXIuZ2V0U2NlbmVDb250cm9sQnV0dG9ucyk7XG4gICAgOTJcdCAgICAgICAgSG9va3Mub24oJ2dldENvbWJhdFRyYWNrZXJFbnRyeUNvbnRleHQnLCBTUjZDb21iYXQuYWRkQ29tYmF0VHJhY2tlckNvbnRleHRPcHRpb25zKTtcbiAgICA5M1x0ICAgICAgICBIb29rcy5vbigncmVuZGVySXRlbURpcmVjdG9yeScsIEhvb2tzTWFuYWdlci5yZW5kZXJJdGVtRGlyZWN0b3J5KTtcbiAgICA5NFx0ICAgICAgICAvLyBIb29rcy5vbigncmVuZGVyVG9rZW5IVUQnLCBFbnZNb2RpZmllcnNBcHBsaWNhdGlvbi5hZGRUb2tlbkhVREZpZWxkcyk7XG4gICAgOTVcdCAgICAgICAgSG9va3Mub24oJ3JlbmRlclRva2VuSFVEJywgU2l0dWF0aW9uTW9kaWZpZXJzQXBwbGljYXRpb24ub25SZW5kZXJUb2tlbkhVRCk7XG4gICAgOTZcdCAgICAgICAgSG9va3Mub24oJ3VwZGF0ZUl0ZW0nLCBIb29rc01hbmFnZXIudXBkYXRlSWNDb25uZWN0ZWRUb0hvc3RJdGVtKTtcbiAgICA5N1x0ICAgICAgICBIb29rcy5vbignZGVsZXRlSXRlbScsIEhvb2tzTWFuYWdlci5yZW1vdmVEZWxldGVkSXRlbXNGcm9tTmV0d29ya3MpO1xuLi4uXG4gICAxMDdcdFxuICAgMTA4XHQgICAgc3RhdGljIGluaXQoKSB7XG4gICAxMDlcdCAgICAgICAgY29uc29sZS5sb2coYExvYWRpbmcgU2hhZG93cnVuIDVlIFN5c3RlbVxuICAgMTEwXHRfX19fX19fX19fX19fX19fX19fXG4gICAxMTFcdCBfX19fX19fX19fXyBfX19fXyBcbiAgIDExMlx0LyAgX19ffCBfX18gXFxcXCAgX19ffFxuICAgMTEzXHRcXFxcIFxcYC0tLnwgfF8vIC9fX18gXFxcXCBcbiAgIDExNFx0IFxcYC0tLiBcXFxcICAgIC8gICAgXFxcXCBcXFxcXG4gICAxMTVcdC9cXFxcX18vIC8gfFxcXFwgXFxcXC9cXFxcX18vIC9cbiAgIDExNlx0XFxcXF9fX18vXFxcXF98IFxcXFxfXFxcXF9fX18vIFxuICAgMTE3XHQ9PT09PT09PT09PT09PT09PT09XG4gICAxMThcdGApO1xuICAgMTE5XHQgICAgICAgIC8vIENyZWF0ZSBhIHNyNmVseXNpdW0gbmFtZXNwYWNlIHdpdGhpbiB0aGUgZ2FtZSBnbG9iYWxcbiAgIDEyMFx0ICAgICAgICBnYW1lWydzcjZlbHlzaXVtJ10gPSB7XG4gICAxMjFcdCAgICAgICAgICAgIC8qKlxuICAgMTIyXHQgICAgICAgICAgICAgKiBTeXN0ZW0gbGV2ZWwgRG9jdW1lbnQgaW1wbGVtZW50YXRpb25zLlxuICAgMTIzXHQgICAgICAgICAgICAgKi9cbiAgIDEyNFx0ICAgICAgICAgICAgU1I2QWN0b3I6IFNSNkFjdG9yLFxuICAgMTI1XHQgICAgICAgICAgICBTUjZJdGVtOiBTUjZJdGVtLFxuICAgMTI2XHQgICAgICAgICAgICBTUjZBY3RpdmVFZmZlY3Q6IFNSNkFjdGl2ZUVmZmVjdCxcbiAgIDEyN1x0ICAgICAgICAgICAgLyoqXG4gICAxMjhcdCAgICAgICAgICAgICAqIE1hY3JvIGhvb2tzIHVzZWQgd2hlbiBzb21ldGhpbmcncyBkcm9wcGVkIG9udG8gdGhlIGhvdGJhci5cbiAgIDEyOVx0ICAgICAgICAgICAgICovXG4gICAxMzBcdCAgICAgICAgICAgIHJvbGxJdGVtTWFjcm8sXG4gICAxMzFcdCAgICAgICAgICAgIHJvbGxTa2lsbE1hY3JvLFxuICAgMTMyXHQgICAgICAgICAgICAvKipcbiAgIDEzM1x0ICAgICAgICAgICAgICogU2hvdWxkIHlvdSBvbmx5IHJlYWxseSBuZWVkIGRpY2UgaGFuZGxpbmcsIHVzZSB0aGlzLiBJZiB5b3UgbmVlZCBtb3JlIGNvbXBsZXggdGVzdGluZyBiZWhhdmlvdXIsXG4gICAxMzRcdCAgICAgICAgICAgICAqIGNoZWNrIHRoZSBUZXN0IGltcGxlbWVudGF0aW9ucy5cbiAgIDEzNVx0ICAgICAgICAgICAgICovXG4gICAxMzZcdCAgICAgICAgICAgIFNSNlJvbGw6IFNSNlJvbGwsXG4uLi5cbiAgIDMzMFx0XG4gICAzMzFcdCAgICAgICAgSG9va3NNYW5hZ2VyLmNvbmZpZ3VyZVZpc2lvbigpXG4gICAzMzJcdFxuICAgMzMzXHQgICAgICAgIEhvb2tzTWFuYWdlci5jb25maWd1cmVUZXh0RW5yaWNoZXJzKCk7XG4gICAzMzRcdFxuICAgMzM1XHQgICAgICAgIC8vIFByZWxvYWQgbWlnaHQgcmVkdWNlIGxvYWRpbmcgdGltZSBkdXJpbmcgcGxheS5cbiAgIDMzNlx0ICAgICAgICBIYW5kbGViYXJNYW5hZ2VyLmxvYWRUZW1wbGF0ZXMoKTtcbiAgIDMzN1x0XG4gICAzMzhcdCAgICAgICAgLy8gUmVnaXN0ZXIgVG91cnNcbiAgIDMzOVx0ICAgICAgICByZWdpc3RlclNSNlRvdXJzKCk7XG4gICAzNDBcdFxuICAgMzQxXHQgICAgICAgIERhdGFTdG9yYWdlLnZhbGlkYXRlKCk7XG4gICAzNDJcdCAgICB9XG4gICAzNDNcdFxuICAgMzQ0XHQgICAgc3RhdGljIGFzeW5jIHJlYWR5KCkge1xuICAgMzQ1XHQgICAgICAgIGlmIChnYW1lLnVzZXI/LmlzR00pIHtcbiAgIDM0Nlx0ICAgICAgICAgICAgLy8gUHJvaGliaXQgbWlncmF0aW9uIG9uIGVtcHR5IHdvcmxkcy4uLlxuICAgMzQ3XHQgICAgICAgICAgICBpZiAoTWlncmF0b3IuaXNFbXB0eVdvcmxkKSB7XG4gICAzNDhcdCAgICAgICAgICAgICAgICBhd2FpdCBNaWdyYXRvci5Jbml0V29ybGRGb3JNaWdyYXRpb24oKTtcbiAgIDM0OVx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgIDM1MFx0ICAgICAgICAgICAgfVxuICAgMzUxXHRcbiAgIDM1Mlx0ICAgICAgICAgICAgLy8gT24gcG9wdWxhdGVkIHdvcmxkcywgdHJ5IG1pZ3JhdGluZ1xuICAgMzUzXHQgICAgICAgICAgICBhd2FpdCBNaWdyYXRvci5CZWdpbk1pZ3JhdGlvbigpO1xuICAgMzU0XHRcbiAgIDM1NVx0ICAgICAgICAgICAgaWYgKENoYW5nZWxvZ0FwcGxpY2F0aW9uLnNob3dBcHBsaWNhdGlvbikge1xuICAgMzU2XHQgICAgICAgICAgICAgICAgYXdhaXQgbmV3IENoYW5nZWxvZ0FwcGxpY2F0aW9uKCkucmVuZGVyKHRydWUpO1xuICAgMzU3XHQgICAgICAgICAgICB9XG4gICAzNThcdCAgICAgICAgfVxuLi4uXG4gICA0NzBcdFxuICAgNDcxXHQgICAgLyoqXG4gICA0NzJcdCAgICAgKiBUaGlzIG1ldGhvZCBpcyB1c2VkIGFzIGEgc2ltcGxlIHBsYWNlIHRvIHJlZ2lzdGVyIHNvY2tldCBob29rIGhhbmRsZXJzIGZvciB0aGUgc3lzdGVtLlxuICAgNDczXHQgICAgICpcbiAgIDQ3NFx0ICAgICAqIFlvdSBjYW4gdXNlIHRoZSBTb2NrZXRNZXNzYWdlIGZvciBzZW5kaW5nIG1lc3NhZ2VzIHVzaW5nIGEgc29ja2V0IGV2ZW50IG1lc3NhZ2UgaWQgYW5kIGdlbmVyaWMgZGF0YSBvYmplY3QuXG4gICA0NzVcdCAgICAgKi9cbiAgIDQ3Nlx0ICAgIHN0YXRpYyByZWdpc3RlclNvY2tldExpc3RlbmVycygpIHtcbiAgIDQ3N1x0ICAgICAgICBpZiAoIWdhbWUuc29ja2V0IHx8ICFnYW1lLnVzZXIpIHJldHVybjtcbiAgIDQ3OFx0ICAgICAgICBjb25zb2xlLmxvZygnUmVnaXN0ZXJpbmcgc3I2ZWx5c2l1bSBzeXN0ZW0gc29ja2V0IG1lc3NhZ2VzLi4uJyk7XG4gICA0NzlcdCAgICAgICAgY29uc3QgaG9va3M6IFNoYWRvd3J1bi5Tb2NrZXRNZXNzYWdlSG9va3MgPSB7XG4gICA0ODBcdCAgICAgICAgICAgIFtGTEFHUy5hZGROZXR3b3JrQ29udHJvbGxlcl06IFtOZXR3b3JrRGV2aWNlRmxvdy5faGFuZGxlQWRkTmV0d29ya0NvbnRyb2xsZXJTb2NrZXRNZXNzYWdlXSxcbiAgIDQ4MVx0ICAgICAgICAgICAgW0ZMQUdTLkRvTmV4dFJvdW5kXTogW1NSNkNvbWJhdC5faGFuZGxlRG9OZXh0Um91bmRTb2NrZXRNZXNzYWdlXSxcbiAgIDQ4Mlx0ICAgICAgICAgICAgW0ZMQUdTLkRvSW5pdFBhc3NdOiBbU1I2Q29tYmF0Ll9oYW5kbGVEb0luaXRQYXNzU29ja2V0TWVzc2FnZV0sXG4gICA0ODNcdCAgICAgICAgICAgIFtGTEFHUy5Eb05ld0FjdGlvblBoYXNlXTogW1NSNkNvbWJhdC5faGFuZGxlRG9OZXdBY3Rpb25QaGFzZVNvY2tldE1lc3NhZ2VdLFxuLi4uXG5QYXRoOiBtYWNyb3MvZWRnZS1yZXJvbGwtZmFpbGVkLmpzXG4gICAgIDFcdGNvbnN0IEVER0VfQ09TVCA9IDQ7XG4gICAgIDJcdFxuICAgICAzXHQvLyBHZXQgdGhlIHNlbGVjdGVkIHRva2VuJ3MgYWN0b3JcbiAgICAgNFx0Y29uc3QgYWN0b3IgPSB0b2tlbj8uYWN0b3IgfHwgY2hhcmFjdGVyO1xuICAgICA1XHRpZiAoIWFjdG9yKSB7XG4gICAgIDZcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiUGxlYXNlIHNlbGVjdCBhIHRva2VuIG9yIGFzc2lnbiBhIGNoYXJhY3RlclwiKTtcbiAgICAgN1x0ICAgIHJldHVybjtcbiAgICAgOFx0fVxuICAgICA5XHRcbiAgICAxMFx0Ly8gR2V0IGVkZ2UgZGF0YVxuICAgIDExXHRjb25zdCBlZGdlID0gYWN0b3IuZ2V0RWRnZSgpO1xuICAgIDEyXHRpZiAoIWVkZ2UpIHtcbiAgICAxM1x0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoXCJTZWxlY3RlZCBjaGFyYWN0ZXIgaGFzIG5vIEVkZ2UgYXR0cmlidXRlXCIpO1xuICAgIDE0XHQgICAgcmV0dXJuO1xuICAgIDE1XHR9XG4uLi5cblBhdGg6IG1hY3Jvcy9lZGdlLXJlcm9sbC1zcjYuanNcbiAgICAgMVx0Ly8gR2V0IHRoZSBzZWxlY3RlZCB0b2tlbidzIGFjdG9yXG4gICAgIDJcdGNvbnN0IGFjdG9yID0gdG9rZW4/LmFjdG9yIHx8IGNoYXJhY3RlcjtcbiAgICAgM1x0aWYgKCFhY3Rvcikge1xuICAgICA0XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihcIlBsZWFzZSBzZWxlY3QgYSB0b2tlbiBvciBhc3NpZ24gYSBjaGFyYWN0ZXJcIik7XG4gICAgIDVcdCAgICByZXR1cm47XG4gICAgIDZcdH1cbiAgICAgN1x0XG4gICAgIDhcdC8vIEdldCBlZGdlIGRhdGFcbiAgICAgOVx0Y29uc3QgZWRnZSA9IGFjdG9yLmdldEVkZ2UoKTtcbiAgICAxMFx0aWYgKCFlZGdlKSB7XG4gICAgMTFcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiU2VsZWN0ZWQgY2hhcmFjdGVyIGhhcyBubyBFZGdlIGF0dHJpYnV0ZVwiKTtcbiAgICAxMlx0ICAgIHJldHVybjtcbiAgICAxM1x0fVxuLi4uXG5QYXRoOiBtYWNyb3MvZWRnZS1hZGQtYXR0cmlidXRlLmpzXG4gICAgIDFcdGNvbnN0IEVER0VfQ09TVCA9IDQ7XG4gICAgIDJcdFxuICAgICAzXHQvLyBHZXQgdGhlIHNlbGVjdGVkIHRva2VuJ3MgYWN0b3JcbiAgICAgNFx0Y29uc3QgYWN0b3IgPSB0b2tlbj8uYWN0b3IgfHwgY2hhcmFjdGVyO1xuICAgICA1XHRpZiAoIWFjdG9yKSB7XG4gICAgIDZcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiUGxlYXNlIHNlbGVjdCBhIHRva2VuIG9yIGFzc2lnbiBhIGNoYXJhY3RlclwiKTtcbiAgICAgN1x0ICAgIHJldHVybjtcbiAgICAgOFx0fVxuICAgICA5XHRcbiAgICAxMFx0Ly8gR2V0IGVkZ2UgZGF0YVxuICAgIDExXHRjb25zdCBlZGdlID0gYWN0b3IuZ2V0RWRnZSgpO1xuICAgIDEyXHRpZiAoIWVkZ2UpIHtcbiAgICAxM1x0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoXCJTZWxlY3RlZCBjaGFyYWN0ZXIgaGFzIG5vIEVkZ2UgYXR0cmlidXRlXCIpO1xuICAgIDE0XHQgICAgcmV0dXJuO1xuICAgIDE1XHR9XG4gICAgMTZcdFxuICAgIDE3XHQvLyBDaGVjayBpZiBhY3RvciBoYXMgZW5vdWdoIGVkZ2VcbiAgICAxOFx0aWYgKGVkZ2UudXNlcyA8IEVER0VfQ09TVCkge1xuICAgIDE5XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihgTm90IGVub3VnaCBFZGdlISBOZWVkICR7RURHRV9DT1NUfSBidXQgb25seSBoYXZlICR7ZWRnZS51c2VzfWApO1xuICAgIDIwXHQgICAgcmV0dXJuO1xuICAgIDIxXHR9XG4gICAgMjJcdFxuICAgIDIzXHQvLyBHZXQgZWRnZSBhdHRyaWJ1dGUgdmFsdWVcbiAgICAyNFx0Y29uc3QgZWRnZUF0dHIgPSBhY3Rvci5zeXN0ZW0uYXR0cmlidXRlcy5lZGdlLnZhbHVlO1xuICAgIDI1XHRpZiAoIWVkZ2VBdHRyKSB7XG4gICAgMjZcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiQ291bGQgbm90IGRldGVybWluZSBFZGdlIGF0dHJpYnV0ZSB2YWx1ZVwiKTtcbiAgICAyN1x0ICAgIHJldHVybjtcbiAgICAyOFx0fVxuLi4uXG5QYXRoOiBtYWNyb3MvZWRnZS1oZWFsLXBoeXNpY2FsLmpzXG4gICAgIDFcdGNvbnN0IEVER0VfQ09TVCA9IDQ7XG4gICAgIDJcdFxuICAgICAzXHQvLyBHZXQgdGhlIHNlbGVjdGVkIHRva2VuJ3MgYWN0b3JcbiAgICAgNFx0Y29uc3QgYWN0b3IgPSB0b2tlbj8uYWN0b3IgfHwgY2hhcmFjdGVyO1xuICAgICA1XHRpZiAoIWFjdG9yKSB7XG4gICAgIDZcdCAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKFwiUGxlYXNlIHNlbGVjdCBhIHRva2VuIG9yIGFzc2lnbiBhIGNoYXJhY3RlclwiKTtcbiAgICAgN1x0ICAgIHJldHVybjtcbiAgICAgOFx0fVxuICAgICA5XHRcbiAgICAxMFx0Ly8gR2V0IGVkZ2UgZGF0YVxuICAgIDExXHRjb25zdCBlZGdlID0gYWN0b3IuZ2V0RWRnZSgpO1xuICAgIDEyXHRpZiAoIWVkZ2UpIHtcbiAgICAxM1x0ICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoXCJTZWxlY3RlZCBjaGFyYWN0ZXIgaGFzIG5vIEVkZ2UgYXR0cmlidXRlXCIpO1xuICAgIDE0XHQgICAgcmV0dXJuO1xuICAgIDE1XHR9XG4gICAgMTZcdFxuICAgIDE3XHQvLyBDaGVjayBpZiBhY3RvciBoYXMgZW5vdWdoIGVkZ2VcbiAgICAxOFx0aWYgKGVkZ2UudXNlcyA8IEVER0VfQ09TVCkge1xuICAgIDE5XHQgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihgTm90IGVub3VnaCBFZGdlISBOZWVkICR7RURHRV9DT1NUfSBidXQgb25seSBoYXZlICR7ZWRnZS51c2VzfWApO1xuICAgIDIwXHQgICAgcmV0dXJuO1xuICAgIDIxXHR9XG4uLi5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjdlYjJlYWUzLWE3ZjEtNDhhNi1iZmQzLThkOWZmZGVhYmJkODt0b29sdV92cnR4XzAxNXl1aXU2ZFVLMWp5M25HVUg2M0NOVSI6eyJyZXF1ZXN0SWQiOiI3ZWIyZWFlMy1hN2YxLTQ4YTYtYmZkMy04ZDlmZmRlYWJiZDgiLCJ0b29sVXNlSWQiOiJ0b29sdV92cnR4XzAxNXl1aXU2ZFVLMWp5M25HVUg2M0NOVSIsInBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IkhlcmUncyB0aGUgcmVzdWx0IG9mIHJ1bm5pbmcgYGNhdCAtbmAgb24gc3JjL21vZHVsZS9ob29rcy50czpcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIC8vIEFsbCBzaWRlYmFyIGFjdG9ycyBzaG91bGQgYWxzbyBpbmNsdWRlIHRva2VucyB3aXRoIGxpbmtlZCBhY3RvcnMuXG4gICA0NTFcdCAgICAgICAgICAgICAgICAuLi5nYW1lLmFjdG9ycy5maWx0ZXIoKGFjdG9yOiBTUjZBY3RvcikgPT4gYWN0b3IuaXNJQygpICYmIGFjdG9yLmhhc0hvc3QoKSkgYXMgU1I2QWN0b3JbXSxcbiAgIDQ1Mlx0ICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxuICAgNDUzXHQgICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgIDQ1NFx0ICAgICAgICAgICAgICAgIC4uLmNhbnZhcy5zY2VuZS50b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0b2tlbi5hY3RvckxpbmsgJiYgdG9rZW4uYWN0b3I/LmlzSUMoKSAmJiB0b2tlbi5hY3Rvcj8uaGFzSG9zdCgpKS5tYXAodCA9PiB0LmFjdG9yKVxuICAgNDU1XHQgICAgICAgICAgICBdO1xuICAgNDU2XHRcbiAgIDQ1N1x0ICAgICAgICAgICAgLy8gVXBkYXRlIGhvc3QgZGF0YSBvbiB0aGUgaWMgYWN0b3IuXG4gICA0NThcdCAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBpdGVtLmFzSG9zdDtcbiAgIDQ1OVx0ICAgICAgICAgICAgaWYgKCFob3N0KSByZXR1cm47XG4gICA0NjBcdCAgICAgICAgICAgIGZvciAoY29uc3QgaWMgb2YgY29ubmVjdGVkSUMpIHtcblRvdGFsIGxpbmVzIGluIGZpbGU6IDUzM1xuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiMGU1YTE5YmUtYTg5Ni00YjUzLWIwZjQtOGQzYWI4YTE5NDQyO3Rvb2x1X3ZydHhfMDFKNUNWb2pNNUFGcDQxcFNYRlM3dll3Ijp7InJlcXVlc3RJZCI6IjBlNWExOWJlLWE4OTYtNGI1My1iMGY0LThkM2FiOGExOTQ0MiIsInRvb2xVc2VJZCI6InRvb2x1X3ZydHhfMDFKNUNWb2pNNUFGcDQxcFNYRlM3dll3IiwicGhhc2UiOjUsInJlc3VsdCI6eyJ0ZXh0IjoiVGhlIGZvbGxvd2luZyBjb2RlIHNlY3Rpb25zIHdlcmUgcmV0cmlldmVkOlxuUGF0aDogc3JjL21vZHVsZS9oZWxwZXJzLnRzXG4uLi5cbiAgIDI0N1x0XG4gICAyNDhcdCAgICBzdGF0aWMgb3JkZXJLZXlzKG9iaikge1xuICAgMjQ5XHQgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvYmopLnNvcnQoZnVuY3Rpb24ga2V5T3JkZXIoazEsIGsyKSB7XG4gICAyNTBcdCAgICAgICAgICAgIGlmIChrMSA8IGsyKSByZXR1cm4gLTE7XG4gICAyNTFcdCAgICAgICAgICAgIGlmIChrMSA+IGsyKSByZXR1cm4gKzE7XG4gICAyNTJcdCAgICAgICAgICAgIHJldHVybiAwO1xuICAgMjUzXHQgICAgICAgIH0pO1xuICAgMjU0XHRcbiAgIDI1NVx0ICAgICAgICBsZXQgaTtcbiAgIDI1Nlx0ICAgICAgICBjb25zdCBhZnRlciA9IHt9O1xuICAgMjU3XHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAyNThcdCAgICAgICAgICAgIGFmdGVyW2tleXNbaV1dID0gb2JqW2tleXNbaV1dO1xuICAgMjU5XHQgICAgICAgICAgICBkZWxldGUgb2JqW2tleXNbaV1dO1xuICAgMjYwXHQgICAgICAgIH1cbiAgIDI2MVx0XG4gICAyNjJcdCAgICAgICAgZm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgIDI2M1x0ICAgICAgICAgICAgb2JqW2tleXNbaV1dID0gYWZ0ZXJba2V5c1tpXV07XG4gICAyNjRcdCAgICAgICAgfVxuICAgMjY1XHQgICAgICAgIHJldHVybiBvYmo7XG4gICAyNjZcdCAgICB9XG4gICAyNjdcdFxuICAgMjY4XHQgICAgc3RhdGljIGhhc01vZGlmaWVycyhldmVudCkge1xuICAgMjY5XHQgICAgICAgIHJldHVybiBldmVudCAmJiAoZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQuYWx0S2V5IHx8IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSk7XG4gICAyNzBcdCAgICB9XG4gICAyNzFcdFxuICAgMjcyXHQgICAgc3RhdGljIGZpbHRlcihvYmosIGNvbXApIHtcbiAgIDI3M1x0ICAgICAgICBjb25zdCByZXRPYmogPSB7fTtcbiAgIDI3NFx0ICAgICAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsKSB7XG4gICAyNzVcdCAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKG9iaikuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAyNzZcdCAgICAgICAgICAgICAgICBpZiAoY29tcChba2V5LCB2YWx1ZV0pKSByZXRPYmpba2V5XSA9IHZhbHVlO1xuICAgMjc3XHQgICAgICAgICAgICB9KTtcbiAgIDI3OFx0ICAgICAgICB9XG4gICAyNzlcdCAgICAgICAgcmV0dXJuIHJldE9iajtcbiAgIDI4MFx0ICAgIH1cbi4uLlxuICAgMzA3XHRcbiAgIDMwOFx0ICAgIC8vIFRPRE86IEZvdW5kcnkgMC45IFNob3VsZCBUb2tlbkRvY3VtZW50IGJlIHVzZWQgaW5zdGVhZCBvZiBUb2tlbj9cbiAgIDMwOVx0ICAgIC8vIFRPRE86IENoZWNrIGNhbnZhcy5zY2VuZS50b2tlbnNcbiAgIDMxMFx0ICAgIHN0YXRpYyBnZXRUb2tlbihpZD86IHN0cmluZyk6IFRva2VuIHwgdW5kZWZpbmVkIHtcbiAgIDMxMVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5IHx8ICFjYW52YXMudG9rZW5zKSByZXR1cm47XG4gICAzMTJcdFxuICAgMzEzXHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgY2FudmFzLnRva2Vucy5wbGFjZWFibGVzKSB7XG4gICAzMTRcdCAgICAgICAgICAgIGlmICh0b2tlbi5pZCA9PT0gaWQpIHtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgIDMxNlx0ICAgICAgICAgICAgfVxuICAgMzE3XHQgICAgICAgIH1cbiAgIDMxOFx0ICAgIH1cbiAgIDMxOVx0XG4gICAzMjBcdCAgICAvKipcbiAgIDMyMVx0ICAgICAqIFVzZSB0aGlzIGhlbHBlciB0byBnZXQgYSB0b2tlbnMgYWN0b3IgZnJvbSBhbnkgZ2l2ZW4gc2NlbmUgaWQuXG4gICAzMjJcdCAgICAgKiBAcGFyYW0gc2NlbmVUb2tlbklkIEEgbWl4ZWQgaWQgd2l0aCB0aGUgZm9ybWF0ICc8c2NlbmVJZD4uPHRva2VuaWQ+XG4gICAzMjNcdCAgICAgKi9cbiAgIDMyNFx0ICAgIHN0YXRpYyBnZXRTY2VuZVRva2VuQWN0b3Ioc2NlbmVUb2tlbklkOiBzdHJpbmcpOiBTUjZBY3RvciB8IG51bGwge1xuICAgMzI1XHQgICAgICAgIGNvbnN0IFtzY2VuZUlkLCB0b2tlbklkXSA9IEhlbHBlcnMuZGVjb25zdHJ1Y3RTY2VuZVRva2VuSWQoc2NlbmVUb2tlbklkKTtcbiAgIDMyNlx0ICAgICAgICBjb25zdCB0b2tlbiA9IEhlbHBlcnMuZ2V0U2NlbmVUb2tlbkRvY3VtZW50KHNjZW5lSWQsIHRva2VuSWQpO1xuICAgMzI3XHQgICAgICAgIGlmICghdG9rZW4pIHJldHVybiBudWxsO1xuICAgMzI4XHQgICAgICAgIHJldHVybiB0b2tlbi5nZXRBY3RvcigpO1xuICAgMzI5XHQgICAgfVxuICAgMzMwXHRcbiAgIDMzMVx0ICAgIHN0YXRpYyBkZWNvbnN0cnVjdFNjZW5lVG9rZW5JZChzY2VuZVRva2VuSWQ6IHN0cmluZyk6IFtzY2VuZUlkOiBzdHJpbmcsIHRva2VuSWQ6IHN0cmluZ10ge1xuICAgMzMyXHQgICAgICAgIHJldHVybiBzY2VuZVRva2VuSWQuc3BsaXQoJy4nKSBhcyBbc2NlbmVJZDogc3RyaW5nLCB0b2tlbklkOiBzdHJpbmddO1xuICAgMzMzXHQgICAgfVxuICAgMzM0XHRcbiAgIDMzNVx0ICAgIHN0YXRpYyBnZXRTY2VuZVRva2VuRG9jdW1lbnQoc2NlbmVJZCwgdG9rZW5JZCk6IFRva2VuRG9jdW1lbnQgfCB1bmRlZmluZWQge1xuICAgMzM2XHQgICAgICAgIGNvbnN0IHNjZW5lID0gZ2FtZS5zY2VuZXM/LmdldChzY2VuZUlkKTtcbiAgIDMzN1x0ICAgICAgICBpZiAoIXNjZW5lKSByZXR1cm47XG4gICAzMzhcdCAgICAgICAgY29uc3QgdG9rZW4gPSBzY2VuZS50b2tlbnMuZ2V0KHRva2VuSWQpO1xuICAgMzM5XHQgICAgICAgIGlmICghdG9rZW4pIHJldHVybjtcbiAgIDM0MFx0XG4gICAzNDFcdCAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgMzQyXHQgICAgfVxuICAgMzQzXHRcbiAgIDM0NFx0ICAgIHN0YXRpYyBnZXRVc2VyVGFyZ2V0cyh1c2VyPzogVXNlciB8IG51bGwpOiBUb2tlbltdIHtcbiAgIDM0NVx0ICAgICAgICB1c2VyID0gdXNlciA/IHVzZXIgOiBnYW1lLnVzZXI7XG4gICAzNDZcdFxuICAgMzQ3XHQgICAgICAgIGlmICghdXNlcikgcmV0dXJuIFtdXG4gICAzNDhcdFxuICAgMzQ5XHQgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHVzZXIudGFyZ2V0cyk7XG4gICAzNTBcdCAgICB9XG4gICAzNTFcdFxuICAgMzUyXHQgICAgc3RhdGljIHVzZXJIYXNUYXJnZXRzKHVzZXI/OiBVc2VyIHwgbnVsbCk6IGJvb2xlYW4ge1xuICAgMzUzXHQgICAgICAgIHVzZXIgPSB1c2VyID8gdXNlciA6IGdhbWUudXNlcjtcbiAgIDM1NFx0XG4gICAzNTVcdCAgICAgICAgaWYgKCF1c2VyKSByZXR1cm4gZmFsc2U7XG4gICAzNTZcdFxuICAgMzU3XHQgICAgICAgIHJldHVybiB1c2VyLnRhcmdldHMuc2l6ZSA+IDA7XG4gICAzNThcdCAgICB9XG4uLi5cbiAgIDQ0Nlx0XG4gICA0NDdcdCAgICAvKipcbiAgIDQ0OFx0ICAgICAqIERldGVybWluZSBpZiB0aGUgY3VycmVudCB1c2VyIGhhcyBhbnkgdG9rZW5zIHNlbGVjdGVkLlxuICAgNDQ5XHQgICAgICogQHJldHVybnMgdHJ1ZSBpZiBvbmUgb3IgbW9yZSB0b2tlbnMgaGF2ZSBiZWVuIHNlbGVjdGVkLlxuICAgNDUwXHQgICAgICovXG4gICA0NTFcdCAgICBzdGF0aWMgdXNlckhhc0NvbnRyb2xsZWRUb2tlbnMoKTogYm9vbGVhbiB7XG4gICA0NTJcdCAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5yZWFkeSB8fCAhY2FudmFzLnRva2VucykgcmV0dXJuIGZhbHNlO1xuICAgNDUzXHQgICAgICAgIHJldHVybiBjYW52YXMudG9rZW5zLmNvbnRyb2xsZWQubGVuZ3RoID4gMDtcbiAgIDQ1NFx0ICAgIH1cbiAgIDQ1NVx0XG4gICA0NTZcdCAgICAvKipcbiAgIDQ1N1x0ICAgICAqIFJldHVybiBhbGwgYWN0b3JzIGNvbm5lY3RlZCB0byBhbGwgdXNlciBjb250cm9sbGVkIHRva2Vucy5cbiAgIDQ1OFx0ICAgICAqIEByZXR1cm5zIEFuIGFycmF5IHRva2VuIGFjdG9ycy5cbiAgIDQ1OVx0ICAgICAqL1xuICAgNDYwXHQgICAgc3RhdGljIGdldENvbnRyb2xsZWRUb2tlbkFjdG9ycygpOiBTUjZBY3RvcltdIHtcbiAgIDQ2MVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5KSByZXR1cm4gW11cbiAgIDQ2Mlx0XG4gICA0NjNcdCAgICAgICAgY29uc3QgdG9rZW5zID0gSGVscGVycy5nZXRDb250cm9sbGVkVG9rZW5zKCk7XG4gICA0NjRcdCAgICAgICAgcmV0dXJuIHRva2Vucy5tYXAodG9rZW4gPT4gdG9rZW4uYWN0b3IpIGFzIFNSNkFjdG9yW107XG4gICA0NjVcdCAgICB9XG4gICA0NjZcdFxuICAgNDY3XHQgICAgLyoqXG4gICA0NjhcdCAgICAgKiByZXR1cm4gYWxsIHRva2VucyBhIHVzZXIgaGFzIHRhcmdldGVkIGF0IHRoZSBtb21lbnQuXG4gICA0NjlcdCAgICAgKiBAcmV0dXJucyBBbiBhcnJheSB0b2tlbnMuXG4gICA0NzBcdCAgICAgKi9cbiAgIDQ3MVx0ICAgIHN0YXRpYyBnZXRUYXJnZXRlZFRva2VucygpOiBUb2tlbltdIHtcbiAgIDQ3Mlx0ICAgICAgICBpZiAoIWNhbnZhcy5yZWFkeSB8fCAhZ2FtZS51c2VyKSByZXR1cm4gW107XG4gICA0NzNcdFxuICAgNDc0XHQgICAgICAgIHJldHVybiBBcnJheS5mcm9tKGdhbWUudXNlci50YXJnZXRzKTtcbiAgIDQ3NVx0ICAgIH1cbiAgIDQ3Nlx0XG4gICA0NzdcdCAgICAvKipcbiAgIDQ3OFx0ICAgICAqIFJldHVybiBlaXRoZXIgYWxsIHVzZXIgc2VsZWN0ZWQgdG9rZW4gYWN0b3JzIG9yIHRoZSB1c2VycyBnYW1lIGNoYXJhY3RlciBhY3Rvci5cbiAgIDQ3OVx0ICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIGFjdG9ycy5cbiAgIDQ4MFx0ICAgICAqL1xuICAgNDgxXHQgICAgc3RhdGljIGdldFNlbGVjdGVkQWN0b3JzT3JDaGFyYWN0ZXIoKTogU1I2QWN0b3JbXSB7XG4gICA0ODJcdCAgICAgICAgaWYgKCFnYW1lLnVzZXIpIHJldHVybiBbXTtcbiAgIDQ4M1x0XG4gICA0ODRcdCAgICAgICAgY29uc3QgYWN0b3JzID0gSGVscGVycy5nZXRDb250cm9sbGVkVG9rZW5BY3RvcnMoKTtcbiAgIDQ4NVx0XG4gICA0ODZcdCAgICAgICAgLy8gVHJ5IHRvIGRlZmF1bHQgdG8gYSB1c2VycyBjaGFyYWN0ZXIuXG4gICA0ODdcdCAgICAgICAgaWYgKGFjdG9ycy5sZW5ndGggPT09IDAgJiYgZ2FtZS51c2VyLmNoYXJhY3Rlcikge1xuICAgNDg4XHQgICAgICAgICAgICBhY3RvcnMucHVzaChnYW1lLnVzZXIuY2hhcmFjdGVyKTtcbiAgIDQ4OVx0ICAgICAgICB9XG4gICA0OTBcdFxuICAgNDkxXHQgICAgICAgIHJldHVybiBhY3RvcnMgYXMgU1I2QWN0b3JbXTtcbiAgIDQ5Mlx0ICAgIH1cbi4uLlxuICAgNTc2XHRcbiAgIDU3N1x0ICAgIHN0YXRpYyBnZXREZWZlbnNlUmF0aW5nKHRhcmdldHM6IFRva2VuRG9jdW1lbnRbXSk6IG51bWJlciB7XG4gICA1NzhcdCAgICAgICAgbGV0IGRlZmVuc2VSYXRpbmcgPSAwO1xuICAgNTc5XHQgICAgICAgIGZvcihjb25zdCB0b2tlbiBvZiB0YXJnZXRzKSB7XG4gICA1ODBcdCAgICAgICAgICAgIGxldCB0YXJnZXQgPSB0b2tlbi5hY3RvcjtcbiAgIDU4MVx0ICAgICAgICAgICAgY29uc29sZS5sb2codGFyZ2V0KTtcbiAgIDU4Mlx0ICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgNTgzXHQgICAgICAgICAgICBpZiAoJ2RlZmVuc2VfcmF0aW5nJyBpbiB0YXJnZXQuc3lzdGVtLnZhbHVlcyAmJiB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZSA+IGRlZmVuc2VSYXRpbmcpIHtcbiAgIDU4NFx0ICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgIDU4NVx0ICAgICAgICAgICAgICAgIGRlZmVuc2VSYXRpbmcgPSB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZTtcbiAgIDU4Nlx0ICAgICAgICAgICAgfVxuICAgNTg3XHQgICAgICAgIH1cbiAgIDU4OFx0ICAgICAgICByZXR1cm4gZGVmZW5zZVJhdGluZztcbiAgIDU4OVx0ICAgIH1cbiAgIDU5MFx0XG4gICA1OTFcdCAgICBzdGF0aWMgZ2V0QXR0YWNrUmF0aW5nKGFjdG9yOiBTUjZBY3Rvcik6IG51bWJlciB7XG4gICA1OTJcdCAgICAgICAgcmV0dXJuIDA7XG4gICA1OTNcdCAgICB9XG4uLi5cbiAgIDY2MVx0XG4gICA2NjJcdCAgICAgICAgLy8gSWYgd2UgZGlkIG5vdCBmaW5kIGFueXRoaW5nIG9uIHRoZSBhY3Rvciwgc2VhcmNoIHRoZSBhY3RpdmUgdG9rZW5zICh0aGUgaXRlbSBtaWdodCBvbmx5IGV4aXN0IG9uIGEgbm9uIGxpbmtlZCB0b2tlbilcbiAgIDY2M1x0ICAgICAgICAvLyBUaGlzIHdpbGwgbm90IHdvcmsgaWYgd2UgYXJlIG9uIGEgZGlmZmVyZW50IHNjZW5lIG9yIHRoZSB0b2tlbiBnb3QgZGVsZXRlZCwgd2hpY2ggaXMgZXhwZWN0ZWQgd2hlbiB5b3UgcHV0IGFuXG4gICA2NjRcdCAgICAgICAgLy8gaXRlbSBvbiBhIHRva2VuIHdpdGhvdXQgbGlua2luZyBpdC5cbiAgIDY2NVx0ICAgICAgICBjb25zdCB0b2tlbnMgPSBhY3RvclNvdXJjZS5nZXRBY3RpdmVUb2tlbnMoKTtcbiAgIDY2Nlx0ICAgICAgICBsZXQgdG9rZW5JdGVtOiBTUjZJdGVtIHwgdW5kZWZpbmVkO1xuICAgNjY3XHQgICAgICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDY2OFx0ICAgICAgICAgICAgaWYgKCF0b2tlbi5hY3RvcikgcmV0dXJuO1xuICAgNjY5XHRcbiAgIDY3MFx0ICAgICAgICAgICAgY29uc3QgZm91bmRJdGVtID0gdG9rZW4uYWN0b3IuaXRlbXMuZ2V0KGl0ZW1JZCk7XG4gICA2NzFcdCAgICAgICAgICAgIGlmIChmb3VuZEl0ZW0pIHtcbiAgIDY3Mlx0ICAgICAgICAgICAgICAgIHRva2VuSXRlbSA9IGZvdW5kSXRlbSBhcyB1bmtub3duIGFzIFNSNkl0ZW07XG4gICA2NzNcdCAgICAgICAgICAgIH1cbiAgIDY3NFx0ICAgICAgICB9KTtcbiAgIDY3NVx0XG4gICA2NzZcdCAgICAgICAgcmV0dXJuIHRva2VuSXRlbTtcbiAgIDY3N1x0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50c1xuLi4uXG4gIDI3MDRcdFxuICAyNzA1XHQgICAgLyoqXG4gIDI3MDZcdCAgICAgKiBGaW5kIGFuZCByZWZyZXNoIGFsbCB0b2tlbiBzaGVldHMgZm9yIHRoaXMgYWN0b3JcbiAgMjcwN1x0ICAgICAqIFRoaXMgaXMgbmVlZGVkIGJlY2F1c2UgdG9rZW4gc2hlZXRzIGFyZSBub3QgYXV0b21hdGljYWxseSByZWZyZXNoZWQgd2hlbiB0aGUgYWN0b3IgaXMgdXBkYXRlZFxuICAyNzA4XHQgICAgICovXG4gIDI3MDlcdCAgICByZWZyZXNoVG9rZW5TaGVldHMoKSB7XG4gIDI3MTBcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IFJlZnJlc2hpbmcgdG9rZW4gc2hlZXRzIGZvciAke3RoaXMubmFtZX1gKTtcbiAgMjcxMVx0XG4gIDI3MTJcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgZm9yIHRoaXMgYWN0b3JcbiAgMjcxM1x0ICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLmdldEFjdGl2ZVRva2VucygpO1xuICAyNzE0XHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBGb3VuZCAke3Rva2Vucy5sZW5ndGh9IHRva2VucyBmb3IgJHt0aGlzLm5hbWV9YCk7XG4gIDI3MTVcdFxuICAyNzE2XHQgICAgICAgIC8vIFJlZnJlc2ggZWFjaCB0b2tlblxuICAyNzE3XHQgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgdG9rZW5zKSB7XG4gIDI3MThcdCAgICAgICAgICAgIC8vIFJlZnJlc2ggdGhlIHRva2VuXG4gIDI3MTlcdCAgICAgICAgICAgIGlmICh0b2tlbi5yZWZyZXNoKSB0b2tlbi5yZWZyZXNoKCk7XG4gIDI3MjBcdFxuICAyNzIxXHQgICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSB0b2tlbidzIHNoZWV0IGlmIGl0J3Mgb3BlblxuICAyNzIyXHQgICAgICAgICAgICBpZiAodG9rZW4uc2hlZXQgJiYgdG9rZW4uc2hlZXQucmVuZGVyZWQpIHtcbiAgMjcyM1x0ICAgICAgICAgICAgICAgIHRva2VuLnNoZWV0LnJlbmRlcih0cnVlKTtcbiAgMjcyNFx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBSZWZyZXNoZWQgdG9rZW4gc2hlZXQgZm9yICR7dG9rZW4ubmFtZX1gKTtcbiAgMjcyNVx0ICAgICAgICAgICAgfVxuICAyNzI2XHQgICAgICAgIH1cbiAgMjcyN1x0XG4gIDI3MjhcdCAgICAgICAgLy8gRmluZCBhbmQgcmVmcmVzaCBhbGwgdG9rZW4gc2hlZXRzIGluIHRoZSB1aS53aW5kb3dzIGNvbGxlY3Rpb25cbiAgMjcyOVx0ICAgICAgICBmb3IgKGNvbnN0IFtpZCwgYXBwXSBvZiBPYmplY3QuZW50cmllcyh1aS53aW5kb3dzKSkge1xuICAyNzMwXHQgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgc2hlZXQgZm9yIG9uZSBvZiBvdXIgdG9rZW5zXG4gIDI3MzFcdCAgICAgICAgICAgIGlmIChhcHAudG9rZW4gJiYgdG9rZW5zLnNvbWUodCA9PiB0LmlkID09PSBhcHAudG9rZW4uaWQpKSB7XG4gIDI3MzJcdCAgICAgICAgICAgICAgICBhcHAucmVuZGVyKHRydWUpO1xuICAyNzMzXHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IFJlZnJlc2hlZCB0b2tlbiBzaGVldCAke2lkfSBmb3IgJHthcHAudG9rZW4ubmFtZX1gKTtcbiAgMjczNFx0ICAgICAgICAgICAgfVxuICAyNzM1XHQgICAgICAgIH1cbiAgMjczNlx0ICAgIH1cbi4uLlxuICAyOTkwXHRcbiAgMjk5MVx0ICAgICAgICAvLyBSZWZyZXNoIHRoZSBjYW52YXMgaWYgaXQgZXhpc3RzXG4gIDI5OTJcdCAgICAgICAgaWYgKGNhbnZhcyAmJiBjYW52YXMudG9rZW5zICYmIHR5cGVvZiBjYW52YXMudG9rZW5zLnBsYWNlYWJsZXMgIT09ICd1bmRlZmluZWQnKSB7XG4gIDI5OTNcdCAgICAgICAgICAgIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcy5mb3JFYWNoKHRva2VuID0+IHtcbiAgMjk5NFx0ICAgICAgICAgICAgICAgIGlmICh0b2tlbi5hY3RvciAmJiB0b2tlbi5hY3Rvci5pZCA9PT0gdGhpcy5pZCAmJiB0b2tlbi5yZWZyZXNoKSB7XG4gIDI5OTVcdCAgICAgICAgICAgICAgICAgICAgdG9rZW4ucmVmcmVzaCgpO1xuICAyOTk2XHQgICAgICAgICAgICAgICAgfVxuICAyOTk3XHQgICAgICAgICAgICB9KTtcbiAgMjk5OFx0ICAgICAgICB9XG4gIDI5OTlcdFxuICAzMDAwXHQgICAgICAgIC8vIFJlZnJlc2ggdG9rZW4gc2hlZXRzXG4gIDMwMDFcdCAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW5TaGVldHMoKTtcbiAgMzAwMlx0XG4gIDMwMDNcdCAgICAgICAgY29uc29sZS5sb2coYFNoYWRvd3J1biA2ZSB8IENvbXBsZXRlZCByZWZyZXNoIG9mIGFsbCBzaGVldHMgZm9yICR7dGhpcy5uYW1lfWApO1xuICAzMDA0XHQgICAgfVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3RhcmdldGluZy9UYXJnZXRpbmdTZXJ2aWNlLnRzXG4uLi5cbiAgIDEyMlx0ICAgIFxuICAgMTIzXHQgICAgLyoqXG4gICAxMjRcdCAgICAgKiBTdWdnZXN0IHRhcmdldHMgZm9yIGFuIGFjdGlvbiB3aGVuIG5vbmUgYXJlIHNlbGVjdGVkXG4gICAxMjVcdCAgICAgKiBAcGFyYW0gYWN0aW9uIFRoZSBhY3Rpb24gYmVpbmcgcGVyZm9ybWVkXG4gICAxMjZcdCAgICAgKiBAcGFyYW0gYWN0b3IgVGhlIGFjdG9yIHBlcmZvcm1pbmcgdGhlIGFjdGlvblxuICAgMTI3XHQgICAgICogQHJldHVybnMgQW4gYXJyYXkgb2Ygc3VnZ2VzdGVkIHRhcmdldCB0b2tlbnNcbiAgIDEyOFx0ICAgICAqL1xuICAgMTI5XHQgICAgc3RhdGljIHN1Z2dlc3RUYXJnZXRzRm9yQWN0aW9uKGFjdGlvbjogU1I2SXRlbSwgYWN0b3I6IFNSNkFjdG9yKTogVG9rZW5bXSB7XG4gICAxMzBcdCAgICAgICAgLy8gR2V0IHRoZSBhY3RvcidzIHRva2VuXG4gICAxMzFcdCAgICAgICAgY29uc3QgYWN0b3JUb2tlbiA9IGFjdG9yLmdldFRva2VuKCk7XG4gICAxMzJcdCAgICAgICAgaWYgKCFhY3RvclRva2VuKSByZXR1cm4gW107XG4gICAxMzNcdCAgICAgICAgXG4gICAxMzRcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgaW4gdGhlIHNjZW5lXG4gICAxMzVcdCAgICAgICAgY29uc3QgdG9rZW5zID0gY2FudmFzLnRva2Vucz8ucGxhY2VhYmxlcyB8fCBbXTtcbiAgIDEzNlx0ICAgICAgICBcbiAgIDEzN1x0ICAgICAgICAvLyBGaWx0ZXIgZm9yIHBvdGVudGlhbCB0YXJnZXRzIChleGNsdWRlIHRoZSBhY3RvcidzIG93biB0b2tlbilcbiAgIDEzOFx0ICAgICAgICBjb25zdCBwb3RlbnRpYWxUYXJnZXRzID0gdG9rZW5zLmZpbHRlcih0b2tlbiA9PiBcbiAgIDEzOVx0ICAgICAgICAgICAgdG9rZW4uaWQgIT09IGFjdG9yVG9rZW4uaWQgJiYgXG4gICAxNDBcdCAgICAgICAgICAgIHRva2VuLmFjdG9yICYmIFxuICAgMTQxXHQgICAgICAgICAgICB0aGlzLmlzVmFsaWRUYXJnZXQodG9rZW4sIGFjdGlvbiwgYWN0b3IpXG4gICAxNDJcdCAgICAgICAgKTtcbi4uLlxuICAgMTUxXHQgICAgXG4gICAxNTJcdCAgICAvKipcbiAgIDE1M1x0ICAgICAqIEhpZ2hsaWdodCB2YWxpZCB0YXJnZXRzIGZvciBhbiBhY3Rpb25cbiAgIDE1NFx0ICAgICAqIEBwYXJhbSBhY3Rpb24gVGhlIGFjdGlvbiBiZWluZyBwZXJmb3JtZWRcbiAgIDE1NVx0ICAgICAqIEBwYXJhbSBhY3RvciBUaGUgYWN0b3IgcGVyZm9ybWluZyB0aGUgYWN0aW9uXG4gICAxNTZcdCAgICAgKi9cbiAgIDE1N1x0ICAgIHN0YXRpYyBoaWdobGlnaHRWYWxpZFRhcmdldHMoYWN0aW9uOiBTUjZJdGVtLCBhY3RvcjogU1I2QWN0b3IpOiB2b2lkIHtcbiAgIDE1OFx0ICAgICAgICAvLyBHZXQgYWxsIHRva2VucyBpbiB0aGUgc2NlbmVcbiAgIDE1OVx0ICAgICAgICBjb25zdCB0b2tlbnMgPSBjYW52YXMudG9rZW5zPy5wbGFjZWFibGVzIHx8IFtdO1xuICAgMTYwXHQgICAgICAgIFxuICAgMTYxXHQgICAgICAgIC8vIFJlc2V0IGFsbCB0b2tlbiBoaWdobGlnaHRzXG4gICAxNjJcdCAgICAgICAgdG9rZW5zLmZvckVhY2godG9rZW4gPT4ge1xuICAgMTYzXHQgICAgICAgICAgICB0b2tlbi5ib3JkZXI/LnZpc2libGUgPSBmYWxzZTtcbiAgIDE2NFx0ICAgICAgICB9KTtcbiAgIDE2NVx0ICAgICAgICBcbiAgIDE2Nlx0ICAgICAgICAvLyBHZXQgdmFsaWQgdGFyZ2V0c1xuICAgMTY3XHQgICAgICAgIGNvbnN0IHZhbGlkVGFyZ2V0cyA9IHRva2Vucy5maWx0ZXIodG9rZW4gPT4gXG4gICAxNjhcdCAgICAgICAgICAgIHRva2VuLmFjdG9yICYmIFxuICAgMTY5XHQgICAgICAgICAgICB0aGlzLmlzVmFsaWRUYXJnZXQodG9rZW4sIGFjdGlvbiwgYWN0b3IpXG4gICAxNzBcdCAgICAgICAgKTtcbiAgIDE3MVx0ICAgICAgICBcbiAgIDE3Mlx0ICAgICAgICAvLyBIaWdobGlnaHQgdmFsaWQgdGFyZ2V0c1xuICAgMTczXHQgICAgICAgIHZhbGlkVGFyZ2V0cy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDE3NFx0ICAgICAgICAgICAgdG9rZW4uYm9yZGVyLnZpc2libGUgPSB0cnVlO1xuICAgMTc1XHQgICAgICAgICAgICB0b2tlbi5ib3JkZXIuc3R5bGUuYm9yZGVyQ29sb3IgPSAweDAwRkYwMDsgLy8gR3JlZW4gZm9yIHZhbGlkIHRhcmdldHNcbiAgIDE3Nlx0ICAgICAgICB9KTtcbiAgIDE3N1x0ICAgICAgICBcbiAgIDE3OFx0ICAgICAgICAvLyBGb3JjZSBhIGNhbnZhcyByZWZyZXNoXG4gICAxNzlcdCAgICAgICAgY2FudmFzLnRva2Vucz8ucmVmcmVzaCgpO1xuICAgMTgwXHQgICAgfVxuICAgMTgxXHQgICAgXG4gICAxODJcdCAgICAvKipcbiAgIDE4M1x0ICAgICAqIENsZWFyIHRhcmdldCBoaWdobGlnaHRzXG4gICAxODRcdCAgICAgKi9cbiAgIDE4NVx0ICAgIHN0YXRpYyBjbGVhclRhcmdldEhpZ2hsaWdodHMoKTogdm9pZCB7XG4gICAxODZcdCAgICAgICAgLy8gR2V0IGFsbCB0b2tlbnMgaW4gdGhlIHNjZW5lXG4gICAxODdcdCAgICAgICAgY29uc3QgdG9rZW5zID0gY2FudmFzLnRva2Vucz8ucGxhY2VhYmxlcyB8fCBbXTtcbiAgIDE4OFx0ICAgICAgICBcbiAgIDE4OVx0ICAgICAgICAvLyBSZXNldCBhbGwgdG9rZW4gaGlnaGxpZ2h0c1xuICAgMTkwXHQgICAgICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDE5MVx0ICAgICAgICAgICAgdG9rZW4uYm9yZGVyPy52aXNpYmxlID0gZmFsc2U7XG4gICAxOTJcdCAgICAgICAgfSk7XG4gICAxOTNcdCAgICAgICAgXG4gICAxOTRcdCAgICAgICAgLy8gRm9yY2UgYSBjYW52YXMgcmVmcmVzaFxuICAgMTk1XHQgICAgICAgIGNhbnZhcy50b2tlbnM/LnJlZnJlc2goKTtcbiAgIDE5Nlx0ICAgIH1cbiAgIDE5N1x0ICAgIFxuICAgMTk4XHQgICAgLyoqXG4gICAxOTlcdCAgICAgKiBHZXQgdGFyZ2V0cyBmb3IgYW4gb3Bwb3NlZCB0ZXN0XG4gICAyMDBcdCAgICAgKiBAcGFyYW0gYWN0aW9uIFRoZSBhY3Rpb24gYmVpbmcgcGVyZm9ybWVkXG4gICAyMDFcdCAgICAgKiBAcGFyYW0gYWN0b3IgVGhlIGFjdG9yIHBlcmZvcm1pbmcgdGhlIGFjdGlvblxuICAgMjAyXHQgICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgdGFyZ2V0IGFjdG9yc1xuICAgMjAzXHQgICAgICovXG4gICAyMDRcdCAgICBzdGF0aWMgZ2V0T3Bwb3NlZFRlc3RUYXJnZXRzKGFjdGlvbjogU1I2SXRlbSwgYWN0b3I6IFNSNkFjdG9yKTogU1I2QWN0b3JbXSB7XG4gICAyMDVcdCAgICAgICAgLy8gR2V0IHZhbGlkIHRhcmdldHNcbiAgIDIwNlx0ICAgICAgICBjb25zdCB2YWxpZFRhcmdldHMgPSB0aGlzLmdldFZhbGlkVGFyZ2V0c0ZvckFjdGlvbihhY3Rpb24sIGFjdG9yKTtcbiAgIDIwN1x0ICAgICAgICBcbiAgIDIwOFx0ICAgICAgICAvLyBDb252ZXJ0IHRvIGFjdG9yc1xuICAgMjA5XHQgICAgICAgIHJldHVybiB2YWxpZFRhcmdldHNcbiAgIDIxMFx0ICAgICAgICAgICAgLm1hcCh0b2tlbiA9PiB0b2tlbi5hY3RvciBhcyBTUjZBY3RvcilcbiAgIDIxMVx0ICAgICAgICAgICAgLmZpbHRlcihhY3RvciA9PiBhY3RvciAhPT0gdW5kZWZpbmVkKTtcbiAgIDIxMlx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS90ZXN0cy9UZXN0Q3JlYXRvci50c1xuLi4uXG4gICAyMTZcdFxuICAgMjE3XHQgICAgICAgIC8vIERldGVybWluZSBhY3RvcnMgdG8gcm9sbCB0ZXN0IHdpdGguXG4gICAyMThcdCAgICAgICAgbGV0IGFjdG9ycyA9IGF3YWl0IEhlbHBlcnMuZ2V0T3Bwb3NlZFRlc3RBY3RvcnModGVzdERhdGEuZGF0YSk7XG4gICAyMTlcdFxuICAgMjIwXHQgICAgICAgIC8vIEluZm9ybSB1c2VyIGFib3V0IHRva2VucyB3aXRoIGRlbGV0ZWQgc2lkZWJhciBhY3RvcnMuXG4gICAyMjFcdCAgICAgICAgLy8gVGhpcyBjYW4gYm90aCBoYXBwZW4gZm9yIGxpbmtlZCB0b2tlbnMgaW1tZWRpYXRlbHkgYW5kIHVubGlua2VkIHRva2VucyBhZnRlciByZWxvYWRpbmcuXG4gICAyMjJcdCAgICAgICAgaWYgKGFjdG9ycy5maWx0ZXIoYWN0b3IgPT4gIWFjdG9yKS5sZW5ndGggPiAwKSB7XG4gICAyMjNcdCAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnM/Lndhcm4oJ1RPS0VOLldhcm5pbmdOb0FjdG9yJywge2xvY2FsaXplOiB0cnVlfSk7XG4gICAyMjRcdCAgICAgICAgICAgIHJldHVybjtcbiAgIDIyNVx0ICAgICAgICB9XG4gICAyMjZcdFxuICAgMjI3XHQgICAgICAgIC8vIGZpbHRlciBvdXQgYWN0b3JzIGN1cnJlbnQgdXNlciBzaG91bGRuJ3QgYmUgYWJsZSB0byB0ZXN0IHdpdGguXG4gICAyMjhcdCAgICAgICAgYWN0b3JzID0gYWN0b3JzLmZpbHRlcihhY3RvciA9PiBhY3Rvci5pc093bmVyKTtcbiAgIDIyOVx0ICAgICAgICAvLyBGYWxsYmFjayB0byBwbGF5ZXIgY2hhcmFjdGVyLlxuICAgMjMwXHQgICAgICAgIGlmIChhY3RvcnMubGVuZ3RoID09PSAwICYmIGdhbWUudXNlci5jaGFyYWN0ZXIpIHtcbiAgIDIzMVx0ICAgICAgICAgICAgYWN0b3JzLnB1c2goZ2FtZS51c2VyLmNoYXJhY3Rlcik7XG4gICAyMzJcdCAgICAgICAgfVxuICAgMjMzXHRcbiAgIDIzNFx0ICAgICAgICBpZiAoYWN0b3JzLmxlbmd0aCA9PT0gMCkge1xuICAgMjM1XHQgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zPy53YXJuKGdhbWUuaTE4bi5sb2NhbGl6ZSgnU1I2Lldhcm5pbmdzLlRva2VuU2VsZWN0aW9uTmVlZGVkJykpO1xuICAgMjM2XHQgICAgICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9hcHBzL2dtdG9vbHMvT3ZlcndhdGNoU2NvcmVUcmFja2VyLmpzXG4uLi5cbiAgICA4MFx0XG4gICAgODFcdCAgICAgICAgLy8gQWRkIGxpbmtlZCB0b2tlbiBhY3RvcnMuXG4gICAgODJcdCAgICAgICAgdG9rZW5zLmZpbHRlcih0b2tlbiA9PiB0b2tlbi5kb2N1bWVudC5hY3RvckxpbmspLmZvckVhY2godG9rZW4gPT4ge1xuICAgIDgzXHQgICAgICAgICAgICAvLyBEb3VibGUgY2hlY2sgdGhhdCB0aGUgYWN0b3IgYWN0dWFsbHkgbGl2ZXMgaW4gdGhlIGFjdG9ycyBjb2xsZWN0aW9uLlxuICAgIDg0XHQgICAgICAgICAgICBjb25zdCBhY3RvciA9IGdhbWUuYWN0b3JzLmdldCh0b2tlbi5kb2N1bWVudC5hY3RvcklkKTtcbiAgICA4NVx0ICAgICAgICAgICAgaWYgKCFhY3RvcikgcmV0dXJuO1xuICAgIDg2XHQgICAgICAgICAgICBpZiAodGhpcy5faXNBY3Rvck9uVHJhY2tlcihhY3RvcikpIHJldHVybjtcbiAgICA4N1x0XG4gICAgODhcdCAgICAgICAgICAgIE92ZXJ3YXRjaFNjb3JlVHJhY2tlci5hZGRlZEFjdG9ycy5wdXNoKGFjdG9yLmlkKTtcbiAgICA4OVx0ICAgICAgICB9KTtcbiAgICA5MFx0XG4gICAgOTFcdCAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICA5Mlx0ICAgIH1cbiAgICA5M1x0XG4gICAgOTRcdCAgICAvKipcbiAgICA5NVx0ICAgICAqIENoZWNrIGlmIHRoZSBnaXZlbiBhY3RvciBpcyBhbHJlYWR5IGFkZGVkIGFuZCBkaXNwbGF5ZWQgb24gdGhlIGN1cnJlbnQgdHJhY2tlci5cbiAgICA5Nlx0ICAgICAqXG4gICAgOTdcdCAgICAgKiBAcGFyYW0gYWN0b3IgQSBhY3RvcnMgY29sbGVjdGlvbiBhY3Rvci5cbiAgICA5OFx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufSBXaWxsIHJldHVybiB0cnVlIHdoZW4gdGhlIGdpdmVuIGFjdG9yIGFscmVhZHkgZXhpc3RzLlxuICAgIDk5XHQgICAgICovXG4gICAxMDBcdCAgICBfaXNBY3Rvck9uVHJhY2tlcihhY3Rvcikge1xuICAgMTAxXHQgICAgICAgIHJldHVybiB0aGlzLmFjdG9ycy5maW5kKGFjdG9yRGF0YSA9PiBhY3RvckRhdGEuX2lkID09PSBhY3Rvci5pZCkgIT09IHVuZGVmaW5lZDtcbiAgIDEwMlx0ICAgIH1cbi4uLlxuUGF0aDogc3JjL21vZHVsZS9ydWxlcy9Eb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycy50c1xuLi4uXG4gICAzOTBcdFxuICAgMzkxXHQgICAgLyoqXG4gICAzOTJcdCAgICAgKiBIZWxwZXIgZm9yIHNjZW5lIG1vZGlmaWVyIGluc3RhbmNlcyB0byBjbGVhciBhbGwgbW9kaWZpZXJzIGZvciBhbGwgcGxhY2VkIHRva2Vuc1xuICAgMzkzXHQgICAgICovXG4gICAzOTRcdCAgICBhc3luYyBjbGVhckFsbFRva2Vuc09uU2NlbmUoKSB7XG4gICAzOTVcdCAgICAgICAgaWYgKCFjYW52YXMucmVhZHkgfHwgIWNhbnZhcy5zY2VuZSkgcmV0dXJuO1xuICAgMzk2XHQgICAgICAgIGlmICghdGhpcy5kb2N1bWVudElzU2NlbmUpIHJldHVybjtcbiAgIDM5N1x0XG4gICAzOThcdCAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCBtb2RpZmllcnMgc2NlbmUgaXMgc2FtZSB0byBjdXJyZW50IHNjZW5lLlxuICAgMzk5XHQgICAgICAgIGNvbnN0IHNjZW5lID0gdGhpcy5kb2N1bWVudCBhcyBTY2VuZTtcbiAgIDQwMFx0ICAgICAgICBpZiAoY2FudmFzLnNjZW5lLmlkICE9PSBzY2VuZS5pZCkgcmV0dXJuO1xuICAgNDAxXHRcbiAgIDQwMlx0ICAgICAgICAvLyBVc2UgY3VycmVudCBzY2VuZSBmb3IgZWFzZSBvZiBhY2Nlc3MgdG8gdG9rZW5zXG4gICA0MDNcdCAgICAgICAgY2FudmFzLnNjZW5lLnRva2Vucy5mb3JFYWNoKHRva2VuID0+IHRva2VuLmFjdG9yPy5nZXRTaXR1YXRpb25Nb2RpZmllcnMoKS5jbGVhckFsbCgpKTtcbiAgIDQwNFx0ICAgIH1cbiAgIDQwNVx0fVxuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL2hvb2tzLnRzXG4uLi5cbiAgIDQ0Nlx0XG4gICA0NDdcdCAgICAgICAgaWYgKGl0ZW0uaXNIb3N0KSB7XG4gICA0NDhcdCAgICAgICAgICAgIC8vIENvbGxlY3QgYWN0b3JzIGZyb20gc2lkZWJhciBhbmQgYWN0aXZlIHNjZW5lIHRvIHVwZGF0ZSAvIHJlcmVuZGVyXG4gICA0NDlcdCAgICAgICAgICAgIGxldCBjb25uZWN0ZWRJQyA9IFtcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIC8vIEFsbCBzaWRlYmFyIGFjdG9ycyBzaG91bGQgYWxzbyBpbmNsdWRlIHRva2VucyB3aXRoIGxpbmtlZCBhY3RvcnMuXG4gICA0NTFcdCAgICAgICAgICAgICAgICAuLi5nYW1lLmFjdG9ycy5maWx0ZXIoKGFjdG9yOiBTUjZBY3RvcikgPT4gYWN0b3IuaXNJQygpICYmIGFjdG9yLmhhc0hvc3QoKSkgYXMgU1I2QWN0b3JbXSxcbiAgIDQ1Mlx0ICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxuICAgNDUzXHQgICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgIDQ1NFx0ICAgICAgICAgICAgICAgIC4uLmNhbnZhcy5zY2VuZS50b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0b2tlbi5hY3RvckxpbmsgJiYgdG9rZW4uYWN0b3I/LmlzSUMoKSAmJiB0b2tlbi5hY3Rvcj8uaGFzSG9zdCgpKS5tYXAodCA9PiB0LmFjdG9yKVxuICAgNDU1XHQgICAgICAgICAgICBdO1xuICAgNDU2XHRcbiAgIDQ1N1x0ICAgICAgICAgICAgLy8gVXBkYXRlIGhvc3QgZGF0YSBvbiB0aGUgaWMgYWN0b3IuXG4gICA0NThcdCAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBpdGVtLmFzSG9zdDtcbiAgIDQ1OVx0ICAgICAgICAgICAgaWYgKCFob3N0KSByZXR1cm47XG4gICA0NjBcdCAgICAgICAgICAgIGZvciAoY29uc3QgaWMgb2YgY29ubmVjdGVkSUMpIHtcbiAgIDQ2MVx0ICAgICAgICAgICAgICAgIGlmICghaWMpIGNvbnRpbnVlO1xuICAgNDYyXHQgICAgICAgICAgICAgICAgYXdhaXQgaWMuX3VwZGF0ZUlDSG9zdERhdGEoaG9zdCk7XG4gICA0NjNcdCAgICAgICAgICAgIH1cbiAgIDQ2NFx0ICAgICAgICB9XG4gICA0NjVcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvaXRlbS9mbG93cy9BY3Rpb25GbG93LnRzXG4uLi5cbiAgIDEyMFx0XG4gICAxMjFcdCAgICAgICAgLy8gQ0FTRSAtIFJldHVybiBhY3RvciBza2lsbHMgd2hlbiBhdmFpbGFibGUuXG4gICAxMjJcdCAgICAgICAgLy8gICAgICAgIHRoZSBtYWpvciB1c2UgY2FzZSBpcyBvd25lZCBpdGVtcywgd2hlcmUgdGhlIGFjdG9yIGlzIGF2YWlsYWJsZS5cbiAgIDEyM1x0ICAgICAgICBjb25zdCBhY3RpdmVTa2lsbHMgPSBhY3Rvci5nZXRBY3RpdmVTa2lsbHMoKTtcbiAgIDEyNFx0XG4gICAxMjVcdCAgICAgICAgLy8gQ29udmVydCBza2lsbCBkYXRhIHRvIGEgdmFsdWUgbGFiZWwgbWFwcGluZy5cbiAgIDEyNlx0ICAgICAgICBjb25zdCBza2lsbHM6IFJlY29yZDxzdHJpbmcsIFRyYW5zbGF0aW9uPiA9IHt9O1xuICAgMTI3XHQgICAgICAgIGZvciAoY29uc3QgW2lkLCBza2lsbF0gb2YgT2JqZWN0LmVudHJpZXMoYWN0aXZlU2tpbGxzKSkge1xuICAgMTI4XHQgICAgICAgICAgICBjb25zdCBrZXkgPSBza2lsbC5uYW1lIHx8IGlkO1xuICAgMTI5XHQgICAgICAgICAgICBjb25zdCBsYWJlbCA9IHNraWxsLmxhYmVsIHx8IHNraWxsLm5hbWU7XG4gICAxMzBcdCAgICAgICAgICAgIHNraWxsc1trZXldID0gbGFiZWwgYXMgVHJhbnNsYXRpb247XG4gICAxMzFcdCAgICAgICAgfVxuICAgMTMyXHRcbiAgIDEzM1x0ICAgICAgICBBY3Rpb25GbG93Ll9pbmplY3RNaXNzaW5nQ3VzdG9tU2tpbGwoc2tpbGxzLCBza2lsbE5hbWUpO1xuICAgMTM0XHQgICAgICAgIHJldHVybiBIZWxwZXJzLnNvcnRDb25maWdWYWx1ZXNCeVRyYW5zbGF0aW9uKHNraWxscyk7XG4gICAxMzVcdCAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvbWlncmF0b3IvVmVyc2lvbk1pZ3JhdGlvbi50c1xuLi4uXG4gICAxNThcdFxuICAgMTU5XHQgICAgICAgICAgICAgICAgLy8gTWlncmF0ZSBlbWJlZGRlZCBUb2tlbkRvY3VtZW50IC8gQWN0b3JEYXRhIHdpdGhpbiBTY2VuZURhdGFcbiAgIDE2MFx0ICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2Ygc2NlbmUuZGF0YS50b2tlbnMpIHtcbiAgIDE2MVx0ICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBtaWdyYXRlIHRva2VucyB3aXRob3V0IG9yIGEgbGlua2VkIGFjdG9yLlxuICAgMTYyXHQgICAgICAgICAgICAgICAgICAgIGlmICghdG9rZW4uYWN0b3IgfHwgdG9rZW4uZGF0YS5hY3RvckxpbmspIGNvbnRpbnVlO1xuICAgMTYzXHRcbiAgIDE2NFx0ICAgICAgICAgICAgICAgICAgICAvL0B0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICAxNjVcdCAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kcnkudXRpbHMuaXNFbXB0eSh0b2tlbi5hY3RvcikpIGNvbnRpbnVlO1xuICAgMTY2XHRcbiAgIDE2N1x0ICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0gYXdhaXQgdGhpcy5NaWdyYXRlQWN0b3JEYXRhKHRva2VuLmFjdG9yKTtcbiAgIDE2OFx0XG4gICAxNjlcdCAgICAgICAgICAgICAgICAgICAgZXhwYW5kT2JqZWN0KHVwZGF0ZURhdGEpO1xuICAgMTcwXHQgICAgICAgICAgICAgICAgICAgIGVudGl0eVVwZGF0ZXMuc2V0KHRva2VuLmFjdG9yLCB7XG4gICAxNzFcdCAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGE6IHVwZGF0ZURhdGEuZGF0YSB8fCBudWxsLFxuICAgMTcyXHQgICAgICAgICAgICAgICAgICAgICAgICBlbWJlZGRlZEl0ZW1zOiB1cGRhdGVEYXRhLml0ZW1zIHx8IG51bGwsXG4gICAxNzNcdCAgICAgICAgICAgICAgICAgICAgICAgIGVtYmVkZGVkRWZmZWN0czogdXBkYXRlRGF0YS5lZmZlY3RzIHx8IG51bGxcbiAgIDE3NFx0ICAgICAgICAgICAgICAgICAgICB9KTtcbiAgIDE3NVx0ICAgICAgICAgICAgICAgIH1cbiAgIDE3Nlx0XG4gICAxNzdcdCAgICAgICAgICAgICAgICAvL0B0cy1leHBlY3QtZXJyb3IgLy8gVE9ETzogZm91bmRyeS12dHQtdHlwZXMgdjEwXG4gICAxNzhcdCAgICAgICAgICAgICAgICBpZiAoZm91bmRyeS51dGlscy5pc0VtcHR5KHVwZGF0ZURhdGEpKSB7XG4gICAxNzlcdCAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAxODBcdCAgICAgICAgICAgICAgICB9XG4uLi5cblBhdGg6IHNyYy9tb2R1bGUvZWZmZWN0cy50c1xuLi4uXG4gICAxNDlcdFxuICAgMTUwXHQvKipcbiAgIDE1MVx0ICogQ29sbGVjdCBhbGwgZWZmZWN0cyBmcm9tIGEgZG9jdW1lbnRzIGl0ZW1zIGFuZCBuZXN0ZWQgaXRlbXMuXG4gICAxNTJcdCAqXG4gICAxNTNcdCAqIEBwYXJhbSBkb2N1bWVudCBFaXRoZXIgYSBhY3RvciBvciBpdGVtIGRvY3VtZW50LlxuICAgMTU0XHQgKiBAcGFyYW0gb3B0aW9ucy5hcHBseVRvIEEgaXRlcmFibGUgb2YgYXBwbHktdG8gdGFyZ2V0IHZhbHVlc1xuICAgMTU1XHQgKiBAcGFyYW0gb3B0aW9ucy5uZXN0ZWRJdGVtcyBXaGV0aGVyIHRvIGluY2x1ZGUgbmVzdGVkIGl0ZW1zXG4gICAxNTZcdCAqIEByZXR1cm5zIEFuIGl0ZXJhdG9yIGVmZmVjdFxuICAgMTU3XHQgKi9cbiAgIDE1OFx0ZXhwb3J0IGZ1bmN0aW9uICphbGxBcHBsaWNhYmxlSXRlbXNFZmZlY3RzKGRvY3VtZW50OiBTUjZBY3RvcnxTUjZJdGVtLCBvcHRpb25zOiBBcHBsaWNhYmxlSXRlbUVmZmVjdE9wdGlvbnMgPSB7fSkge1xuICAgMTU5XHQgICAgY29uc3QgYXBwbHlUbyA9IG9wdGlvbnMuYXBwbHlUbyA/PyBbXTtcbiAgIDE2MFx0ICAgIGNvbnN0IG5lc3RlZEl0ZW1zID0gb3B0aW9ucy5uZXN0ZWRJdGVtcyA/PyB0cnVlO1xuLi4uXG5QYXRoOiBzcmMvbW9kdWxlL3Rlc3RzL1JhbmdlZEF0dGFja1Rlc3QudHNcbi4uLlxuICAgIDYxXHRcbiAgICA2Mlx0ICAgICAgICBpZih0aGlzLmFjdG9yKSB7XG4gICAgNjNcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBQcm9jZXNzaW5nIHRhcmdldHMgZm9yIGFjdG9yOicsIHRoaXMuYWN0b3IubmFtZSk7XG4gICAgNjRcdFxuICAgIDY1XHQgICAgICAgICAgICAvLyBNYXAgdGFyZ2V0cyB0byBkZWZlbmRlcnMgd2l0aCB0aGVpciBhY3R1YWwgRFIgdmFsdWVzXG4gICAgNjZcdCAgICAgICAgICAgIGRhdGEuZGVmZW5kZXJzID0gdGFyZ2V0cy5tYXAodG9rZW4gPT4ge1xuICAgIDY3XHQgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NoYWRvd3J1biA2ZSB8IFByb2Nlc3NpbmcgdGFyZ2V0IHRva2VuOicsIHRva2VuLm5hbWUpO1xuICAgIDY4XHRcbiAgICA2OVx0ICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEFjdG9yID0gdG9rZW4uYWN0b3I7XG4gICAgNzBcdCAgICAgICAgICAgICAgICBsZXQgZHIgPSA1OyAvLyBkZWZhdWx0IERSXG4gICAgNzFcdFxuICAgIDcyXHQgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXRBY3Rvcikge1xuICAgIDczXHQgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBObyBhY3RvciBmb3VuZCBmb3IgdG9rZW46JywgdG9rZW4ubmFtZSk7XG4gICAgNzRcdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgNzVcdCAgICAgICAgICAgICAgICB9XG4gICAgNzZcdFxuICAgIDc3XHQgICAgICAgICAgICAgICAgaWYgKCEodGFyZ2V0QWN0b3IgaW5zdGFuY2VvZiBTUjZBY3RvcikpIHtcbiAgICA3OFx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2hhZG93cnVuIDZlIHwgQWN0b3IgaXMgbm90IFNSNkFjdG9yOicsIHRva2VuLm5hbWUpO1xuICAgIDc5XHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgIDgwXHQgICAgICAgICAgICAgICAgfVxuICAgIDgxXHRcbiAgICA4Mlx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaGFkb3dydW4gNmUgfCBQcm9jZXNzaW5nIFNSNkFjdG9yIHRhcmdldDonLCB7XG4gICAgODNcdCAgICAgICAgICAgICAgICAgICAgbmFtZTogdGFyZ2V0QWN0b3IubmFtZSxcbiAgICA4NFx0ICAgICAgICAgICAgICAgICAgICB0eXBlOiB0YXJnZXRBY3Rvci50eXBlLFxuICAgIDg1XHQgICAgICAgICAgICAgICAgICAgIGhhc1N5c3RlbTogISF0YXJnZXRBY3Rvci5zeXN0ZW0sXG4gICAgODZcdCAgICAgICAgICAgICAgICAgICAgaGFzQXR0cmlidXRlczogISF0YXJnZXRBY3Rvci5zeXN0ZW0/LmF0dHJpYnV0ZXNcbiAgICA4N1x0ICAgICAgICAgICAgICAgIH0pO1xuLi4uXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJiNjQ1MmNiMS0xMjhhLTQ4MjItYjU0ZC0zMGM1Mjk0YmIyZmU7dG9vbHVfdnJ0eF8wMURCS1JoU2FoMnZ3OWY5a3UxazRMWFkiOnsicmVxdWVzdElkIjoiYjY0NTJjYjEtMTI4YS00ODIyLWI1NGQtMzBjNTI5NGJiMmZlIiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMURCS1JoU2FoMnZ3OWY5a3UxazRMWFkiLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tb2R1bGUvaG9va3MudHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlIGZvciBlbnRyeSB3aXRoIGluZGV4IFswXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgNDQzXHQgICAgICovXG4gICA0NDRcdCAgICBzdGF0aWMgYXN5bmMgdXBkYXRlSWNDb25uZWN0ZWRUb0hvc3RJdGVtKGl0ZW06IFNSNkl0ZW0sIGRhdGE6IFNoYWRvd3J1bi5TaGFkb3dydW5JdGVtRGF0YURhdGEsIGlkOiBzdHJpbmcpIHtcbiAgIDQ0NVx0ICAgICAgICBpZiAoIWNhbnZhcy5yZWFkeSB8fCAhZ2FtZS5hY3RvcnMpIHJldHVybjtcbiAgIDQ0Nlx0XG4gICA0NDdcdCAgICAgICAgaWYgKGl0ZW0uaXNIb3N0KSB7XG4gICA0NDhcdCAgICAgICAgICAgIC8vIENvbGxlY3QgYWN0b3JzIGZyb20gc2lkZWJhciBhbmQgYWN0aXZlIHNjZW5lIHRvIHVwZGF0ZSAvIHJlcmVuZGVyXG4gICA0NDlcdCAgICAgICAgICAgIGxldCBjb25uZWN0ZWRJQyA9IFtcbiAgIDQ1MFx0ICAgICAgICAgICAgICAgIC8vIEFsbCBzaWRlYmFyIGFjdG9ycyBzaG91bGQgYWxzbyBpbmNsdWRlIHRva2VucyB3aXRoIGxpbmtlZCBhY3RvcnMuXG4gICA0NTFcdCAgICAgICAgICAgICAgICAuLi5nYW1lLmFjdG9ycy5maWx0ZXIoKGFjdG9yOiBTUjZBY3RvcikgPT4gYWN0b3IuaXNJQygpICYmIGFjdG9yLmhhc0hvc3QoKSkgYXMgU1I2QWN0b3JbXSxcbiAgIDQ1Mlx0ICAgICAgICAgICAgICAgIC8vIEFsbCB0b2tlbiBhY3RvcnMgdGhhdCBhcmVuJ3QgbGlua2VkLlxuICAgNDUzXHQgICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAvLyBUT0RPOiBmb3VuZHJ5LXZ0dC10eXBlcyB2MTBcbiAgIDQ1NFx0ICAgICAgICAgICAgICAgIC4uLmNhbnZhcy5zY2VuZS50b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0b2tlbi5hY3RvckxpbmsgJiYgdG9rZW4uYWN0b3I/LmlzSUMoKSAmJiB0b2tlbi5hY3Rvcj8uaGFzSG9zdCgpKS5tYXAodCA9PiB0LmFjdG9yKS5maWx0ZXIoYWN0b3IgPT4gYWN0b3IgIT09IG51bGwgJiYgYWN0b3IgIT09IHVuZGVmaW5lZClcbiAgIDQ1NVx0ICAgICAgICAgICAgXTtcbiAgIDQ1Nlx0XG4gICA0NTdcdCAgICAgICAgICAgIC8vIFVwZGF0ZSBob3N0IGRhdGEgb24gdGhlIGljIGFjdG9yLlxuICAgNDU4XHQgICAgICAgICAgICBjb25zdCBob3N0ID0gaXRlbS5hc0hvc3Q7XG4gICA0NTlcdCAgICAgICAgICAgIGlmICghaG9zdCkgcmV0dXJuO1xuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJhM2I0MTUwZC1kYjY2LTQ3OTQtOThlMS03ZTE3NWI3OWQyOTU7dG9vbHVfdnJ0eF8wMVkxVXJESEZ4dE1McFlqWW5KVXdvQVciOnsicmVxdWVzdElkIjoiYTNiNDE1MGQtZGI2Ni00Nzk0LTk4ZTEtN2UxNzViNzlkMjk1IiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMVkxVXJESEZ4dE1McFlqWW5KVXdvQVciLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlIGZvciBlbnRyeSB3aXRoIGluZGV4IFswXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAgMzE0XHQgICAgICAgICAgICAgICAgSUNQcmVwLnByZXBhcmVEZXJpdmVkRGF0YSh0aGlzLnN5c3RlbSwgaXRlbURhdGFXcmFwcGVycyk7XG4gICAzMTVcdCAgICAgICAgICAgICAgICBicmVhaztcbiAgIDMxNlx0ICAgICAgICB9XG4gICAzMTdcdFxuICAgMzE4XHQgICAgICAgIC8vIEVuc3VyZSBtYXRyaXggYWN0aW9ucyBhcmUgYXZhaWxhYmxlIGZvciBhbGwgYWN0b3JzIHRoYXQgY2FuIHVzZSB0aGUgTWF0cml4XG4gICAzMTlcdCAgICAgICAgaWYgKGdhbWUudXNlcj8uaXNHTSAmJiB0aGlzLmlzT3duZXIgJiYgKHRoaXMuaXNDaGFyYWN0ZXIoKSB8fCB0aGlzLmlzU3ByaXRlKCkgfHwgdGhpcy5pc0lDKCkpKSB7XG4gICAzMjBcdCAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxuICAgMzIxXHQgICAgICAgICAgICBjb25zdCBoYXNNYXRyaXhBY3Rpb25zID0gdGhpcy5nZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnKTtcbiAgIDMyMlx0ICAgICAgICAgICAgaWYgKCFoYXNNYXRyaXhBY3Rpb25zKSB7XG4gICAzMjNcdCAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHVzZSBhIHNldFRpbWVvdXQgdG8gYXZvaWQgaXNzdWVzIHdpdGggdGhlIGFjdG9yIGJlaW5nIGxvY2tlZCBkdXJpbmcgZGF0YSBwcmVwYXJhdGlvblxuICAgMzI0XHQgICAgICAgICAgICAgICAgLy8gQWxzbyBhZGQgZXJyb3IgaGFuZGxpbmcgdG8gcHJldmVudCBjcmFzaGVzIGR1cmluZyBpbml0aWFsaXphdGlvblxuICAgMzI1XHQgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAzMjZcdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgIDMyN1x0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCk7XG4gICAzMjhcdCAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgIDMyOVx0ICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBTaGFkb3dydW4gNmUgfCBGYWlsZWQgdG8gZW5zdXJlIG1hdHJpeCBhY3Rpb25zIGZvciBhY3RvciAke3RoaXMubmFtZX06YCwgZXJyb3IpO1xuICAgMzMwXHQgICAgICAgICAgICAgICAgICAgIH1cbiAgIDMzMVx0ICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAzMzJcdCAgICAgICAgICAgIH1cbiAgIDMzM1x0ICAgICAgICB9XG4gICAzMzRcdCAgICB9XG4gICAzMzVcdFxuICAgMzM2XHQgICAgLyoqXG4gICAzMzdcdCAgICAgKiBOT1RFOiBUaGlzIG1ldGhvZCBpcyB1bnVzZWQgYXQgdGhlIG1vbWVudCwga2VlcCBpdCBmb3IgZnV0dXJlIGluc3BpcmF0aW9uLlxuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJmNDgxZTMxNy1hOTQwLTQ4NzYtYmQ1MS0zMjEyNTU3N2M4NjM7dG9vbHVfdnJ0eF8wMVhLTXJ0YWZMYmZyUlNSQW1vUmFoQVEiOnsicmVxdWVzdElkIjoiZjQ4MWUzMTctYTk0MC00ODc2LWJkNTEtMzIxMjU1NzdjODYzIiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMVhLTXJ0YWZMYmZyUlNSQW1vUmFoQVEiLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJIZXJlJ3MgdGhlIHJlc3VsdCBvZiBydW5uaW5nIGBjYXQgLW5gIG9uIHNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHM6XG4gIDI3NDBcdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgUmVmcmVzaGVkIHRva2VuIHNoZWV0ICR7aWR9IGZvciAke2FwcC50b2tlbi5uYW1lfWApO1xuICAyNzQxXHQgICAgICAgICAgICB9XG4gIDI3NDJcdCAgICAgICAgfVxuICAyNzQzXHQgICAgfVxuICAyNzQ0XHRcbiAgMjc0NVx0ICAgIC8qKlxuICAyNzQ2XHQgICAgICogRW5zdXJlcyB0aGF0IHRoZSBhY3RvciBoYXMgYWNjZXNzIHRvIGFsbCBtYXRyaXggYWN0aW9ucyBmcm9tIHRoZSBtYXRyaXgtYWN0aW9ucyBjb21wZW5kaXVtLlxuICAyNzQ3XHQgICAgICogVGhpcyBtZXRob2Qgd2lsbCBhZGQgYW55IG1pc3NpbmcgbWF0cml4IGFjdGlvbnMgdG8gdGhlIGFjdG9yLlxuICAyNzQ4XHQgICAgICpcbiAgMjc0OVx0ICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAyNzUwXHQgICAgICovXG4gIDI3NTFcdCAgICBhc3luYyBlbnN1cmVNYXRyaXhBY3Rpb25zKCkge1xuICAyNzUyXHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBFbnN1cmluZyBtYXRyaXggYWN0aW9ucyBmb3IgYWN0b3IgJHt0aGlzLm5hbWV9ICgke3RoaXMuaWR9KWApO1xuICAyNzUzXHRcbiAgMjc1NFx0ICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGFkZGVkIG1hdHJpeCBhY3Rpb25zIHRvIHRoaXMgYWN0b3JcbiAgMjc1NVx0ICAgICAgICBjb25zdCBoYXNNYXRyaXhBY3Rpb25zID0gdGhpcy5nZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnKTtcbiAgMjc1Nlx0ICAgICAgICBpZiAoaGFzTWF0cml4QWN0aW9ucykge1xuICAyNzU3XHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIG1hdHJpeCBhY3Rpb25zIGZsYWcgc2V0YCk7XG4gIDI3NThcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjc1OVx0ICAgICAgICB9XG4gIDI3NjBcdFxuICAyNzYxXHQgICAgICAgIC8vIEdldCB0aGUgbWF0cml4IGFjdGlvbnMgY29tcGVuZGl1bVxuICAyNzYyXHQgICAgICAgIGNvbnN0IG1hdHJpeFBhY2sgPSBnYW1lLnBhY2tzLmdldChcInNyNmVseXNpdW0ubWF0cml4LWFjdGlvbnNcIik7XG4gIDI3NjNcdCAgICAgICAgaWYgKCFtYXRyaXhQYWNrKSB7XG4gIDI3NjRcdCAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTaGFkb3dydW4gNmUgfCBNYXRyaXggQWN0aW9ucyBjb21wZW5kaXVtIG5vdCBmb3VuZFwiKTtcbiAgMjc2NVx0ICAgICAgICAgICAgcmV0dXJuO1xuICAyNzY2XHQgICAgICAgIH1cbiAgMjc2N1x0XG4gIDI3NjhcdCAgICAgICAgLy8gR2V0IGFsbCBtYXRyaXggYWN0aW9uc1xuICAyNzY5XHQgICAgICAgIGF3YWl0IG1hdHJpeFBhY2suZ2V0SW5kZXgoKTtcbiAgMjc3MFx0ICAgICAgICBjb25zdCBtYXRyaXhBY3Rpb25zID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gIDI3NzFcdCAgICAgICAgICAgIEFycmF5LmZyb20obWF0cml4UGFjay5pbmRleCkubWFwKGkgPT4gbWF0cml4UGFjay5nZXREb2N1bWVudChpLl9pZCkpXG4gIDI3NzJcdCAgICAgICAgKTtcbiAgMjc3M1x0XG4gIDI3NzRcdCAgICAgICAgLy8gR2V0IGV4aXN0aW5nIGFjdGlvbiBuYW1lcyB0byBhdm9pZCBkdXBsaWNhdGVzXG4gIDI3NzVcdCAgICAgICAgY29uc3QgZXhpc3RpbmdOYW1lcyA9IHRoaXMuaXRlbXNcbiAgMjc3Nlx0ICAgICAgICAgICAgLmZpbHRlcihpID0+IGkudHlwZSA9PT0gXCJhY3Rpb25cIilcbiAgMjc3N1x0ICAgICAgICAgICAgLm1hcChpID0+IGkubmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgMjc3OFx0XG4gIDI3NzlcdCAgICAgICAgLy8gRmlsdGVyIG91dCBhY3Rpb25zIHRoZSBhY3RvciBhbHJlYWR5IGhhc1xuICAyNzgwXHQgICAgICAgIGNvbnN0IGFjdGlvbnNUb0FkZCA9IG1hdHJpeEFjdGlvbnMuZmlsdGVyKFxuICAyNzgxXHQgICAgICAgICAgICBhID0+ICFleGlzdGluZ05hbWVzLmluY2x1ZGVzKGEubmFtZS50b0xvd2VyQ2FzZSgpKVxuICAyNzgyXHQgICAgICAgICk7XG4gIDI3ODNcdFxuICAyNzg0XHQgICAgICAgIGlmIChhY3Rpb25zVG9BZGQubGVuZ3RoID09PSAwKSB7XG4gIDI3ODVcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCAke3RoaXMubmFtZX0gYWxyZWFkeSBoYXMgYWxsIG1hdHJpeCBhY3Rpb25zYCk7XG4gIDI3ODZcdCAgICAgICAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IHdlJ3ZlIGNoZWNrZWQgZm9yIG1hdHJpeCBhY3Rpb25zXG4gIDI3ODdcdCAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI3ODhcdCAgICAgICAgICAgIHJldHVybjtcbiAgMjc4OVx0ICAgICAgICB9XG4gIDI3OTBcdFxuICAyNzkxXHQgICAgICAgIC8vIEFkZCB0aGUgYWN0aW9uc1xuICAyNzkyXHQgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRW1iZWRkZWREb2N1bWVudHMoXG4gIDI3OTNcdCAgICAgICAgICAgIFwiSXRlbVwiLFxuICAyNzk0XHQgICAgICAgICAgICBhY3Rpb25zVG9BZGQubWFwKGEgPT4gYS50b09iamVjdCgpKVxuICAyNzk1XHQgICAgICAgICk7XG4gIDI3OTZcdFxuICAyNzk3XHQgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBBZGRlZCAke2FjdGlvbnNUb0FkZC5sZW5ndGh9IG1hdHJpeCBhY3Rpb25zIHRvICR7dGhpcy5uYW1lfWApO1xuICAyNzk4XHRcbiAgMjc5OVx0ICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBhZGRlZCBtYXRyaXggYWN0aW9uc1xuICAyODAwXHQgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG5Ub3RhbCBsaW5lcyBpbiBmaWxlOiAzMDM4XG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCI2NzgwY2ZlOC0zZDgyLTQ1ZGEtODgxNS0xYmU3OGY1NmM4NWQ7dG9vbHVfdnJ0eF8wMVdFWWFOZW9mTUNYNDlDVXpFelppZU4iOnsicmVxdWVzdElkIjoiNjc4MGNmZTgtM2Q4Mi00NWRhLTg4MTUtMWJlNzhmNTZjODVkIiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMVdFWWFOZW9mTUNYNDlDVXpFelppZU4iLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tb2R1bGUvYWN0b3IvU1I2QWN0b3IudHMuXG5SZXN1bHQgZm9yIHN0cl9yZXBsYWNlIGZvciBlbnRyeSB3aXRoIGluZGV4IFswXTpcblJlcGxhY2VtZW50IHN1Y2Nlc3NmdWwuXG5FZGl0ZWQgc2VjdGlvbiBhZnRlciBJREUgYXV0by1mb3JtYXR0aW5nIHdhcyBhcHBsaWVkOlxuICAyNzQ3XHQgICAgICogVGhpcyBtZXRob2Qgd2lsbCBhZGQgYW55IG1pc3NpbmcgbWF0cml4IGFjdGlvbnMgdG8gdGhlIGFjdG9yLlxuICAyNzQ4XHQgICAgICpcbiAgMjc0OVx0ICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAyNzUwXHQgICAgICovXG4gIDI3NTFcdCAgICBhc3luYyBlbnN1cmVNYXRyaXhBY3Rpb25zKCkge1xuICAyNzUyXHQgICAgICAgIHRyeSB7XG4gIDI3NTNcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCBFbnN1cmluZyBtYXRyaXggYWN0aW9ucyBmb3IgYWN0b3IgJHt0aGlzLm5hbWV9ICgke3RoaXMuaWR9KWApO1xuICAyNzU0XHRcbiAgMjc1NVx0ICAgICAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgYWN0b3Igc3RpbGwgZXhpc3RzIGFuZCBpcyB2YWxpZFxuICAyNzU2XHQgICAgICAgICAgICBpZiAoIXRoaXMuaWQgfHwgIXRoaXMubmFtZSkge1xuICAyNzU3XHQgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBTaGFkb3dydW4gNmUgfCBBY3RvciBpcyBpbnZhbGlkLCBza2lwcGluZyBtYXRyaXggYWN0aW9ucyBpbml0aWFsaXphdGlvbmApO1xuICAyNzU4XHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAyNzU5XHQgICAgICAgICAgICB9XG4gIDI3NjBcdFxuICAyNzYxXHQgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBhbHJlYWR5IGFkZGVkIG1hdHJpeCBhY3Rpb25zIHRvIHRoaXMgYWN0b3JcbiAgMjc2Mlx0ICAgICAgICAgICAgY29uc3QgaGFzTWF0cml4QWN0aW9ucyA9IHRoaXMuZ2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJyk7XG4gIDI3NjNcdCAgICAgICAgICAgIGlmIChoYXNNYXRyaXhBY3Rpb25zKSB7XG4gIDI3NjRcdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgJHt0aGlzLm5hbWV9IGFscmVhZHkgaGFzIG1hdHJpeCBhY3Rpb25zIGZsYWcgc2V0YCk7XG4gIDI3NjVcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gIDI3NjZcdCAgICAgICAgICAgIH1cbiAgMjc2N1x0XG4gIDI3NjhcdCAgICAgICAgICAgIC8vIEdldCB0aGUgbWF0cml4IGFjdGlvbnMgY29tcGVuZGl1bVxuICAyNzY5XHQgICAgICAgICAgICBjb25zdCBtYXRyaXhQYWNrID0gZ2FtZS5wYWNrcy5nZXQoXCJzcjZlbHlzaXVtLm1hdHJpeC1hY3Rpb25zXCIpO1xuICAyNzcwXHQgICAgICAgICAgICBpZiAoIW1hdHJpeFBhY2spIHtcbiAgMjc3MVx0ICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJTaGFkb3dydW4gNmUgfCBNYXRyaXggQWN0aW9ucyBjb21wZW5kaXVtIG5vdCBmb3VuZFwiKTtcbiAgMjc3Mlx0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgMjc3M1x0ICAgICAgICAgICAgfVxuICAyNzc0XHRcbiAgMjc3NVx0ICAgICAgICAgICAgLy8gR2V0IGFsbCBtYXRyaXggYWN0aW9uc1xuICAyNzc2XHQgICAgICAgICAgICBhd2FpdCBtYXRyaXhQYWNrLmdldEluZGV4KCk7XG4gIDI3NzdcdCAgICAgICAgICAgIGNvbnN0IG1hdHJpeEFjdGlvbnMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgMjc3OFx0ICAgICAgICAgICAgICAgIEFycmF5LmZyb20obWF0cml4UGFjay5pbmRleCkubWFwKGkgPT4gbWF0cml4UGFjay5nZXREb2N1bWVudChpLl9pZCkpXG4gIDI3NzlcdCAgICAgICAgICAgICk7XG4gIDI3ODBcdFxuICAyNzgxXHQgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IG51bGwvdW5kZWZpbmVkIGFjdGlvbnNcbiAgMjc4Mlx0ICAgICAgICAgICAgY29uc3QgdmFsaWRNYXRyaXhBY3Rpb25zID0gbWF0cml4QWN0aW9ucy5maWx0ZXIoYWN0aW9uID0+IGFjdGlvbiAmJiBhY3Rpb24ubmFtZSk7XG4gIDI3ODNcdCAgICAgICAgICAgIGlmICh2YWxpZE1hdHJpeEFjdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gIDI3ODRcdCAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IE5vIHZhbGlkIG1hdHJpeCBhY3Rpb25zIGZvdW5kIGluIGNvbXBlbmRpdW1gKTtcbiAgMjc4NVx0ICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI3ODZcdCAgICAgICAgICAgICAgICByZXR1cm47XG4gIDI3ODdcdCAgICAgICAgICAgIH1cbiAgMjc4OFx0XG4gIDI3ODlcdCAgICAgICAgICAgIC8vIEdldCBleGlzdGluZyBhY3Rpb24gbmFtZXMgdG8gYXZvaWQgZHVwbGljYXRlc1xuICAyNzkwXHQgICAgICAgICAgICBjb25zdCBleGlzdGluZ05hbWVzID0gdGhpcy5pdGVtc1xuICAyNzkxXHQgICAgICAgICAgICAgICAgLmZpbHRlcihpID0+IGkgJiYgaS50eXBlID09PSBcImFjdGlvblwiICYmIGkubmFtZSlcbiAgMjc5Mlx0ICAgICAgICAgICAgICAgIC5tYXAoaSA9PiBpLm5hbWUudG9Mb3dlckNhc2UoKSk7XG4gIDI3OTNcdFxuICAyNzk0XHQgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGFjdGlvbnMgdGhlIGFjdG9yIGFscmVhZHkgaGFzXG4gIDI3OTVcdCAgICAgICAgICAgIGNvbnN0IGFjdGlvbnNUb0FkZCA9IHZhbGlkTWF0cml4QWN0aW9ucy5maWx0ZXIoXG4gIDI3OTZcdCAgICAgICAgICAgICAgICBhID0+IGEgJiYgYS5uYW1lICYmICFleGlzdGluZ05hbWVzLmluY2x1ZGVzKGEubmFtZS50b0xvd2VyQ2FzZSgpKVxuICAyNzk3XHQgICAgICAgICAgICApO1xuICAyNzk4XHRcbiAgMjc5OVx0ICAgICAgICAgICAgaWYgKGFjdGlvbnNUb0FkZC5sZW5ndGggPT09IDApIHtcbiAgMjgwMFx0ICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTaGFkb3dydW4gNmUgfCAke3RoaXMubmFtZX0gYWxyZWFkeSBoYXMgYWxsIG1hdHJpeCBhY3Rpb25zYCk7XG4gIDI4MDFcdCAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB3ZSd2ZSBjaGVja2VkIGZvciBtYXRyaXggYWN0aW9uc1xuICAyODAyXHQgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcbiAgMjgwM1x0ICAgICAgICAgICAgICAgIHJldHVybjtcbiAgMjgwNFx0ICAgICAgICAgICAgfVxuICAyODA1XHRcbiAgMjgwNlx0ICAgICAgICAgICAgLy8gQWRkIHRoZSBhY3Rpb25zXG4gIDI4MDdcdCAgICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRW1iZWRkZWREb2N1bWVudHMoXG4gIDI4MDhcdCAgICAgICAgICAgICAgICBcIkl0ZW1cIixcbiAgMjgwOVx0ICAgICAgICAgICAgICAgIGFjdGlvbnNUb0FkZC5tYXAoYSA9PiBhLnRvT2JqZWN0KCkpXG4gIDI4MTBcdCAgICAgICAgICAgICk7XG4gIDI4MTFcdFxuICAyODEyXHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2hhZG93cnVuIDZlIHwgQWRkZWQgJHthY3Rpb25zVG9BZGQubGVuZ3RofSBtYXRyaXggYWN0aW9ucyB0byAke3RoaXMubmFtZX1gKTtcbiAgMjgxM1x0XG4gIDI4MTRcdCAgICAgICAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBpbmRpY2F0ZSB0aGF0IHdlJ3ZlIGFkZGVkIG1hdHJpeCBhY3Rpb25zXG4gIDI4MTVcdCAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0RmxhZygnc3I2ZWx5c2l1bScsICdoYXNNYXRyaXhBY3Rpb25zJywgdHJ1ZSk7XG4gIDI4MTZcdCAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgMjgxN1x0ICAgICAgICAgICAgY29uc29sZS5lcnJvcihgU2hhZG93cnVuIDZlIHwgRXJyb3IgZW5zdXJpbmcgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XG4gIDI4MThcdCAgICAgICAgICAgIC8vIFNldCB0aGUgZmxhZyBhbnl3YXkgdG8gcHJldmVudCByZXBlYXRlZCBhdHRlbXB0c1xuICAyODE5XHQgICAgICAgICAgICB0cnkge1xuICAyODIwXHQgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnLCB0cnVlKTtcbiAgMjgyMVx0ICAgICAgICAgICAgfSBjYXRjaCAoZmxhZ0Vycm9yKSB7XG4gIDI4MjJcdCAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBTaGFkb3dydW4gNmUgfCBGYWlsZWQgdG8gc2V0IG1hdHJpeCBhY3Rpb25zIGZsYWcgZm9yICR7dGhpcy5uYW1lfTpgLCBmbGFnRXJyb3IpO1xuICAyODIzXHQgICAgICAgICAgICB9XG4gIDI4MjRcdCAgICAgICAgfVxuICAyODI1XHQgICAgfVxuICAyODI2XHRcbiAgMjgyN1x0ICAgIGFzeW5jIG5ld1NjZW5lU2V0dXAoKSB7XG4gIDI4MjhcdCAgICAgICAgY29uc3QgdXBkYXRlRGF0YTogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCJiNmZkYjcxMS1lYjA0LTRhZDQtOWFhNC0yNmU1NDQ5M2ViMDk7dG9vbHVfdnJ0eF8wMU44R3V5ckJFbnQxRFEyR3hOMWg5aVQiOnsicmVxdWVzdElkIjoiYjZmZGI3MTEtZWIwNC00YWQ0LTlhYTQtMjZlNTQ0OTNlYjA5IiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMU44R3V5ckJFbnQxRFEyR3hOMWg5aVQiLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tb2R1bGUvaGVscGVycy50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICA0NTJcdCAgICAgICAgaWYgKCFjYW52YXMgfHwgIWNhbnZhcy5yZWFkeSB8fCAhY2FudmFzLnRva2VucykgcmV0dXJuIGZhbHNlO1xuICAgNDUzXHQgICAgICAgIHJldHVybiBjYW52YXMudG9rZW5zLmNvbnRyb2xsZWQubGVuZ3RoID4gMDtcbiAgIDQ1NFx0ICAgIH1cbiAgIDQ1NVx0XG4gICA0NTZcdCAgICAvKipcbiAgIDQ1N1x0ICAgICAqIFJldHVybiBhbGwgYWN0b3JzIGNvbm5lY3RlZCB0byBhbGwgdXNlciBjb250cm9sbGVkIHRva2Vucy5cbiAgIDQ1OFx0ICAgICAqIEByZXR1cm5zIEFuIGFycmF5IHRva2VuIGFjdG9ycy5cbiAgIDQ1OVx0ICAgICAqL1xuICAgNDYwXHQgICAgc3RhdGljIGdldENvbnRyb2xsZWRUb2tlbkFjdG9ycygpOiBTUjZBY3RvcltdIHtcbiAgIDQ2MVx0ICAgICAgICBpZiAoIWNhbnZhcyB8fCAhY2FudmFzLnJlYWR5KSByZXR1cm4gW11cbiAgIDQ2Mlx0XG4gICA0NjNcdCAgICAgICAgY29uc3QgdG9rZW5zID0gSGVscGVycy5nZXRDb250cm9sbGVkVG9rZW5zKCk7XG4gICA0NjRcdCAgICAgICAgcmV0dXJuIHRva2Vucy5tYXAodG9rZW4gPT4gdG9rZW4uYWN0b3IpLmZpbHRlcihhY3RvciA9PiBhY3RvciAhPT0gbnVsbCAmJiBhY3RvciAhPT0gdW5kZWZpbmVkKSBhcyBTUjZBY3RvcltdO1xuICAgNDY1XHQgICAgfVxuICAgNDY2XHRcbiAgIDQ2N1x0ICAgIC8qKlxuICAgNDY4XHQgICAgICogcmV0dXJuIGFsbCB0b2tlbnMgYSB1c2VyIGhhcyB0YXJnZXRlZCBhdCB0aGUgbW9tZW50LlxuICAgNDY5XHQgICAgICogQHJldHVybnMgQW4gYXJyYXkgdG9rZW5zLlxuXG5SZXZpZXcgdGhlIGNoYW5nZXMgYW5kIG1ha2Ugc3VyZSB0aGV5IGFyZSBhcyBleHBlY3RlZCAoY29ycmVjdCBpbmRlbnRhdGlvbiwgbm8gZHVwbGljYXRlIGxpbmVzLCBldGMpLlxuRWRpdCB0aGUgZmlsZSBhZ2FpbiBpZiBuZWNlc3NhcnkuXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCI1Y2M5NWM3MC1mMTJjLTRjMGUtYjQ2ZC00OWE0MzI4ZTY0NDg7dG9vbHVfdnJ0eF8wMVBOOUN2cjE5S0VwSzZWbml0UXdtM00iOnsicmVxdWVzdElkIjoiNWNjOTVjNzAtZjEyYy00YzBlLWI0NmQtNDlhNDMyOGU2NDQ4IiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMVBOOUN2cjE5S0VwSzZWbml0UXdtM00iLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJTdWNjZXNzZnVsbHkgZWRpdGVkIHRoZSBmaWxlIHNyYy9tb2R1bGUvaGVscGVycy50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICA1NzNcdFxuICAgNTc0XHQgICAgICAgIHJldHVybiBhY3Rvci5uYW1lIGFzIHN0cmluZztcbiAgIDU3NVx0ICAgIH1cbiAgIDU3Nlx0XG4gICA1NzdcdCAgICBzdGF0aWMgZ2V0RGVmZW5zZVJhdGluZyh0YXJnZXRzOiBUb2tlbkRvY3VtZW50W10pOiBudW1iZXIge1xuICAgNTc4XHQgICAgICAgIGxldCBkZWZlbnNlUmF0aW5nID0gMDtcbiAgIDU3OVx0ICAgICAgICBmb3IoY29uc3QgdG9rZW4gb2YgdGFyZ2V0cykge1xuICAgNTgwXHQgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gdG9rZW4uYWN0b3I7XG4gICA1ODFcdCAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICA1ODJcdCAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1NoYWRvd3J1biA2ZSB8IFRva2VuIGhhcyBubyBhY3RvcjonLCB0b2tlbi5uYW1lKTtcbiAgIDU4M1x0ICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgNTg0XHQgICAgICAgICAgICB9XG4gICA1ODVcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKHRhcmdldCk7XG4gICA1ODZcdCAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgIDU4N1x0ICAgICAgICAgICAgaWYgKHRhcmdldC5zeXN0ZW0gJiYgdGFyZ2V0LnN5c3RlbS52YWx1ZXMgJiYgJ2RlZmVuc2VfcmF0aW5nJyBpbiB0YXJnZXQuc3lzdGVtLnZhbHVlcyAmJiB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZSA+IGRlZmVuc2VSYXRpbmcpIHtcbiAgIDU4OFx0ICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgIDU4OVx0ICAgICAgICAgICAgICAgIGRlZmVuc2VSYXRpbmcgPSB0YXJnZXQuc3lzdGVtLnZhbHVlcy5kZWZlbnNlX3JhdGluZy52YWx1ZTtcbiAgIDU5MFx0ICAgICAgICAgICAgfVxuICAgNTkxXHQgICAgICAgIH1cbiAgIDU5Mlx0ICAgICAgICByZXR1cm4gZGVmZW5zZVJhdGluZztcbiAgIDU5M1x0ICAgIH1cbiAgIDU5NFx0XG4gICA1OTVcdCAgICBzdGF0aWMgZ2V0QXR0YWNrUmF0aW5nKGFjdG9yOiBTUjZBY3Rvcik6IG51bWJlciB7XG4gICA1OTZcdCAgICAgICAgcmV0dXJuIDA7XG4gICA1OTdcdCAgICB9XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjQzYTlhMjEzLTY4MjMtNGJhOS04OWNiLTE3ZDNiNzg0N2Y2Yzt0b29sdV92cnR4XzAxV3hSQW9EOHh4WHc0QXFFVmVWWlFQcSI6eyJyZXF1ZXN0SWQiOiI0M2E5YTIxMy02ODIzLTRiYTktODljYi0xN2QzYjc4NDdmNmMiLCJ0b29sVXNlSWQiOiJ0b29sdV92cnR4XzAxV3hSQW9EOHh4WHc0QXFFVmVWWlFQcSIsInBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21vZHVsZS9ydWxlcy9Eb2N1bWVudFNpdHVhdGlvbk1vZGlmaWVycy50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAzOThcdCAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCBtb2RpZmllcnMgc2NlbmUgaXMgc2FtZSB0byBjdXJyZW50IHNjZW5lLlxuICAgMzk5XHQgICAgICAgIGNvbnN0IHNjZW5lID0gdGhpcy5kb2N1bWVudCBhcyBTY2VuZTtcbiAgIDQwMFx0ICAgICAgICBpZiAoY2FudmFzLnNjZW5lLmlkICE9PSBzY2VuZS5pZCkgcmV0dXJuO1xuICAgNDAxXHRcbiAgIDQwMlx0ICAgICAgICAvLyBVc2UgY3VycmVudCBzY2VuZSBmb3IgZWFzZSBvZiBhY2Nlc3MgdG8gdG9rZW5zXG4gICA0MDNcdCAgICAgICAgY2FudmFzLnNjZW5lLnRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcbiAgIDQwNFx0ICAgICAgICAgICAgaWYgKHRva2VuLmFjdG9yKSB7XG4gICA0MDVcdCAgICAgICAgICAgICAgICB0b2tlbi5hY3Rvci5nZXRTaXR1YXRpb25Nb2RpZmllcnMoKS5jbGVhckFsbCgpO1xuICAgNDA2XHQgICAgICAgICAgICB9XG4gICA0MDdcdCAgICAgICAgfSk7XG4gICA0MDhcdCAgICB9XG4gICA0MDlcdH1cbiAgIDQxMFx0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjlhMzdiZTA3LTgzNzYtNDEwYy1iY2Q4LTJjMTkxMzgzYjUzMjt0b29sdV92cnR4XzAxOVVmNXFQRVl4N2FyTlZqRWZFNUR0TSI6eyJyZXF1ZXN0SWQiOiI5YTM3YmUwNy04Mzc2LTQxMGMtYmNkOC0yYzE5MTM4M2I1MzIiLCJ0b29sVXNlSWQiOiJ0b29sdV92cnR4XzAxOVVmNXFQRVl4N2FyTlZqRWZFNUR0TSIsInBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gIDMwMThcdCAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiB0aGlzLmdldEFjdGl2ZVRva2VucygpKSB7XG4gIDMwMTlcdCAgICAgICAgICAgIGlmICh0b2tlbi5yZWZyZXNoKSB0b2tlbi5yZWZyZXNoKCk7XG4gIDMwMjBcdCAgICAgICAgfVxuICAzMDIxXHRcbiAgMzAyMlx0ICAgICAgICAvLyBSZWZyZXNoIHRoZSBjYW52YXMgaWYgaXQgZXhpc3RzXG4gIDMwMjNcdCAgICAgICAgaWYgKGNhbnZhcyAmJiBjYW52YXMudG9rZW5zICYmIHR5cGVvZiBjYW52YXMudG9rZW5zLnBsYWNlYWJsZXMgIT09ICd1bmRlZmluZWQnKSB7XG4gIDMwMjRcdCAgICAgICAgICAgIGNhbnZhcy50b2tlbnMucGxhY2VhYmxlcy5mb3JFYWNoKHRva2VuID0+IHtcbiAgMzAyNVx0ICAgICAgICAgICAgICAgIGlmICh0b2tlbi5hY3RvciAmJiB0b2tlbi5hY3Rvci5pZCA9PT0gdGhpcy5pZCAmJiB0b2tlbi5yZWZyZXNoKSB7XG4gIDMwMjZcdCAgICAgICAgICAgICAgICAgICAgdG9rZW4ucmVmcmVzaCgpO1xuICAzMDI3XHQgICAgICAgICAgICAgICAgfVxuICAzMDI4XHQgICAgICAgICAgICB9KTtcbiAgMzAyOVx0ICAgICAgICB9XG4gIDMwMzBcdFxuICAzMDMxXHQgICAgICAgIC8vIFJlZnJlc2ggdG9rZW4gc2hlZXRzXG4gIDMwMzJcdCAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW5TaGVldHMoKTtcbiAgMzAzM1x0XG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sIjUwOTZlNjQ2LWI5NDktNGUyYy1hN2YxLTExNjJhOGUyMTZkZjt0b29sdV92cnR4XzAxVFM2dHN2NXFNZEJCa0h1b2dVdzJ2VyI6eyJyZXF1ZXN0SWQiOiI1MDk2ZTY0Ni1iOTQ5LTRlMmMtYTdmMS0xMTYyYThlMjE2ZGYiLCJ0b29sVXNlSWQiOiJ0b29sdV92cnR4XzAxVFM2dHN2NXFNZEJCa0h1b2dVdzJ2VyIsInBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IlN1Y2Nlc3NmdWxseSBlZGl0ZWQgdGhlIGZpbGUgc3JjL21vZHVsZS9hY3Rvci9TUjZBY3Rvci50cy5cblJlc3VsdCBmb3Igc3RyX3JlcGxhY2UgZm9yIGVudHJ5IHdpdGggaW5kZXggWzBdOlxuUmVwbGFjZW1lbnQgc3VjY2Vzc2Z1bC5cbkVkaXRlZCBzZWN0aW9uIGFmdGVyIElERSBhdXRvLWZvcm1hdHRpbmcgd2FzIGFwcGxpZWQ6XG4gICAzMTRcdCAgICAgICAgICAgICAgICBJQ1ByZXAucHJlcGFyZURlcml2ZWREYXRhKHRoaXMuc3lzdGVtLCBpdGVtRGF0YVdyYXBwZXJzKTtcbiAgIDMxNVx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgMzE2XHQgICAgICAgIH1cbiAgIDMxN1x0XG4gICAzMThcdCAgICAgICAgLy8gRW5zdXJlIG1hdHJpeCBhY3Rpb25zIGFyZSBhdmFpbGFibGUgZm9yIGFsbCBhY3RvcnMgdGhhdCBjYW4gdXNlIHRoZSBNYXRyaXhcbiAgIDMxOVx0ICAgICAgICAvLyBPbmx5IHJ1biB0aGlzIGlmIHRoZSBnYW1lIGlzIGZ1bGx5IHJlYWR5IGFuZCBub3QgZHVyaW5nIG1pZ3JhdGlvblxuICAgMzIwXHQgICAgICAgIGlmIChnYW1lLnJlYWR5ICYmIGdhbWUudXNlcj8uaXNHTSAmJiB0aGlzLmlzT3duZXIgJiYgKHRoaXMuaXNDaGFyYWN0ZXIoKSB8fCB0aGlzLmlzU3ByaXRlKCkgfHwgdGhpcy5pc0lDKCkpKSB7XG4gICAzMjFcdCAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGFscmVhZHkgYWRkZWQgbWF0cml4IGFjdGlvbnMgdG8gdGhpcyBhY3RvclxuICAgMzIyXHQgICAgICAgICAgICBjb25zdCBoYXNNYXRyaXhBY3Rpb25zID0gdGhpcy5nZXRGbGFnKCdzcjZlbHlzaXVtJywgJ2hhc01hdHJpeEFjdGlvbnMnKTtcbiAgIDMyM1x0ICAgICAgICAgICAgaWYgKCFoYXNNYXRyaXhBY3Rpb25zKSB7XG4gICAzMjRcdCAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHVzZSBhIHNldFRpbWVvdXQgdG8gYXZvaWQgaXNzdWVzIHdpdGggdGhlIGFjdG9yIGJlaW5nIGxvY2tlZCBkdXJpbmcgZGF0YSBwcmVwYXJhdGlvblxuICAgMzI1XHQgICAgICAgICAgICAgICAgLy8gQWxzbyBhZGQgZXJyb3IgaGFuZGxpbmcgdG8gcHJldmVudCBjcmFzaGVzIGR1cmluZyBpbml0aWFsaXphdGlvblxuICAgMzI2XHQgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAzMjdcdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgIDMyOFx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG91YmxlLWNoZWNrIHRoYXQgdGhlIGdhbWUgaXMgc3RpbGwgcmVhZHkgYW5kIHRoZSBhY3RvciBpcyB2YWxpZFxuICAgMzI5XHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZS5yZWFkeSAmJiB0aGlzLmlkICYmIHRoaXMubmFtZSkge1xuICAgMzMwXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnN1cmVNYXRyaXhBY3Rpb25zKCk7XG4gICAzMzFcdCAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgIDMzMlx0ICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgMzMzXHQgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFNoYWRvd3J1biA2ZSB8IEZhaWxlZCB0byBlbnN1cmUgbWF0cml4IGFjdGlvbnMgZm9yIGFjdG9yICR7dGhpcy5uYW1lfTpgLCBlcnJvcik7XG4gICAzMzRcdCAgICAgICAgICAgICAgICAgICAgfVxuICAgMzM1XHQgICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgIDMzNlx0ICAgICAgICAgICAgfVxuICAgMzM3XHQgICAgICAgIH1cbiAgIDMzOFx0ICAgIH1cbiAgIDMzOVx0XG4gICAzNDBcdCAgICAvKipcbiAgIDM0MVx0ICAgICAqIE5PVEU6IFRoaXMgbWV0aG9kIGlzIHVudXNlZCBhdCB0aGUgbW9tZW50LCBrZWVwIGl0IGZvciBmdXR1cmUgaW5zcGlyYXRpb24uXG5cblJldmlldyB0aGUgY2hhbmdlcyBhbmQgbWFrZSBzdXJlIHRoZXkgYXJlIGFzIGV4cGVjdGVkIChjb3JyZWN0IGluZGVudGF0aW9uLCBubyBkdXBsaWNhdGUgbGluZXMsIGV0YykuXG5FZGl0IHRoZSBmaWxlIGFnYWluIGlmIG5lY2Vzc2FyeS5cbiIsImlzRXJyb3IiOmZhbHNlLCJyZXF1ZXN0SWQiOiIifX0sImU0M2Y0ZWQ0LTdmZDgtNGNlNy1hMWQ1LTI0NTUwMDNmNzc1YTt0b29sdV92cnR4XzAxWFJ3NW5jY2RtSGd6TkZkQWQ3QmdxdyI6eyJyZXF1ZXN0SWQiOiJlNDNmNGVkNC03ZmQ4LTRjZTctYTFkNS0yNDU1MDAzZjc3NWEiLCJ0b29sVXNlSWQiOiJ0b29sdV92cnR4XzAxWFJ3NW5jY2RtSGd6TkZkQWQ3QmdxdyIsInBoYXNlIjo1LCJyZXN1bHQiOnsidGV4dCI6IkhlcmUncyB0aGUgcmVzdWx0IG9mIHJ1bm5pbmcgYGNhdCAtbmAgb24gc3JjL21vZHVsZS90YXJnZXRpbmcvVGFyZ2V0aW5nU2VydmljZS50czpcbiAgIDEzNVx0ICAgICAgICBjb25zdCB0b2tlbnMgPSBjYW52YXMudG9rZW5zPy5wbGFjZWFibGVzIHx8IFtdO1xuICAgMTM2XHQgICAgICAgIFxuICAgMTM3XHQgICAgICAgIC8vIEZpbHRlciBmb3IgcG90ZW50aWFsIHRhcmdldHMgKGV4Y2x1ZGUgdGhlIGFjdG9yJ3Mgb3duIHRva2VuKVxuICAgMTM4XHQgICAgICAgIGNvbnN0IHBvdGVudGlhbFRhcmdldHMgPSB0b2tlbnMuZmlsdGVyKHRva2VuID0+IFxuICAgMTM5XHQgICAgICAgICAgICB0b2tlbi5pZCAhPT0gYWN0b3JUb2tlbi5pZCAmJiBcbiAgIDE0MFx0ICAgICAgICAgICAgdG9rZW4uYWN0b3IgJiYgXG4gICAxNDFcdCAgICAgICAgICAgIHRoaXMuaXNWYWxpZFRhcmdldCh0b2tlbiwgYWN0aW9uLCBhY3RvcilcbiAgIDE0Mlx0ICAgICAgICApO1xuICAgMTQzXHQgICAgICAgIFxuICAgMTQ0XHQgICAgICAgIC8vIFNvcnQgYnkgZGlzdGFuY2UgdG8gdGhlIGFjdG9yXG4gICAxNDVcdCAgICAgICAgcmV0dXJuIHBvdGVudGlhbFRhcmdldHMuc29ydCgoYSwgYikgPT4ge1xuVG90YWwgbGluZXMgaW4gZmlsZTogMjUyXG4iLCJpc0Vycm9yIjpmYWxzZSwicmVxdWVzdElkIjoiIn19LCI2MjcyZTdmZC1hNjdiLTQ2MTQtOGJiYy00ZmRjMjQ0N2VlNjQ7dG9vbHVfdnJ0eF8wMVVhUUN6dXlwQlUzTUVlTmk3dnF3eVQiOnsicmVxdWVzdElkIjoiNjI3MmU3ZmQtYTY3Yi00NjE0LThiYmMtNGZkYzI0NDdlZTY0IiwidG9vbFVzZUlkIjoidG9vbHVfdnJ0eF8wMVVhUUN6dXlwQlUzTUVlTmk3dnF3eVQiLCJwaGFzZSI6NSwicmVzdWx0Ijp7InRleHQiOiJIZXJlJ3MgdGhlIHJlc3VsdCBvZiBydW5uaW5nIGBjYXQgLW5gIG9uIHNyYy9tb2R1bGUvYXBwcy9nbXRvb2xzL092ZXJ3YXRjaFNjb3JlVHJhY2tlci5qczpcbiAgICA4MFx0XG4gICAgODFcdCAgICAgICAgLy8gQWRkIGxpbmtlZCB0b2tlbiBhY3RvcnMuXG4gICAgODJcdCAgICAgICAgdG9rZW5zLmZpbHRlcih0b2tlbiA9PiB0b2tlbi5kb2N1bWVudC5hY3RvckxpbmspLmZvckVhY2godG9rZW4gPT4ge1xuICAgIDgzXHQgICAgICAgICAgICAvLyBEb3VibGUgY2hlY2sgdGhhdCB0aGUgYWN0b3IgYWN0dWFsbHkgbGl2ZXMgaW4gdGhlIGFjdG9ycyBjb2xsZWN0aW9uLlxuICAgIDg0XHQgICAgICAgICAgICBjb25zdCBhY3RvciA9IGdhbWUuYWN0b3JzLmdldCh0b2tlbi5kb2N1bWVudC5hY3RvcklkKTtcbiAgICA4NVx0ICAgICAgICAgICAgaWYgKCFhY3RvcikgcmV0dXJuO1xuICAgIDg2XHQgICAgICAgICAgICBpZiAodGhpcy5faXNBY3Rvck9uVHJhY2tlcihhY3RvcikpIHJldHVybjtcbiAgICA4N1x0XG4gICAgODhcdCAgICAgICAgICAgIE92ZXJ3YXRjaFNjb3JlVHJhY2tlci5hZGRlZEFjdG9ycy5wdXNoKGFjdG9yLmlkKTtcbiAgICA4OVx0ICAgICAgICB9KTtcbiAgICA5MFx0XG4gICAgOTFcdCAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICA5Mlx0ICAgIH1cbiAgICA5M1x0XG4gICAgOTRcdCAgICAvKipcbiAgICA5NVx0ICAgICAqIENoZWNrIGlmIHRoZSBnaXZlbiBhY3RvciBpcyBhbHJlYWR5IGFkZGVkIGFuZCBkaXNwbGF5ZWQgb24gdGhlIGN1cnJlbnQgdHJhY2tlci5cblRvdGFsIGxpbmVzIGluIGZpbGU6IDE2NVxuIiwiaXNFcnJvciI6ZmFsc2UsInJlcXVlc3RJZCI6IiJ9fSwiNDk5YzE5ODUtMGMzNi00NmI2LTkwN2EtM2U1MDg5NGQ1MzllO3Rvb2x1X3ZydHhfMDFRVGRKVFN2eDJ2RjVZaDlKQjlhQnpnIjp7InJlcXVlc3RJZCI6IjQ5OWMxOTg1LTBjMzYtNDZiNi05MDdhLTNlNTA4OTRkNTM5ZSIsInRvb2xVc2VJZCI6InRvb2x1X3ZydHhfMDFRVGRKVFN2eDJ2RjVZaDlKQjlhQnpnIiwicGhhc2UiOjh9fSwiZHJhZnRFeGNoYW5nZSI6eyJyZXF1ZXN0X21lc3NhZ2UiOiIiLCJyaWNoX3RleHRfanNvbl9yZXByIjp7InR5cGUiOiJkb2MiLCJjb250ZW50IjpbeyJ0eXBlIjoicGFyYWdyYXBoIn1dfSwibWVudGlvbmVkX2l0ZW1zIjpbXSwic3RhdHVzIjoiZHJhZnQifSwicmVxdWVzdElkcyI6W10sImlzUGlubmVkIjpmYWxzZSwiaXNTaGFyZWFibGUiOnRydWUsImV4dHJhRGF0YSI6eyJpc0FnZW50Q29udmVyc2F0aW9uIjp0cnVlLCJoYXNEaXJ0eUVkaXRzIjp0cnVlfSwicGVyc29uYVR5cGUiOjAsInJvb3RUYXNrVXVpZCI6IjI2YTMwMTQyLWFmNjktNGY1Yi1hYjA3LWIzZTE4ZGJkODU2ZSJ9fSwiYWdlbnRFeGVjdXRpb25Nb2RlIjoibWFudWFsIiwiaXNQYW5lbENvbGxhcHNlZCI6dHJ1ZSwiZGlzcGxheWVkQW5ub3VuY2VtZW50cyI6W10sImlzQWdlbnRFZGl0c0NvbGxhcHNlZCI6dHJ1ZSwiaXNDb250ZXh0UGFuZU9wZW4iOmZhbHNlLCJpc0FjdGlvbnNQYW5lT3BlbiI6ZmFsc2UsInNvcnRDb252ZXJzYXRpb25zQnkiOiJsYXN0TWVzc2FnZVRpbWVzdGFtcCJ9" />
      </map>
    </option>
  </component>
</project>